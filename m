Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-bk0-f46.google.com ([209.85.214.46]:64357 "EHLO
	mail-bk0-f46.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1751523Ab2ANSii (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Sat, 14 Jan 2012 13:38:38 -0500
Received: by bkuw12 with SMTP id w12so702066bku.19
        for <linux-media@vger.kernel.org>; Sat, 14 Jan 2012 10:38:37 -0800 (PST)
MIME-Version: 1.0
Date: Sat, 14 Jan 2012 19:38:37 +0100
Message-ID: <CAEN_-SC+oQ5M+yMra8ubrRt0ZxgLCdHM5NG1OGqZMnvRw92vRA@mail.gmail.com>
Subject: xc4000: add direct signal and noise reading
From: =?ISO-8859-2?Q?Miroslav_Sluge=F2?= <thunder.mmm@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=000e0ce0f3061cf71304b6814a91
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--000e0ce0f3061cf71304b6814a91
Content-Type: text/plain; charset=ISO-8859-1



--000e0ce0f3061cf71304b6814a91
Content-Type: text/x-patch; charset=US-ASCII;
	name="xc4000-add-direct-signal-and-noise-registers.patch"
Content-Disposition: attachment;
	filename="xc4000-add-direct-signal-and-noise-registers.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gxezbrem0

U2lnbmVkLW9mZi1ieTogTWlyb3NsYXYgU2x1Z2VuIDx0aHVuZGVyLm1tbUBnbWFpbC5jb20+CkZy
b206IE1pcm9zbGF2IFNsdWdlbiA8dGh1bmRlci5tbW1AZ21haWwuY29tPgpEYXRlOiBXZWQsIDIx
IERlYyAyMDExIDAxOjE4OjM4ICswMTAwClN1YmplY3Q6IFtQQVRDSF0gSW4geGM0MDAwIGNoaXBz
ZXRzIHJlYWwgc2lnbmFsIGFuZCBub2lzZSBsZXZlbCBpcyBzdG9yZWQgaW4gcmVnaXN0ZXIgMHgw
QSBhbmQgMHgwQiwKIHNvIHdlIGNhbiB1c2UgdGhvc2UgcmVnaXN0ZXJzIHRvIG1vbml0b3Igc2ln
bmFsIHN0cmVuZ3RoLgoKSSB0ZXN0ZWQgdGhpcyBwYXRjaCBvbiAyIGRpZmZlcmVudCBjYXJkcyBM
ZWFkdGVrIERWUjMyMDAgYW5kIERUVjIwMDBIIFBsdXMsIGJvdGgKd2l0aCBzYW1lIHJlc3VsdHMs
IEkgdXNlZCBzcGVjaWFsIGFudGVubmEgaHVicyAodG9uZXIgNHgsIDZ4LCA4eCBhbmQgMTJ4KSB3
aXRoIG1lc3VyZWQKc2lnbmFsIGxvc3QsIGJvdGggcmVnaXN0ZXJzIGFyZSBpbiBkQiB2YWx1ZSwg
Zmlyc3QgcmVwcmVzZW50IHNpZ25hbCB3aXRoIGxpbWl0CnZhbHVlIC0xMTMuNWRCIChzaG91bGQg
YmUgLTExNGRCKSBhbmQgZXhhY3RseSBtYXRjaCB3aXRoIHRlc3QgcmVzdWx0cy4gU2Vjb25kIHJl
cHJlc2VudHMKbm9pc2UgbGV2ZWwgYWxzbyBpbiBkQiBhbmQgdGhlcmUgaXMgbm8gbWF4aW11bSB2
YWx1ZSwgYnV0IGZyb20gdGVzdHMgd2UgY2FuIGRyb3AKZXZlcnl0aGluZyBhYm92ZSAzMmRCIHdo
aWNoIHR1bmVyIHJlYWx5IGNhbid0IHVzZSwgc2lnbmFsIHdhcyB1c2FibGUgdGlsbCAyMGRCIG5v
aXNlIGxldmVsLgoKSW4gZGlnaXRhbCBtb2RlIHdlIGNhbiB0YWtlIHNpZ25hbCBzdHJlbmd0aCBi
dXQgc2FkbHkgbm9pc2UgbGV2ZWwgaXMgbm90IHJlbGV2YW50IGFuZApyZWFsIHZhbHVlIGlzIHN0
b3JlZCBpbiBkZW1vZHVsYXRvciBmb3Igbm93IGp1c3QgemwxMDM1MywgYWxzbyBkaWdpdGFsIG1v
ZGUgaXMganVzdCBmb3IKdGVzdGluZywgYmVjYXVzZSBpdCBuZWVkcyBjaGFuZ2luZyBvdGhlciBw
YXJ0cyBvZiBjb2RlIHdoaWNoIHJlYWRzIGRhdGEgb25seSBmcm9tCmRlbW9kdWxhdG9yLgoKSW4g
YW5hbG9nIG1vZGUgSSB3YXMgYWJsZSB0byB0ZXN0IG9ubHkgRk0gcmFkaW8sIHNpZ25hbCBsZXZl
bCBpcyBub3QgaW1wb3J0YW50LCBpdCBzYXlzCnNvbWV0aGluZyBhYm91dCBjYWJsZSBhbmQgaHVi
IGxvc3RzLCBidXQgbm90aGluZyBhYm91dCByZWFsIHF1YWxpdHkgb2YgcmVjZXB0aW9uLCBzbyBl
dmVuCmlmIHdlIGhhdmUgc2lnbmFsIGxldmVsIGF0IG1pbmltdW0gMTEzZEIgd2UgY2FuIHN0aWxs
IGhlcmUgcmFkaW8sIGJlY2F1c2Ugb2YgdGhhdCBpdCBpcwpkaXNwbGFpZWQgb25seSBpbiBkZWJ1
ZyBtb2RlLCBidXQgZm9yIHJlYWwgc2lnbmFsIGxldmVsIGlzIHVzZWQgbm9pc2UgcmVnaXN0ZXIg
d2hpY2ggaXMKYWdhaW4gdmVyeSBhY2N1cmF0ZSwgcmFkaW8gbm9pc2UgbGV2ZWwgd2FzIGJldHdl
biA2LTIwZEIgZm9yIGdvb2Qgc2lnbmFsLCAyMC0yNWRCIGZvcgptZWRpdW0gc2lnbmFsLCBhbmQg
YWJvdmUgMjVkQiBzaWduYWwgaXMgdW51c2FibGUuCgpGb3Igbm93IHJlYWwgYmVuZWZpdCBvZiB0
aGlzIHBhdGNoIGlzIG9ubHkgZm9yIEZNIHJhZGlvIG1vZGUuCi0tLQogZHJpdmVycy9tZWRpYS9j
b21tb24vdHVuZXJzL3hjNDAwMC5jIHwgICA4NiArKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrCiAxIGZpbGVzIGNoYW5nZWQsIDg2IGluc2VydGlvbnMoKyksIDAgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL3hjNDAwMC5jIGIvZHJp
dmVycy9tZWRpYS9jb21tb24vdHVuZXJzL3hjNDAwMC5jCmluZGV4IDYzNGY0ZDkuLjM3NTgxYzMg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3R1bmVycy94YzQwMDAuYworKysgYi9k
cml2ZXJzL21lZGlhL2NvbW1vbi90dW5lcnMveGM0MDAwLmMKQEAgLTE1NCw2ICsxNTQsOCBAQCBz
dHJ1Y3QgeGM0MDAwX3ByaXYgewogI2RlZmluZSBYUkVHX1NOUiAgICAgICAgICAweDA2CiAjZGVm
aW5lIFhSRUdfVkVSU0lPTiAgICAgIDB4MDcKICNkZWZpbmUgWFJFR19QUk9EVUNUX0lEICAgMHgw
OAorI2RlZmluZSBYUkVHX1NJR05BTF9MRVZFTCAweDBBCisjZGVmaW5lIFhSRUdfTk9JU0VfTEVW
RUwgIDB4MEIKIAogLyoKICAgIEJhc2ljIGZpcm13YXJlIGRlc2NyaXB0aW9uLiBUaGlzIHdpbGwg
cmVtYWluIHdpdGgKQEAgLTQ4Niw2ICs0ODgsMTYgQEAgc3RhdGljIGludCB4Y19nZXRfcXVhbGl0
eShzdHJ1Y3QgeGM0MDAwX3ByaXYgKnByaXYsIHUxNiAqcXVhbGl0eSkKIAlyZXR1cm4geGM0MDAw
X3JlYWRyZWcocHJpdiwgWFJFR19RVUFMSVRZLCBxdWFsaXR5KTsKIH0KIAorc3RhdGljIGludCB4
Y19nZXRfc2lnbmFsX2xldmVsKHN0cnVjdCB4YzQwMDBfcHJpdiAqcHJpdiwgdTE2ICpzaWduYWwp
Cit7CisJcmV0dXJuIHhjNDAwMF9yZWFkcmVnKHByaXYsIFhSRUdfU0lHTkFMX0xFVkVMLCBzaWdu
YWwpOworfQorCitzdGF0aWMgaW50IHhjX2dldF9ub2lzZV9sZXZlbChzdHJ1Y3QgeGM0MDAwX3By
aXYgKnByaXYsIHUxNiAqbm9pc2UpCit7CisJcmV0dXJuIHhjNDAwMF9yZWFkcmVnKHByaXYsIFhS
RUdfTk9JU0VfTEVWRUwsIG5vaXNlKTsKK30KKwogc3RhdGljIHUxNiB4Y193YWl0X2Zvcl9sb2Nr
KHN0cnVjdCB4YzQwMDBfcHJpdiAqcHJpdikKIHsKIAl1MTYJbG9ja19zdGF0ZSA9IDA7CkBAIC0x
MDg5LDYgKzExMDEsOCBAQCBzdGF0aWMgdm9pZCB4Y19kZWJ1Z19kdW1wKHN0cnVjdCB4YzQwMDBf
cHJpdiAqcHJpdikKIAl1MzIJaHN5bmNfZnJlcV9oeiA9IDA7CiAJdTE2CWZyYW1lX2xpbmVzOwog
CXUxNglxdWFsaXR5OworCXUxNglzaWduYWwgPSAwOworCXUxNglub2lzZSA9IDA7CiAJdTgJaHdf
bWFqb3J2ZXJzaW9uID0gMCwgaHdfbWlub3J2ZXJzaW9uID0gMDsKIAl1OAlmd19tYWpvcnZlcnNp
b24gPSAwLCBmd19taW5vcnZlcnNpb24gPSAwOwogCkBAIC0xMTE5LDYgKzExMzMsMTIgQEAgc3Rh
dGljIHZvaWQgeGNfZGVidWdfZHVtcChzdHJ1Y3QgeGM0MDAwX3ByaXYgKnByaXYpCiAKIAl4Y19n
ZXRfcXVhbGl0eShwcml2LCAmcXVhbGl0eSk7CiAJZHByaW50aygxLCAiKioqIFF1YWxpdHkgKDA6
PDhkQiwgNzo+NTZkQikgPSAlZFxuIiwgcXVhbGl0eSk7CisKKwl4Y19nZXRfc2lnbmFsX2xldmVs
KHByaXYsICZzaWduYWwpOworCWRwcmludGsoMSwgIioqKiBTaWduYWwgbGV2ZWwgPSAtJWRkQiAo
JWQpXG4iLCBzaWduYWwgPj4gOCwgc2lnbmFsKTsKKworCXhjX2dldF9ub2lzZV9sZXZlbChwcml2
LCAmbm9pc2UpOworCWRwcmludGsoMSwgIioqKiBOb2lzZSBsZXZlbCA9ICVkZEIgKCVkKVxuIiwg
bm9pc2UgPj4gOCwgbm9pc2UpOwogfQogCiBzdGF0aWMgaW50IHhjNDAwMF9zZXRfcGFyYW1zKHN0
cnVjdCBkdmJfZnJvbnRlbmQgKmZlLApAQCAtMTQ1MSw2ICsxNDcxLDcxIEBAIGZhaWw6CiAJcmV0
dXJuIHJldDsKIH0KIAorc3RhdGljIGludCB4YzQwMDBfZ2V0X3NpZ25hbChzdHJ1Y3QgZHZiX2Zy
b250ZW5kICpmZSwgdTE2ICpzdHJlbmd0aCkKK3sKKwlzdHJ1Y3QgeGM0MDAwX3ByaXYgKnByaXYg
PSBmZS0+dHVuZXJfcHJpdjsKKwl1MTYgdmFsdWUgPSAwOworCWludCByYzsKKworCW11dGV4X2xv
Y2soJnByaXYtPmxvY2spOworCXJjID0geGM0MDAwX3JlYWRyZWcocHJpdiwgWFJFR19TSUdOQUxf
TEVWRUwsICZ2YWx1ZSk7CisJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKKworCWlmIChyYyA8
IDApCisJCWdvdG8gcmV0OworCisJLyogSW5mb3JtYXRpb25zIGZyb20gcmVhbCB0ZXN0aW5nIG9m
IERWQi1UIGFuZCByYWRpbyBwYXJ0LAorCSAgIGNvZWZpY2llbnQgZm9yIG9uZSBkQiBpcyAweGZm
LgorCSAqLworCXR1bmVyX2RiZygiU2lnbmFsIHN0cmVuZ3RoOiAtJWRkQiAoJTA1ZClcbiIsIHZh
bHVlID4+IDgsIHZhbHVlKTsKKworCS8qIGFsbCBrbm93biBkaWdpdGFsIG1vZGVzICovCisJaWYg
KChwcml2LT52aWRlb19zdGFuZGFyZCA9PSBYQzQwMDBfRFRWNikgfHwKKwkgICAgKHByaXYtPnZp
ZGVvX3N0YW5kYXJkID09IFhDNDAwMF9EVFY3KSB8fAorCSAgICAocHJpdi0+dmlkZW9fc3RhbmRh
cmQgPT0gWEM0MDAwX0RUVjdfOCkgfHwKKwkgICAgKHByaXYtPnZpZGVvX3N0YW5kYXJkID09IFhD
NDAwMF9EVFY4KSkKKwkJZ290byBkaWdpdGFsOworCisJLyogQW5hbG9nIG1vZGUgaGFzIE5PSVNF
IExFVkVMIGltcG9ydGFudCwgc2lnbmFsCisJICAgZGVwZW5kcyBvbmx5IG9uIGdhaW4gb2YgYW50
ZW5uYSBhbmQgYW1wbGlmaWVycywKKwkgICBidXQgaXQgZG9lc24ndCB0ZWxsIGFueXRoaW5nIGFi
b3V0IHJlYWwgcXVhbGl0eQorCSAgIG9mIHJlY2VwdGlvbi4KKwkgKi8KKwltdXRleF9sb2NrKCZw
cml2LT5sb2NrKTsKKwlyYyA9IHhjNDAwMF9yZWFkcmVnKHByaXYsIFhSRUdfTk9JU0VfTEVWRUws
ICZ2YWx1ZSk7CisJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKKworCXR1bmVyX2RiZygiTm9p
c2UgbGV2ZWw6ICVkZEIgKCUwNWQpXG4iLCB2YWx1ZSA+PiA4LCB2YWx1ZSk7CisKKwkvKiBoaWdo
ZXN0IG5vaXNlIGxldmVsOiAzMmRCICovCisJaWYgKHZhbHVlID49IDB4MjAwMCkgeworCQl2YWx1
ZSA9IDA7CisJfSBlbHNlIHsKKwkJdmFsdWUgPSB+dmFsdWUgPDwgMzsKKwl9CisKKwlnb3RvIHJl
dDsKKworCS8qIERpZ2l0YWwgbW9kZSBoYXMgU0lHTkFMIExFVkVMIGltcG9ydGFudCBhbmQgcmVh
bAorCSAgIG5vaXNlIGxldmVsIGlzIHN0b3JlZCBpbiBkZW1vZHVsYXRvciByZWdpc3RlcnMuCisJ
ICovCitkaWdpdGFsOgorCS8qIGJlc3Qgc2lnbmFsOiAtNTBkQiAqLworCWlmICh2YWx1ZSA8PSAw
eDMyMDApIHsKKwkJdmFsdWUgPSAweGZmZmY7CisJLyogbWluaW11bTogLTExNGRCIC0gc2hvdWxk
IGJlIDB4NzIwMCBidXQgcmVhbCB6ZXJvIGlzIDB4NzEzQSAqLworCX0gZWxzZSBpZiAodmFsdWUg
Pj0gMHg3MTNBKSB7CisJCXZhbHVlID0gMDsKKwl9IGVsc2UgeworCQl2YWx1ZSA9IH4odmFsdWUg
LSAweDMyMDApIDw8IDI7CisJfQorCityZXQ6CisJKnN0cmVuZ3RoID0gdmFsdWU7CisKKwlyZXR1
cm4gcmM7Cit9CisKIHN0YXRpYyBpbnQgeGM0MDAwX2dldF9mcmVxdWVuY3koc3RydWN0IGR2Yl9m
cm9udGVuZCAqZmUsIHUzMiAqZnJlcSkKIHsKIAlzdHJ1Y3QgeGM0MDAwX3ByaXYgKnByaXYgPSBm
ZS0+dHVuZXJfcHJpdjsKQEAgLTE1NzgsNiArMTY2Myw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qg
ZHZiX3R1bmVyX29wcyB4YzQwMDBfdHVuZXJfb3BzID0gewogCS5zZXRfcGFyYW1zCSAgID0geGM0
MDAwX3NldF9wYXJhbXMsCiAJLnNldF9hbmFsb2dfcGFyYW1zID0geGM0MDAwX3NldF9hbmFsb2df
cGFyYW1zLAogCS5nZXRfZnJlcXVlbmN5CSAgID0geGM0MDAwX2dldF9mcmVxdWVuY3ksCisJLmdl
dF9yZl9zdHJlbmd0aCAgID0geGM0MDAwX2dldF9zaWduYWwsCiAJLmdldF9iYW5kd2lkdGgJICAg
PSB4YzQwMDBfZ2V0X2JhbmR3aWR0aCwKIAkuZ2V0X3N0YXR1cwkgICA9IHhjNDAwMF9nZXRfc3Rh
dHVzCiB9OwotLSAKMS43LjIuMwoK
--000e0ce0f3061cf71304b6814a91--
