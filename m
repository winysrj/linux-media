Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.atb-potsdam.de ([141.89.210.5]:52663 "EHLO
	mailgate.atb-potsdam.de" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1753091AbaIBMWN (ORCPT
	<rfc822;linux-media@vger.kernel.org>); Tue, 2 Sep 2014 08:22:13 -0400
From: =?utf-8?B?TcOhY2hhLCBLYXJlbA==?= <KMacha@atb-potsdam.de>
To: "linux-media@vger.kernel.org" <linux-media@vger.kernel.org>
Subject: Corrupt images, when capturing images from multiple cameras using the
 V4L2 driver
Date: Tue, 2 Sep 2014 12:06:46 +0000
Message-ID: <BDE207EB81F3F14F85CFF86344BBE70E2D2FDF@saturn.atb-potsdam.de>
Content-Language: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

SGVsbG8sIAoKSSB3b3VsZCBsaWtlIHRvIGdyYWIgaW1hZ2VzIGZyb20gbXVsdGlwbGUgY2FtZXJh
cyB1bmRlciB1c2luZyB0aGUgVjRMMgpBUEkuIEkgZm9sbG93ZWQgdGhlIHByZXNlbnRhdGlvbiB1
bmRlciBmb3VuZCBvbgpodHRwOi8vbGludXh0di5vcmcvZG93bmxvYWRzL3ByZXNlbnRhdGlvbnMv
c3VtbWl0X2p1bl8yMDEwLzIwMTAwMjA2LWZvc2RlbS5wZGYgCnVzZWQgdGhlIGNvZGUgYW5kIGFk
YXB0ZWQgaXQgc2lnaHRseSBmb3IgbXkgcHVycG9zZS4gSXQgd29ya3MgdmVyeSB3ZWxsCmZvciAx
IGNhbWVyYS4KCkhvd2V2ZXIgT25jZSBJIGJlZ2luIHRvIGdyYWIgaW1hZ2VzIGZyb20gbXVsdGlw
bGUgY2FtZXJhcyAoc3VjY2Vzc2l2ZWx5KQpJIGdldCBjb3JydXB0IGltYWdlcy4gSSB1cGxvYWRl
ZCBhbiBleGFtcGxlIGltYWdlIHRvCmh0dHA6Ly93d3cuZGlyZWN0dXBsb2FkLm5ldC9maWxlL2Qv
MzczMy85YzRqeDNwdl9wbmcuaHRtCgpBbHRob3VnaCBJIHNldCB0aGUgcmlnaHQgcmVzb2x1dGlv
biBmb3IgdGhlIGNhbWVyYSAoNzQ0IHggNDgwKSwgdGhlCm91dHB1dCBvZiBidWZmZXIuYnl0ZXN1
c2VkLCBhZnRlciB0aGUgVklESU9DX0RRQlVGIGRvZXMgbm90IGNvcnJlc3BvbmQKd2l0aCB0aGUg
ZXhwZWN0ZWQgdmFsdWUgKDc0NHg0ODAgPSAzNTcxMjApLiBUaGlzIHdvdWxkIHByb2JhYmx5IGV4
cGxhaW4KdGhlIGNvcnJ1cHQgaW1hZ2VzLgoKVGhlIG1vcmUgY2FtZXJhIEkgdXNlLCB0aGUgbGVz
cyBidWZmZXIuYnl0ZXN1c2VkIEkgZ2V0IGFuZCB0aGUgbW9yZQpzdHJpcGVzIGFyZSBpbiB0aGUg
aW1hZ2UuIENvdWxkIHlvdSBwbGVhc2UgZ2l2ZSBtZSBhIGhpbnQsIHdoYXQgYW0gSQpkb2luZyB3
cm9uZyA/CgpUaGFua3MsIEthcmVsCgpIZXJlIGlzIHRoZSBtaW5pbWFsIEMgY29kZSBJIHVzZSBm
b3IgbXkgYXBwbGljYXRpb246CgoKaW50IG1haW4oKQp7CgkvKiAjIyMjIyMjIyMjIyMjIyMjIyMj
IyMgSU5JVCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMgKi8KCglpbnQgbnVtT2ZDYW1lcmFzID0gNjsK
CWludCB4UmVzID0gNzQ0OwoJaW50IHlSZXMgPSA0ODA7CglpbnQgZXhwb3N1cmUgPSAyMDAwOwoJ
dW5zaWduZWQgaW50IHRpbWVCZXR3ZWVuU25hcHNob3RzID0gMjsgLy8gaW4gc2VjCgljaGFyIGZp
bGVOYW1lW3NpemVvZiAiLi9vdXRwdXQvaW1hZ2UgMDAwIGZyb20gY2FtZXJhIDAuUE5HIl07CgoJ
c3RhdGljIGNvbnN0IGNoYXIgKmRldmljZXNbXSA9IHsgIi9kZXYvdmlkZW8wIiwgIi9kZXYvdmlk
ZW8xIiwKIi9kZXYvdmlkZW8yIiwgIi9kZXYvdmlkZW8zIiwgIi9kZXYvdmlkZW80IiwgIi9kZXYv
dmlkZW81IiwKIi9kZXYvdmlkZW82IiwgIi9kZXYvdmlkZW83IiB9OwoKCXN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgY2FwWzhdOwoJc3RydWN0IHY0bDJfY29udHJvbCBjb250cm9sWzhdOwoJc3RydWN0
IHY0bDJfZm9ybWF0IGZvcm1hdFs4XTsKCXN0cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzIHJlcVs4
XTsKCXN0cnVjdCB2NGwyX2J1ZmZlciBidWZmZXJbOF07CgoJaW50IHR5cGUgPSBWNEwyX0JVRl9U
WVBFX1ZJREVPX0NBUFRVUkU7IC8vIGhhZCB0byBkZWNsYXJlIHRoZSB0eXBlIGhlcmUKYmVjYXVz
ZSBvZiB0aGUgbG9vcAoKCXVuc2lnbmVkIGludCBpOwoJdW5zaWduZWQgaW50IGo7Cgl1bnNpZ25l
ZCBpbnQgazsKCglpbnQgZmRbOF07Cgl2b2lkICoqbWVtWzhdOwoJLy91bnNpZ25lZCBjaGFyICoq
bWVtWzhdOwoKCS8qICMjIyMjIyMjIyMjIyMjIyMjIyMjIyBPUEVOIERFVklDRSAjIyMjIyMjIyMj
IyMjIyMjIyMjIyMgKi8KCglmb3IgKGogPSAwOyBqIDwgbnVtT2ZDYW1lcmFzOyArK2opIHsKCgkJ
ZmRbal0gPSBvcGVuKGRldmljZXNbal0sIE9fUkRXUik7CgkJaW9jdGwoZmRbal0sIFZJRElPQ19R
VUVSWUNBUCwgJmNhcFtqXSk7CgoKCQkvKiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ0FNIENPTlRS
T0xMICMjIyMjIyMjIyMjIyMjIyAqLwoKCQljb250cm9sW2pdLmlkID0gVjRMMl9DSURfRVhQT1NV
UkVfQVVUTzsKCQljb250cm9sW2pdLnZhbHVlID0gVjRMMl9FWFBPU1VSRV9TSFVUVEVSX1BSSU9S
SVRZOwoJCWlvY3RsKGZkW2pdLCBWSURJT0NfU19DVFJMLCAmY29udHJvbFtqXSk7CgoJCWNvbnRy
b2xbal0uaWQgPSBWNEwyX0NJRF9FWFBPU1VSRV9BQlNPTFVURTsKCQljb250cm9sW2pdLnZhbHVl
ID0gZXhwb3N1cmU7CgkJaW9jdGwoZmRbal0sIFZJRElPQ19TX0NUUkwsICZjb250cm9sW2pdKTsK
CgkJLyogIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEZPUk1BVCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMg
Ki8KCgkJaW9jdGwoZmRbal0sIFZJRElPQ19HX0ZNVCwgJmZvcm1hdFtqXSk7CgkJZm9ybWF0W2pd
LnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkU7CgkJZm9ybWF0W2pdLmZtdC5waXgu
d2lkdGggPSB4UmVzOwoJCWZvcm1hdFtqXS5mbXQucGl4LmhlaWdodCA9IHlSZXM7CgkJLy9mb3Jt
YXQuZm10LnBpeC5waXhlbGZvcm1hdCA9IFY0TDJfUElYX0ZNVF9ZVVlWOwoJCWZvcm1hdFtqXS5m
bXQucGl4LnBpeGVsZm9ybWF0ID0gVjRMMl9QSVhfRk1UX0dSRVk7CgkJaW9jdGwoZmRbal0sIFZJ
RElPQ19TX0ZNVCwgJmZvcm1hdFtqXSk7CgoJCS8qICMjIyMjIyMjIyMjIyMjIyMjIyMjIyBSRVEg
QlVGICMjIyMjIyMjIyMjIyMjIyMjIyMjICovCgoJCXJlcVtqXS50eXBlID0gVjRMMl9CVUZfVFlQ
RV9WSURFT19DQVBUVVJFOwoJCXJlcVtqXS5jb3VudCA9IDQ7CgkJcmVxW2pdLm1lbW9yeSA9IFY0
TDJfTUVNT1JZX01NQVA7CgkJaW9jdGwoZmRbal0sIFZJRElPQ19SRVFCVUZTLCAmcmVxW2pdKTsK
CQltZW1bal0gPSBtYWxsb2MocmVxW2pdLmNvdW50ICogc2l6ZW9mKCptZW0pKTsKCgkJLyogIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIE1NQVAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjICovCgoJCWZvciAo
aSA9IDA7IGkgPCByZXFbal0uY291bnQ7ICsraSkgewoJCQlidWZmZXJbal0udHlwZSA9IFY0TDJf
QlVGX1RZUEVfVklERU9fQ0FQVFVSRTsKCQkJYnVmZmVyW2pdLm1lbW9yeSA9IFY0TDJfTUVNT1JZ
X01NQVA7CgkJCWJ1ZmZlcltqXS5pbmRleCA9IGk7CgkJCWlvY3RsKGZkW2pdLCBWSURJT0NfUVVF
UllCVUYsICZidWZmZXJbal0pOwoJCQltZW1bal1baV0gPSBtbWFwKDAsIGJ1ZmZlcltqXS5sZW5n
dGgsCgkJCQkJUFJPVF9SRUFEfFBST1RfV1JJVEUsCgkJCQkJTUFQX1NIQVJFRCwgZmRbal0sIGJ1
ZmZlcltqXS5tLm9mZnNldCk7CgkJfQoKCQkvKiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ1JFQVRF
IFFVRVVFICMjIyMjIyMjIyMjIyMjIyAqLwoKCQlmb3IgKGkgPSAwOyBpIDwgcmVxW2pdLmNvdW50
OyArK2kpIHsKCQkJYnVmZmVyW2pdLnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkU7
CgkJCWJ1ZmZlcltqXS5tZW1vcnkgPSBWNEwyX01FTU9SWV9NTUFQOwoJCQlidWZmZXJbal0uaW5k
ZXggPSBpOwoJCQlpb2N0bChmZFtqXSwgVklESU9DX1FCVUYsICZidWZmZXJbal0pOwoJCX0KCgl9
IC8qICMjIyAjIyMgZW5kIG9mIGNhbWVyYSBpbml0ICMjIyAjIyMgKi8KCgkvKiAjIyMjIyMjIyMj
IyMjIyMjIyMjIyMgU1RSRUFNIE9OICMjIyMjIyMjIyMjIyMjIyMjIyMjIyAqLwoJZm9yIChqID0g
MDsgaiA8IG51bU9mQ2FtZXJhczsgKytqKSB7CgoJCWlvY3RsKGZkW2pdLCBWSURJT0NfU1RSRUFN
T04sICZ0eXBlKTsKCX0KCgoJLyogIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEdFVCBGUkFNRSAjIyMj
IyMjIyMjIyMjIyMjIyMjIyMgKi8KCglrID0gMDsKCXdoaWxlICgha2JoaXQoKSl7CgkJayArKzsK
CgkJZm9yIChqID0gMDsgaiA8IG51bU9mQ2FtZXJhczsgaisrKSB7CgoJCQlidWZmZXJbal0udHlw
ZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRTsKCQkJYnVmZmVyW2pdLm1lbW9yeSA9IFY0
TDJfTUVNT1JZX01NQVA7CgkJCXVzbGVlcCgxMDAwMDApOwoJCQlpb2N0bChmZFtqXSwgVklESU9D
X0RRQlVGLCAmYnVmZmVyW2pdKTsKCQkJcHJpbnRmKCJcbkJ1ZmZlciB7JXB9LCBCdWYuIEluZGV4
ICVkLCBCdWYuIGJ5dGVzIHVzZWQgJWRcbiIsCm1lbVtqXVtidWZmZXJbal0uaW5kZXhdLCBidWZm
ZXJbal0uaW5kZXgsICBidWZmZXJbal0uYnl0ZXN1c2VkKTsKCgkJCS8vIGNyZWF0ZSBmaWxlbmFt
ZQoJCQlzcHJpbnRmKGZpbGVOYW1lLCAiLi9vdXRwdXQvaW1hZ2UgJTAzZCBmcm9tIGNhbWVyYSAl
ZC5QTkciLCBrLCBqKTsKCQkJLy8gc2F2ZSBhcyBQTkcgZmlsZQoJCQlzYXZlVG9QbmcobWVtW2pd
W2J1ZmZlcltqXS5pbmRleF0sIGZpbGVOYW1lLCB4UmVzLCB5UmVzKTsKCgkJCWlvY3RsKGZkW2pd
LCBWSURJT0NfUUJVRiwgJmJ1ZmZlcltqXSk7CgoJCQlzbGVlcCh0aW1lQmV0d2VlblNuYXBzaG90
cyk7CgkJfQoJfQoKCS8qICMjIyMjIyMjIyMjIyMjIyMjIyMjIyBTVFJFQU0gT0ZGICMjIyMjIyMj
IyMjIyMjIyMjIyMjIyAqLwoJZm9yIChqID0gMDsgaiA8IG51bU9mQ2FtZXJhczsgKytqKSB7CgoJ
CWlvY3RsKGZkW2pdLCBWSURJT0NfU1RSRUFNT0ZGLCAmdHlwZSk7Cgl9CgoJLyogIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIENMRUFOVVAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjICovCgoJZm9yIChqID0g
MDsgaiA8IG51bU9mQ2FtZXJhczsgKytqKSB7CgoJCWNsb3NlKGZkW2pdKTsKCQlmcmVlKG1lbVtq
XSk7Cgl9CgoJcmV0dXJuICgwKTsKfQoKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgpMZWlibml6LUluc3RpdHV0IGbD
vHIgQWdyYXJ0ZWNobmlrIFBvdHNkYW0tQm9ybmltIGUuVi4KTWF4LUV5dGgtQWxsZWUgMTAwCkQt
MTQ0NjkgUG90c2RhbQogClZvcnN0YW5kOiAKUHJvZi4gRHIuIFJlaW5lciBCcnVuc2NoIChXaXNz
ZW5zY2hhZnRsaWNoZXIgRGlyZWt0b3IpCkRyLiBNYXJ0aW4gR2V5ZXIgKFN0ZWxsdmVydHJldGVy
IGRlcyBXaXNzZW5zY2hhZnRsaWNoZW4gRGlyZWt0b3JzKQpQcm9mLiBEci4gVGhvbWFzIEFtb24g
ICgyLiBTdGVsbHZlcnRyZXRlciBkZXMgV2lzc2Vuc2NoYWZ0bGljaGVuIERpcmVrdG9ycykKRHIu
IFV0YSBUaWV0eiAoVmVyd2FsdHVuZ3NsZWl0ZXJpbikgCkFtdHNnZXJpY2h0IFBvdHNkYW0sIFZS
IDY4MCBQLCBVU3QtSUQgREU4MTE3MDQxNTAKCioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKVGhpcyBlbWFpbCBhbmQg
YW55IGZpbGVzIHRyYW5zbWl0dGVkIHdpdGggaXQgYXJlIGNvbmZpZGVudGlhbCBhbmQKaW50ZW5k
ZWQgc29sZWx5IGZvciB0aGUgdXNlIG9mIHRoZSBpbmRpdmlkdWFsIG9yIGVudGl0eSB0byB3aG9t
IHRoZXkKYXJlIGFkZHJlc3NlZC4gSWYgeW91IGhhdmUgcmVjZWl2ZWQgdGhpcyBlbWFpbCBpbiBl
cnJvciBwbGVhc2Ugbm90aWZ5CnRoZSBzeXN0ZW0gbWFuYWdlci4KClNjYW5uZWQgYnkgdGhlIENs
ZWFyc3dpZnQgU0VDVVJFIEVtYWlsIEdhdGV3YXkuCgp3d3cuY2xlYXJzd2lmdC5jb20KKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgo=
