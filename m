Return-path: <mchehab@pedra>
Received: from mailout-de.gmx.net ([213.165.64.23]:51080 "HELO
	mailout-de.gmx.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with SMTP id S1752754Ab1AYWyd (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Tue, 25 Jan 2011 17:54:33 -0500
From: Peter =?iso-8859-1?q?H=FCwe?= <PeterHuewe@gmx.de>
To: Julia Lawall <julia@diku.dk>
Subject: Re: [PATCH] video/saa7164: Fix sparse warning: Using plain integer as NULL pointer
Date: Tue, 25 Jan 2011 23:54:30 +0100
Cc: Mauro Carvalho Chehab <mchehab@infradead.org>,
	linux-media@vger.kernel.org, linux-kernel@vger.kernel.org,
	kernel-janitors@vger.kernel.org,
	Steven Toth <stoth@kernellabs.com>, Tejun Heo <tj@kernel.org>,
	Dan Carpenter <error27@gmail.com>
References: <1295988851-23561-1-git-send-email-peterhuewe@gmx.de> <Pine.LNX.4.64.1101252319570.3668@ask.diku.dk>
In-Reply-To: <Pine.LNX.4.64.1101252319570.3668@ask.diku.dk>
MIME-Version: 1.0
Content-Type: Text/Plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Message-Id: <201101252354.31217.PeterHuewe@gmx.de>
List-ID: <linux-media.vger.kernel.org>
Sender: <mchehab@pedra>

Am Dienstag 25 Januar 2011, 23:20:44 schrieb Julia Lawall:
> On Tue, 25 Jan 2011, Peter Huewe wrote:
> > This patch fixes the warning "Using plain integer as NULL pointer",
> > generated by sparse, by replacing the offending 0s with NULL.
> 
> I recall (a number of years ago) being told that for things like kmalloc,
> the proper test was !x, not x == NULL.
> 
> julia
> 


Hi Julia,

thanks for your input.
So do I understand you correctly if I say
if(!x) is better than if(x==NULL) in any case?

Or only for the kmalloc family?

Do you remember the reason why !x should be preferred?

In Documentation/CodingStyle ,  Chapter 7: Centralized exiting of functions 
there is a function fun with looks like this:
int fun(int a)
{
    int result = 0;
    char *buffer = kmalloc(SIZE);

    if (buffer == NULL)
        return -ENOMEM;

    if (condition1) {
        while (loop1) {
            ...
        }
        result = 1;
        goto out;
    }
    ...
out:
    kfree(buffer);
    return result;
}


-->  So   if (buffer == NULL) is in the official CodingStyle - maybe we should 
add a paragraph there as well ;)


Don't get me wrong, I just want to learn ;)


Thanks,
Peter

