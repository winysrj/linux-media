Return-path: <linux-media-owner@vger.kernel.org>
Received: from mga07.intel.com ([134.134.136.100]:2637 "EHLO mga07.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1728353AbeIQBod (ORCPT <rfc822;linux-media@vger.kernel.org>);
        Sun, 16 Sep 2018 21:44:33 -0400
From: "Zhi, Yong" <yong.zhi@intel.com>
To: Tomasz Figa <tfiga@chromium.org>
CC: Linux Media Mailing List <linux-media@vger.kernel.org>,
        Sakari Ailus <sakari.ailus@linux.intel.com>,
        "Mani, Rajmohan" <rajmohan.mani@intel.com>,
        "Toivonen, Tuukka" <tuukka.toivonen@intel.com>,
        "Hu, Jerry W" <jerry.w.hu@intel.com>,
        "Zheng, Jian Xu" <jian.xu.zheng@intel.com>
Subject: RE: [PATCH v6 12/12] intel-ipu3: Add imgu top level pci device
 driver
Date: Sun, 16 Sep 2018 20:20:17 +0000
Message-ID: <C193D76D23A22742993887E6D207B54D3DAFA2B2@ORSMSX103.amr.corp.intel.com>
References: <1522376100-22098-1-git-send-email-yong.zhi@intel.com>
 <1522376100-22098-13-git-send-email-yong.zhi@intel.com>
 <CAAFQd5CdV2BxBnW4Z70q7Sm0j=e1eO0MTTScFs-zPnMH8JHELw@mail.gmail.com>
In-Reply-To: <CAAFQd5CdV2BxBnW4Z70q7Sm0j=e1eO0MTTScFs-zPnMH8JHELw@mail.gmail.com>
Content-Language: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

SGksIFRvbWFzeiwNCg0KVGhhbmtzIGZvciB0aGUgY29kZSByZXZpZXcuDQoNCj4gLS0tLS1Pcmln
aW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogbGludXgtbWVkaWEtb3duZXJAdmdlci5rZXJuZWwu
b3JnIFttYWlsdG86bGludXgtbWVkaWEtDQo+IG93bmVyQHZnZXIua2VybmVsLm9yZ10gT24gQmVo
YWxmIE9mIFRvbWFzeiBGaWdhDQo+IFNlbnQ6IE1vbmRheSwgSnVseSAyLCAyMDE4IDM6MDggQU0N
Cj4gVG86IFpoaSwgWW9uZyA8eW9uZy56aGlAaW50ZWwuY29tPg0KPiBDYzogTGludXggTWVkaWEg
TWFpbGluZyBMaXN0IDxsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmc+OyBTYWthcmkgQWlsdXMN
Cj4gPHNha2FyaS5haWx1c0BsaW51eC5pbnRlbC5jb20+OyBNYW5pLCBSYWptb2hhbg0KPiA8cmFq
bW9oYW4ubWFuaUBpbnRlbC5jb20+OyBUb2l2b25lbiwgVHV1a2thDQo+IDx0dXVra2EudG9pdm9u
ZW5AaW50ZWwuY29tPjsgSHUsIEplcnJ5IFcgPGplcnJ5LncuaHVAaW50ZWwuY29tPjsgWmhlbmcs
DQo+IEppYW4gWHUgPGppYW4ueHUuemhlbmdAaW50ZWwuY29tPg0KPiBTdWJqZWN0OiBSZTogW1BB
VENIIHY2IDEyLzEyXSBpbnRlbC1pcHUzOiBBZGQgaW1ndSB0b3AgbGV2ZWwgcGNpIGRldmljZQ0K
PiBkcml2ZXINCj4gDQo+IEhpIFlvbmcsDQo+IA0KPiBPbiBGcmksIE1hciAzMCwgMjAxOCBhdCAx
MToxNSBBTSBZb25nIFpoaSA8eW9uZy56aGlAaW50ZWwuY29tPiB3cm90ZToNCj4gPiArLyoNCj4g
PiArICogUXVldWUgYXMgbWFueSBidWZmZXJzIHRvIENTUyBhcyBwb3NzaWJsZS4gSWYgYWxsIGJ1
ZmZlcnMgZG9uJ3QgZml0DQo+ID4gK2ludG8NCj4gPiArICogQ1NTIGJ1ZmZlciBxdWV1ZXMsIHRo
ZXkgcmVtYWluIHVucXVldWVkIGFuZCB3aWxsIGJlIHF1ZXVlZCBsYXRlci4NCj4gPiArICovDQo+
ID4gK2ludCBpbWd1X3F1ZXVlX2J1ZmZlcnMoc3RydWN0IGltZ3VfZGV2aWNlICppbWd1LCBib29s
IGluaXRpYWwpIHsNCj4gPiArICAgICAgIHVuc2lnbmVkIGludCBub2RlOw0KPiA+ICsgICAgICAg
aW50IHIgPSAwOw0KPiA+ICsgICAgICAgc3RydWN0IGltZ3VfYnVmZmVyICppYnVmOw0KPiA+ICsN
Cj4gPiArICAgICAgIGlmICghaXB1M19jc3NfaXNfc3RyZWFtaW5nKCZpbWd1LT5jc3MpKQ0KPiA+
ICsgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gPiArDQo+ID4gKyAgICAgICBtdXRleF9sb2Nr
KCZpbWd1LT5sb2NrKTsNCj4gPiArDQo+ID4gKyAgICAgICAvKiBCdWZmZXIgc2V0IGlzIHF1ZXVl
ZCB0byBGVyBvbmx5IHdoZW4gaW5wdXQgYnVmZmVyIGlzIHJlYWR5ICovDQo+ID4gKyAgICAgICBp
ZiAoIWltZ3VfcXVldWVfZ2V0YnVmKGltZ3UsIElNR1VfTk9ERV9JTikpIHsNCj4gPiArICAgICAg
ICAgICAgICAgbXV0ZXhfdW5sb2NrKCZpbWd1LT5sb2NrKTsNCj4gPiArICAgICAgICAgICAgICAg
cmV0dXJuIDA7DQo+ID4gKyAgICAgICB9DQo+ID4gKyAgICAgICBmb3IgKG5vZGUgPSBJTUdVX05P
REVfSU4gKyAxOyAxOyBub2RlID0gKG5vZGUgKyAxKSAlDQo+ID4gKyBJTUdVX05PREVfTlVNKSB7
DQo+IA0KPiBTaG91bGRuJ3Qgd2UgbWFrZSAobm9kZSAhPSBJTUdVX05PREVfSU4gfHwgaW1ndV9x
dWV1ZV9nZXRidWYoaW1ndSwNCj4gSU1HVV9OT0RFX0lOKSkgdGhlIGNvbmRpdGlvbiBoZXJlLCBy
YXRoZXIgdGhhbiAxPw0KPiANCj4gVGhpcyB3b3VsZCBhbHNvIGxldCB1cyByZW1vdmUgdGhlIGV4
cGxpY2l0IGNhbGwgdG8gaW1ndV9xdWV1ZV9nZXRidWYoKQ0KPiBhYm92ZSB0aGUgbG9vcC4NCj4g
DQoNCkFjaywgd2lsbCBtYWtlIHRoZSBzdWdnZXN0ZWQgY2hhbmdlcyByZWdhcmRpbmcgdGhlIGxv
b3AgY29uZGl0aW9uIGV2YWx1YXRpb24uDQoNCj4gPiArICAgICAgICAgICAgICAgaWYgKG5vZGUg
PT0gSU1HVV9OT0RFX1ZGICYmDQo+ID4gKyAgICAgICAgICAgICAgICAgICAoaW1ndS0+Y3NzLnBp
cGVfaWQgPT0gSVBVM19DU1NfUElQRV9JRF9DQVBUVVJFIHx8DQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgIWltZ3UtPm5vZGVzW0lNR1VfTk9ERV9WRl0uZW5hYmxlZCkpIHsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICBjb250aW51ZTsNCj4gPiArICAgICAgICAgICAgICAgfSBlbHNlIGlm
IChub2RlID09IElNR1VfTk9ERV9QViAmJg0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
IChpbWd1LT5jc3MucGlwZV9pZCA9PSBJUFUzX0NTU19QSVBFX0lEX1ZJREVPIHx8DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICFpbWd1LT5ub2Rlc1tJTUdVX05PREVfUFZdLmVuYWJs
ZWQpKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQo+ID4gKyAgICAg
ICAgICAgICAgIH0gZWxzZSBpZiAoaW1ndS0+cXVldWVfZW5hYmxlZFtub2RlXSkgew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBpcHUzX2Nzc19idWZmZXIgKmJ1ZiA9DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ3VfcXVldWVfZ2V0YnVm
KGltZ3UsIG5vZGUpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGludCBkdW1teTsNCj4g
PiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFidWYpDQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgciA9IGlwdTNfY3NzX2J1Zl9xdWV1ZSgmaW1ndS0+Y3NzLCBidWYpOw0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGlmIChyKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZHVtbXkgPSBpbWd1
X2R1bW15YnVmc19jaGVjayhpbWd1LCBidWYpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
IGlmICghZHVtbXkpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpYnVmID0g
Y29udGFpbmVyX29mKGJ1Ziwgc3RydWN0IGltZ3VfYnVmZmVyLA0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3NfYnVmKTsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBkZXZfZGJnKCZpbWd1LT5wY2lfZGV2LT5kZXYsDQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicXVldWUgJXMgJXMgYnVmZmVyICVkIHRvIGNz
cyBkYTogMHglMDh4XG4iLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVt
bXkgPyAiZHVtbXkiIDogInVzZXIiLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW1ndV9ub2RlX21hcFtub2RlXS5uYW1lLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZHVtbXkgPyAwIDogaWJ1Zi0+dmlkX2J1Zi52YmIudmIyX2J1Zi5pbmRleCwNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh1MzIpYnVmLT5kYWRkcik7DQo+ID4g
KyAgICAgICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgICAgaWYgKG5vZGUgPT0gSU1HVV9O
T0RFX0lOICYmDQo+ID4gKyAgICAgICAgICAgICAgICAgICAhaW1ndV9xdWV1ZV9nZXRidWYoaW1n
dSwgSU1HVV9OT0RFX0lOKSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4g
DQo+IE15IHN1Z2dlc3Rpb24gdG8gdGhlIGZvciBsb29wIGNvbmRpdGlvbiBpcyBiYXNlZCBvbiB0
aGlzLg0KPiANCg0KR290IGl0Lg0KDQo+ID4gKyAgICAgICB9DQo+ID4gKyAgICAgICBtdXRleF91
bmxvY2soJmltZ3UtPmxvY2spOw0KPiA+ICsNCj4gPiArICAgICAgIGlmIChyICYmIHIgIT0gLUVC
VVNZKQ0KPiA+ICsgICAgICAgICAgICAgICBnb3RvIGZhaWxlZDsNCj4gPiArDQo+ID4gKyAgICAg
ICByZXR1cm4gMDsNCj4gPiArDQo+ID4gK2ZhaWxlZDoNCj4gPiArICAgICAgIC8qDQo+ID4gKyAg
ICAgICAgKiBPbiBlcnJvciwgbWFyayBhbGwgYnVmZmVycyBhcyBmYWlsZWQgd2hpY2ggYXJlIG5v
dA0KPiA+ICsgICAgICAgICogeWV0IHF1ZXVlZCB0byBDU1MNCj4gPiArICAgICAgICAqLw0KPiA+
ICsgICAgICAgZGV2X2VycigmaW1ndS0+cGNpX2Rldi0+ZGV2LA0KPiA+ICsgICAgICAgICAgICAg
ICAiZmFpbGVkIHRvIHF1ZXVlIGJ1ZmZlciB0byBDU1Mgb24gcXVldWUgJWkgKCVkKVxuIiwNCj4g
PiArICAgICAgICAgICAgICAgbm9kZSwgcik7DQo+ID4gKw0KPiA+ICsgICAgICAgaWYgKGluaXRp
YWwpDQo+ID4gKyAgICAgICAgICAgICAgIC8qIElmIHdlIHdlcmUgY2FsbGVkIGZyb20gc3RyZWFt
b24oKSwgbm8gbmVlZCB0byBmaW5pc2ggYnVmcyAqLw0KPiA+ICsgICAgICAgICAgICAgICByZXR1
cm4gcjsNCj4gPiArDQo+ID4gKyAgICAgICBmb3IgKG5vZGUgPSAwOyBub2RlIDwgSU1HVV9OT0RF
X05VTTsgbm9kZSsrKSB7DQo+ID4gKyAgICAgICAgICAgICAgIHN0cnVjdCBpbWd1X2J1ZmZlciAq
YnVmLCAqYnVmMDsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgIGlmICghaW1ndS0+cXVldWVf
ZW5hYmxlZFtub2RlXSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgICAg
ICAgLyogU2tpcCBkaXNhYmxlZCBxdWV1ZXMgKi8NCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAg
IG11dGV4X2xvY2soJmltZ3UtPmxvY2spOw0KPiA+ICsgICAgICAgICAgICAgICBsaXN0X2Zvcl9l
YWNoX2VudHJ5X3NhZmUoYnVmLCBidWYwLCAmaW1ndS0NCj4gPm5vZGVzW25vZGVdLmJ1ZmZlcnMs
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWRfYnVmLmxp
c3QpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXB1M19jc3NfYnVmX3N0YXRl
KCZidWYtPmNzc19idWYpID09DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElQVTNfQ1NTX0JVRkZFUl9RVUVVRUQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb250aW51ZTsgICAgICAgLyogV2FzIGFscmVhZHkgcXVldWVkLCBza2lwICov
DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlwdTNfdjRsMl9idWZmZXJfZG9u
ZSgmYnVmLT52aWRfYnVmLnZiYi52YjJfYnVmLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBWQjJfQlVGX1NUQVRFX0VSUk9SKTsNCj4gPiArICAgICAg
ICAgICAgICAgfQ0KPiA+ICsgICAgICAgICAgICAgICBtdXRleF91bmxvY2soJmltZ3UtPmxvY2sp
Ow0KPiA+ICsgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAgIHJldHVybiByOw0KPiA+ICt9DQo+
IA0KPiBbc25pcF0NCj4gDQo+ID4gK3N0YXRpYyBpcnFyZXR1cm5fdCBpbWd1X2lzcl90aHJlYWRl
ZChpbnQgaXJxLCB2b2lkICppbWd1X3B0cikgew0KPiA+ICsgICAgICAgc3RydWN0IGltZ3VfZGV2
aWNlICppbWd1ID0gaW1ndV9wdHI7DQo+ID4gKw0KPiA+ICsgICAgICAgLyogRGVxdWV1ZSAvIHF1
ZXVlIGJ1ZmZlcnMgKi8NCj4gPiArICAgICAgIGRvIHsNCj4gPiArICAgICAgICAgICAgICAgdTY0
IG5zID0ga3RpbWVfZ2V0X25zKCk7DQo+ID4gKyAgICAgICAgICAgICAgIHN0cnVjdCBpcHUzX2Nz
c19idWZmZXIgKmI7DQo+ID4gKyAgICAgICAgICAgICAgIHN0cnVjdCBpbWd1X2J1ZmZlciAqYnVm
Ow0KPiA+ICsgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbm9kZTsNCj4gPiArICAgICAgICAg
ICAgICAgYm9vbCBkdW1teTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgIGRvIHsNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICBtdXRleF9sb2NrKCZpbWd1LT5sb2NrKTsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBiID0gaXB1M19jc3NfYnVmX2RlcXVldWUoJmltZ3UtPmNzcyk7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbXV0ZXhfdW5sb2NrKCZpbWd1LT5sb2NrKTsN
Cj4gPiArICAgICAgICAgICAgICAgfSB3aGlsZSAoUFRSX0VSUihiKSA9PSAtRUFHQUlOKTsNCj4g
PiArDQo+ID4gKyAgICAgICAgICAgICAgIGlmIChJU19FUlJfT1JfTlVMTChiKSkgew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGlmICghYiB8fCBQVFJfRVJSKGIpID09IC1FQlVTWSkgLyog
QWxsIGRvbmUgKi8NCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGRldl9lcnIoJmltZ3UtPnBjaV9kZXYtPmRldiwN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmYWlsZWQgdG8gZGVxdWV1ZSBi
dWZmZXJzICglbGQpXG4iLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFRS
X0VSUihiKSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAg
ICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgIG5vZGUgPSBpbWd1X21hcF9u
b2RlKGltZ3UsIGItPnF1ZXVlKTsNCj4gPiArICAgICAgICAgICAgICAgZHVtbXkgPSBpbWd1X2R1
bW15YnVmc19jaGVjayhpbWd1LCBiKTsNCj4gPiArICAgICAgICAgICAgICAgaWYgKCFkdW1teSkN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICBidWYgPSBjb250YWluZXJfb2YoYiwgc3RydWN0
IGltZ3VfYnVmZmVyLCBjc3NfYnVmKTsNCj4gPiArICAgICAgICAgICAgICAgZGV2X2RiZygmaW1n
dS0+cGNpX2Rldi0+ZGV2LA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICJkZXF1ZXVlICVz
ICVzIGJ1ZmZlciAlZCBmcm9tIGNzc1xuIiwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICBk
dW1teSA/ICJkdW1teSIgOiAidXNlciIsDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaW1n
dV9ub2RlX21hcFtub2RlXS5uYW1lLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGR1bW15
ID8gMCA6IGJ1Zi0+dmlkX2J1Zi52YmIudmIyX2J1Zi5pbmRleCk7DQo+ID4gKw0KPiA+ICsgICAg
ICAgICAgICAgICBpZiAoZHVtbXkpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogSXQg
d2FzIGEgZHVtbXkgYnVmZmVyLCBza2lwIGl0ICovDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgY29udGludWU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgICAvKiBGaWxsIHZiMiBidWZm
ZXIgZW50cmllcyBhbmQgdGVsbCBpdCdzIHJlYWR5ICovDQo+ID4gKyAgICAgICAgICAgICAgIGlm
ICghaW1ndS0+bm9kZXNbbm9kZV0ub3V0cHV0KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgYnVmLT52aWRfYnVmLnZiYi52YjJfYnVmLnRpbWVzdGFtcCA9IG5zOw0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGJ1Zi0+dmlkX2J1Zi52YmIuZmllbGQgPSBWNEwyX0ZJRUxEX05PTkU7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYnVmLT52aWRfYnVmLnZiYi5zZXF1ZW5jZSA9
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfaW5jX3JldHVybigm
aW1ndS0+bm9kZXNbbm9kZV0uc2VxdWVuY2UpOw0KPiA+ICsgICAgICAgICAgICAgICB9DQo+ID4g
KyAgICAgICAgICAgICAgIGltZ3VfYnVmZmVyX2RvbmUoaW1ndSwgJmJ1Zi0+dmlkX2J1Zi52YmIu
dmIyX2J1ZiwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcHUzX2Nzc19i
dWZfc3RhdGUoJmJ1Zi0+Y3NzX2J1ZikgPT0NCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgSVBVM19DU1NfQlVGRkVSX0RPTkUgPw0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWQjJfQlVG
X1NUQVRFX0RPTkUgOg0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBWQjJfQlVGX1NUQVRFX0VSUk9SKTsNCj4gPiArICAgICAgIH0gd2hpbGUg
KDEpOw0KPiA+ICsNCj4gPiArICAgICAgIC8qDQo+ID4gKyAgICAgICAgKiBUcnkgdG8gcXVldWUg
bW9yZSBidWZmZXJzIGZvciBDU1MuDQo+ID4gKyAgICAgICAgKiBxYnVmX2JhcnJpZXIgaXMgdXNl
ZCB0byBkaXNhYmxlIG5ldyBidWZmZXJzDQo+ID4gKyAgICAgICAgKiB0byBiZSBxdWV1ZWQgdG8g
Q1NTLg0KPiA+ICsgICAgICAgICovDQo+ID4gKyAgICAgICBpZiAoIWF0b21pY19yZWFkKCZpbWd1
LT5xYnVmX2JhcnJpZXIpKQ0KPiA+ICsgICAgICAgICAgICAgICBpbWd1X3F1ZXVlX2J1ZmZlcnMo
aW1ndSwgZmFsc2UpOw0KPiA+ICsNCj4gPiArICAgICAgIHJldHVybiBJUlFfTk9ORTsNCj4gDQo+
IFRoaXMgaXMgYSBzZXJpb3VzIGJ1Zy4gQW4gaW50ZXJydXB0IGhhbmRsZXIgbXVzdCBub3QgcmV0
dXJuIElSUV9OT05FDQo+IHVubGVzcyBpdCdzIHJlYWxseSBzdXJlIHRoYXQgdGhlIGRldmljZSBp
dCBoYW5kbGVzIGRpZCBub3QgZ2VuZXJhdGUgYW55DQo+IGludGVycnVwdC4gVGhpcyB0aHJlYWRl
ZCBoYW5kbGVyIGlzIGNhbGxlZCBhcyBhIHJlc3VsdCBvZiB0aGUgaGFyZGlycSBoYW5kbGVyDQo+
IGFjdHVhbGx5IGZpbmRpbmcgYW4gaW50ZXJydXB0IHRvIGJlIGhhbmRsZWQsIHNvIHdlIG11c3Qg
YWx3YXlzIHJldHVybg0KPiBJUlFfSEFORExFRCBoZXJlLg0KPiANCj4gW3NuaXBdDQoNCkFjaywg
dGhhbmtzIGZvciBwb2ludGluZyBpdCBvdXQuDQoNCj4gDQo+ID4gK3N0YXRpYyBpbnQgX19tYXli
ZV91bnVzZWQgaW1ndV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikgew0KPiA+ICsgICAgICAg
c3RydWN0IHBjaV9kZXYgKnBjaV9kZXYgPSB0b19wY2lfZGV2KGRldik7DQo+ID4gKyAgICAgICBz
dHJ1Y3QgaW1ndV9kZXZpY2UgKmltZ3UgPSBwY2lfZ2V0X2RydmRhdGEocGNpX2Rldik7DQo+ID4g
KyAgICAgICB1bnNpZ25lZCBsb25nIGV4cGlyZTsNCj4gPiArDQo+ID4gKyAgICAgICBkZXZfZGJn
KGRldiwgImVudGVyICVzXG4iLCBfX2Z1bmNfXyk7DQo+ID4gKyAgICAgICBpbWd1LT5zdXNwZW5k
X2luX3N0cmVhbSA9IGlwdTNfY3NzX2lzX3N0cmVhbWluZygmaW1ndS0+Y3NzKTsNCj4gPiArICAg
ICAgIGlmICghaW1ndS0+c3VzcGVuZF9pbl9zdHJlYW0pDQo+ID4gKyAgICAgICAgICAgICAgIGdv
dG8gb3V0Ow0KPiA+ICsgICAgICAgLyogQmxvY2sgbmV3IGJ1ZmZlcnMgdG8gYmUgcXVldWVkIHRv
IENTUy4gKi8NCj4gPiArICAgICAgIGF0b21pY19zZXQoJmltZ3UtPnFidWZfYmFycmllciwgMSk7
DQo+ID4gKyAgICAgICAvKg0KPiA+ICsgICAgICAgICogV2FpdCBmb3IgY3VycmVudGx5IHJ1bm5p
bmcgaXJxIGhhbmRsZXIgdG8gYmUgZG9uZSBzbyB0aGF0DQo+ID4gKyAgICAgICAgKiBubyBuZXcg
YnVmZmVycyB3aWxsIGJlIHF1ZXVlZCB0byBmdyBsYXRlci4NCj4gPiArICAgICAgICAqLw0KPiA+
ICsgICAgICAgc3luY2hyb25pemVfaXJxKHBjaV9kZXYtPmlycSk7DQo+ID4gKyAgICAgICAvKiBX
YWl0IHVudGlsIGFsbCBidWZmZXJzIGluIENTUyBhcmUgZG9uZS4gKi8NCj4gPiArICAgICAgIGV4
cGlyZSA9IGppZmZpZXMgKyBtc2Vjc190b19qaWZmaWVzKDEwMDApOw0KPiA+ICsgICAgICAgd2hp
bGUgKCFpcHUzX2Nzc19xdWV1ZV9lbXB0eSgmaW1ndS0+Y3NzKSkgew0KPiA+ICsgICAgICAgICAg
ICAgICBpZiAodGltZV9pc19iZWZvcmVfamlmZmllcyhleHBpcmUpKSB7DQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgZGV2X2VycihkZXYsICJ3YWl0IGJ1ZmZlciBkcmFpbiB0aW1lb3V0Llxu
Iik7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAg
ICAgIH0NCj4gPiArICAgICAgIH0NCj4gDQo+IFVobS4gV2Ugc3RydWdnbGUgdG8gc2F2ZSBzb21l
IHBvd2VyIGJ5IHN1c3BlbmRpbmcgdGhlIGRldmljZSBvbmx5IHRvDQo+IGVuZCB1cCB3aXRoIGFu
IHVnbHkgYnVzeSB3YWl0IHRoYXQgY291bGQgdGFrZSBldmVuIGEgc2Vjb25kIGhlcmUuIFRoaXMN
Cj4gZG9lc24ndCBtYWtlIGFueSBzZW5zZS4NCj4gDQo+IFdlIGhhZCBhIHdvcmtpbmcgc29sdXRp
b24gdXNpbmcgYSB3YWl0IHF1ZXVlIGluIHByZXZpb3VzIHJldmlzaW9uIFsxXS4NCj4gV2hhdCBo
YXBwZW5lZCB0byBpdD8NCj4gDQo+IFsxXSBodHRwczovL2Nocm9taXVtLQ0KPiByZXZpZXcuZ29v
Z2xlc291cmNlLmNvbS9jL2Nocm9taXVtb3MvdGhpcmRfcGFydHkva2VybmVsLysvMTAyOTU5NC8y
DQo+IC9kcml2ZXJzL21lZGlhL3BjaS9pbnRlbC9pcHUzL2lwdTMuYyNiOTEzDQo+IChzZWUgdGhl
IGxlZnQgc2lkZSkNCj4gDQoNClRoZSBjb2RlIGhlcmUgd2FzIGJhc2VkIG9uIGFuIG9sZCB2ZXJz
aW9uIG9mIHBhdGNoICJpcHUzLWltZ3U6IEF2b2lkIG1pZ2h0IHNsZWVwIG9wZXJhdGlvbnMgaW4g
c3VzcGVuZCBjYWxsYmFjayIgYXQgc3VibWlzc2lvbiwgc28gaXQgZGlkIGhhdmUgYnVmX2RyYWlu
X3dxLCBzb3JyeSBmb3IgdGhlIGNvbmZ1c2lvbi4NCg0KPiA+ICsgICAgICAgaXB1M19jc3Nfc3Rv
cF9zdHJlYW1pbmcoJmltZ3UtPmNzcyk7DQo+ID4gKyAgICAgICBhdG9taWNfc2V0KCZpbWd1LT5x
YnVmX2JhcnJpZXIsIDApOw0KPiA+ICsgICAgICAgaW1ndV9wb3dlcmRvd24oaW1ndSk7DQo+ID4g
KyAgICAgICBwbV9ydW50aW1lX2ZvcmNlX3N1c3BlbmQoZGV2KTsNCj4gPiArb3V0Og0KPiA+ICsg
ICAgICAgZGV2X2RiZyhkZXYsICJsZWF2ZSAlc1xuIiwgX19mdW5jX18pOw0KPiA+ICsgICAgICAg
cmV0dXJuIDA7DQo+ID4gK30NCj4gDQo+IEJlc3QgcmVnYXJkcywNCj4gVG9tYXN6DQo=
