Return-path: <linux-media-owner@vger.kernel.org>
Received: from rv-out-0506.google.com ([209.85.198.231]:8272 "EHLO
	rv-out-0506.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1750840AbZC0EBO (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Fri, 27 Mar 2009 00:01:14 -0400
Received: by rv-out-0506.google.com with SMTP id f9so1022903rvb.1
        for <linux-media@vger.kernel.org>; Thu, 26 Mar 2009 21:01:12 -0700 (PDT)
MIME-Version: 1.0
Date: Fri, 27 Mar 2009 12:01:12 +0800
Message-ID: <15ed362e0903262101iadbfd97iad20a38ca5c4f083@mail.gmail.com>
Subject: [PATCH] Support for ASUS U3100 Mini DMB-TH USB Dongle
From: David Wong <davidtlwong@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=000e0cd14d66926ca2046611c8d6
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--000e0cd14d66926ca2046611c8d6
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

This patch adds support for ASUS U3100 Mini DMB-TH USB Dongle, using
unified LGS8GXX driver and partial Analog Device ADMTV102 support

Signed-off-by: David T.L. Wong <davidtlwong@gmail.com>

--000e0cd14d66926ca2046611c8d6
Content-Type: text/x-patch; charset=US-ASCII; name="asus_u3100_dmbth.patch"
Content-Disposition: attachment; filename="asus_u3100_dmbth.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_fsscegkx0

ZGlmZiAtciA2ZjA4ODlmZGEzMTcgbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL0tj
b25maWcKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL0tjb25maWcJTW9u
IE1hciAwMiAxMDo0MDo1MiAyMDA5ICswMTAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvY29t
bW9uL3R1bmVycy9LY29uZmlnCUZyaSBNYXIgMjAgMTE6NTA6MjQgMjAwOSArMDgwMApAQCAtMTcy
LDQgKzE3MiwxMSBAQAogCWhlbHAKIAkgIFNheSBZIGhlcmUgdG8gc3VwcG9ydCB0aGUgRnJlZXNj
YWxlIE1DNDRTODAzIGJhc2VkIHR1bmVycwogCitjb25maWcgTUVESUFfVFVORVJfQURNVFYxMDIK
Kwl0cmlzdGF0ZSAiQW5hbG9nIERldmljZSBNVFYgMTAyIHNpbGljb24gdHVuZXIiCisJZGVwZW5k
cyBvbiBWSURFT19NRURJQSAmJiBJMkMKKwlkZWZhdWx0IG0gaWYgTUVESUFfVFVORVJfQ1VTVE9N
SVpFCisJaGVscAorCSAgU2F5IFkgaGVyZSB0byBzdXBwb3J0IHRoZSBBbmFsb2cgRGV2aWNlIE1U
ViAxMDIgc2lsaWNvbiB0dW5lcgorCiBlbmRpZiAjIE1FRElBX1RVTkVSX0NVU1RPTUlaRQpkaWZm
IC1yIDZmMDg4OWZkYTMxNyBsaW51eC9kcml2ZXJzL21lZGlhL2NvbW1vbi90dW5lcnMvTWFrZWZp
bGUKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL01ha2VmaWxlCU1vbiBN
YXIgMDIgMTA6NDA6NTIgMjAwOSArMDEwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2NvbW1v
bi90dW5lcnMvTWFrZWZpbGUJRnJpIE1hciAyMCAxMTo1MDoyNCAyMDA5ICswODAwCkBAIC0yMyw2
ICsyMyw3IEBACiBvYmotJChDT05GSUdfTUVESUFfVFVORVJfTVhMNTAwNVMpICs9IG14bDUwMDVz
Lm8KIG9iai0kKENPTkZJR19NRURJQV9UVU5FUl9NWEw1MDA3VCkgKz0gbXhsNTAwN3Qubwogb2Jq
LSQoQ09ORklHX01FRElBX1RVTkVSX01DNDRTODAzKSArPSBtYzQ0czgwMy5vCitvYmotJChDT05G
SUdfTUVESUFfVFVORVJfQURNVFYxMDIpICs9IGFkbXR2MTAyLm8KIAogRVhUUkFfQ0ZMQUdTICs9
IC1JZHJpdmVycy9tZWRpYS9kdmIvZHZiLWNvcmUKIEVYVFJBX0NGTEFHUyArPSAtSWRyaXZlcnMv
bWVkaWEvZHZiL2Zyb250ZW5kcwpkaWZmIC1yIDZmMDg4OWZkYTMxNyBsaW51eC9kcml2ZXJzL21l
ZGlhL2NvbW1vbi90dW5lcnMvYWRtdHYxMDIuYwotLS0gL2Rldi9udWxsCVRodSBKYW4gMDEgMDA6
MDA6MDAgMTk3MCArMDAwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2NvbW1vbi90dW5lcnMv
YWRtdHYxMDIuYwlGcmkgTWFyIDIwIDExOjUwOjI0IDIwMDkgKzA4MDAKQEAgLTAsMCArMSw5NzAg
QEAKKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgor
I2luY2x1ZGUgPGxpbnV4L2kyYy5oPgorI2luY2x1ZGUgImR2Yl9mcm9udGVuZC5oIgorCisjaW5j
bHVkZSAiYWRtdHYxMDIuaCIKKyNpbmNsdWRlICJhZG10djEwMl9wcml2LmgiCisKKy8qIGRlZmlu
ZSB0aGUgcmVnaXN0ZXIgYWRkcmVzcyBhbmQgZGF0YSBvZiBUdW5lciB0aGF0IG5lZWQgdG8gYmUg
aW5pdGlhbGl6ZWQgd2hlbiBwb3dlciBvbiAqLyAKK3U4IEFkZHJEYXRhTWVtQURNVFYxMDJfVUhG
WzEwMF09Cit7CisvL0FkZHIgRGF0YQorIDB4MTAsMHg2QSwgICAgICAvLyBMTkEgY3VycmVudCwg
MHg0QyB3aWxsIGRlZ3JhZGUgMSBkQiBwZXJmb3JtYW5jZSBidXQgZ2V0IGJldHRlciBwb3dlciBj
b25zdW1wdGlvbi4KKyAweDExLDB4RDgsICAgICAgLy8gTWl4ZXIgY3VycmVudAorIDB4MTIsMHhD
MCwgICAgICAvLyBNaXhlciBnYWluCisgMHgxNSwweDNELCAgICAgIC8vIFRPUCBhbmQgQURKIHRv
IG9wdGltaXplIFNOUiBhbmQgQUNJIAorIDB4MTcsMHg5NywgICAgICAvLyBUT1AgYW5kIEFESiB0
byBvcHRpbWl6ZSBTTlIgYW5kIEFDSSAvLyo5QS0+OTcsQ2hhbmdlZCBUT1AgYW5kIEFESiB0byBv
cHRpbWl6ZSBTTlIgYW5kIEFDSQorIDB4MTgsMHgwMywgICAgICAvLyBDaGFuZ2VkIHBvd2VyIGRl
dGVjdG9yIHNhdHVyYXRpb24gdm9sdGFnZSBwb2ludCBhbmQgd2FybmluZyB2b2x0YWdlIHBvaW50
IC8vKiBuZXcgaW5zZXJ0CisgMHgxRiwweDE3LCAgICAgIC8vIFZDT1NFTCxQTExGIFJGUEdBIGFt
cCBjdXJyZW50IAorIDB4MjAsMHhGRiwgICAgICAvLyBSRlBHQSBhbXAgY3VycmVudAorIDB4MjEs
MHhBNCwgICAgICAvLyBSRlBHQSBhbXAgY3VycmVudAorIDB4MjIsMHhBNCwgICAgICAvLyBSRlBH
QSBhbXAgY3VycmVudAorIDB4MjMsMHhERiwgICAgICAvLyBNaXhlciBCaWFzIGNvbnRyb2wKKyAw
eDI2LDB4RkEsICAgICAgLy8gUExMIEJVRkZFUiBDVVJSRU5UCisgMHgyNywweDAwLCAgICAgIC8v
IENPTlZDT0wvSCBmb3IgVkNPIGN1cnJlbnQgY29udHJvbAorIDB4MjgsMHhGRiwgICAgICAvLyBD
T05WQ09CVUZML0ggZm9yIFZDTyBidWZmZXIgYW1wbGlmaWVyIGN1cnJlbnQgY29udHJvbAorIDB4
MjksMHhGRiwgICAgICAvLyBDT05ESVYxLzIgZm9yIGZpcnN0IGFuZCBzZWNvbmQgZGl2aWRlciBj
dXJyZW50IGNvbnRyb2wKKyAweDJBLDB4RkYsICAgICAgLy8gQ09ORElWMy80IGZvciB0aGlyZCBh
bmQgbGFzdCBkaXZpZGVyIGN1cnJlbnQgY29udHJvbAorIDB4MkIsMHhFNywgICAgICAvLyBDT05E
SVY1IGZvciB0aGlyZCBhbmQgbGFzdCBkaXZpZGVyIGN1cnJlbnQgY29udHJvbAorIDBYMkMsMHhG
RiwgICAgICAvLyBDT05CVUYwLzEgZm9yIEwtQmFuZCBCdWZmZXIgYW1wIGFuZCBmaXJzdCBCdWZm
ZXIgYW1wIGN1cnJlbnQgY29udHJvbAorIDB4MkUsMHhGQiwgICAgICAvLyBDT05CVUY0IGZvciBm
b3J0aCBCdWZmZXIgYW1wIGN1cnJlbnQgY29udHJvbAorIDB4MzAsMHg4MCwgICAgICAvLyBMRlNX
KEludGVybmFsIExvb3AgRmlsdGVyKSB0byBpbXByb3ZlIHBoYXNlIG5vaXNlIC8vKiBGOC0+ODAK
KyAweDMyLDB4YzIsICAgICAgLy8gTE9PUCBmaWx0ZXIgYm91bmRhcnkgCisgMHgzMywweDgwLCAg
ICAgIC8vIERDIG9mZnNldCBjb250cm9sCisgMHgzNCwweEVDLCAgICAgIC8vIERDIG9mZnNldCBj
b250cm9sCisgMHgzOSwweDk2LCAgICAgIC8vIEFHQ0hNIEFHQyBjb21wZW5zYXRpb24gdmFsdWUg
d2hlbiBMTkEgY2hhbmdlcworIDB4M0EsMHhBMCwgICAgICAvLyBBR0NITSBBR0MgY29tcGVuc2F0
aW9uIHZhbHVlIHdoZW4gTE5BIGNoYW5nZXMKKyAweDNCLDB4MDUsICAgICAgLy8gQUdDSE0gQUdD
IGNvbXBlbnNhdGlvbiB2YWx1ZSB3aGVuIExOQSBjaGFuZ2VzCisgMHgzQywweEQwLCAgICAgIC8v
IEFHQ0hNIEFHQyBjb21wZW5zYXRpb24gdmFsdWUgd2hlbiBMTkEgY2hhbmdlcworIDB4NDQsMHhE
RiwgICAgIC8vIEJCUEdBIG5lZWRzIHRvIHN0YXkgb24gZm9yIGN1cnJlbnQgc2lsaWNvbiByZXZp
c2lvbgorIDB4NDgsMHgyMywgICAgICAvLyBjdXJyZW50IGZvciBvdXRwdXQgYnVmZmVyIGFtcCAv
LyoyMy0+MjEKKyAweDQ5LDB4MDgsICAgICAgLy8gZ2FpbiBtb2RlIGZvciBvdXRwdXQgYnVmZmVy
IGFtcAorIDB4NEEsMHhBMCwgICAgICAvLyB0cmlwIHBvaW50IGZvciBCQlZHQQorIDB4NEIsMHg5
RCwgICAgICAvLyB0cmlwIHBvaW50IGZvciBSRlBHQQorIDB4NEMsMHg5RCwgICAgICAvLyBBREpS
U1NJIHdhcm5pbmcgcG9pbnQKKyAweDRELDB4QzMsICAgICAgLy8gUExMIGN1cnJlbnQgZm9yIHN0
YWJpbGl0eSBQTEwgbG9jaworIDB4ZmYsMHhmZgorfTsgCisKK3U4IEFkZHJEYXRhTWVtQURNVFYx
MDJfVkhGWzEwMF09Cit7CisvL0FkZHIgRGF0YQorIDB4MTAsMHgwOCwgICAgICAvLyBMTkEgY3Vy
cmVudAorIDB4MTEsMHhjMiwgICAgICAvLyBNaXhlciBjdXJyZW50CisgMHgxMiwweEMwLCAgICAg
IC8vIE1peGVyIGdhaW4KKyAweDE3LDB4OTgsICAgICAgLy8gVE9QIGFuZCBBREogdG8gb3B0aW1p
emUgU05SIGFuZCBBQ0kgLy8qIDlBLT45OAorIDB4MUYsMHgxNywgICAgICAvLyBWQ09TRUwsUExM
RiBSRlBHQSBhbXAgY3VycmVudCAKKyAweDIwLDB4OWIsICAgICAgLy8gUkZQR0EgYW1wIGN1cnJl
bnQKKyAweDIxLDB4QTQsICAgICAgLy8gUkZQR0EgYW1wIGN1cnJlbnQKKyAweDIyLDB4QTQsICAg
ICAgLy8gUkZQR0EgYW1wIGN1cnJlbnQKKyAweDIzLDB4OUYsICAgICAgLy8gTWl4ZXIgQmlhcyBj
b250cm9sCisgMHgyNiwweEY5LCAgICAgIC8vIFBMTCBCVUZGRVIgQ1VSUkVOVAorIDB4MjcsMHgx
MSwgICAgICAvLyBDT05WQ09ML0ggZm9yIFZDTyBjdXJyZW50IGNvbnRyb2wKKyAweDI4LDB4OTIs
ICAgICAgLy8gQ09OVkNPQlVGTC9IIGZvciBWQ08gYnVmZmVyIGFtcGxpZmllciBjdXJyZW50IGNv
bnRyb2wKKyAweDI5LDB4QkMsICAgICAgLy8gQ09ORElWMS8yIGZvciBmaXJzdCBhbmQgc2Vjb25k
IGRpdmlkZXIgY3VycmVudCBjb250cm9sCisgMHgyQiwweEU3LCAgICAgIC8vIENPTkRJVjUgZm9y
IHRoaXJkIGFuZCBsYXN0IGRpdmlkZXIgY3VycmVudCBjb250cm9sCisgMHgyRCwweDlDLCAgICAg
CisgMHgyRSwweENFLCAgICAgIC8vIENPTkJVRjQgZm9yIGZvcnRoIEJ1ZmZlciBhbXAgY3VycmVu
dCBjb250cm9sCisgMHgyRiwweDFGLAorIDB4MzAsMHg4MCwgICAgICAvLyBMRlNXKEludGVybmFs
IExvb3AgRmlsdGVyKSB0byBpbXByb3ZlIHBoYXNlIG5vaXNlCisgMHgzMiwweGMyLCAgICAgIC8v
IExPT1AgZmlsdGVyIGJvdW5kYXJ5IAorIDB4MzMsMHg4MCwgICAgICAvLyBEQyBvZmZzZXQgY29u
dHJvbAorIDB4MzQsMHhFQywgICAgICAvLyBEQyBvZmZzZXQgY29udHJvbAorIDB4NDgsMHgyOSwg
ICAgICAvLyBjdXJyZW50IGZvciBvdXRwdXQgYnVmZmVyIGFtcAorIDB4NDksMHgwOCwgICAgICAv
LyBnYWluIG1vZGUgZm9yIG91dHB1dCBidWZmZXIgYW1wCisgMHg0QSwweEEwLCAgICAgIC8vIHRy
aXAgcG9pbnQgZm9yIEJCVkdBCisgMHg0QiwweDlELCAgICAgIC8vIHRyaXAgcG9pbnQgZm9yIFJG
UEdBCisgMHg0QywweDlELCAgICAgIC8vIEFESlJTU0kgd2FybmluZyBwb2ludAorIDB4NEQsMHhD
MywgICAgICAvLyBQTEwgY3VycmVudCBmb3Igc3RhYmlsaXR5IFBMTCBsb2NrCisgMHhmZiwweGZm
Cit9OyAKKworCit1OCBQTExSZWdTZXRUYWJsZSBbMTBdWzNdPQoreyAvLyAweDI0LDB4MzEsMHgz
OAorCXsweDBGLDB4MDQsMHg1MH0sIC8vMTNNSHogLy8weDI0OiAweG5CLT4gMHhuRgorCXsweDFG
LDB4MDQsMHg1MH0sIC8vMTYuMzg0TUh6IAorCXsweDJGLDB4MDQsMHg1MH0sIC8vMTkuMk1Iegor
CXsweDNGLDB4MDQsMHg1MH0sIC8vMjAuNDhNSHoKKwl7MHg0RiwweDE1LDB4NTF9LCAvLzI0LjU3
Nk1IegorCXsweDVGLDB4MTUsMHg1MX0sIC8vMjZNSHoKKwl7MHg1QSwweDA0LDB4NTF9LCAvLzMw
LjRNSHogIC8vKiBzcGVjaWFsIHNldCBmb3IgMzAuNE1IeiBjYXNlIAorCXsweDZGLDB4MTUsMHg1
MX0sIC8vMzZNSHoKKwl7MHg3RiwweDE1LDB4NTF9LCAvLzM4LjRNSHoKKwl7MHgzRiwweDA0LDB4
NTB9LCAvLzIwTUh6Cit9OworCisKK3N0YXRpYyBpbnQgZGVidWcgPSAwOworbW9kdWxlX3BhcmFt
KGRlYnVnLCBpbnQsIDA2NDQpOworTU9EVUxFX1BBUk1fREVTQyhkZWJ1ZywgIlR1cm4gb24vb2Zm
IGRlYnVnZ2luZyAoZGVmYXVsdDpvZmYpLiIpOworCisjZGVmaW5lIGRwcmludGsoYXJncy4uLikg
ZG8geyBpZiAoZGVidWcpIHtwcmludGsoS0VSTl9ERUJVRyAiYWRtdHYxMDI6ICIgYXJncyk7IHBy
aW50aygiXG4iKTsgfX0gd2hpbGUgKDApCisKKy8vIFJlYWRzIGEgc2luZ2xlIHJlZ2lzdGVyCitz
dGF0aWMgaW50IGFkbXR2MTAyX3JlYWRyZWcoc3RydWN0IGFkbXR2MTAyX3ByaXYgKnByaXYsIHU4
IHJlZywgdTggKnZhbCkKK3sKKwlzdHJ1Y3QgaTJjX21zZyBtc2dbMl0gPSB7CisJCXsgLmFkZHIg
PSBwcml2LT5jZmctPmkyY19hZGRyZXNzLCAuZmxhZ3MgPSAwLCAgICAgICAgLmJ1ZiA9ICZyZWcs
IC5sZW4gPSAxIH0sCisJCXsgLmFkZHIgPSBwcml2LT5jZmctPmkyY19hZGRyZXNzLCAuZmxhZ3Mg
PSBJMkNfTV9SRCwgLmJ1ZiA9IHZhbCwgIC5sZW4gPSAxIH0sCisJfTsKKworCWlmIChpMmNfdHJh
bnNmZXIocHJpdi0+aTJjLCBtc2csIDIpICE9IDIpIHsKKwkJcHJpbnRrKEtFUk5fV0FSTklORyAi
YWRtdHYxMDIgSTJDIHJlYWQgZmFpbGVkXG4iKTsKKwkJcmV0dXJuIC1FUkVNT1RFSU87CisJfQor
CWlmIChkZWJ1ZyA+PSAyKQorCQlwcmludGsoIiVzKHJlZz0weCUwMlgpIDogMHglMDJYXG4iLCBf
X2Z1bmNfXywgcmVnLCAqdmFsKTsKKwlyZXR1cm4gMDsKK30KKworLy8gV3JpdGVzIGEgc2luZ2xl
IHJlZ2lzdGVyCitzdGF0aWMgaW50IGFkbXR2MTAyX3dyaXRlcmVnKHN0cnVjdCBhZG10djEwMl9w
cml2ICpwcml2LCB1OCByZWcsIHU4IHZhbCkKK3sKKwl1OCBidWZbMl0gPSB7IHJlZywgdmFsIH07
CisJc3RydWN0IGkyY19tc2cgbXNnID0geworCQkuYWRkciA9IHByaXYtPmNmZy0+aTJjX2FkZHJl
c3MsIC5mbGFncyA9IDAsIC5idWYgPSBidWYsIC5sZW4gPSAyCisJfTsKKworCWlmIChpMmNfdHJh
bnNmZXIocHJpdi0+aTJjLCAmbXNnLCAxKSAhPSAxKSB7CisJCXByaW50ayhLRVJOX1dBUk5JTkcg
ImFkbXR2MTAyIEkyQyB3cml0ZSBmYWlsZWRcbiIpOworCQlyZXR1cm4gLUVSRU1PVEVJTzsKKwl9
CisJaWYgKGRlYnVnID49IDIpCisJCXByaW50aygiJXMocmVnPTB4JTAyWCwgdmFsPTB4JTAyWClc
biIsIF9fZnVuY19fLCByZWcsIHZhbCk7CisJcmV0dXJuIDA7Cit9CisKKy8vIFdyaXRlcyBhIHNl
dCBvZiBjb25zZWN1dGl2ZSByZWdpc3RlcnMKK3N0YXRpYyBpbnQgYWRtdHYxMDJfd3JpdGVyZWdz
KHN0cnVjdCBhZG10djEwMl9wcml2ICpwcml2LHU4ICpidWYsIHU4IGxlbikKK3sKKwlzdHJ1Y3Qg
aTJjX21zZyBtc2cgPSB7CisJCS5hZGRyID0gcHJpdi0+Y2ZnLT5pMmNfYWRkcmVzcywgLmZsYWdz
ID0gMCwgLmJ1ZiA9IGJ1ZiwgLmxlbiA9IGxlbgorCX07CisJaWYgKGkyY190cmFuc2Zlcihwcml2
LT5pMmMsICZtc2csIDEpICE9IDEpIHsKKwkJcHJpbnRrKEtFUk5fV0FSTklORyAibXQyMDYwIEky
QyB3cml0ZSBmYWlsZWQgKGxlbj0laSlcbiIsKGludClsZW4pOworCQlyZXR1cm4gLUVSRU1PVEVJ
TzsKKwl9CisJcmV0dXJuIDA7Cit9CisKKy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKy8qKiBjaGVj
ayBhbGwgZm8gdGhlc2UhISEhICovCisKKy8vdTggZ19pY3AsCisvL2dfY29udmNvLGdfY3VyVGVt
cFN0YXRlLGdfQ1RVTkVfQ0xLT0ZTOworLy9pbnQgZ19WSEZTZXQ9VUhGU3VwcG9ydDsKKy8vaW50
IGdfVHVuZXJQTExUeXBlPVJFRkNMSzE2Mzg0OworLy9DaGFubmVsSW5mbyAgRmluZENoYW5uZWxb
NTBdOworLy9NUEVHX1BST0dJTkZPIG15TXBlZ0luZm9bTWF4UHJvZ051bV07CisvL2ludCBGaW5k
UHJvZ051bTsgICAvLyBpbmRpY2F0ZSBob3cgbWFueSBwcm9ncmFtIGlzIGZvdW5kIGluIG9uZSBj
ZXJ0YWluIGNoYW5uZWwKKworLyoKK1RoZSBjYXJkIHNob3VsZCBub3QgZG8gdGhpcyBhcyBpdCBw
cmV2ZW50cyBtdWx0aXBsZSBjYXJkcyBmcm9tIHdvcmtpbmchISEhIQorc3RydWN0IGFkbXR2MTAy
X3ByaXYgKnN0YXRlPU5VTEw7Cit2b2lkIG15QWRpSW5pdChzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAq
c3RhdGUpCit7CisJc3RhdGUgPSBzdGF0ZTsKKwkvLy8gZnVuYyBjYWxscyB3aXRoICAgc3RydWN0
IGFkbXR2MTAyX3ByaXYgKnN0YXRlLAorfQorKi8KKworLy8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgor
Ly8gRnVuY3Rpb246ICBDb25maWd1cmUgVHVuZXIgY2hpcCByZWdpc3RlcnMgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAorLy8gSW5wdXQ6IHRhcmdldCAtLSBEZXZp
Y2UgSTJDIGFkZHJlc3MgCisvLyAgICAgICAgQWRkckRhdGEgLS0gUmVnaXN0ZXIgYWRkcmVzcyBh
bmQgQ29uZmlnIGRhdGEgYXJyYXkgCisvLyBPdXRwdXQ6IE5vbmUKKy8vKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioKK3ZvaWQgQ29uZmlnVHVuZXIoc3RydWN0IGFkbXR2MTAyX3ByaXYgKnN0YXRlLCB1OCAq
QWRkckRhdGEpCit7CisgICBpbnQgaT0wOworICAgdTggYWRkciwgZGF0YTsKKworICAgd2hpbGUg
KEFkZHJEYXRhW2ldIT0weEZGKQorICAgeyAKKyAgICAgYWRkciA9IEFkZHJEYXRhW2krK107Cisg
ICAgIGRhdGEgPSBBZGRyRGF0YVtpKytdOworICAgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwg
YWRkciwgZGF0YSk7CisgICB9Cit9CisKKy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKy8vIEZ1bmN0
aW9uOiAgU2V0IFR1bmVyIExQRiBjb25maWd1cmF0aW9uICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAKKy8vIElucHV0OiB0YXJnZXQgLS0gVHVuZXIgSTJDIGRldmlj
ZSBBZGRyZXNzIAorLy8gICAgICAgIHJlZkNsa1R5cGUgLS0gVHVuZXIgUExMIFR5cGUgCisvLyAg
ICAgICAgbHBmQlcgLS0gQmFuZCB3aWR0aCAsIGluIE1IeiB1bml0CisvLyBSZXR1cm46IE5vbmUK
Ky8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioKK3ZvaWQgU2V0TFBGKHN0cnVjdCBhZG10djEwMl9wcml2
ICpzdGF0ZSwgdTMyIHJlZkNsa1R5cGUsIHU4IGxwZkJXKQoreworCXU4IHR1bmV2YWw7CisJdTgg
dDsKKwlpbnQgcmV0OworCisJYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUsIDB4MTUsICh1OCkoIDB4
Mzh8ICgobHBmQlctMykmIDB4MDcpICkpOworCWFkbXR2MTAyX3dyaXRlcmVnKHN0YXRlLCAweDI1
ICwgKF9FWFRVTkVPRkYgPDwgMikgfCAoX1RVTkVFTjw8MSkgKTsgIAorCW1zbGVlcCgxMCk7ICAv
L2NoYW5nZSBmcm9tIDEgdG8gMTAgCisKKwl0dW5ldmFsPTB4MTA7IC8vZGVmYXVsdCB2YWx1ZSAK
KwlyZXQgPSBhZG10djEwMl9yZWFkcmVnKHN0YXRlLCAweDBGLCAmdCk7CisJaWYocmV0ID09IDAp
CisJCXR1bmV2YWwgPSB0OwkKKwkKKyAgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgyNSAs
IChfRVhUVU5FT04gPDwgMikgfCAoX1RVTkVFTiA8PCAxKSApOyAgIC8vY2hhbmdlIFR1bmluZyBt
b2RlIDogYXV0by10dW5lID0+IG1hbnVhbCB0dW5lKGhvbGQgbW9kZSkuCisKKwlpZiAocmVmQ2xr
VHlwZT09QURNVFYxMDJfUkVGQ0xLMzA0MDApCisJCWFkbXR2MTAyX3dyaXRlcmVnKHN0YXRlLCAw
eDI1LCAodTgpKCgodHVuZXZhbCtzdGF0ZS0+Q1RVTkVfQ0xLT0ZTKTw8MykgfCAoX0VYVFVORU9O
IDw8IDIpIHwgKF9UVU5FRU4gPDwgMSkpICk7ICAgLy9Xcml0ZSBDVFVORSB2YWwuIGluIG9yZGVy
IHRvIHN0b3JlIHR1bmVkIHZhbHVlLgorCWVsc2UKKwkJYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUs
IDB4MjUsICh1OCkoKHR1bmV2YWw8PDMpIHwgKF9FWFRVTkVPTiA8PCAyKSB8IChfVFVORUVOIDw8
IDEpKSApOyAgIC8vV3JpdGUgQ1RVTkUgdmFsLiBpbiBvcmRlciB0byBzdG9yZSB0dW5lZCB2YWx1
ZS4KKworICAgIHJldHVybjsKK30KKworLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKy8vIEZ1bmN0
aW9uOiBUdW5lciBQTEwgUmVnaXN0ZXIgU2V0dGluZyAKKy8vIElucHV0OiB0YXJnZXQgLS0gVHVu
ZXIgSTJDIGRldmljZSBBZGRyZXNzIAorLy8gICAgICAgIFJlZ0RhdCAtLSBSZWcgc2V0IHZhbHVl
IHRhYmxlICAgCisvLyBSZXR1cm46IHN1Y2Nlc3MgZmxhZworLy8qKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioKK2ludCBUdW5lclBMTFJlZ1NldChzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUsIHU4KiBS
ZWdEYXQsIGludCBUdW5lclBMTFR5cGUpCit7CisJaW50IGk9MDsKKwl1OCBhZGRyLCBkYXRhOwor
CXU4IHNwbGl0aWQ7CisJdTggdDsKKworICAgaWYoQURNVFYxMDJfUkVGQ0xLMzA0MDA9PVR1bmVy
UExMVHlwZSkKKwkgIHsKKwkgICAgYWRkcj0weDI0OworCSAgICBhZG10djEwMl9yZWFkcmVnKHN0
YXRlLCAweDAwLCAmc3BsaXRpZCk7CisKKwkJaWYgKDB4MEU9PXNwbGl0aWQpCisJCQlkYXRhPVJF
RkNMSzMwNDAwX0NMS1NFTF9SRUdfU1BMSVRJRDBFOyAgLy8gMHg1QSAKKwkgICAgZWxzZSBpZigw
eDBGPT1zcGxpdGlkKQorCQkJZGF0YT1SRUZDTEszMDQwMF9DTEtTRUxfUkVHX1NQTElUSUQwRjsg
IC8vIDB4NkEsIGZvciBtYXNzIHByb2R1Y3QgCisJCWVsc2UKKwkJCWRhdGE9UmVnRGF0W2ldOwor
CisJICAgIGFkbXR2MTAyX3dyaXRlcmVnKHN0YXRlLCBhZGRyLCBkYXRhKTsKKwkgICAgaSsrOwor
CSAgfQorCWVsc2UgeworCQlhZGRyPTB4MjQ7CisJCWRhdGE9UmVnRGF0W2krK107CisJCWFkbXR2
MTAyX3dyaXRlcmVnKHN0YXRlLCBhZGRyLCBkYXRhKTsKKwl9CisKKwlhZGRyPTB4MzE7CisJZGF0
YT1SZWdEYXRbaSsrXTsKKwlhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgYWRkciwgZGF0YSk7Cisg
CisJYWRkcj0weDM4OworCWRhdGE9UmVnRGF0W2krK107CisJYWRtdHYxMDJfd3JpdGVyZWcoc3Rh
dGUsIGFkZHIsIGRhdGEpOyAKKwkKKwlyZXR1cm4gMTsKK30KKy8vKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioKKy8vIEZ1bmN0aW9uOiAgRGlzdGluZ3Vpc2ggVHVuZXIgQ2hpcCB0eXBlIGJ5IHJlYWQgU3Bs
aWRJRCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKKy8vIElu
cHV0OiB0YXJnZXQgLS0gRGV2aWNlIEkyQyBhZGRyZXNzIAorLy8gICAgICAgIAorLy8gUmV0dXJu
OiBUdW5lciBUeXBlLCBNVFYxMDIgb3IgQURNVFYxMDIgCisvLyoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
CitpbnQgR2V0VHVuZXJUeXBlKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSkKK3sKKwl1OCBz
cGxpdGlkLFJldFR1bmVyVHlwZTsgCisKKwlhZG10djEwMl9yZWFkcmVnIChzdGF0ZSwgMHgwMCwg
JnNwbGl0aWQpOworCisJc3RhdGUtPkNUVU5FX0NMS09GUz1DVFVORV9DTEtPRlNfU1BMSVQwRTsK
Kwlzd2l0Y2goc3BsaXRpZCkKKwl7CisJY2FzZSAweDBFOgorCQlzdGF0ZS0+Q1RVTkVfQ0xLT0ZT
PUNUVU5FX0NMS09GU19TUExJVDBFOworCQlSZXRUdW5lclR5cGU9VHVuZXJfQURNVFYxMDI7CisJ
CWJyZWFrOworCWNhc2UgMHgwRjogIC8vIGZvciBtYXNzIHByb2R1Y3QgdmVyc2lvbgorCQlzdGF0
ZS0+Q1RVTkVfQ0xLT0ZTPUNUVU5FX0NMS09GU19TUExJVDBGOworCQlSZXRUdW5lclR5cGU9VHVu
ZXJfQURNVFYxMDI7CisJCWJyZWFrOworICAgIGNhc2UgMHgwODoKKyAgICBjYXNlIDB4MEE6CisJ
CVJldFR1bmVyVHlwZT1UdW5lcl9NVFYxMDI7CisJCWJyZWFrOworICAgIGRlZmF1bHQ6CisJCVJl
dFR1bmVyVHlwZT1UdW5lcl9OZXdNVFYxMDI7CisgICAgfQorCisJcmV0dXJuKFJldFR1bmVyVHlw
ZSk7Cit9CisKKy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKy8vIEZ1bmN0aW9uOiAgTWFpbiBGdW5j
dGlvbiBmb3IgVHVuZXIgSW5pdGlhbGl6YXRpb24KKy8vICAgICAgICAgICAgb25seSBzdXBwb3J0
IEFETVRWMTAyIHR5cGUsIGRvIG5vdCBzdXBwb3J0IE1UVjEwMiBhbnkgbW9yZSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKKy8vIElucHV0OiBOb25lCisvLyBS
ZXR1cm46IE5vbmUKKy8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKK3ZvaWQgVHVuZXJJbml0KHN0cnVj
dCBhZG10djEwMl9wcml2ICpzdGF0ZSkKK3sKKwlpbnQgVHVuZXJQTExUeXBlID0gc3RhdGUtPmNm
Zy0+cmVmX2Nsa190eXBlOworCisJR2V0VHVuZXJUeXBlKHN0YXRlKTsKKwlzdGF0ZS0+aWNwPTA7
CisJc3RhdGUtPmNvbnZjbz0wOworCXN0YXRlLT5jdXJUZW1wU3RhdGU9SElHSF9URU1QOyAKKwlp
ZihUdW5lclBMTFR5cGU8MCB8fCBUdW5lclBMTFR5cGU+OSApIAlUdW5lclBMTFR5cGU9MTsKKwlp
ZihzdGF0ZS0+VkhGU2V0PT0gVkhGU3VwcG9ydCkKKwkJQ29uZmlnVHVuZXIgKHN0YXRlLCAmQWRk
ckRhdGFNZW1BRE1UVjEwMl9WSEZbMF0pOworCWVsc2UKKwkJQ29uZmlnVHVuZXIgKHN0YXRlLCAm
QWRkckRhdGFNZW1BRE1UVjEwMl9VSEZbMF0pOworCisJVHVuZXJQTExSZWdTZXQoc3RhdGUsICZQ
TExSZWdTZXRUYWJsZVtUdW5lclBMTFR5cGVdWzBdLFR1bmVyUExMVHlwZSk7CisJU2V0TFBGKHN0
YXRlLCBUdW5lclBMTFR5cGUsIDgpOworfQorCisvLyoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisvLyBG
dW5jdGlvbjogIGZyZXF1ZW5jeSBzZXR0aW5nIGZvciBBRE1UVjEwMiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKKy8vICBJbnB1dDoKKy8vICAgICAgICAgICAg
ICAgdGFyZ2V0ICAgIDogSTJDIGFkZHJlc3Mgb2YgdHVuZXIKKy8vICAgICAgICAgICAgICAgZnJl
cXVlbmN5IDogVHVuZXIgY2VudGVyIGZyZXF1ZW5jeSBpbiBNSHoKKy8vICAgICAgICAgICAgICAg
bHBmQlcgICAgIDogQ2hhbm5lbCBCYW5kd2lkdGggaW4gTUh6IChkZWZhdWx0OiA4LSA4TUhaKQor
Ly8gICAgICAgICAgICAgICByZWZDbGtUeXBlOiBUdW5lciBQTEwgcmVmZXJlbmNlIGNsb2NrIHR5
cGUKKy8vICBmcmVxdWVuY3kgc2V0dGluZyBmb3JtdWxhCisvLyAgICAgICAgICAgICAgIExPZnJl
cXVlbmN5PShDbG9ja2ZyZXF1ZW5jeS9QTExSKihQTExOK1BMTEYvMl4yMCkpL1BMTFM7CisvLyAg
UmV0dXJuOiBOb25lIAorLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgordm9pZCBTZXRUdW5lckZyZXEo
c3RydWN0IGFkbXR2MTAyX3ByaXYgKnN0YXRlLCB1MzIgZnJlcXVlbmN5LCB1MzIgbHBmQlcpCit7
CisJdTMyICAgIE1UVjEweF9SRUZDTEs7IAorCXUzMiAgICBQTExGUkVRLEZyZXE7CisJdTMyICAg
IERJVlNFTD0wLFZDT1NFTD0wOwkKKwl1OCAgICBQQzQ9MCxQQzhfMTY9MCxEQVRBNDcsX3RlbXBl
cjsKKwl1MzIgICAgU2VnX251bTsKKwl1OCAgICBQTExSOyAKKwl1MzIgICAgbG9mcmVxOworCXUz
MiAgIFBMTE4sIFBMTEYsdG1wOworCXUzMiAgICBNdWx0aUZhY3RvcixzdWJfZXhwLGRpdl8xLGRp
dl8yOworCisJcHJpbnRrKCIlcyhmcmVxPSVkLCBidz0lZClcbiIsIF9fZnVuY19fLCBmcmVxdWVu
Y3ksIGxwZkJXKTsKKwkKKwlzdGF0ZS0+ZnJlcXVlbmN5ID0gZnJlcXVlbmN5OworCS8vIGp1ZGdl
IGlmIHRoZSBWRkhzZXQgaGFzIGNvbmZsaWN0IHdpdGggZnJlcXVlbmN5IHZhbHVlIG9yIG5vdCAK
KwlpZiggZnJlcXVlbmN5ID40MDAgJiYgIFZIRlN1cHBvcnQ9PXN0YXRlLT5WSEZTZXQpIC8vIFZI
RiBpcyAxNzRNSHogfiAyNDVNSHogCisJeworCQlzdGF0ZS0+VkhGU2V0PVVIRlN1cHBvcnQ7CisJ
CVR1bmVySW5pdChzdGF0ZSk7CisJfQorCWVsc2UgaWYoZnJlcXVlbmN5IDw0MDAgJiYgIFVIRlN1
cHBvcnQ9PXN0YXRlLT5WSEZTZXQpCisJeworCQlzdGF0ZS0+VkhGU2V0PVZIRlN1cHBvcnQ7CisJ
CVR1bmVySW5pdChzdGF0ZSk7CisJfQorCisJUExMUj0xOworCWxvZnJlcSAgPSBmcmVxdWVuY3kq
MTAwMDsKKwlESVZTRUwgID0gTE8yUExMX0ZyZXEobG9mcmVxKTsKKwlTZWdfbnVtID0gKDB4MDEg
PDwgRElWU0VMKTsKKwkKKwlpZihTZWdfbnVtID49MSAmJiBTZWdfbnVtIDw9MTYpCisJeyBQTExG
UkVRID0gbG9mcmVxKiAoMTYvU2VnX251bSk7CisJCUZyZXE9ZnJlcXVlbmN5KiAoMTYvU2VnX251
bSk7CisJfQorCWVsc2UgCQorCXsgUExMRlJFUSA9IGxvZnJlcSoyOworCQlGcmVxPWZyZXF1ZW5j
eSoyOworCX0KKworCXN3aXRjaChzdGF0ZS0+Y2ZnLT5yZWZfY2xrX3R5cGUpCisJeworCWNhc2Ug
QURNVFYxMDJfUkVGQ0xLMTMwMDA6CisJCU1UVjEweF9SRUZDTEsgPSAxMzA7ICAvLyAxMypNdWx0
aUZhY3RvcgorCQlNdWx0aUZhY3Rvcj0xMDsJCisJCXN1Yl9leHA9MTsKKwkJZGl2XzE9NTsKKwkJ
ZGl2XzI9MTM7IC8vIDEzMD0xMyo1KigyXjEpCisJCWJyZWFrOworICAgY2FzZSBBRE1UVjEwMl9S
RUZDTEsxNjM4NDogeyAKKwkgICBNVFYxMHhfUkVGQ0xLID0gMTYzODQ7IAorCSAgIE11bHRpRmFj
dG9yPTEwMDA7CisJICAgc3ViX2V4cD0xNDsKKwkgICBkaXZfMT0xOworCSAgIGRpdl8yPTE7IC8v
IDE2Mzg0PT0gMl4xNCAKKwkgICBicmVhazsgfQorICAgY2FzZSBBRE1UVjEwMl9SRUZDTEsxOTIw
MDogeworCSAgIE1UVjEweF9SRUZDTEsgPSAxOTI7IAorCSAgIE11bHRpRmFjdG9yPTEwOworCSAg
IHN1Yl9leHA9NjsKKwkgICBkaXZfMT0xOworCSAgIGRpdl8yPTM7IC8vICAxOTIgPSAyXjYgKjMg
CisJICAgYnJlYWs7fQorICAgY2FzZSBBRE1UVjEwMl9SRUZDTEsyMDQ4MDogeworCSAgIE1UVjEw
eF9SRUZDTEsgPSAyMDQ4OyAKKwkgICBNdWx0aUZhY3Rvcj0xMDA7CisJICAgc3ViX2V4cD0xMTsK
KwkgICBkaXZfMT0xOworCSAgIGRpdl8yPTE7IC8vICAyMDQ4ID0gMl4xMSAgIAorICAgICAgIGJy
ZWFrO30KKyAgIGNhc2UgQURNVFYxMDJfUkVGQ0xLMjQ1NzY6IHsKKwkgICBNVFYxMHhfUkVGQ0xL
ID0gMjQ1NzY7IAorCSAgIE11bHRpRmFjdG9yPTEwMDA7CisJICAgc3ViX2V4cD0xMzsKKwkgICBk
aXZfMT0xOworCSAgIGRpdl8yPTM7IC8vIDI0NTc2ID0gMl4xMyozIAorICAgICAgIGJyZWFrOyB9
CisgICBjYXNlIEFETVRWMTAyX1JFRkNMSzI2MDAwOiB7CisJICAgTVRWMTB4X1JFRkNMSyA9IDI2
MDsgCisJICAgTXVsdGlGYWN0b3I9MTA7CQorCSAgIHN1Yl9leHA9MjsKKwkgICBkaXZfMT01Owor
CSAgIGRpdl8yPTEzOyAvLyAyNjA9MTMqNSooMl4yKSAgIAorICAgICAgIGJyZWFrO30KKyAgIGNh
c2UgQURNVFYxMDJfUkVGQ0xLMzA0MDA6IHsKKwkJTVRWMTB4X1JFRkNMSyA9IDMwNDsKKwkgICBN
dWx0aUZhY3Rvcj0xMDsKKwkgICBQTExSID0gMiA7CisJICAgU2V0TFBGKHN0YXRlLCBBRE1UVjEw
Ml9SRUZDTEszMDQwMCwodTgpbHBmQlcpOworCQlhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgx
OSwgUExMUik7IC8vUmVmLiBDbG9jayBEaXZpZGVyIFBMTDAgcmVnaXN0ZXIgLCBiaXRbNzo0XSBp
cyByZXNlcnZlZCwgYml0WzM6MF0gaXMgUExMUgorCSAgIHN1Yl9leHA9NDsKKwkgICBkaXZfMT0x
OworCSAgIGRpdl8yPTE5OyAvLyAzMDQgPSAxNioxOSAgIAorCSAgIGJyZWFrOworCSAgIH0KKyAg
IGNhc2UgQURNVFYxMDJfUkVGQ0xLMzYwMDA6IHsgCisJICAgTVRWMTB4X1JFRkNMSyA9IDM2MDsK
KwkgICBNdWx0aUZhY3Rvcj0xMDsJCisJICAgc3ViX2V4cD0zOworCSAgIGRpdl8xPTU7CisJICAg
ZGl2XzI9OTsgLy8gMzYwPTJeMyo5KjUgCSAgIAorCSAgIGJyZWFrO30KKyAgIGNhc2UgQURNVFYx
MDJfUkVGQ0xLMzg0MDA6eyAKKwkgICBNVFYxMHhfUkVGQ0xLID0gMzg0OyAKKwkgICBNdWx0aUZh
Y3Rvcj0xMDsKKwkgICBzdWJfZXhwPTc7CisJICAgZGl2XzE9MTsKKwkgICBkaXZfMj0zOyAvLyAz
ODQgPSAyXjcgKjMgICAgCisJICAgYnJlYWs7fQorICAgY2FzZSBBRE1UVjEwMl9SRUZDTEsyMDAw
MDp7IAorCSAgIE1UVjEweF9SRUZDTEsgPSAyMDA7IAorCSAgIE11bHRpRmFjdG9yPTEwOwkKKwkg
ICBzdWJfZXhwPTM7CisJICAgZGl2XzE9NTsKKwkgICBkaXZfMj01OyAvLyAyMDA9OCo1KjUKKyAg
ICAgICBicmVhazt9CisgICBkZWZhdWx0OiB7IAorCSAgIE1UVjEweF9SRUZDTEsgPSAxNjM4NDsg
CisJICAgTXVsdGlGYWN0b3I9MTAwMDsKKwkgICBzdWJfZXhwPTE0OworCSAgIGRpdl8xPTE7CisJ
ICAgZGl2XzI9MTsgLy8gMTYzODQ9PSAyXjE0IAorCSAgIGJyZWFrO30KKyAgIH0KKyAgIAorICAg
UExMTiA9IChGcmVxKk11bHRpRmFjdG9yKiBQTExSL01UVjEweF9SRUZDTEsgKTsgLy9uZXcgZm9y
bXVsYSwgbGl1IGRvbmcsIDIwMDcvMTIvMTEKKyAgIHRtcCA9ICgoUExMUipGcmVxKk11bHRpRmFj
dG9yL2Rpdl8xKSA8PCAoMjAtc3ViX2V4cCkgKS9kaXZfMjsgICAKKyAgIFBMTEYgPSB0bXAgLSAo
UExMTjw8MjApOworCisgICBEQVRBNDcgPSAweDEwOyAvL2RlZmF1bHQgVmFsdWUKKyAgIGFkbXR2
MTAyX3JlYWRyZWcoc3RhdGUsIDB4MmYsICZEQVRBNDcpOworICAgCisgICBpZiAoUExMTjw9NjYp
ICAgCisgICB7ICAgCisgICAgICAgLy80LXByZXNjYWxlcgorICAgICAgIFBDNCAgICA9IDE7Cisg
ICAgICAgUEM4XzE2ID0gMDsKKyAgICAgICBEQVRBNDcgPSAodTgpKERBVEE0NyB8IChQQzQ8PDYp
IHwgKFBDOF8xNjw8NSkpOyAKKyAgIH0KKyAgIGVsc2UKKyAgIHsKKyAgICAgICAvLzgtcHJlc2Nh
bGVyCisgICAgICAgUEM0ICAgID0gMDsKKyAgICAgICBQQzhfMTYgPSAwOworICAgICAgIERBVEE0
NyA9ICh1OCkgKERBVEE0NyB8IChQQzQ8PDYpIHwgKFBDOF8xNjw8NSkpOyAKKyAgIH0KKworICAg
Ly8gZG8gYSByZXNldCBvcGVyYXRpb24gCisgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgy
NywgMHgwMCApOyAvL2FkZGVkIDogdjEuNi4zIGF0IFBNIDIwOjM5IDIwMDctMDctMjYKKyAgIC8v
UExMIFJlc2V0IEVuYWJsZQorICAgYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUsIDB4MmYsIERBVEE0
NyApOyAgICAgIC8vUmVzZXQgU2VxLiAwID0+IDEgIDogLy91cGRhdGVkIDogdjEuNi4zIGF0IFBN
IDIwOjM5IDIwMDctMDctMjYKKyAgIGFkbXR2MTAyX3dyaXRlcmVnKHN0YXRlLCAweDJmLCAodTgp
IChEQVRBNDcgfCAweDgwKSk7CisKKyAgIGlmICgoUExMRlJFUSoyKTwyNTkyMDAwKSAgLy8gNjQ4
KjEwMDAqMioyIGFjY29yZGluZyB0byBkYXRhIHNoZWV0CisgICAgICBWQ09TRUwgPSAwOworICAg
ZWxzZSAgIFZDT1NFTCA9IDE7CisKKyAgIC8vIHJlYWQgMHgwOSByZWdpc3RlciBiaXQgWzU6MF0K
KyAgIF90ZW1wZXI9MHgwQzsKKyAgIGFkbXR2MTAyX3JlYWRyZWcoc3RhdGUsIDB4MDksICZfdGVt
cGVyKSA7ICAvL1RvIGdldCBUZW1wZXJhdHVyZSBzZW5zb3IgdmFsdWUKKyAgIF90ZW1wZXIgJj0g
MHgzZjsgLy8gZ2V0IGxvdyA2IGJpdHMgCisgICAKKyAgIGRwUGhhc2VUdW5pbmcoc3RhdGUsIGxv
ZnJlcSxfdGVtcGVyKTsgLy90aGVzZSB2YWx1ZSBtYXkgY2hhbmdlczogZ19pY3A9MCwgc3RhdGUt
PmNvbnZjbz0wLCBzdGF0ZS0+Y3VyVGVtcFN0YXRlPUhJR0hfVEVNUDsKKyAgIAorICAgaWYgKGxv
ZnJlcT40MDAwMDApICAvL2lmIGlSRj1VSEYKKyAgIHsgICAKKyAgICAgIGFkbXR2MTAyX3dyaXRl
cmVnKHN0YXRlLCAweDFhLCAodTgpKChzdGF0ZS0+aWNwPDwyKXwgKChQTExOJjB4MzAwKT4+OCkp
KTsgICAgLy8gY2hhbmdlIDFDIHRvIDdDLiAyMDA3LzA3LzA5CisgICB9CisgICBlbHNlIAorICAg
eworICAgICAgIGFkbXR2MTAyX3dyaXRlcmVnKHN0YXRlLCAweDFhLCAodTgpKCAweEZDIHwgKCAo
IFBMTE4mMHgzMDAgKSA+PiA4ICkpICk7CisgICB9CisKKyAgIC8vUExMIFNldHRpbmcKKyAgIGFk
bXR2MTAyX3dyaXRlcmVnKHN0YXRlLCAweDFiLCAodTgpKFBMTE4gJiAweEZGKSk7CisgICBhZG10
djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgxYywgKHU4KSggKERJVlNFTDw8NCkgfCAoVkNPU0VMPDw3
KSB8ICgoUExMRiYweEYwMDAwKT4+MTYpICkgKTsKKyAgIGFkbXR2MTAyX3dyaXRlcmVnKHN0YXRl
LCAweDFkLCAodTgpKCAoUExMRiYweDBGRjAwKT4+OCApICAgKTsKKyAgIGFkbXR2MTAyX3dyaXRl
cmVnKHN0YXRlLCAweDFlLCAodTgpKCBQTExGJjB4RkYgKSk7CisgICBhZG10djEwMl93cml0ZXJl
ZyhzdGF0ZSwgMHgxNSwgKHU4KSggMHgzOHwgKChscGZCVy0zKSYgMHgwNykgKSk7CisKKyAgIC8v
UExMIFJlc2V0CisgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgyZiwgREFUQTQ3KTsgICAg
ICAvL1Jlc2V0IFNlcS4gMCA9PiAxID0+IDAgOiAvL3VwZGF0ZWQgOiB2MS41IGF0IFBNIDIwOjM5
IDIwMDctMDYtOAorICAgYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUsIDB4MmYsICh1OCkoIERBVEE0
NyB8IDB4ODAgKSk7CisgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgyZiwgREFUQTQ3KTsK
KyAgIAorICAgYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUsIDB4MjcsIHN0YXRlLT5jb252Y28gKTsK
KyAgIGlmIChsb2ZyZXE+NDAwMDAwKSAgICBhZG10djEwMl93cml0ZXJlZyhzdGF0ZSwgMHgyOSwg
MHhCRiApOwkgCisgICByZXR1cm47IAkKK30KKy8vKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKy8vIEZ1
bmN0aW9uOiAgY2FsY3VsYXRlIERJVlNFTCBhY2NvcmRpbmcgdG8gbG9mcmVxICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCisvLyAgSW5wdXQ6ICAgbG9mcmVxICAt
LSBGcmVxdWVuY3kgcG9pbnQgdmFsdWUgaW4ga0h6IHVuaXQgCisvLyAgUmV0dXJuOiAgbV9ESVZT
RUwgLS0gRElWU0VMIGluIHJlZ2lzdGVyIDB4MUMgIAorLy8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgor
aW50ICBMTzJQTExfRnJlcSh1MzIgbG9mcmVxKQoreworICAgdTMyIGZkZWZMb0JvdW5kRnJlcT05
NDAwMDA7CisKKyAgIGludAlTZWdfbnVtLCBtX0RJVlNFTD0wOworICAgIAorICAgU2VnX251bT0o
aW50KShsb2ZyZXEvKGZkZWZMb0JvdW5kRnJlcS8xNikpOworCisgICB3aGlsZShTZWdfbnVtPjB4
MDEpCisgICB7CisgICAgIFNlZ19udW09KFNlZ19udW0+PjEpOworICAgICBtX0RJVlNFTCsrOwor
ICAgfQorICAgcmV0dXJuKG1fRElWU0VMKSA7Cit9CisKKy8vKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
CisvLyBGdW5jdGlvbjogQ2hhbmdlIENPTlZDTyB2YWx1ZSBhY2NvcmRpbmcgdG8gVGVtcGVyYXR1
cmUgU2Vuc29yKDB4MjdbMDo0XSkKKy8vIElucHV0OiBsb2ZyZXEgLS0gZnJlcXVlbmN5IGluIGtI
eiB1bml0IAorLy8gICAgICAgIHRlbXBlciAtLSBUdW5lciAweDA5IHJlZ2lzdGVyIGNvbnRlbnQg
IAorLy8gUmV0dXJuOiBOb25lCisKKy8vID8/IGlzIHRoaXMgbWVzc2luZyBhcm91bmQgd2l0aCBn
bG9iYWxzISE/IT8hPworCisvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgordm9pZCBkcFBoYXNlVHVu
aW5nKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSwgdTMyIGxvZnJlcSwgdTggdGVtcGVyKQor
eyAgCisgIGlmIChmRGVnVmNvQXBwbHkpCisgIHsKKyAgICBpZihzdGF0ZS0+VkhGU2V0PT0gVkhG
U3VwcG9ydCkgeworICAgCWlmICh0ZW1wZXI8PXZsb3dEZWdCb3VuZGFyeSkgIC8vbG93IGJvdW5k
YXJ5CisJeworCSAgc3RhdGUtPmNvbnZjbz1yZ2xvd0RlZ0NPTlZDT19WSEY7IAorCSAgc3RhdGUt
PmN1clRlbXBTdGF0ZT1MT1dfVEVNUDsKKwl9CisJZWxzZQorCSAgaWYgKHRlbXBlcj49dmhpZ2hE
ZWdCb3VuZGFyeSkgLy9oaWdoIGJvdW5kYXJ5CisJICB7CisJCXN0YXRlLT5jb252Y289cmdIaWdo
RGVnQ09OVkNPOworCQlzdGF0ZS0+Y3VyVGVtcFN0YXRlPUhJR0hfVEVNUDsKKwkgIH0JCisgICAg
fQorICAgZWxzZSB7ICAgCQorICAgIGlmICh0ZW1wZXI8PXZsb3dEZWdCb3VuZGFyeSkgIC8vbG93
IGJvdW5kYXJ5CisgICAgeworICAgICAgc3RhdGUtPmNvbnZjbz1yZ2xvd0RlZ0NPTkRJVjsKKyAg
ICAgIHN0YXRlLT5pY3A9MHgzRjsKKyAgICAgc3RhdGUtPmN1clRlbXBTdGF0ZT1MT1dfVEVNUDsK
KyAgICB9CisgICAgZWxzZQorICAgICAgaWYgKHRlbXBlcj49dmhpZ2hEZWdCb3VuZGFyeSkgLy9o
aWdoIGJvdW5kYXJ5CisgICAgICB7CisJc3RhdGUtPmNvbnZjbz1yZ0hpZ2hEZWdDT05ESVY7CisJ
aWYgKCggbG9mcmVxID4gNjEwMDAwICApICYmICggbG9mcmVxIDwgNjQ4MDAwICApKSAvLzYxME1I
eiB+IDY0OE1IegorCSAgICBzdGF0ZS0+aWNwPTB4MUY7CisJZWxzZSAgc3RhdGUtPmljcD0weDNG
OworCXN0YXRlLT5jdXJUZW1wU3RhdGU9SElHSF9URU1QOworICAgICAgfQorICAgICAgZWxzZQor
CSAgeyAgaWYgKHN0YXRlLT5jdXJUZW1wU3RhdGUpCisJICAgICB7CisJCSBzdGF0ZS0+Y29udmNv
PXJnbG93RGVnQ09ORElWOworCQkgc3RhdGUtPmljcD0weDNGOworCSAgICAgIH0KKwkgICAgIGVs
c2UKKwkgICAgICB7CXN0YXRlLT5jb252Y289cmdIaWdoRGVnQ09ORElWOworCQlpZiAoKCBsb2Zy
ZXEgPiA2MTAwMDAgICkgJiYgKCBsb2ZyZXEgPCA2NDgwMDAgICkpIC8vNjEwTUh6IH4gNjQ4TUh6
CisJCSAgc3RhdGUtPmljcD0weDFGOworCQllbHNlICBzdGF0ZS0+aWNwPTB4M0Y7CisJICAgICAg
fQkKKwkgIH0KKyAgICAgfQorICB9CisgIHJldHVybjsKK30KKy8vKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqCisvLyBGdW5jdGlvbjogRG8gdHVuZXIgdGVtcGVyYXR1cmUgY29tcGVuc2F0ZSwgaXQgY2Fu
IGJlIGNhbGxlZCBieSBwcm9jZXNzb3IgCisvLyAgICAgICAgICAgZm9yIGV2ZXJ5IDV+MTAgc2Vj
b25kcy4gVGhpcyBtYXkgaW1wcm92ZSB0aGUgdHVuZXIgcGVyZm9ybWFuY2UuICAKKy8vICAKKy8v
IElucHV0OiBsb2ZyZXEgLS0gZnJlcXVlbmN5IGluIGtIeiB1bml0IAorLy8gUmV0dXJuOiBOb25l
CisvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgordm9pZCAgICBUdW5lclRlbXBlcmF0dXJlQ29tcChz
dHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUsIGxvbmcgbG9mcmVxKQoreyAgCisgICAgdTggIE9y
aV9SZWdfMHgxQSxSZWdfMHgxQSxfdGVtcGVyOworCisgICAgT3JpX1JlZ18weDFBPTB4RkM7IAor
ICAgIF90ZW1wZXI9MHgwQzsKKyAgICBhZG10djEwMl9yZWFkcmVnKHN0YXRlLCAweDA5LCAmX3Rl
bXBlcikgOyAgLy9UbyBnZXQgVGVtcGVyYXR1cmUgc2Vuc29yIHZhbHVlCisgICAgX3RlbXBlciAm
PSAweDNGOyAvLyBnZXQgbG93IDYgYml0cyAKKworICAgIGRwUGhhc2VUdW5pbmcoc3RhdGUsIGxv
ZnJlcSwgX3RlbXBlcik7CisKKyAgICBhZG10djEwMl9yZWFkcmVnKHN0YXRlLCAweDFBLCAmT3Jp
X1JlZ18weDFBKSA7ICAvL1RvIGdldCBUZW1wZXJhdHVyZSBzZW5zb3IgdmFsdWUKKworICAgIC8v
IHJlc2VydmUgYml0IDcsIGJpdDEgYW5kIGJpdCAwCisgICAgUmVnXzB4MUE9ICh1OCkoKHN0YXRl
LT5pY3AgPDwyKSB8IChPcmlfUmVnXzB4MUEgJiAweDgzKSk7IAorICAgIC8vIHdyaXRlIHN0YXRl
LT5pY3AgaW50byAweDFBIHJlZ2lzdGVyIGJpdFs2OjJdIAorICAgIGFkbXR2MTAyX3dyaXRlcmVn
KHN0YXRlLCAweDFBLCBSZWdfMHgxQSk7CisgICAgYWRtdHYxMDJfd3JpdGVyZWcoc3RhdGUsIDB4
MjcsIHN0YXRlLT5jb252Y28pOworCisKK30KKworLyogKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgorICog
IEZ1bmN0aW9uOiBjYWxjdWxhdGUgc2lnbmFsIHBvd2VyIHVzaW5nIFR1bmVyIHJlbGF0ZWQgcmVn
aXN0ZXJzIAorICogIElucHV0OiBOb25lCisgKiAgIFJldHVybjogc2lnbmFsIHBvd2VyIGluIGRC
bSB1bml0ICAKKyAqICBOb3RlOiBUaGUgcHJlY2lzZSBpcyBhYm91dCAxMGRCCisgKiAqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLworI2RlZmluZSBDT01QNDk3IDQ5NworI2RlZmluZSBDT01QNTMwIC01MzAK
KworI2RlZmluZSBGUkVRNDc0IDQ3NAorI2RlZmluZSBGUkVRODU4IDg1OAorCisKKyNpZiAwCitp
bnQgICBUdW5lclJTU0lDYWxjKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSwgaW50IGZyZXEp
Cit7CisgCWludCBQb3dlckRCVmFsdWU9MDsgLy8gaW4gZEJtIHVuaXQKKwl1bnNpZ25lZCBjaGFy
IFJGX0FHQ19Mb3dCeXRlID0wLFJGX0FHQ19IaWdoQnl0ZT0wLExOQV9HYWluPTAsR1ZCQj0wOwor
CWludCBSRl9BR0M7CisJaW50IENhc2VOdW1iZXI7CisJaW50IENvZWZbNV07CisJLy9pbnQgQ29t
cFRhYlsyXT17IDQ5NywgLTUzMH07CisJLy9pbnQgRnJlcVRhYlsyXT17IDQ3NCwgODU4IH07CisJ
aW50IEZyZXFfQ29tcCxCQkFHQ19QYXJ0OworCXVuc2lnbmVkIGNoYXIgVmFsXzB4M0QsVmFsXzB4
M2UsVmFsXzB4M2Y7CisKKwkKKwkKKwlGcmVxX0NvbXA9IC0oIAorCQkoQ09NUDUzMCAtIENPTVA0
OTcpICoKKwkJCShmcmVxIC0gRlJFUTQ3NCkgLworCQkJCShGUkVRODU4IC0gRlJFUTQ3NCkgCisJ
CSsgQ09NUDQ5NyApOyAvLzAuMDFkQgorCisJR1ZCQj0wOworCWFkbXR2MTAyX3JlYWRyZWcgKHN0
YXRlLCAweDA1LCAmUkZfQUdDX0xvd0J5dGUpOyAKKwlhZG10djEwMl9yZWFkcmVnIChzdGF0ZSwg
MHgwNiwgJlJGX0FHQ19IaWdoQnl0ZSk7IAorCQorCVJGX0FHQz0gKFJGX0FHQ19IaWdoQnl0ZSAm
IDB4MDEpOworCVJGX0FHQz0gKFJGX0FHQzw8OCkgKyBSRl9BR0NfTG93Qnl0ZTsKKwkKKwlhZG10
djEwMl9yZWFkcmVnIChzdGF0ZSwgMHgwZCwgJkxOQV9HYWluKTsgCisJTE5BX0dhaW4gPSAoIChM
TkFfR2FpbiAmIDB4NjAgKT4+IDUgKTsKKworCWFkbXR2MTAyX3JlYWRyZWcgKHN0YXRlLCAweDA0
LCAmR1ZCQik7IAorCUdWQkI9KEdWQkImMHhmMCk+PjQ7CisKKwlWYWxfMHgzRD0wOworCVZhbF8w
eDNlPTA7CisJVmFsXzB4M2Y9MDsKKwkKKyNpZiAwCisJYWRtdHYxMDJfcmVhZHJlZyAoc3RhdGUs
IGxvd0RlbW9kSTJDQWRyLCAweDNkLCAmVmFsXzB4M0QpOworCWFkbXR2MTAyX3JlYWRyZWcgKHN0
YXRlLCBsb3dEZW1vZEkyQ0FkciwgMHgzZSwgJlZhbF8weDNlKTsKKwlhZG10djEwMl9yZWFkcmVn
IChzdGF0ZSwgbG93RGVtb2RJMkNBZHIsIDB4M2YsICZWYWxfMHgzZik7CisJaWYgKFZhbF8weDNm
ICYgMHgxMCkgCisJCVZhbF8weDNmPSAoVmFsXzB4M2YgJiAweDBmKTsvLyB0d28ncyBjb21wbGVt
ZW50IHRvIG9mZnNldCBiaW5hcnkKKwllbHNlIAorCQlWYWxfMHgzZj0gKFZhbF8weDNmfDB4MWYp
OyAgICAgIC8vCisjZW5kaWYKKworCUJCQUdDX1BhcnQ9IFZhbF8weDNmOworCUJCQUdDX1BhcnQg
PSAoIEJCQUdDX1BhcnQgPDw4KSArIFZhbF8weDNlOyAKKworCUNhc2VOdW1iZXI9MDsgLy8gZGVm
YXVsdCBhbGdvcml0aG0KKwlpZiAoTE5BX0dhaW49PTAgJiYgR1ZCQj09NCkgIENhc2VOdW1iZXI9
MTsgLy9bMCwtMzFkQm1dLCBjYXNlIDEgCisJaWYgKExOQV9HYWluPT0zICYmIEdWQkI9PTQgJiYg
UkZfQUdDPDM4MykgIENhc2VOdW1iZXI9MjsgLy9bLTM0ZEJtLC01OWRCbV0sIGNhc2UgMgorCWlm
IChMTkFfR2Fpbj09MyAmJiBHVkJCPjQgJiYgUkZfQUdDPj0zODMpICBDYXNlTnVtYmVyPTM7IC8v
Wy02MUJtLC05M2RCbV0sIGNhc2UgMworCWlmICggKExOQV9HYWluPT0wICYmIEdWQkI+NCkgfHwg
KExOQV9HYWluPT0zICYmIEdWQkI8NCkgKSBDYXNlTnVtYmVyPTQ7IC8vWy0yLC01MmRCbV0sIGNh
c2UgNCAKKwlpZiAoTE5BX0dhaW49PTMgJiYgR1ZCQj40ICYmIFJGX0FHQzwzODMpICBDYXNlTnVt
YmVyPTU7IC8vWy01MywtNzhkQm1dLCBjYXNlIDUgCisJaWYgKEdldFR1bmVyVHlwZShzdGF0ZSxs
b3dUdW5lckkyQ0Fkcik9PVR1bmVyX01UVjEwMikgQ2FzZU51bWJlcj0wOyAvL3VzZSBkZWZhdWx0
IGZvcm11bGEKKwkKKwkvL3ByaW50aygiUlNTSSBDYWxjIHVzZSBmb3JtdWxhICVkXG4iLCBDYXNl
TnVtYmVyKTsKKwkvLyBiYXNpY2FsbHkgYWxsIHRoZSB0ZXN0cyBJJ3ZlIGZvdW5kIGhhdmUgZW5k
ZWQgdXAgd2l0aCBjYXN0IDUhISExCisJCisJCisJLy8gaWYgQkJBR0MgPiAwLjk3LCBjYXNlIG51
bWJlciBpcyBmb3JjZWQgdG8gMCwgbGl1IGRvbmcsIDIwMDgvMDQvMjIKKwlpZihWYWxfMHgzZiA+
PSAweDEwKSBDYXNlTnVtYmVyPTA7CisKKwlzd2l0Y2goQ2FzZU51bWJlcikKKwl7ICBjYXNlIDE6
ICB7IAorCQkgICAgICBDb2VmWzBdPS0yNTsgIENvZWZbMV09LTEwMDA7IENvZWZbMl09LTI4Nzsg
Q29lZlszXT0tMTE0MDAgOyBDb2VmWzRdPS0zMTA7ICAKKwkJICAgICAgQkJBR0NfUGFydD0oKENv
ZWZbM10qQkJBR0NfUGFydCkvODE5MikgKyA1MDE2OyAgIC8vIDUwMTYgPSBDb2VmWzNdKjAuNDQK
KwkgICAgICAgICAgICAgIFBvd2VyREJWYWx1ZT1Db2VmWzBdKlJGX0FHQytDb2VmWzFdKkxOQV9H
YWluK0NvZWZbMl0qKEdWQkItNSkrQkJBR0NfUGFydCtDb2VmWzRdK0ZyZXFfQ29tcDsKKwkgICAg
ICAgICAgICAgIGJyZWFrOworCQkgICAgfQorICAgICAgIGNhc2UgMjogIHsgCisJCSAgQ29lZlsw
XT0tMTM7ICBDb2VmWzFdPS03NTI7IENvZWZbMl09MjE0OyBDb2VmWzNdPTEwMDAgOyBDb2VmWzRd
PTg4NjsgCisJCSAgQkJBR0NfUGFydD0oKENvZWZbM10qQkJBR0NfUGFydCkvODE5MiktIDQ0MDsg
ICAvLyA0NDAgPSBDb2VmWzNdKjAuNDQKKyAgICAgICAgICAgICAgICAgIFBvd2VyREJWYWx1ZT1D
b2VmWzBdKlJGX0FHQytDb2VmWzFdKkxOQV9HYWluK0NvZWZbMl0qKEdWQkItNSkrQkJBR0NfUGFy
dCtDb2VmWzRdK0ZyZXFfQ29tcDsKKwkgICAgICAgICAgYnJlYWs7CisJCX0KKyAgICAgICBjYXNl
IDM6ICB7IAorICAgICAgICAgICAgICAgICAgQ29lZlswXT0tMTI7ICBDb2VmWzFdPS05NTI7IENv
ZWZbMl09LTM0NzsgQ29lZlszXT0tMTE0MDAgOyBDb2VmWzRdPTEyMDsgCisJCSAgQkJBR0NfUGFy
dD0oKENvZWZbM10qQkJBR0NfUGFydCkvODE5MikgKyA1MDE2OyAgIC8vIDUwMiA9IENvZWZbM10q
MC40NAorCSAgICAgICAgICBQb3dlckRCVmFsdWU9Q29lZlswXSpSRl9BR0MrQ29lZlsxXSpMTkFf
R2FpbitDb2VmWzJdKihHVkJCLTUpK0JCQUdDX1BhcnQrQ29lZls0XStGcmVxX0NvbXA7CisJICAg
ICAgICAgIGJyZWFrOworCQl9CisgICAgICAgY2FzZSA0OiAgeyAJCisgIAkJICBDb2VmWzBdPS0x
MjsgIENvZWZbMV09LTEwMDA7IENvZWZbMl09LTMzMDsgQ29lZlszXT0tMTE0MDAgOyBDb2VmWzRd
PTcwOyAKKwkJICBCQkFHQ19QYXJ0PSgoQ29lZlszXSpCQkFHQ19QYXJ0KS84MTkyKSArIDUwMTY7
ICAgLy8gNTAxNiA9IENvZWZbM10qMC40NAorCSAgICAgICAgICBQb3dlckRCVmFsdWU9Q29lZlsw
XSpSRl9BR0MrQ29lZlsxXSpMTkFfR2FpbitDb2VmWzJdKihHVkJCLTUpK0JCQUdDX1BhcnQrQ29l
Zls0XStGcmVxX0NvbXA7ICAgICAgICAgICAgIAorCSAgICAgICAgICBicmVhazsKKwkJfQorICAg
ICAgIGNhc2UgNTogIHsgCQorCQkgIENvZWZbMF09LTEyOyAgCisJCSAgQ29lZlsxXT0tOTUyOyAK
KwkJICBDb2VmWzJdPS0yODA7IAorCQkgIENvZWZbM109LTExNDAwIDsgCisJCSAgQ29lZls0XT0x
MjA7IAorCQkgIAorCQkgIEJCQUdDX1BhcnQ9KChDb2VmWzNdKkJCQUdDX1BhcnQpLzgxOTIpICsg
NTAxNjsgICAvLyA1MDIgPSBDb2VmWzNdKjAuNDQKKwkJICAvLyBMTkEgR2FpbCA9PSBhbHdheSBz
MyAuLi4gKGR1ZSB0byBjYXNlKQorCQkgIC8vIEAgNTYyID0+IEdvb2Q6QUdDIDwgMjkwICwgIChH
VkJCLTUpIDwgNSAKKwkJICAvLyBAIDYwMiA9PiBHb29kOkFHQyA8IDI5MCAsICAoR1ZCQi01KSA8
IDQKKwkJICAvLyBAIDc0NiA/PyA9PiBHb29kOkFHQyA8IDI5MCAsICAoR1ZCQi01KSA8IDQgICog
YXQgdGhpcyBmcmVxLCAgCisJCSAgCisJCSAgCisJCSAgLy9wcmludGsoIihmcmVxPSVkKSBSRl9B
R0M9JWQsIExOQV9HYWluPSVkLCBHVkJCPSVkLCBCQkFHQ19QYXJ0PSVkLCBGcmVxX0NvbXA9JWRc
biIsCisJCQkvLwlmcmVxLCBSRl9BR0MsIExOQV9HYWluLCBHVkJCLTUsIEJCQUdDX1BhcnQsIEZy
ZXFfQ29tcCk7CisJCSAgCisJCSAgUG93ZXJEQlZhbHVlPQlDb2VmWzBdICogUkZfQUdDICsKKwkJ
CQkJCUNvZWZbMV0gKiBMTkFfR2FpbiArCisJCQkJCQlDb2VmWzJdICogKEdWQkItNSkgKworCQkJ
CQkJQkJBR0NfUGFydCArCisJCQkJCQlDb2VmWzRdICsKKwkJCQkJCUZyZXFfQ29tcDsKKwkgICAg
ICAgICAgYnJlYWs7CisJCX0KKyAgICAgICBkZWZhdWx0OiAgeyAgCQorCSAgICAgICAgICBDb2Vm
WzBdPS0xMjsgIENvZWZbMV09LTgzMDsgQ29lZlsyXT04MDA7CisJICAgICAgICAgIFBvd2VyREJW
YWx1ZT1SRl9BR0MqQ29lZlswXStMTkFfR2FpbipDb2VmWzFdICtDb2VmWzJdOworICAgICAgICAg
ICAgICAgCSAgQkJBR0NfUGFydD0gIC0xMDAwKkJCQUdDX1BhcnQvODE5MjsJCisJCSAgUG93ZXJE
QlZhbHVlPVBvd2VyREJWYWx1ZS0zMDAqKEdWQkItNSkrQkJBR0NfUGFydCArIEZyZXFfQ29tcDsg
IC8vIGZvciA4OTM0IGNhc2UgCisgICAgICAgICAgICAgICAgICBicmVhazsKKwkJfQorCX0KKwkK
KwlyZXR1cm4oUG93ZXJEQlZhbHVlKTsKK30KKworIAorIAoraW50IFR1bmVyUlNTSUNhbGNBdmco
c3RydWN0IGFkbXR2MTAyX3ByaXYgKnN0YXRlLCBpbnQgZnJlcSkgCit7CisJCisJaW50IGksUlNT
SV92YWxfdG90YWw9MDsJCisJZm9yKGk9MDtpPFJTU0lBdmVUaW1lcztpKyspIC8vIG1lYXN1cmUg
UlNTSSBmb3IgUlNTSUF2ZVRpbWVzIHRpbWVzLgorCXsgCisJCVJTU0lfdmFsX3RvdGFsKz0gVHVu
ZXJSU1NJQ2FsYyhzdGF0ZSwgZnJlcSk7ICAgCSAgICAKKwkgICAgIAkgICAgIAorCX0gCisJcmV0
dXJuIFJTU0lfdmFsX3RvdGFsL1JTU0lBdmVUaW1lczsKK30KKyNlbmRpZgorCitpbnQgIFR1bmVy
UGxsTG9ja0NoZWNrKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSkKK3sgIAorICAgaW50IFR1
bmVySTJDX3N0YXR1cywgRGVtb2RJMkNfc3RhdHVzMSwgRGVtb2RJMkNfc3RhdHVzMjsgLy9yZWNv
cmQgdGhlIEkyQyBhY2Nlc3Mgc3RhdHVzIAorICAgaW50IFR1bmVyX3BsbF9sb2NrLCBEZW1vZF9D
QUxPQ0ssIERlbW9kX0F1dG9Eb25lOyAvL3JlY29yZCB0aGUgYml0IHN0YXR1cyAKKyAgIGludCBj
aGVja19tb2RlOyAKKyAgIGludCBUdW5lcjB4MDZMb2NrLFR1bmVyQURvdXQ7CisJdTggdDsKKyAg
ICAKKyAgIFR1bmVySTJDX3N0YXR1cz1EZW1vZEkyQ19zdGF0dXMxPURlbW9kSTJDX3N0YXR1czI9
MDsKKyAgIFR1bmVyX3BsbF9sb2NrPURlbW9kX0NBTE9DSz1EZW1vZF9BdXRvRG9uZT0wOworICAg
IAorICAgY2hlY2tfbW9kZT0xOworCisgICAvLyBjaGVjayBpZiB0aGUgVHVuZXIgUExMIGlzIGxv
Y2tlZCBvciBub3QgCisJYWRtdHYxMDJfcmVhZHJlZyhzdGF0ZSwgMHgwNiwgJnQpOworCWlmICgo
dCAmIDB4MDIpID09IDB4MDIpCisJCVR1bmVyMHgwNkxvY2s9MTsgCisJZWxzZQorCQlUdW5lcjB4
MDZMb2NrPTA7IAorCisJYWRtdHYxMDJfcmVhZHJlZyhzdGF0ZSwgMHgwNCwgJnQpOworCVR1bmVy
QURvdXQ9MHhmZjsKKwlUdW5lckFEb3V0ID0gdCAmIDB4MGY7CisKKyAgIGlmICggKCAoIFR1bmVy
QURvdXQgPiBUdW5lckFET3V0TWluICkgJiYgKCBUdW5lckFEb3V0IDwgVHVuZXJBRE91dE1heCAp
ICkgJiYgVHVuZXIweDA2TG9jayApICAvL3BsbCBsb2NrIGNyb3NzIGNoZWNrCisJICBUdW5lcl9w
bGxfbG9jaz0xOworICAgZWxzZSBUdW5lcl9wbGxfbG9jaz0wOworICAgcmV0dXJuIFR1bmVyX3Bs
bF9sb2NrOworfQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKKworc3RhdGljIGludCBhZG10
djEwMl9zZXRfcGFyYW1zKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCBzdHJ1Y3QgZHZiX2Zyb250
ZW5kX3BhcmFtZXRlcnMgKnBhcmFtcykKK3sKKwlzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqcHJpdjsK
Kwl1MzIgZnJlcTsKKwlpbnQgaTsKKwlpbnQgcmV0ID0gMDsKKwl1OCBidyA9IDg7CisJcHJpdiA9
IGZlLT50dW5lcl9wcml2OworCisJaWYgKGZlLT5vcHMuaTJjX2dhdGVfY3RybCkKKwkJZmUtPm9w
cy5pMmNfZ2F0ZV9jdHJsKGZlLCAxKTsgLyogb3BlbiBpMmNfZ2F0ZSAqLworCisJZnJlcSA9IHBh
cmFtcy0+ZnJlcXVlbmN5IC8gMTAwMCAvIDEwMDA7IC8vIEh6IC0+IE1IegorCisJcHJpdi0+YmFu
ZHdpZHRoID0gQkFORFdJRFRIXzhfTUhaOworCWlmIChmZS0+b3BzLmluZm8udHlwZSA9PSBGRV9P
RkRNKSB7CisJCXByaXYtPmJhbmR3aWR0aCA9ICBwYXJhbXMtPnUub2ZkbS5iYW5kd2lkdGg7CisJ
CXByaW50aygicGFyYW1zLT51Lm9mZG0uYmFuZHdpZHRoID0gJWRcbiIsIHBhcmFtcy0+dS5vZmRt
LmJhbmR3aWR0aCk7CisJCisJCXN3aXRjaCAocGFyYW1zLT51Lm9mZG0uYmFuZHdpZHRoKSB7CisJ
CQljYXNlIEJBTkRXSURUSF82X01IWjoKKwkJCQlidyA9IDY7CisJCQkJYnJlYWs7CisJCQljYXNl
IEJBTkRXSURUSF83X01IWjoKKwkJCQlidyA9IDc7CisJCQkJYnJlYWs7CisJCQljYXNlIEJBTkRX
SURUSF84X01IWjoKKwkJCQlidyA9IDg7CisJCQkJYnJlYWs7CisJCX0KKwl9CisKKwlTZXRUdW5l
ckZyZXEocHJpdiwgZnJlcSwgYncpOworCisJLy9XYWl0cyBmb3IgcGxsIGxvY2sgb3IgdGltZW91
dAorCWkgPSAwOworCWRvIHsKKwkJaWYgKFR1bmVyUGxsTG9ja0NoZWNrKHByaXYpKSB7CisJCQlw
cmludGsoIlR1bmVyIFBMTCBMb2NrZWRcbiIpOworCQkJYnJlYWs7CisJCX0KKwkJbXNsZWVwKDQp
OworCQlpKys7CisJfSB3aGlsZSAoaTwxMCk7CisKKwlpZiAoZmUtPm9wcy5pMmNfZ2F0ZV9jdHJs
KQorCQlmZS0+b3BzLmkyY19nYXRlX2N0cmwoZmUsIDApOyAvKiBjbG9zZSBpMmNfZ2F0ZSAqLwor
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBhZG10djEwMl9nZXRfZnJlcXVlbmN5KHN0
cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCB1MzIgKmZyZXF1ZW5jeSkKK3sKKwlzdHJ1Y3QgYWRtdHYx
MDJfcHJpdiAqcHJpdiA9IGZlLT50dW5lcl9wcml2OworCSpmcmVxdWVuY3kgPSBwcml2LT5mcmVx
dWVuY3k7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYWRtdHYxMDJfZ2V0X2JhbmR3aWR0
aChzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTMyICpiYW5kd2lkdGgpCit7CisJc3RydWN0IGFk
bXR2MTAyX3ByaXYgKnByaXYgPSBmZS0+dHVuZXJfcHJpdjsKKwkqYmFuZHdpZHRoID0gcHJpdi0+
YmFuZHdpZHRoOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGFkbXR2MTAyX2luaXQoc3Ry
dWN0IGR2Yl9mcm9udGVuZCAqZmUpCit7CisJc3RydWN0IGFkbXR2MTAyX3ByaXYgKnN0YXRlID0g
ZmUtPnR1bmVyX3ByaXY7CisKKwlUdW5lckluaXQoc3RhdGUpOyAgLy8gaW5pdCBUdW5lciAgIAkJ
CisJU2V0VHVuZXJGcmVxKHN0YXRlLCA3NDYsIDgpOworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IGFkbXR2MTAyX3NsZWVwKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlKQoreworCXJldHVybiAw
OworfQorCitzdGF0aWMgaW50IGFkbXR2MTAyX3JlbGVhc2Uoc3RydWN0IGR2Yl9mcm9udGVuZCAq
ZmUpCit7CisJa2ZyZWUoZmUtPnR1bmVyX3ByaXYpOworCWZlLT50dW5lcl9wcml2ID0gTlVMTDsK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkdmJfdHVuZXJfb3BzIGFkbXR2
MTAyX3R1bmVyX29wcyA9IHsKKwkuaW5mbyA9IHsKKwkJLm5hbWUgICAgICAgICAgID0gIkFuYWxv
ZyBEZXZpY2UgQURNVFYxMDIiLAorCQkuZnJlcXVlbmN5X21pbiAgPSAgNDgwMDAwMDAsCisJCS5m
cmVxdWVuY3lfbWF4ICA9IDg2MDAwMDAwMCwKKwkJLmZyZXF1ZW5jeV9zdGVwID0gICAgIDUwMDAw
LAorCX0sCisKKwkucmVsZWFzZSAgICAgICA9IGFkbXR2MTAyX3JlbGVhc2UsCisKKwkuaW5pdCAg
ICAgICAgICA9IGFkbXR2MTAyX2luaXQsCisJLnNsZWVwICAgICAgICAgPSBhZG10djEwMl9zbGVl
cCwKKworCS5zZXRfcGFyYW1zICAgID0gYWRtdHYxMDJfc2V0X3BhcmFtcywKKwkuZ2V0X2ZyZXF1
ZW5jeSA9IGFkbXR2MTAyX2dldF9mcmVxdWVuY3ksCisJLmdldF9iYW5kd2lkdGggPSBhZG10djEw
Ml9nZXRfYmFuZHdpZHRoCit9OworCisvKiBUaGlzIGZ1bmN0aW9ucyB0cmllcyB0byBpZGVudGlm
eSBhIE1UMjA2MCB0dW5lciBieSByZWFkaW5nIHRoZSBQQVJUL1JFViByZWdpc3Rlci4gVGhpcyBp
cyBoYXN0eS4gKi8KK3N0cnVjdCBkdmJfZnJvbnRlbmQgKiBhZG10djEwMl9hdHRhY2goc3RydWN0
IGR2Yl9mcm9udGVuZCAqZmUsIHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjLCBzdHJ1Y3QgYWRtdHYx
MDJfY29uZmlnICpjZmcpCit7CisJc3RydWN0IGFkbXR2MTAyX3ByaXYgKnByaXYgPSBOVUxMOwor
CXU4IGlkID0gMDsKKworCXByaXYgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgYWRtdHYxMDJfcHJp
diksIEdGUF9LRVJORUwpOworCWlmIChwcml2ID09IE5VTEwpCisJCXJldHVybiBOVUxMOworCisJ
cHJpdi0+Y2ZnICAgICAgPSBjZmc7CisJcHJpdi0+aTJjICAgICAgPSBpMmM7CisKKwlpZiAoZmUt
Pm9wcy5pMmNfZ2F0ZV9jdHJsKQorCQlmZS0+b3BzLmkyY19nYXRlX2N0cmwoZmUsIDEpOyAvKiBv
cGVuIGkyY19nYXRlICovCisKKwlpZiAoYWRtdHYxMDJfcmVhZHJlZyhwcml2LDAsJmlkKSAhPSAw
KSB7CisJCWtmcmVlKHByaXYpOworCQlyZXR1cm4gTlVMTDsKKwl9CisKKyNpZiAwCisJaWYgKGlk
ICE9IFBBUlRfUkVWKSB7CisJCWtmcmVlKHByaXYpOworCQlyZXR1cm4gTlVMTDsKKwl9CisjZW5k
aWYKKwkvL3ByaW50ayhLRVJOX0lORk8gIkFETVRWMTAyOiBzdWNjZXNzZnVsbHkgaWRlbnRpZmll
ZCAoSUQgPSAlZClcbiIsIGlkKTsKKwltZW1jcHkoJmZlLT5vcHMudHVuZXJfb3BzLCAmYWRtdHYx
MDJfdHVuZXJfb3BzLCBzaXplb2Yoc3RydWN0IGR2Yl90dW5lcl9vcHMpKTsKKworCWZlLT50dW5l
cl9wcml2ID0gcHJpdjsKKworCWlmIChmZS0+b3BzLmkyY19nYXRlX2N0cmwpCisJCWZlLT5vcHMu
aTJjX2dhdGVfY3RybChmZSwgMCk7IC8qIGNsb3NlIGkyY19nYXRlICovCisKKwlyZXR1cm4gZmU7
Cit9CitFWFBPUlRfU1lNQk9MKGFkbXR2MTAyX2F0dGFjaCk7CisKK01PRFVMRV9BVVRIT1IoIkRh
dmlkIFQuTC4gV29uZyIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJBbmFsb2cgRGV2aWNlIEFETVRW
MTAyIHNpbGljb24gdHVuZXIgZHJpdmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CmRpZmYg
LXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvY29tbW9uL3R1bmVycy9hZG10djEw
Mi5oCi0tLSAvZGV2L251bGwJVGh1IEphbiAwMSAwMDowMDowMCAxOTcwICswMDAwCisrKyBiL2xp
bnV4L2RyaXZlcnMvbWVkaWEvY29tbW9uL3R1bmVycy9hZG10djEwMi5oCUZyaSBNYXIgMjAgMTE6
NTA6MjQgMjAwOSArMDgwMApAQCAtMCwwICsxLDU1IEBACisvKgorICogIERyaXZlciBmb3IgTWlj
cm90dW5lIE1UMjA2MCAiU2luZ2xlIGNoaXAgZHVhbCBjb252ZXJzaW9uIGJyb2FkYmFuZCB0dW5l
ciIKKyAqCisgKiAgQ29weXJpZ2h0IChjKSAyMDA2IE9saXZpZXIgREFORVQgPG9kYW5ldEBjYXJh
bWFpbC5jb20+CisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICB0aGUg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNl
LCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogIFRo
aXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNl
ZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBs
aWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFS
VElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICoKKyAqICBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQg
YSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogIGFsb25nIHdpdGgg
dGhpcyBwcm9ncmFtOyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAgRm91
bmRhdGlvbiwgSW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAyMTM5LCBVU0EuPQor
ICovCisKKyNpZm5kZWYgQURNVFYxMDJfSAorI2RlZmluZSBBRE1UVjEwMl9ICisKKyNkZWZpbmUg
QURNVFYxMDJfUkVGQ0xLMTMwMDAgIDAKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMTYzODQgIDEK
KyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMTkyMDAgIDIKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xL
MjA0ODAgIDMKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMjQ1NzYgIDQKKyNkZWZpbmUgQURNVFYx
MDJfUkVGQ0xLMjYwMDAgIDUKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMzA0MDAgIDYKKyNkZWZp
bmUgQURNVFYxMDJfUkVGQ0xLMzYwMDAgIDcKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMzg0MDAg
IDgKKyNkZWZpbmUgQURNVFYxMDJfUkVGQ0xLMjAwMDAgIDkKKworCitzdHJ1Y3QgZHZiX2Zyb250
ZW5kOworc3RydWN0IGkyY19hZGFwdGVyOworCitzdHJ1Y3QgYWRtdHYxMDJfY29uZmlnIHsKKwl1
OCBpMmNfYWRkcmVzczsKKwl1OCByZWZfY2xrX3R5cGU7Cit9OworCisjaWYgZGVmaW5lZChDT05G
SUdfTUVESUFfVFVORVJfQURNVFYxMDIpIHx8IChkZWZpbmVkKENPTkZJR19NRURJQV9UVU5FUl9B
RE1UVjEwMl9NT0RVTEUpICYmIGRlZmluZWQoTU9EVUxFKSkKK2V4dGVybiBzdHJ1Y3QgZHZiX2Zy
b250ZW5kICogYWRtdHYxMDJfYXR0YWNoKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCBzdHJ1Y3Qg
aTJjX2FkYXB0ZXIgKmkyYywgc3RydWN0IGFkbXR2MTAyX2NvbmZpZyAqY2ZnKTsKKyNlbHNlCitz
dGF0aWMgaW5saW5lIHN0cnVjdCBkdmJfZnJvbnRlbmQgKiBhZG10djEwMl9hdHRhY2goc3RydWN0
IGR2Yl9mcm9udGVuZCAqZmUsIHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjLCBzdHJ1Y3QgYWRtdHYx
MDJfY29uZmlnICpjZmcpCit7CisJcHJpbnRrKEtFUk5fV0FSTklORyAiJXM6IGRyaXZlciBkaXNh
YmxlZCBieSBLY29uZmlnXG4iLCBfX2Z1bmNfXyk7CisJcmV0dXJuIE5VTEw7Cit9CisjZW5kaWYg
Ly8gQ09ORklHX01FRElBX1RVTkVSX01UMjA2MAorCisjZW5kaWYKXCBObyBuZXdsaW5lIGF0IGVu
ZCBvZiBmaWxlCmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvY29tbW9u
L3R1bmVycy9hZG10djEwMl9wcml2LmgKLS0tIC9kZXYvbnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAw
IDE5NzAgKzAwMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL2FkbXR2
MTAyX3ByaXYuaAlGcmkgTWFyIDIwIDExOjUwOjI0IDIwMDkgKzA4MDAKQEAgLTAsMCArMSw1NyBA
QAorc3RydWN0IGFkbXR2MTAyX3ByaXYgeworCXN0cnVjdCBhZG10djEwMl9jb25maWcgKmNmZzsK
KwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgICAqaTJjOworCisJdTMyIGZyZXF1ZW5jeTsKKwl1MzIgYmFu
ZHdpZHRoOworCisJaW50IFZIRlNldDsKKwl1OCBpY3A7CisJdTggY29udmNvOworCXU4IGN1clRl
bXBTdGF0ZTsKKwl1OCBDVFVORV9DTEtPRlM7Cit9OworCisjZGVmaW5lIFR1bmVyX01UVjEwMgkJ
MHgwMCAKKyNkZWZpbmUgVHVuZXJfQURNVFYxMDIJCTB4MDEgCisjZGVmaW5lICBUdW5lcl9OZXdN
VFYxMDIJMHgwMiAKKworI2RlZmluZSAgVkhGU3VwcG9ydCAgICAgICAgICAgICAgIDEgIC8vIAor
I2RlZmluZSAgVUhGU3VwcG9ydCAgICAgICAgICAgICAgIDAgIC8vIAorCisjZGVmaW5lIHZsb3dE
ZWdCb3VuZGFyeSAgICA3CisjZGVmaW5lIHJnbG93RGVnQ09ORElWICAgICAweEVDCisjZGVmaW5l
IHZoaWdoRGVnQm91bmRhcnkgICA5CisjZGVmaW5lIHJnSGlnaERlZ0NPTkRJViAgICAweDAwCisj
ZGVmaW5lIGZEZWdWY29BcHBseSAgICAgICAxCisjZGVmaW5lIEhJR0hfVEVNUAkgICAwCisjZGVm
aW5lIExPV19URU1QCSAgIDEKKyNkZWZpbmUgcmdsb3dEZWdDT05WQ09fVkhGICAgICAweDlECisj
ZGVmaW5lIHJnSGlnaERlZ0NPTlZDTyAgICAgICAgMHgwMAorCisjZGVmaW5lIF9FWFRVTkVPRkYg
ICAwICAKKyNkZWZpbmUgX0VYVFVORU9OICAgIDEgIAorI2RlZmluZSBfVFVORUVOICAgICAgMSAK
KyNkZWZpbmUgX1RVTkVESVMgICAgIDAgCisjZGVmaW5lIENUVU5FT0ZTICAgICAweDAxICAvL2Rl
ZmF1bHQgPSAwIDsgIAorCisjZGVmaW5lIENUVU5FX0NMS09GU19TUExJVDBFICAgMHgwOSAvKmFk
ZGVkIGF0IHYxLjYuOCovCisjZGVmaW5lIENUVU5FX0NMS09GU19TUExJVDBGICAgMHgwMCAvLyBm
b3IgbWFzcyBwcm9kdWN0IAorI2RlZmluZSBSRUZDTEszMDQwMF9DTEtTRUxfUkVHX1NQTElUSUQw
RSAgIDB4NUEgICAvL2ZvciBzcGxpdCBJRCBpcyAweDBlCisjZGVmaW5lIFJFRkNMSzMwNDAwX0NM
S1NFTF9SRUdfU1BMSVRJRDBGICAgMHg2QSAgIC8vZm9yIHNwbGl0IElEIGlzIDB4MGYKKworI2Rl
ZmluZSAgVHVuZXJBRE91dE1pbiAgMgorI2RlZmluZSAgVHVuZXJBRE91dE1heCAgMTIKKwordm9p
ZCBDb25maWdUdW5lcihzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUsIHU4ICpBZGRyRGF0YSk7
Cit2b2lkIFR1bmVySW5pdChzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUpOworaW50ICBHZXRU
dW5lclR5cGUoc3RydWN0IGFkbXR2MTAyX3ByaXYgKnN0YXRlKTsKK3ZvaWQgU2V0VHVuZXJGcmVx
KHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSwgdTMyIGZyZXF1ZW5jeSwgdTMyIGxwZkJXKTsK
K3ZvaWQgU2V0TFBGKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSx1MzIgcmVmQ2xrVHlwZSx1
OCBscGZCVyk7CitpbnQgIExPMlBMTF9GcmVxKHUzMiBsb2ZyZXEpOworaW50ICBUdW5lclBMTFJl
Z1NldChzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUsIHU4ICpSZWdEYXQsIGludCBUdW5lclBM
TFR5cGUpOworaW50ICAgVHVuZXJSU1NJQ2FsYyhzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUs
aW50IGZyZXEpOworaW50ICAgVHVuZXJSU1NJQ2FsY0F2ZyhzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAq
c3RhdGUsaW50IGZyZXEpOwordm9pZCBkcFBoYXNlVHVuaW5nKHN0cnVjdCBhZG10djEwMl9wcml2
ICpzdGF0ZSx1MzIgbG9mcmVxLCB1OCB0ZW1wZXIpOwordm9pZCBUdW5lclRlbXBlcmF0dXJlQ29t
cChzdHJ1Y3QgYWRtdHYxMDJfcHJpdiAqc3RhdGUsbG9uZyBsb2ZyZXEpOworaW50ICBDaGVja1R1
bmVySTJDKHN0cnVjdCBhZG10djEwMl9wcml2ICpzdGF0ZSk7CmRpZmYgLXIgNmYwODg5ZmRhMzE3
IGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvS2NvbmZpZwotLS0gYS9saW51eC9kcml2
ZXJzL21lZGlhL2R2Yi9kdmItdXNiL0tjb25maWcJTW9uIE1hciAwMiAxMDo0MDo1MiAyMDA5ICsw
MTAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvS2NvbmZpZwlGcmkgTWFy
IDIwIDExOjUwOjI0IDIwMDkgKzA4MDAKQEAgLTYzLDYgKzYzLDEzIEBACiAJICBGb3IgYW4gdXAt
dG8tZGF0ZSBsaXN0IG9mIGRldmljZXMgc3VwcG9ydGVkIGJ5IHRoaXMgZHJpdmVyLCBoYXZlIGEg
bG9vawogCSAgb24gdGhlIExpbnV4LURWQiBXaWtpIGF0IHd3dy5saW51eHR2Lm9yZy4KIAorCSAg
U2F5IFkgaWYgeW91IG93biBzdWNoIGEgZGV2aWNlIGFuZCB3YW50IHRvIHVzZSBpdC4gWW91IHNo
b3VsZCBidWlsZCBpdCBhcworCSAgYSBtb2R1bGUuCisKK2NvbmZpZyBEVkJfVVNCX0RJQlVTQl9V
MzEwMERNQgorCXRyaXN0YXRlICJBU1VTIFUzMTAwIE1pbmkgRE1CLVRIIFVTQiBTdGljayIgCisJ
ZGVwZW5kcyBvbiBEVkJfVVNCCisJaGVscAogCSAgU2F5IFkgaWYgeW91IG93biBzdWNoIGEgZGV2
aWNlIGFuZCB3YW50IHRvIHVzZSBpdC4gWW91IHNob3VsZCBidWlsZCBpdCBhcwogCSAgYSBtb2R1
bGUuCiAKZGlmZiAtciA2ZjA4ODlmZGEzMTcgbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZHZiLXVz
Yi9NYWtlZmlsZQotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9kdmItdXNiL01ha2VmaWxl
CU1vbiBNYXIgMDIgMTA6NDA6NTIgMjAwOSArMDEwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlh
L2R2Yi9kdmItdXNiL01ha2VmaWxlCUZyaSBNYXIgMjAgMTE6NTA6MjQgMjAwOSArMDgwMApAQCAt
MjMsNiArMjMsOSBAQAogCiBkdmItdXNiLWRpYnVzYi1tYy1vYmpzID0gZGlidXNiLW1jLm8KIG9i
ai0kKENPTkZJR19EVkJfVVNCX0RJQlVTQl9NQykgKz0gZHZiLXVzYi1kaWJ1c2ItY29tbW9uLm8g
ZHZiLXVzYi1kaWJ1c2ItbWMubworCitkdmItdXNiLWRpYnVzYi11MzEwMGRtYi1vYmpzID0gZGli
dXNiLXUzMTAwZG1iLm8KK29iai0kKENPTkZJR19EVkJfVVNCX0RJQlVTQl9VMzEwMERNQikgKz0g
ZHZiLXVzYi1kaWJ1c2ItY29tbW9uLm8gZHZiLXVzYi1kaWJ1c2ItdTMxMDBkbWIubwogCiBkdmIt
dXNiLW5vdmEtdC11c2IyLW9ianMgPSBub3ZhLXQtdXNiMi5vCiBvYmotJChDT05GSUdfRFZCX1VT
Ql9OT1ZBX1RfVVNCMikgKz0gZHZiLXVzYi1kaWJ1c2ItY29tbW9uLm8gZHZiLXVzYi1ub3ZhLXQt
dXNiMi5vCmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11
c2IvZGlidXNiLXUzMTAwZG1iLmMKLS0tIC9kZXYvbnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAwIDE5
NzAgKzAwMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZHZiLXVzYi9kaWJ1c2ItdTMx
MDBkbWIuYwlGcmkgTWFyIDIwIDExOjUwOjI0IDIwMDkgKzA4MDAKQEAgLTAsMCArMSwzMjYgQEAK
Ky8qIEFTVVMgVTMxMDAgTWluaSBETUItVEggVVNCIERpZ2l0YWwgVFYgc3RpY2sKKyAqCisgKiBi
YXNlZCBvbiBHUEwgY29kZSBmcm9tIERpQmNvbSwgd2hpY2ggaGFzCisgKiBDb3B5cmlnaHQgKEMp
IDIwMDQgQW1hdXJ5IERlbW9sIGZvciBEaUJjb20gKGFkZW1vbEBkaWJjb20uZnIpCisgKgorICoJ
VGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFu
ZC9vciBtb2RpZnkgaXQKKyAqCXVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlCisgKglTb2Z0d2FyZSBGb3VuZGF0
aW9uLCB2ZXJzaW9uIDIuCisgKgorICogc2VlIERvY3VtZW50YXRpb24vZHZiL1JFQURNRS5kdmIt
dXNiIGZvciBtb3JlIGluZm9ybWF0aW9uCisgKi8KKyNpbmNsdWRlICJkaWJ1c2IuaCIKKyNpbmNs
dWRlICJhZG10djEwMi5oIgorI2luY2x1ZGUgImxnczhneHguaCIKKworRFZCX0RFRklORV9NT0Rf
T1BUX0FEQVBURVJfTlIoYWRhcHRlcl9ucik7CisKKy8qIFVTQiBEcml2ZXIgc3R1ZmYgKi8KK3N0
YXRpYyBzdHJ1Y3QgZHZiX3VzYl9kZXZpY2VfcHJvcGVydGllcyB1MzEwMGRtYl9wcm9wZXJ0aWVz
OworCitzdGF0aWMgaW50IHUzMTAwZG1iX3Byb2JlKHN0cnVjdCB1c2JfaW50ZXJmYWNlICppbnRm
LAorCQljb25zdCBzdHJ1Y3QgdXNiX2RldmljZV9pZCAqaWQpCit7CisJcHJpbnRrKCJ1MzEwMGRt
Yl9wcm9iZSIpOy8vSkhBCisJcmV0dXJuIGR2Yl91c2JfZGV2aWNlX2luaXQoaW50ZiwmdTMxMDBk
bWJfcHJvcGVydGllcyxUSElTX01PRFVMRSxOVUxMLGFkYXB0ZXJfbnIpOworfQorCisvLyAyMDA4
MDUxMywgY2hpaG1pbmcKK3N0YXRpYyBpbnQgYXN1c19kbWJ0aF9pZGVudGlmeV9zdGF0ZSAoc3Ry
dWN0IHVzYl9kZXZpY2UgKnVkZXYsIHN0cnVjdAorCQlkdmJfdXNiX2RldmljZV9wcm9wZXJ0aWVz
ICpwcm9wcywgc3RydWN0IGR2Yl91c2JfZGV2aWNlX2Rlc2NyaXB0aW9uICoqZGVzYywKKwkJaW50
ICpjb2xkKQoreworCisJc3RhdGljIHVuc2lnbmVkIHNob3J0IGludCBwaWQ9MDsKKwkvL3ByaW50
aygiJXM6IGlNYW51ZmFjdHVyZXIgPT4gJWQsIGlQcm9kdWN0ID0+IDB4JTB4XG4iLF9fRlVOQ1RJ
T05fXywgdWRldi0+ZGVzY3JpcHRvci5pTWFudWZhY3R1cmVyLCB1ZGV2LT5kZXNjcmlwdG9yLmlQ
cm9kdWN0KTsvLzIwMDgwNTEzLCBjaGlobWluZworCSpjb2xkID0gdWRldi0+ZGVzY3JpcHRvci5p
TWFudWZhY3R1cmVyID09IDAgJiYgdWRldi0+ZGVzY3JpcHRvci5pUHJvZHVjdCA9PSAwOworCSNp
ZiAwCisJdCA9IGxhc3RfdGljayArIDMqSFo7CisJaWYgKHRpbWVfYmVmb3JlKGppZmZpZXMsIHQp
KQorCQkqY29sZCA9IGZhbHNlOworCWVsc2UKKwkJKmNvbGQgPSB0cnVlOworCWlmIChsYXN0X3Rp
Y2sgPT0gMCkKKwkJKmNvbGQgPSB0cnVlOworCWxhc3RfdGljayA9IGppZmZpZXM7CisJcHJpbnRr
KCJ0aW1lX2JlZm9yZSA9PiAlc1xuIiwgKCpjb2xkKSA/ICJ0cnVlIjoiZmFsc2UiKTsKKwkjZW5k
aWYKKwkvLyAyMDA3MTEwMywgY2hpaG1pbmcKKwkjaWYgMQorCS8vcHJpbnRrKCIlczogcGlkID0+
IDB4JXgsIGlkUHJvZHVjdCA9PiAweCV4XG4iLCBfX0ZVTkNUSU9OX18sIHBpZCwgbGUxNl90b19j
cHUodWRldi0+ZGVzY3JpcHRvci5pZFByb2R1Y3QpKQorCWlmIChwaWQgPT0gMCAmJiAoMHgxNzQ5
ID09IGxlMTZfdG9fY3B1KHVkZXYtPmRlc2NyaXB0b3IuaWRQcm9kdWN0KSkpCisJeworCQlpbnQg
cmV0ID0gdXNiX3RyeWxvY2tfZGV2aWNlKHVkZXYpOworCQlpZiAocmV0ID09IDEpIHsKKwkJCXJl
dCA9IHVzYl9yZXNldF9kZXZpY2UodWRldik7CisJCQl1c2JfdW5sb2NrX2RldmljZSh1ZGV2KTsK
KwkJCS8vcHJpbnRrKCJ1c2JfcmVzZXRfZGV2aWNlMSIpOworCQl9IGVsc2UgeworCQkJcmV0ID0g
dXNiX3Jlc2V0X2RldmljZSh1ZGV2KTsKKwkJCS8vcHJpbnRrKCJ1c2JfcmVzZXRfZGV2aWNlMiIp
OworCQl9CisJCW1zbGVlcCgxMDApOworCQkvL3ByaW50aygiJXNcbiIsIF9fRlVOQ1RJT05fXyk7
CisJfQorCXBpZCA9IGxlMTZfdG9fY3B1KHVkZXYtPmRlc2NyaXB0b3IuaWRQcm9kdWN0KTsKKwkv
L3ByaW50aygiJXM6IE5vdyBwaWQgPT4gMHgleFxuIiwgX19GVU5DVElPTl9fLCBwaWQpOworCSNl
bmRpZgorCS8vCisKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHUzMTAwZG1iX3Bvd2Vy
X2N0cmwoc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkLCBpbnQgb25vZmYpCit7CisJI2lmIDEgLy8y
MDA4MDUxNSwgY2hpaG1pbmcsIGRvbnQgcmVtb3ZlCisJaWYgKG9ub2ZmKSB7CisJCXU4IGJbM10g
PSB7IERJQlVTQl9SRVFfU0VUX0lPQ1RMLCBESUJVU0JfSU9DVExfQ01EX1BPV0VSX01PREUsIERJ
QlVTQl9JT0NUTF9QT1dFUl9XQUtFVVAgfTsKKwkJaW50IHJldCA9ICBkdmJfdXNiX2dlbmVyaWNf
d3JpdGUoZCxiLDMpOworCQlwcmludGsoImRpYnVzYjJfMF9wb3dlcl9jdHJsOiByZXQgb2YgZHZi
X3VzYl9nZW5lcmljX3dyaXRlID09PiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwkJLy9y
ZXR1cm4gZHZiX3VzYl9nZW5lcmljX3dyaXRlKGQsYiwzKTsKKwl9IGVsc2UKKwkJcmV0dXJuIDA7
CisJI2VuZGlmCisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHN0cnVjdCBsZ3M4Z3h4X2NvbmZp
ZyB1MzEwMGRtYl9sZ3M4Z2w1X2NmZyA9IHsKKwkucHJvZCA9IExHUzhHWFhfUFJPRF9MR1M4R0w1
LAorCS5kZW1vZF9hZGRyZXNzID0gMHgxOSwKKwkuc2VyaWFsX3RzID0gMCwKKwkudHNfY2xrX3Bv
bCA9IDEsCisJLnRzX2Nsa19nYXRlZCA9IDEsCisJLmlmX2Nsa19mcmVxID0gMzA0MDAsIC8qIDMw
LjQgTUh6ICovCisJLmlmX2ZyZXEgPSAwLCAvKiBCYXNlYmFuZCAqLworCS5pZl9uZWdfY2VudGVy
ID0gMSwKKwkuZXh0X2FkYyA9IDAsCisJLmFkY19zaWduZWQgPSAwLAorCS5pZl9uZWdfZWRnZSA9
IDAsCisJLnR1bmVyX2FkZHJlc3MgPSAweDYxLAorfTsKKworCitzdGF0aWMgaW50IHUzMTAwZG1i
X2Zyb250ZW5kX2F0dGFjaChzdHJ1Y3QgZHZiX3VzYl9hZGFwdGVyICphZGFwKQoreworI2lmIDAK
KwlpZiAoKGFkYXAtPmZlID0gZHZiX2F0dGFjaChkaWIzMDAwbWNfYXR0YWNoLCAmYWRhcC0+ZGV2
LT5pMmNfYWRhcCwgREVGQVVMVF9ESUIzMDAwUF9JMkNfQUREUkVTUywgICZtb2QzMDAwcF9kaWIz
MDAwcF9jb25maWcpKSAhPSBOVUxMIHx8CisJCShhZGFwLT5mZSA9IGR2Yl9hdHRhY2goZGliMzAw
MG1jX2F0dGFjaCwgJmFkYXAtPmRldi0+aTJjX2FkYXAsIERFRkFVTFRfRElCMzAwME1DX0kyQ19B
RERSRVNTLCAmbW9kMzAwMHBfZGliMzAwMHBfY29uZmlnKSkgIT0gTlVMTCkgeworCQlpZiAoYWRh
cC0+cHJpdiAhPSBOVUxMKSB7CisJCQlzdHJ1Y3QgZGlidXNiX3N0YXRlICpzdCA9IGFkYXAtPnBy
aXY7CisJCQlzdC0+b3BzLnBpZF9wYXJzZSA9IGRpYjMwMDBtY19waWRfcGFyc2U7CisJCQlzdC0+
b3BzLnBpZF9jdHJsICA9IGRpYjMwMDBtY19waWRfY29udHJvbDsKKwkJfQorCQlyZXR1cm4gMDsK
Kwl9CisjZW5kaWYKKwlpZiAoKGFkYXAtPmZlID0gCisJCQlkdmJfYXR0YWNoKGxnczhneHhfYXR0
YWNoLAorCQkJJnUzMTAwZG1iX2xnczhnbDVfY2ZnLAorCQkJJmFkYXAtPmRldi0+aTJjX2FkYXAp
KSAKKwkJCSE9IE5VTEwpIHsKKwkJCisJCXJldHVybiAwOworCX0KKwlyZXR1cm4gLUVOT0RFVjsK
K30KKworc3RhdGljIHN0cnVjdCBhZG10djEwMl9jb25maWcgdTMxMDBkbWJfYWRtdHYxMDJfY2Zn
ID0geworCS5pMmNfYWRkcmVzcyA9IDB4NjEsCisJLnJlZl9jbGtfdHlwZSA9IEFETVRWMTAyX1JF
RkNMSzE2Mzg0Cit9OworCitzdGF0aWMgaW50IHUzMTAwZG1iX3R1bmVyX2F0dGFjaChzdHJ1Y3Qg
ZHZiX3VzYl9hZGFwdGVyICphZGFwKQoreworLy8gCXN0cnVjdCBkaWJ1c2Jfc3RhdGUgKnN0ID0g
YWRhcC0+cHJpdjsKKy8vIAlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKnR1bl9pMmM7CisKKwkvL3R1bl9p
MmMgPSBkaWIzMDAwbWNfZ2V0X3R1bmVyX2kyY19tYXN0ZXIoYWRhcC0+ZmUsIDEpOworCS8vaWYg
KGR2Yl9hdHRhY2goYWRpbXR2MTAyX2F0dGFjaCwgYWRhcC0+ZmUsICZhZGFwLT5kZXYtPmkyY19h
ZGFwLCAmc3RrMzAwMHBfYWRpbXR2MTAyX2NvbmZpZywgaWYxKSA9PSBOVUxMKSB7CisJCS8qIG5v
dCBmb3VuZCAtIHVzZSBwYW5hc29uaWMgcGxsIHBhcmFtZXRlcnMgKi8KKwkvLwlpZiAoZHZiX2F0
dGFjaChkdmJfcGxsX2F0dGFjaCwgYWRhcC0+ZmUsIDB4NjAsIHR1bl9pMmMsIERWQl9QTExfRU5W
NTdIMVhENSkgPT0gTlVMTCkKKwkvLwkJcmV0dXJuIC1FTk9NRU07CisJLy99IGVsc2UgeworCQkv
L3N0LT5tdDIwNjBfcHJlc2VudCA9IDE7CisJCS8qIHNldCB0aGUgY29ycmVjdCBwYXJhbWV0ZXJz
IGZvciB0aGUgZGliMzAwMHAgKi8KKwkJLy9kaWIzMDAwbWNfc2V0X2NvbmZpZyhhZGFwLT5mZSwg
JnN0azMwMDBwX2RpYjMwMDBwX2NvbmZpZyk7IEpIQQorCS8vfQorCisJaWYgKGR2Yl9hdHRhY2go
YWRtdHYxMDJfYXR0YWNoLCBhZGFwLT5mZSwKKwkJJmFkYXAtPmRldi0+aTJjX2FkYXAsICZ1MzEw
MGRtYl9hZG10djEwMl9jZmcpICE9IE5VTEwpIHsKKwkJcmV0dXJuIDA7CisJfQorCXJldHVybiAt
RU5PREVWOworfQorCitzdGF0aWMgaW50IHUzMTAwZG1iX2kyY19tc2coc3RydWN0IGR2Yl91c2Jf
ZGV2aWNlICpkLCB1OCBhZGRyLAorCQkJICB1OCAqd2J1ZiwgdTE2IHdsZW4sIHU4ICpyYnVmLCB1
MTYgcmxlbikKK3sKKwl1OCBzbmRidWZbd2xlbis0KzFdOyAvKiBsZWFkKDEpIGRldmFkZHIsZGly
ZWN0aW9uKDEpIGFkZHIoMikgZGF0YSh3bGVuKSAobGVuKDIpICh3aGVuIHJlYWRpbmcpKSAqLwor
CS8qIHdyaXRlIG9ubHkgPyAqLworCWludCB3byA9IChyYnVmID09IE5VTEwgfHwgcmxlbiA9PSAw
KSwKKwkJbGVuID0gMiArIHdsZW4gKyAod28gPyAwIDogMisxKTsKKworCXNuZGJ1ZlswXSA9IHdv
ID8gRElCVVNCX1JFUV9JMkNfV1JJVEUgOiBESUJVU0JfUkVRX0kyQ19SRUFEOworCXNuZGJ1Zlsx
XSA9IChhZGRyIDw8IDEpIHwgKHdvID8gMCA6IDEpOworCisJaWYgKHdvKQorCQltZW1jcHkoJnNu
ZGJ1ZlsyXSx3YnVmLHdsZW4pOworCWVsc2UKKwkJbWVtY3B5KCZzbmRidWZbM10sd2J1Zix3bGVu
KTsKKworCWlmICghd28pIHsKKwkJc25kYnVmW3dsZW4rMisxXSA9IChybGVuID4+IDgpICYgMHhm
ZjsKKwkJc25kYnVmW3dsZW4rMysxXSA9IHJsZW4gJiAweGZmOworCX0KKwkvL3ByaW50aygiJXM6
IGFkZHIgJXggc2I6JXggJXggJXggJXggJXggJXggc2xlbiAlZCBcbiIsX19mdW5jX18sCisJLy8g
YWRkcixzbmRidWZbMF0sc25kYnVmWzFdLCBzbmRidWZbMl0sc25kYnVmWzNdLHNuZGJ1Zls0XSxz
bmRidWZbNV0sbGVuKTsKKwlyZXR1cm4gZHZiX3VzYl9nZW5lcmljX3J3KGQsc25kYnVmLGxlbixy
YnVmLHJsZW4sMCk7Cit9CisKKy8qCisgKiBJMkMgbWFzdGVyIHhmZXIgZnVuY3Rpb24KKyAqLwor
c3RhdGljIGludCB1MzEwMGRtYl9pMmNfeGZlcihzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXAsc3Ry
dWN0IGkyY19tc2cgbXNnW10saW50IG51bSkKK3sKKwlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmQg
PSBpMmNfZ2V0X2FkYXBkYXRhKGFkYXApOworCWludCBpOworCisJLy9wcmludGsoImRpYnVzYl9p
MmNfeGZlcjogbnVtICV4IFxuIixudW0pOyAvL0pIQQorCWlmIChtdXRleF9sb2NrX2ludGVycnVw
dGlibGUoJmQtPmkyY19tdXRleCkgPCAwKQorCQlyZXR1cm4gLUVBR0FJTjsKKworCWZvciAoaSA9
IDA7IGkgPCBudW07IGkrKykgeworCQkvKiB3cml0ZS9yZWFkIHJlcXVlc3QgKi8JCQorCQlpZiAo
aSsxIDwgbnVtICYmIChtc2dbaSsxXS5mbGFncyAmIEkyQ19NX1JEKSkgeworCQkJaWYgKHUzMTAw
ZG1iX2kyY19tc2coZCwgbXNnW2ldLmFkZHIsIG1zZ1tpXS5idWYsbXNnW2ldLmxlbiwKKwkJCQkJ
CW1zZ1tpKzFdLmJ1Zixtc2dbaSsxXS5sZW4pIDwgMCkKKwkJCQlicmVhazsKKwkJCWkrKzsKKwkJ
fSBlbHNlCisJCQlpZiAodTMxMDBkbWJfaTJjX21zZyhkLCBtc2dbaV0uYWRkciwgbXNnW2ldLmJ1
Zixtc2dbaV0ubGVuLE5VTEwsMCkgPCAwKQorCQkJCWJyZWFrOworCX0KKworCW11dGV4X3VubG9j
aygmZC0+aTJjX211dGV4KTsKKwlyZXR1cm4gaTsKK30KKworc3RhdGljIHUzMiB1MzEwMGRtYl9p
MmNfZnVuYyhzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpCit7CisJcmV0dXJuIEkyQ19GVU5D
X0kyQzsKK30KKworc3RydWN0IGkyY19hbGdvcml0aG0gdTMxMDBkbWJfaTJjX2FsZ28gPSB7CisJ
Lm1hc3Rlcl94ZmVyICAgPSB1MzEwMGRtYl9pMmNfeGZlciwKKwkuZnVuY3Rpb25hbGl0eSA9IHUz
MTAwZG1iX2kyY19mdW5jLAorfTsKKworLyogZG8gbm90IGNoYW5nZSB0aGUgb3JkZXIgb2YgdGhl
IElEIHRhYmxlICovCitzdGF0aWMgc3RydWN0IHVzYl9kZXZpY2VfaWQgZGlidXNiX3UzMTAwZG1i
X3RhYmxlIFtdID0geworLyogMCAqLyAge1VTQl9ERVZJQ0UgKFVTQl9WSURfQVNVUywJCVVTQl9Q
SURfVTMxMDBfODkzNF9DT0xEKSB9LCAvL0pIQQorLyogMSAqLyAge1VTQl9ERVZJQ0UgKFVTQl9W
SURfQVNVUywJCVVTQl9QSURfVTMxMDBfODkzNF9XQVJNKSB9LCAvL0pIQQorLyogMiAqLyAge1VT
Ql9ERVZJQ0UgKFVTQl9WSURfQVNVUywJCVVTQl9QSURfVTMxMDBfOEdMNV9DT0xEKSB9LCAvL0pI
QQorLyogMyAqLyAge1VTQl9ERVZJQ0UgKFVTQl9WSURfQVNVUywJCVVTQl9QSURfVTMxMDBfOEdM
NV9XQVJNKSB9LCAvL0pIQQorCQkJeyB9CQkvKiBUZXJtaW5hdGluZyBlbnRyeSAqLworfTsKK01P
RFVMRV9ERVZJQ0VfVEFCTEUgKHVzYiwgZGlidXNiX3UzMTAwZG1iX3RhYmxlKTsKKworc3RhdGlj
IHN0cnVjdCBkdmJfdXNiX2RldmljZV9wcm9wZXJ0aWVzIHUzMTAwZG1iX3Byb3BlcnRpZXMgPSB7
CisJLmNhcHMgPSBEVkJfVVNCX0lTX0FOX0kyQ19BREFQVEVSLAorCisJLnVzYl9jdHJsID0gQ1lQ
UkVTU19GWDIsCisJLmZpcm13YXJlID0gInUzMTAwZG1idGguZnciLAorCisJLm51bV9hZGFwdGVy
cyA9IDEsCisJLmFkYXB0ZXIgPSB7CisJCXsKKwkJCS5jYXBzID0gRFZCX1VTQl9BREFQX0hBU19Q
SURfRklMVEVSIHwgRFZCX1VTQl9BREFQX1BJRF9GSUxURVJfQ0FOX0JFX1RVUk5FRF9PRkYsCisJ
CQkucGlkX2ZpbHRlcl9jb3VudCA9IDMyLAorCQkJLnN0cmVhbWluZ19jdHJsICAgPSBkaWJ1c2Iy
XzBfc3RyZWFtaW5nX2N0cmwsCisJCQkucGlkX2ZpbHRlciAgICAgICA9IGRpYnVzYl9waWRfZmls
dGVyLAorCQkJLnBpZF9maWx0ZXJfY3RybCAgPSBkaWJ1c2JfcGlkX2ZpbHRlcl9jdHJsLAorCQkJ
LmZyb250ZW5kX2F0dGFjaCAgPSB1MzEwMGRtYl9mcm9udGVuZF9hdHRhY2gsCisJCQkudHVuZXJf
YXR0YWNoICAgICA9IHUzMTAwZG1iX3R1bmVyX2F0dGFjaCwKKworCS8qIHBhcmFtZXRlciBmb3Ig
dGhlIE1QRUcyLWRhdGEgdHJhbnNmZXIgKi8KKwkJCS5zdHJlYW0gPSB7CisJCQkJLnR5cGUgPSBV
U0JfQlVMSywKKwkJCQkuY291bnQgPSA3LAorCQkJCS5lbmRwb2ludCA9IDB4MDIsCisJCQkJLnUg
PSB7CisJCQkJCS5idWxrID0geworCQkJCQkJLmJ1ZmZlcnNpemUgPSA0MDk2LAorCQkJCQl9CisJ
CQkJfQorCQkJfSwKKwkJCS5zaXplX29mX3ByaXYgICAgID0gc2l6ZW9mKHN0cnVjdCBkaWJ1c2Jf
c3RhdGUpLAorCQl9CisJfSwKKwkuaWRlbnRpZnlfc3RhdGUgICA9IGFzdXNfZG1idGhfaWRlbnRp
Znlfc3RhdGUsIC8vIDIwMDgwNTEzLCBjaGlobWluZworCS5wb3dlcl9jdHJsICAgICAgID0gdTMx
MDBkbWJfcG93ZXJfY3RybCwKKworI2lmIDAKKwkucmNfaW50ZXJ2YWwgICAgICA9IERFRkFVTFRf
UkNfSU5URVJWQUwsCisJLnJjX2tleV9tYXAgICAgICAgPSBkaWJ1c2JfcmNfa2V5cywKKwkucmNf
a2V5X21hcF9zaXplICA9IDExMSwgLyogRklYTUUgKi8KKwkucmNfcXVlcnkgICAgICAgICA9IGRp
YnVzYl9yY19xdWVyeSwKKyNlbmRpZgorCisJLmkyY19hbGdvICAgICAgICAgPSAmdTMxMDBkbWJf
aTJjX2FsZ28sCisKKwkuZ2VuZXJpY19idWxrX2N0cmxfZW5kcG9pbnQgPSAweDAxLAorCisJLm51
bV9kZXZpY2VfZGVzY3MgPSA3LAorCS5kZXZpY2VzID0geworCQkvL3ssSkhBCisJCXsgICAiQVNV
U1RlSyBVMzEwMCBNaW5pIERNQi1USCAiLAorIAkJCXsgJmRpYnVzYl91MzEwMGRtYl90YWJsZVsw
XSwgTlVMTCB9LAorIAkJCXsgJmRpYnVzYl91MzEwMGRtYl90YWJsZVsxXSwgTlVMTCB9LAorIAkJ
fSwKKwkJeyAgICJBU1VTVGVLIFUzMTAwIE1pbmkgRE1CLVRIIiwKKyAJCQl7ICZkaWJ1c2JfdTMx
MDBkbWJfdGFibGVbMl0sIE5VTEwgfSwKKyAJCQl7ICZkaWJ1c2JfdTMxMDBkbWJfdGFibGVbM10s
IE5VTEwgfSwKKyAJCX0sCisJCS8vfSxKSEEKKworCisKKwkJeyBOVUxMIH0sCisJfQorfTsKKwor
c3RhdGljIHN0cnVjdCB1c2JfZHJpdmVyIHUzMTAwZG1iX2RyaXZlciA9IHsKKwkubmFtZQkJPSAi
ZHZiX3VzYl91MzEwMGRtYiIsCisJLnByb2JlCQk9IHUzMTAwZG1iX3Byb2JlLAorCS5kaXNjb25u
ZWN0ID0gZHZiX3VzYl9kZXZpY2VfZXhpdCwKKwkuaWRfdGFibGUJPSBkaWJ1c2JfdTMxMDBkbWJf
dGFibGUsCit9OworCisvKiBtb2R1bGUgc3R1ZmYgKi8KK3N0YXRpYyBpbnQgX19pbml0IHUzMTAw
ZG1iX21vZHVsZV9pbml0KHZvaWQpCit7CisJaW50IHJlc3VsdDsKKwlpZiAoKHJlc3VsdCA9IHVz
Yl9yZWdpc3RlcigmdTMxMDBkbWJfZHJpdmVyKSkpIHsKKwkJZXJyKCJ1c2JfcmVnaXN0ZXIgZmFp
bGVkLiBFcnJvciBudW1iZXIgJWQiLHJlc3VsdCk7CisJCXJldHVybiByZXN1bHQ7CisJfQorCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIF9fZXhpdCB1MzEwMGRtYl9tb2R1bGVfZXhpdCh2
b2lkKQoreworCS8qIGRlcmVnaXN0ZXIgdGhpcyBkcml2ZXIgZnJvbSB0aGUgVVNCIHN1YnN5c3Rl
bSAqLworCXVzYl9kZXJlZ2lzdGVyKCZ1MzEwMGRtYl9kcml2ZXIpOworfQorCittb2R1bGVfaW5p
dCAodTMxMDBkbWJfbW9kdWxlX2luaXQpOworbW9kdWxlX2V4aXQgKHUzMTAwZG1iX21vZHVsZV9l
eGl0KTsKKworTU9EVUxFX0FVVEhPUigiUGF0cmljayBCb2V0dGNoZXIgPHBhdHJpY2suYm9ldHRj
aGVyQGRlc3kuZGU+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIkRyaXZlciBmb3IgRGlCY29tIFVT
QjIuMCBEVkItVCAoRGlCMzAwME0tQy9QIGJhc2VkKSBkZXZpY2VzIik7CitNT0RVTEVfVkVSU0lP
TigiMS4wIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxp
bnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvZHZiLXVzYi1maXJtd2FyZS5jCi0tLSBhL2xp
bnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvZHZiLXVzYi1maXJtd2FyZS5jCU1vbiBNYXIg
MDIgMTA6NDA6NTIgMjAwOSArMDEwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9kdmIt
dXNiL2R2Yi11c2ItZmlybXdhcmUuYwlGcmkgTWFyIDIwIDExOjUwOjI0IDIwMDkgKzA4MDAKQEAg
LTEyNiw4ICsxMjYsOSBAQAogCiAJaWYgKCgqcG9zICsgaHgtPmxlbiArIDQpID49IGZ3LT5zaXpl
KQogCQlyZXR1cm4gLUVJTlZBTDsKLQotCWh4LT5hZGRyID0gYlsxXSB8IChiWzJdIDw8IDgpOwor
CS8vIGFkZGVkPz8/IHRvIGZpeCBzb21ldGhpbmcgLSBhayBiYXNlZCBvbiBkaWZmLi4JCisJaHgt
PmFkZHIgPSBsZTE2X3RvX2NwdSggKigodTE2ICopICZiWzFdKSApOworCS8vaHgtPmFkZHIgPSBi
WzFdIHwgKGJbMl0gPDwgOCk7CiAJaHgtPnR5cGUgPSBiWzNdOwogCiAJaWYgKGh4LT50eXBlID09
IDB4MDQpIHsKZGlmZiAtciA2ZjA4ODlmZGEzMTcgbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZHZi
LXVzYi9kdmItdXNiLWlkcy5oCi0tLSBhL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2Iv
ZHZiLXVzYi1pZHMuaAlNb24gTWFyIDAyIDEwOjQwOjUyIDIwMDkgKzAxMDAKKysrIGIvbGludXgv
ZHJpdmVycy9tZWRpYS9kdmIvZHZiLXVzYi9kdmItdXNiLWlkcy5oCUZyaSBNYXIgMjAgMTE6NTA6
MjQgMjAwOSArMDgwMApAQCAtMjM0LDYgKzIzNCwxMCBAQAogI2RlZmluZSBVU0JfUElEX0FTVVNf
VTMwMDAJCQkJMHgxNzFmCiAjZGVmaW5lIFVTQl9QSURfQVNVU19VMzAwMEgJCQkJMHgxNzM2CiAj
ZGVmaW5lIFVTQl9QSURfQVNVU19VMzEwMAkJCQkweDE3M2YKKyNkZWZpbmUgVVNCX1BJRF9VMzEw
MF84OTM0X0NPTEQJCQkweDE3NDgKKyNkZWZpbmUgVVNCX1BJRF9VMzEwMF84OTM0X1dBUk0JCQkw
eDE3NDkKKyNkZWZpbmUgVVNCX1BJRF9VMzEwMF84R0w1X0NPTEQJCQkweDE3MjEKKyNkZWZpbmUg
VVNCX1BJRF9VMzEwMF84R0w1X1dBUk0JCQkweDE3MjIKICNkZWZpbmUgVVNCX1BJRF9ZVUFOX0VD
MzcyUwkJCQkweDFlZGMKICNkZWZpbmUgVVNCX1BJRF9ZVUFOX1NUSzc3MDBQSAkJCQkweDFmMDgK
ICNkZWZpbmUgVVNCX1BJRF9ZVUFOX1BEMzc4UwkJCQkweDJlZGMKZGlmZiAtciA2ZjA4ODlmZGEz
MTcgbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZHZiLXVzYi9kdmItdXNiLXVyYi5jCi0tLSBhL2xp
bnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvZHZiLXVzYi11cmIuYwlNb24gTWFyIDAyIDEw
OjQwOjUyIDIwMDkgKzAxMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZHZiLXVzYi9k
dmItdXNiLXVyYi5jCUZyaSBNYXIgMjAgMTE6NTA6MjQgMjAwOSArMDgwMApAQCAtNyw2ICs3LDI1
IEBACiAgKiBVU0IgYW5kIFVSQiBzdHVmZi4KICAqLwogI2luY2x1ZGUgImR2Yi11c2ItY29tbW9u
LmgiCisKK2ludCB1c2JfYnVsa19tc2cyKHN0cnVjdCB1c2JfZGV2aWNlICp1c2JfZGV2LCB1bnNp
Z25lZCBpbnQgcGlwZSwgCisJCQl2b2lkICpkYXRhLCBpbnQgbGVuLCBpbnQgKmFjdHVhbF9sZW5n
dGgsIGludCB0aW1lb3V0KQoreworCXN0cnVjdCB1cmIgKnVyYjsKKwlzdHJ1Y3QgdXNiX2hvc3Rf
ZW5kcG9pbnQgKmVwOworCisJZXAgPSAodXNiX3BpcGVpbihwaXBlKSA/IHVzYl9kZXYtPmVwX2lu
IDogdXNiX2Rldi0+ZXBfb3V0KQorCQkJW3VzYl9waXBlZW5kcG9pbnQocGlwZSldOworCisJLy8g
bW9kaWZ5IHRoZSBpbnRlcnZhbGwuIHRvIG1hdGNoIHRoZSBvbGQgc3BlYy4uLgorCisKKwlpZiAo
IWVwIHx8IGxlbiA8IDApCisJCXJldHVybiAtRUlOVkFMOworCWVwLT5kZXNjLmJJbnRlcnZhbCA9
ICBtaW4oMTUsIGVwLT5kZXNjLmJJbnRlcnZhbCk7CisJcmV0dXJuIHVzYl9idWxrX21zZyh1c2Jf
ZGV2LCAgcGlwZSwgZGF0YSwgbGVuLCBhY3R1YWxfbGVuZ3RoLCB0aW1lb3V0KTsKKwkgCit9CiAK
IGludCBkdmJfdXNiX2dlbmVyaWNfcncoc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkLCB1OCAqd2J1
ZiwgdTE2IHdsZW4sIHU4ICpyYnVmLAogCXUxNiBybGVuLCBpbnQgZGVsYXlfbXMpCkBAIC0zOCwx
MiArNTcsMTggQEAKIAogCS8qIGFuIGFuc3dlciBpcyBleHBlY3RlZCwgYW5kIG5vIGVycm9yIGJl
Zm9yZSAqLwogCWlmICghcmV0ICYmIHJidWYgJiYgcmxlbikgeworI2lmIDEKKwkJcmV0ID0gdXNi
X2J1bGtfbXNnMihkLT51ZGV2LHVzYl9yY3ZidWxrcGlwZShkLT51ZGV2LAorCQkJCWQtPnByb3Bz
LmdlbmVyaWNfYnVsa19jdHJsX2VuZHBvaW50KSxyYnVmLHJsZW4sJmFjdGxlbiwKKwkJCQkxMDAp
OworI2Vsc2UKIAkJaWYgKGRlbGF5X21zKQogCQkJbXNsZWVwKGRlbGF5X21zKTsKIAogCQlyZXQg
PSB1c2JfYnVsa19tc2coZC0+dWRldix1c2JfcmN2YnVsa3BpcGUoZC0+dWRldiwKIAkJCQlkLT5w
cm9wcy5nZW5lcmljX2J1bGtfY3RybF9lbmRwb2ludCkscmJ1ZixybGVuLCZhY3RsZW4sCiAJCQkJ
MjAwMCk7CisjZW5kaWYKIAogCQlpZiAocmV0KQogCQkJZXJyKCJyZWN2IGJ1bGsgbWVzc2FnZSBm
YWlsZWQ6ICVkIixyZXQpOwpkaWZmIC1yIDZmMDg4OWZkYTMxNyBsaW51eC9kcml2ZXJzL21lZGlh
L2R2Yi9mcm9udGVuZHMvS2NvbmZpZwotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9u
dGVuZHMvS2NvbmZpZwlNb24gTWFyIDAyIDEwOjQwOjUyIDIwMDkgKzAxMDAKKysrIGIvbGludXgv
ZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL0tjb25maWcJRnJpIE1hciAyMCAxMTo1MDoyNCAy
MDA5ICswODAwCkBAIC01MTMsNiArNTEzLDEzIEBACiAJaGVscAogCSAgQSBETUItVEggdHVuZXIg
bW9kdWxlLiBTYXkgWSB3aGVuIHlvdSB3YW50IHRvIHN1cHBvcnQgdGhpcyBmcm9udGVuZC4KIAor
Y29uZmlnIERWQl9MR1M4R1hYCisJdHJpc3RhdGUgIkxlZ2VuZCBTaWxpY29uIExHUzg5MTMvTEdT
OEdMNS9MR1M4R1hYIERNQi1USCBkZW1vZHVsYXRvciIKKwlkZXBlbmRzIG9uIERWQl9DT1JFICYm
IEkyQworCWRlZmF1bHQgbSBpZiBEVkJfRkVfQ1VTVE9NSVNFCisJaGVscAorCSAgQSBETUItVEgg
dHVuZXIgbW9kdWxlLiBTYXkgWSB3aGVuIHlvdSB3YW50IHRvIHN1cHBvcnQgdGhpcyBmcm9udGVu
ZC4KKwogY29tbWVudCAiVG9vbHMgdG8gZGV2ZWxvcCBuZXcgZnJvbnRlbmRzIgogCiBjb25maWcg
RFZCX0RVTU1ZX0ZFCmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZi
L2Zyb250ZW5kcy9NYWtlZmlsZQotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVu
ZHMvTWFrZWZpbGUJTW9uIE1hciAwMiAxMDo0MDo1MiAyMDA5ICswMTAwCisrKyBiL2xpbnV4L2Ry
aXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9NYWtlZmlsZQlGcmkgTWFyIDIwIDExOjUwOjI0IDIw
MDkgKzA4MDAKQEAgLTYwLDYgKzYwLDcgQEAKIG9iai0kKENPTkZJR19EVkJfVFVORVJfQ1gyNDEx
MykgKz0gY3gyNDExMy5vCiBvYmotJChDT05GSUdfRFZCX1M1SDE0MTEpICs9IHM1aDE0MTEubwog
b2JqLSQoQ09ORklHX0RWQl9MR1M4R0w1KSArPSBsZ3M4Z2w1Lm8KK29iai0kKENPTkZJR19EVkJf
TEdTOEdYWCkgKz0gbGdzOGd4eC5vCiBvYmotJChDT05GSUdfRFZCX0RVTU1ZX0ZFKSArPSBkdmJf
ZHVtbXlfZmUubwogb2JqLSQoQ09ORklHX0RWQl9BRjkwMTMpICs9IGFmOTAxMy5vCiBvYmotJChD
T05GSUdfRFZCX0NYMjQxMTYpICs9IGN4MjQxMTYubwpkaWZmIC1yIDZmMDg4OWZkYTMxNyBsaW51
eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eC5jCi0tLSAvZGV2L251bGwJVGh1
IEphbiAwMSAwMDowMDowMCAxOTcwICswMDAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZi
L2Zyb250ZW5kcy9sZ3M4Z3h4LmMJRnJpIE1hciAyMCAxMTo1MDoyNCAyMDA5ICswODAwCkBAIC0w
LDAgKzEsOTA3IEBACisvKgorICogICAgU3VwcG9ydCBmb3IgTGVnZW5kIFNpbGljb24gRE1CLVRI
IGRlbW9kdWxhdG9yCisgKiAgICBMR1M4OTEzLCBMR1M4R0w1CisgKiAgICBleHBlcmltZW50YWwg
c3VwcG9ydCBMR1M4RzQyLCBMR1M4RzUyCisgKgorICogICAgQ29weXJpZ2h0IChDKSAyMDA3LDIw
MDggRGF2aWQgVC5MLiBXb25nIDxkYXZpZHRsd29uZ0BnbWFpbC5jb20+CisgKiAgICBDb3B5cmln
aHQgKEMpIDIwMDggU2lyaXVzIEludGVybmF0aW9uYWwgKEhvbmcgS29uZykgTGltaXRlZAorICog
ICAgVGltb3RoeSBMZWUgPHRpbW90aHkubGVlQHNpcml1c2hrLmNvbT4gKGZvciBpbml0aWFsIHdv
cmsgb24gTEdTOEdMNSkKKyAqCisgKiAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogICAgaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkK
KyAqICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2Yg
dGhlIExpY2Vuc2UsIG9yCisgKiAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9u
LgorICoKKyAqICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsLAorICogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRo
b3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqICAgIE1FUkNIQU5UQUJJTElUWSBv
ciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICAgIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogICAgWW91IHNo
b3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UKKyAqICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHdyaXRlIHRvIHRoZSBG
cmVlIFNvZnR3YXJlCisgKiAgICBGb3VuZGF0aW9uLCBJbmMuLCA2NzUgTWFzcyBBdmUsIENhbWJy
aWRnZSwgTUEgMDIxMzksIFVTQS4KKyAqCisgKi8KKworI2luY2x1ZGUgPGFzbS9kaXY2NC5oPgor
CisjaW5jbHVkZSAiZHZiX2Zyb250ZW5kLmgiCisKKyNpbmNsdWRlICJsZ3M4Z3h4LmgiCisjaW5j
bHVkZSAibGdzOGd4eF9wcml2LmgiCisKKyNkZWZpbmUgZHByaW50ayhhcmdzLi4uKSBcCisJZG8g
eyBcCisJCWlmIChkZWJ1ZykgXAorCQkJcHJpbnRrKEtFUk5fREVCVUcgImxnczhneHg6ICIgYXJn
cyk7IFwKKwl9IHdoaWxlICgwKQorCisjdW5kZWYgVVNFX0ZBS0VfU0lHTkFMX1NUUkVOR1RICisK
K3N0YXRpYyB2b2lkIGxnczhneHhfYXV0b19sb2NrKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2
KTsKKworc3RhdGljIGludCBkZWJ1ZyA9IDA7CisKK21vZHVsZV9wYXJhbShkZWJ1ZywgaW50LCAw
NjQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoZGVidWcsICJUdXJuIG9uL29mZiBmcm9udGVuZCBkZWJ1
Z2dpbmcgKGRlZmF1bHQ6b2ZmKS4iKTsKKworLyogTEdTOEdYWCBpbnRlcm5hbCBoZWxwZXIgZnVu
Y3Rpb25zICovCisKK3N0YXRpYyBpbnQgbGdzOGd4eF93cml0ZV9yZWcoc3RydWN0IGxnczhneHhf
c3RhdGUgKnByaXYsIHU4IHJlZywgdTggZGF0YSkKK3sKKwlpbnQgcmV0OworCXU4IGJ1ZltdID0g
eyByZWcsIGRhdGEgfTsKKwlzdHJ1Y3QgaTJjX21zZyBtc2cgPSB7IC5mbGFncyA9IDAsIC5idWYg
PSBidWYsIC5sZW4gPSAyIH07CisKKwltc2cuYWRkciA9IHByaXYtPmNvbmZpZy0+ZGVtb2RfYWRk
cmVzczsKKwlpZiAocmVnID49IDB4QzApCisJCW1zZy5hZGRyICs9IDB4MDI7CisKKwlpZiAoZGVi
dWcgPj0gMikKKwkJcHJpbnRrKCIlczogcmVnPTB4JTAyWCwgZGF0YT0weCUwMlhcbiIsIF9fZnVu
Y19fLCByZWcsIGRhdGEpOworCisJcmV0ID0gaTJjX3RyYW5zZmVyKHByaXYtPmkyYywgJm1zZywg
MSk7CisKKwlpZiAocmV0ICE9IDEpCisJCWRwcmludGsoIiVzOiBlcnJvciByZWc9MHgleCwgZGF0
YT0weCV4LCByZXQ9JWlcbiIsCisJCQlfX2Z1bmNfXywgcmVnLCBkYXRhLCByZXQpOworCisJcmV0
dXJuIChyZXQgIT0gMSkgPyAtMSA6IDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9yZWFkX3Jl
ZyhzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiwgdTggcmVnLCB1OCAqcF9kYXRhKQoreworCWlu
dCByZXQ7CisJdTggZGV2X2FkZHI7CisKKwl1OCBiMFtdID0geyByZWcgfTsKKwl1OCBiMVtdID0g
eyAwIH07CisJc3RydWN0IGkyY19tc2cgbXNnW10gPSB7CisJCXsgLmZsYWdzID0gMCwgLmJ1ZiA9
IGIwLCAubGVuID0gMSB9LAorCQl7IC5mbGFncyA9IEkyQ19NX1JELCAuYnVmID0gYjEsIC5sZW4g
PSAxIH0sCisJfTsKKworCWRldl9hZGRyID0gcHJpdi0+Y29uZmlnLT5kZW1vZF9hZGRyZXNzOwor
CWlmIChyZWcgPj0gMHhDMCkKKwkJZGV2X2FkZHIgKz0gMHgwMjsKKwltc2dbMV0uYWRkciA9ICBt
c2dbMF0uYWRkciA9IGRldl9hZGRyOworCisJcmV0ID0gaTJjX3RyYW5zZmVyKHByaXYtPmkyYywg
bXNnLCAyKTsKKwlpZiAocmV0ICE9IDIpIHsKKwkJZHByaW50aygiJXM6IGVycm9yIHJlZz0weCV4
LCByZXQ9JWlcbiIsIF9fZnVuY19fLCByZWcsIHJldCk7CisJCXJldHVybiAtMTsKKwl9CisKKwkq
cF9kYXRhID0gYjFbMF07CisJaWYgKGRlYnVnID49IDIpCisJCXByaW50aygiJXM6IHJlZz0weCUw
MlgsIGRhdGE9MHglMDJYXG4iLCBfX2Z1bmNfXywgcmVnLCBiMVswXSk7CisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9zb2Z0X3Jlc2V0KHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpw
cml2KQoreworCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDIsIDB4MDApOworCW1zbGVlcCgx
KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDAyLCAweDAxKTsKKwltc2xlZXAoMTAwKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxnczhneHhfc2V0X2FkX21vZGUoc3RydWN0
IGxnczhneHhfc3RhdGUgKnByaXYpCit7CisJY29uc3Qgc3RydWN0IGxnczhneHhfY29uZmlnICpj
b25maWcgPSBwcml2LT5jb25maWc7CisJdTggaWZfY29uZjsKKworCWlmX2NvbmYgPSAweDEwOyAv
LyBBR0Mgb3V0cHV0IG9uOworCisJaWZfY29uZiB8PQorCQkoKGNvbmZpZy0+ZXh0X2FkYykgPyAw
eDgwOjB4MDApIHwKKwkJKChjb25maWctPmlmX25lZ19jZW50ZXIpID8gMHgwNDoweDAwKSB8CisJ
CSgoY29uZmlnLT5pZl9mcmVxID09IDApID8gMHgwODoweDAwKSB8IC8qIEJhc2ViYW5kICovCisJ
CSgoY29uZmlnLT5leHRfYWRjICYmIGNvbmZpZy0+YWRjX3NpZ25lZCkgPyAweDAyOjB4MDApIHwK
KwkJKChjb25maWctPmV4dF9hZGMgJiYgY29uZmlnLT5pZl9uZWdfZWRnZSkgPyAweDAxOjB4MDAp
OworCisJaWYgKGNvbmZpZy0+ZXh0X2FkYyAmJgorCQkoY29uZmlnLT5wcm9kID09IExHUzhHWFhf
UFJPRF9MR1M4RzUyKSkgeworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweEJBLCAweDQwKTsK
Kwl9CisKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDA3LCBpZl9jb25mKTsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgaW50IGxnczhneHhfc2V0X2lmX2ZyZXEoc3RydWN0IGxnczhneHhf
c3RhdGUgKnByaXYsIHUzMiBmcmVxIC8qaW4ga0h6Ki8pCit7CisJdTY0IHZhbDsKKwl1MzIgdjMy
OworCXUzMiBpZl9jbGs7CisKKwlpZl9jbGsgPSBwcml2LT5jb25maWctPmlmX2Nsa19mcmVxOwor
CisJdmFsID0gZnJlcTsKKwlpZiAoZnJlcSAhPSAwKSB7CisJCXZhbCAqPSAodTY0KTEgPDwgMzI7
CisJCWlmIChpZl9jbGsgIT0gMCkKKwkJCWRvX2Rpdih2YWwsIGlmX2Nsayk7CisJCXYzMiA9IHZh
bCAmIDB4RkZGRkZGRkY7CisJCWRwcmludGsoIlNldCBJRiBGcmVxIHRvICVka0h6XG4iLCBmcmVx
KTsKKwl9IGVsc2UgeworCQl2MzIgPSAwOworCQlkcHJpbnRrKCJTZXQgSUYgRnJlcSB0byBiYXNl
YmFuZFxuIik7CisJfQorCWRwcmludGsoIkFGQ19JTklUX0ZSRVEgPSAweCUwOFhcbiIsIHYzMik7
CisKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDA5LCAweEZGICYgKHYzMikpOworCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4MEEsIDB4RkYgJiAodjMyID4+IDgpKTsKKwlsZ3M4Z3h4X3dy
aXRlX3JlZyhwcml2LCAweDBCLCAweEZGICYgKHYzMiA+PiAxNikpOworCWxnczhneHhfd3JpdGVf
cmVnKHByaXYsIDB4MEMsIDB4RkYgJiAodjMyID4+IDI0KSk7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBsZ3M4Z3h4X3NldF9tb2RlX2F1dG8oc3RydWN0IGxnczhneHhfc3RhdGUgKnBy
aXYpCit7CisJdTggdDsKKworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9E
X0xHUzg5MTMpIHsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDNiwgMHgwMSk7CisJfQor
CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDdFLCAmdCk7CisJbGdzOGd4eF93cml0ZV9yZWco
cHJpdiwgMHg3RSwgdCB8IDB4MDEpOworCisJLy8gY2xlYXIgRkVDIHNlbGYgcmVzZXQKKwlsZ3M4
Z3h4X3JlYWRfcmVnKHByaXYsIDB4QzUsICZ0KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAw
eEM1LCB0ICYgMHhFMCk7CisKKwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJP
RF9MR1M4OTEzKSB7CisJCS8qIEZFQyBhdXRvIGRldGVjdCAqLworCQlsZ3M4Z3h4X3dyaXRlX3Jl
Zyhwcml2LCAweEMxLCAweDAzKTsKKworCQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4N0MsICZ0
KTsKKwkJdCA9ICh0ICYgMHg4QykgfCAweDAzOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAw
eDdDLCB0KTsKKwl9CisKKworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9E
X0xHUzg5MTMpIHsKKwkJLyogQkVSIHRlc3QgbW9kZSAqLworCQlsZ3M4Z3h4X3JlYWRfcmVnKHBy
aXYsIDB4QzMsICZ0KTsKKwkJdCA9ICh0ICYgMHhFRikgfCAgMHgxMDsKKwkJbGdzOGd4eF93cml0
ZV9yZWcocHJpdiwgMHhDMywgdCk7CisJfQorCisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBM
R1M4R1hYX1BST0RfTEdTOEc1MikgeworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweEQ5LCAw
eDQwKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X3NldF9tb2Rl
X21hbnVhbChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdikKK3sKKwlpbnQgcmV0ID0gMDsKKwl1
OCB0OworCisJLyogdHVybiBvZmYgYXV0by1kZXRlY3Q7IG1hbnVhbCBzZXR0aW5ncyovCisJbGdz
OGd4eF93cml0ZV9yZWcocHJpdiwgMHg3RSwgMCk7CisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9
PSBMR1M4R1hYX1BST0RfTEdTODkxMykKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDMSwg
MCk7CisKKwlyZXQgPSBsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QzUsICZ0KTsKKwl0ID0gKHQg
JiAweEUwKSB8IDB4MDY7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDNSwgdCk7CisKKwls
Z3M4Z3h4X3NvZnRfcmVzZXQocHJpdik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBs
Z3M4Z3h4X2lzX2xvY2tlZChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiwgdTggKmxvY2tlZCkK
K3sKKwlpbnQgcmV0ID0gMDsKKwl1OCB0OworCisJcmV0ID0gbGdzOGd4eF9yZWFkX3JlZyhwcml2
LCAweDRCLCAmdCk7CisJaWYgKHJldCAhPSAwKQorCQlyZXR1cm4gcmV0OworCisJKmxvY2tlZCA9
ICgodCAmIDB4QzApID09IDB4QzApID8gMSA6IDA7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBp
bnQgbGdzOGd4eF9pc19hdXRvZGV0ZWN0X2ZpbmlzaGVkKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpw
cml2LAorCQkJCQkgIHU4ICpmaW5pc2hlZCkKK3sKKwlpbnQgcmV0ID0gMDsKKwl1OCB0OworCisJ
cmV0ID0gbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweEE0LCAmdCk7CisJaWYgKHJldCAhPSAwKQor
CQlyZXR1cm4gcmV0OworCisJKmZpbmlzaGVkID0gKCh0ICYgMHgzKSA9PSAweDEpID8gMSA6IDA7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X2F1dG9sb2NrX2dpKHN0cnVj
dCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1OCBnaSwgdTggKmxvY2tlZCkKK3sKKwlpbnQgZXJyOyAK
Kwl1OCBhZF9maW5pID0gMDsKKworCWlmIChnaSA9PSBHSV85NDUpCisJCWRwcmludGsoInRyeSBH
SSA5NDVcbiIpOworCWVsc2UgaWYgKGdpID09IEdJXzU5NSkKKwkJZHByaW50aygidHJ5IEdJIDU5
NVxuIik7CisJZWxzZSBpZiAoZ2kgPT0gR0lfNDIwKQorCQlkcHJpbnRrKCJ0cnkgR0kgNDIwXG4i
KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDA0LCBnaSk7CisJbGdzOGd4eF9zb2Z0X3Jl
c2V0KHByaXYpOworCW1zbGVlcCg1MCk7CisJZXJyID0gbGdzOGd4eF9pc19hdXRvZGV0ZWN0X2Zp
bmlzaGVkKHByaXYsICZhZF9maW5pKTsKKwlpZiAoZXJyICE9IDApCisJCXJldHVybiBlcnI7CisJ
aWYgKGFkX2ZpbmkpIHsKKwkJZXJyID0gbGdzOGd4eF9pc19sb2NrZWQocHJpdiwgbG9ja2VkKTsK
KwkJaWYgKGVyciAhPSAwKQorCQkJcmV0dXJuIGVycjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBsZ3M4Z3h4X2F1dG9fZGV0ZWN0KHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2
LAorCQkJICAgICAgIHU4ICpkZXRlY3RlZF9wYXJhbSwgdTggKmdpKQoreworCWludCBpLGo7CisJ
aW50IGVyciA9IDA7CisJdTggbG9ja2VkID0gMCwgdG1wX2dpOworCisJZHByaW50aygiJXNcbiIs
IF9fZnVuY19fKTsKKworCWxnczhneHhfc2V0X21vZGVfYXV0byhwcml2KTsKKwkvKiBHdWFyZCBJ
bnRlcnZhbCAqLworCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDMsIDAwKTsKKworCWZvciAo
aSA9IDA7IGkgPCAyOyBpKyspIHsKKwkJZm9yIChqID0wIDsgaiA8IDI7IGorKykgeworCQkJdG1w
X2dpID0gR0lfOTQ1OworCQkJZXJyID0gbGdzOGd4eF9hdXRvbG9ja19naShwcml2LCBHSV85NDUs
ICZsb2NrZWQpOworCQkJaWYgKGVycikgZ290byBvdXQ7CisJCQlpZiAobG9ja2VkKSBnb3RvIGxv
Y2tlZDsKKwkJfQorCQlmb3IgKGogPTAgOyBqIDwgMjsgaisrKSB7CisJCQl0bXBfZ2kgPSBHSV80
MjA7CisJCQllcnIgPSBsZ3M4Z3h4X2F1dG9sb2NrX2dpKHByaXYsIEdJXzQyMCwgJmxvY2tlZCk7
CisJCQlpZiAoZXJyKSBnb3RvIG91dDsKKwkJCWlmIChsb2NrZWQpIGdvdG8gbG9ja2VkOworCQl9
CisJCXRtcF9naSA9IEdJXzU5NTsKKwkJZXJyID0gbGdzOGd4eF9hdXRvbG9ja19naShwcml2LCBH
SV81OTUsICZsb2NrZWQpOworCQlpZiAoZXJyKSBnb3RvIG91dDsKKwkJaWYgKGxvY2tlZCkgZ290
byBsb2NrZWQ7CisJfQorCitsb2NrZWQ6CisJaWYgKChlcnIgPT0gMCkgJiYgKGxvY2tlZCA9PSAx
KSkgeworCQl1OCB0OworCisJCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhBMiwgJnQpOworCQkq
ZGV0ZWN0ZWRfcGFyYW0gPSB0OworCisJCWlmICh0bXBfZ2kgPT0gR0lfOTQ1KQorCQkJZHByaW50
aygiR0kgOTQ1IGxvY2tlZFxuIik7CisJCWVsc2UgaWYgKHRtcF9naSA9PSBHSV81OTUpCisJCQlk
cHJpbnRrKCJHSSA1OTUgbG9ja2VkXG4iKTsKKwkJZWxzZSBpZiAodG1wX2dpID09IEdJXzQyMCkK
KwkJCWRwcmludGsoIkdJIDQyMCBsb2NrZWRcbiIpOworCQkqZ2kgPSB0bXBfZ2k7CisJfQorCWlm
ICghbG9ja2VkKQorCQllcnIgPSAtMTsKKworb3V0OgorCXJldHVybiBlcnI7Cit9CisKK3N0YXRp
YyB2b2lkIGxnczhneHhfYXV0b19sb2NrKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2KQorewor
CXM4IGVycjsKKwkvL3U4IGN0cmxfZnJhbWUgPSAwLCBtb2RlID0gMCwgcmF0ZSA9IDA7CisJdTgg
LyppbnRlcl9sZWF2ZXJfbGVuID0gMCwqLyBnaSA9IDB4MjsKKwl1OCBkZXRlY3RlZF9wYXJhbSA9
IDA7CisKKwllcnIgPSBsZ3M4Z3h4X2F1dG9fZGV0ZWN0KHByaXYsICZkZXRlY3RlZF9wYXJhbSwg
JmdpKTsKKworCWlmIChlcnIgIT0gMCkgeworI2lmIDAKKwkJLyogU2V0IGF1dG8gZ3VhcmRpbnRl
cnZhbCBkZXRlY3Rpb24gKi8KKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgwMywgMHgwMSk7
CisjZW5kaWYKKwkJZHByaW50aygibGdzOGd4eF9hdXRvX2RldGVjdCBmYWlsZWRcbiIpOworCX0K
KworCQorCS8qIEFwcGx5IGRldGVjdGVkIHBhcmFtZXRlcnMgKi8KKwlpZiAocHJpdi0+Y29uZmln
LT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKSB7CisJCXU4IGludGVyX2xlYXZlX2xlbiA9
IGRldGVjdGVkX3BhcmFtICYgVElNX01BU0sgOworCQlpbnRlcl9sZWF2ZV9sZW4gPSAoaW50ZXJf
bGVhdmVfbGVuID09IFRJTV9MT05HKSA/IDB4NjAgOiAweDQwOworCQlkZXRlY3RlZF9wYXJhbSAm
PSBDRl9NQVNLIHwgU0NfTUFTSyAgfCBMR1NfRkVDX01BU0s7CisJCWRldGVjdGVkX3BhcmFtIHw9
IGludGVyX2xlYXZlX2xlbjsKKwl9CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHg3RCwgZGV0
ZWN0ZWRfcGFyYW0pOworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xH
Uzg5MTMpIHsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDMCwgZGV0ZWN0ZWRfcGFyYW0p
OworCX0KKwkvL2xnczhneHhfc29mdF9yZXNldChwcml2KTsKKworCS8qIEVudGVyIG1hbnVhbCBt
b2RlICovCisJbGdzOGd4eF9zZXRfbW9kZV9tYW51YWwocHJpdik7CisKKwlpZiAoZ2kgPT0gMHgy
KQorCXN3aXRjaChnaSkgeworCWNhc2UgR0lfOTQ1OgorCQlwcml2LT5jdXJyX2dpID0gOTQ1OyBi
cmVhazsKKwljYXNlIEdJXzU5NToKKwkJcHJpdi0+Y3Vycl9naSA9IDU5NTsgYnJlYWs7CisJY2Fz
ZSBHSV80MjA6CisJCXByaXYtPmN1cnJfZ2kgPSA0MjA7IGJyZWFrOworCWRlZmF1bHQ6CisJCXBy
aXYtPmN1cnJfZ2kgPSA5NDU7IGJyZWFrOworCX0KK30KKworc3RhdGljIGludCBsZ3M4Z3h4X3Nl
dF9tcGVnX21vZGUoc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYsCisJCQkJIHU4IHNlcmlhbCwg
dTggY2xrX3BvbCwgdTggY2xrX2dhdGVkKQoreworCWludCByZXQgPSAwOworCXU4IHQ7CisKKwly
ZXQgPSBsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QzIsICZ0KTsKKwlpZiAocmV0ICE9IDApCisJ
CXJldHVybiByZXQ7CisKKwl0ICY9IDB4Rjg7CisJdCB8PSBzZXJpYWwgPyBUU19TRVJJQUwgOiBU
U19QQVJBTExFTDsKKwl0IHw9IGNsa19wb2wgPyBUU19DTEtfSU5WRVJURUQgOiBUU19DTEtfTk9S
TUFMOworCXQgfD0gY2xrX2dhdGVkID8gVFNfQ0xLX0dBVEVEIDogVFNfQ0xLX0ZSRUVSVU47CisK
KwlyZXQgPSBsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweEMyLCB0KTsKKwlpZiAocmV0ICE9IDAp
CisJCXJldHVybiByZXQ7CisKKwlyZXR1cm4gMDsKK30KKworCisvKiBMR1M4OTEzIGRlbW9kIGZy
b250ZW5kIGZ1bmN0aW9ucyAqLworCitzdGF0aWMgaW50IGxnczg5MTNfaW5pdChzdHJ1Y3QgbGdz
OGd4eF9zdGF0ZSAqcHJpdikKK3sKKwl1OCB0OworCisJLyogTEdTODkxMyBzcGVjaWZpYyAqLwor
CWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4YzEsIDB4Myk7CisKKwlsZ3M4Z3h4X3JlYWRfcmVn
KHByaXYsIDB4N2MsICZ0KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDdjLCAodCYweDhj
KSB8IDB4Myk7CisKKwkvKiBMR1M4OTEzIHNwZWNpZmljICovCisJbGdzOGd4eF9yZWFkX3JlZyhw
cml2LCAweGMzLCAmdCk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhjMywgdCYweDEwKTsK
KworI2lmIDAKKwkvKiBzZXQgQUdDIHJlZiAqLworCS8qIEZJWE1FIGJldHRlciBzZXQgZnJvbSBj
b25maWd1cmF0aW9uIHBlciBoYXJkd2FyZSAqLworCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4
MkMsIDApOyAKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDJELCAweDE4KTsKKwlsZ3M4Z3h4
X3dyaXRlX3JlZyhwcml2LCAweDJFLCAweEEyKTsKKyNlbmRpZgorCisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBpbnQgbGdzOGd4eF9pbml0KHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlKQoreworCXN0
cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICopZmUtPmRl
bW9kdWxhdG9yX3ByaXY7CisJY29uc3Qgc3RydWN0IGxnczhneHhfY29uZmlnICpjb25maWcgPSBw
cml2LT5jb25maWc7CisJdTggZGF0YSA9IDA7CisJczggZXJyOworCWRwcmludGsoIiVzXG4iLCBf
X2Z1bmNfXyk7CisKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDAsICZkYXRhKTsKKwlkcHJpbnRr
KCJyZWcgMCA9IDB4JTAyWFxuIiwgZGF0YSk7CisKKwkvKiBTZXR1cCBNUEVHIG91dHB1dCBmb3Jt
YXQgKi8KKwllcnIgPSBsZ3M4Z3h4X3NldF9tcGVnX21vZGUocHJpdiwgY29uZmlnLT5zZXJpYWxf
dHMsCisJCQkJICAgIGNvbmZpZy0+dHNfY2xrX3BvbCwKKwkJCQkgICAgY29uZmlnLT50c19jbGtf
Z2F0ZWQpOworCWlmIChlcnIgIT0gMCkKKwkJcmV0dXJuIC1FSU87CisKKwlpZiAoY29uZmlnLT5w
cm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKSB7CisJCWxnczg5MTNfaW5pdChwcml2KTsKKwl9
CisJbGdzOGd4eF9zZXRfaWZfZnJlcShwcml2LCBwcml2LT5jb25maWctPmlmX2ZyZXEpOworCWlm
IChjb25maWctPnByb2QgIT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpCisJCWxnczhneHhfc2V0X2Fk
X21vZGUocHJpdik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbGdzOGd4eF9yZWxl
YXNlKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlKQoreworCXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpz
dGF0ZSA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCWRwcmludGsoIiVzXG4iLCBfX2Z1bmNfXyk7
CisKKwlrZnJlZShzdGF0ZSk7Cit9CisKKyNpZiAwCitzdGF0aWMgaW50IGxnczhneHhfc2xlZXAo
c3RydWN0IGR2Yl9mcm9udGVuZCAqZmUpCit7CisJZHByaW50aygiJXNcbiIsIF9fZnVuY19fKTsK
KworCXJldHVybiAwOworfQorI2VuZGlmCisKK3N0YXRpYyBpbnQgbGdzOGd4eF93cml0ZShzdHJ1
Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTggKmJ1ZiwgaW50IGxlbikKK3sKKwlzdHJ1Y3QgbGdzOGd4
eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCisJaWYgKGxlbiAhPSAyKQor
CQlyZXR1cm4gLUVJTlZBTDsKKworCXJldHVybiBsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCBidWZb
MF0sIGJ1ZlsxXSk7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9zZXRfZmUoc3RydWN0IGR2Yl9m
cm9udGVuZCAqZmUsCisJCQkgIHN0cnVjdCBkdmJfZnJvbnRlbmRfcGFyYW1ldGVycyAqZmVfcGFy
YW1zKQoreworCXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3By
aXY7CisKKwlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJLyogc2V0IGZyZXF1ZW5jeSAq
LworCWlmIChmZS0+b3BzLnR1bmVyX29wcy5zZXRfcGFyYW1zKSB7CisJCWZlLT5vcHMudHVuZXJf
b3BzLnNldF9wYXJhbXMoZmUsIGZlX3BhcmFtcyk7CisJCWlmIChmZS0+b3BzLmkyY19nYXRlX2N0
cmwpCisJCQlmZS0+b3BzLmkyY19nYXRlX2N0cmwoZmUsIDApOworCX0KKworCS8qIEhhcmRjb2Rl
ZCB0byB1c2UgYXV0byBhcyBtdWNoIGFzIHBvc3NpYmxlICovCisJZmVfcGFyYW1zLT51Lm9mZG0u
Y29kZV9yYXRlX0hQID0gRkVDX0FVVE87CisJZmVfcGFyYW1zLT51Lm9mZG0uZ3VhcmRfaW50ZXJ2
YWwgPSBHVUFSRF9JTlRFUlZBTF9BVVRPOworCWZlX3BhcmFtcy0+dS5vZmRtLnRyYW5zbWlzc2lv
bl9tb2RlID0gVFJBTlNNSVNTSU9OX01PREVfQVVUTzsKKworCS8qIFNldCBzdGFuZGFyZCBwYXJh
bXMuLiBvciBwdXQgdGhlbSB0byBhdXRvICovCisJaWYgKChmZV9wYXJhbXMtPnUub2ZkbS5jb2Rl
X3JhdGVfSFAgPT0gRkVDX0FVVE8pIHx8CisJICAgIChmZV9wYXJhbXMtPnUub2ZkbS5jb2RlX3Jh
dGVfTFAgPT0gRkVDX0FVVE8pIHx8CisJICAgIChmZV9wYXJhbXMtPnUub2ZkbS5jb25zdGVsbGF0
aW9uID09IFFBTV9BVVRPKSB8fAorCSAgICAoZmVfcGFyYW1zLT51Lm9mZG0uaGllcmFyY2h5X2lu
Zm9ybWF0aW9uID09IEhJRVJBUkNIWV9BVVRPKSkgeworCX0gZWxzZSB7CisJCS8qIHNldCBjb25z
dGVsbGF0aW9uICovCisJCXN3aXRjaCAoZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbikg
eworCQljYXNlIFFQU0s6CisJCWNhc2UgUUFNXzE2OgorCQljYXNlIFFBTV82NDoKKwkJCWJyZWFr
OworCisJCWRlZmF1bHQ6CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCisJCS8qIHNldCBoaWVy
YXJjaHkgKi8KKwkJc3dpdGNoIChmZV9wYXJhbXMtPnUub2ZkbS5oaWVyYXJjaHlfaW5mb3JtYXRp
b24pIHsKKwkJY2FzZSBISUVSQVJDSFlfTk9ORToKKwkJY2FzZSBISUVSQVJDSFlfMToKKwkJY2Fz
ZSBISUVSQVJDSFlfMjoKKwkJY2FzZSBISUVSQVJDSFlfNDoKKwkJCWJyZWFrOworCisJCWRlZmF1
bHQ6CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCX0KKworCS8qIHNldCBndWFyZCBpbnRlcnZh
bCAqLworCXN3aXRjaCAoZmVfcGFyYW1zLT51Lm9mZG0uZ3VhcmRfaW50ZXJ2YWwpIHsKKwljYXNl
IEdVQVJEX0lOVEVSVkFMXzFfMzI6CisJY2FzZSBHVUFSRF9JTlRFUlZBTF8xXzE2OgorCWNhc2Ug
R1VBUkRfSU5URVJWQUxfMV84OgorCWNhc2UgR1VBUkRfSU5URVJWQUxfMV80OgorCWNhc2UgR1VB
UkRfSU5URVJWQUxfQVVUTzoKKwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZB
TDsKKwl9CisKKwkvKiBzZXQgdHJhbnNtaXNzaW9uIG1vZGUgKi8KKwlzd2l0Y2ggKGZlX3BhcmFt
cy0+dS5vZmRtLnRyYW5zbWlzc2lvbl9tb2RlKSB7CisJY2FzZSBUUkFOU01JU1NJT05fTU9ERV8y
SzoKKwljYXNlIFRSQU5TTUlTU0lPTl9NT0RFXzhLOgorCWNhc2UgVFJBTlNNSVNTSU9OX01PREVf
QVVUTzoKKwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwkv
KiBzdGFydCBhdXRvIGxvY2sgKi8KKwlsZ3M4Z3h4X2F1dG9fbG9jayhwcml2KTsKKworCW1zbGVl
cCgxMCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X2dldF9mZShzdHJ1
Y3QgZHZiX2Zyb250ZW5kICpmZSwKKwkJCSAgc3RydWN0IGR2Yl9mcm9udGVuZF9wYXJhbWV0ZXJz
ICpmZV9wYXJhbXMpCit7CisJc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYgPSBmZS0+ZGVtb2R1
bGF0b3JfcHJpdjsKKwl1OCB0OworCWludCB0cmFuc2xhdGVkX2ZlYyA9IEZFQ18xXzI7CisKKwlk
cHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJLyogVE9ETzogZ2V0IHJlYWwgcmVhZGluZ3Mg
ZnJvbSBkZXZpY2UgKi8KKwkvKiBpbnZlcnNpb24gc3RhdHVzICovCisJZmVfcGFyYW1zLT5pbnZl
cnNpb24gPSBJTlZFUlNJT05fT0ZGOworCisJLyogYmFuZHdpZHRoICovCisJZmVfcGFyYW1zLT51
Lm9mZG0uYmFuZHdpZHRoID0gQkFORFdJRFRIXzhfTUhaOworCisJbGdzOGd4eF9yZWFkX3JlZyhw
cml2LCAweDdELCAmdCk7CisJLyogRkVDLiBObyBleGFjdCBtYXRjaCBmb3IgRE1CLVRILCBwaWNr
IGFwcHJveC4gdmFsdWUgKi8KKwlzd2l0Y2godCAmIExHU19GRUNfTUFTSykgeworCWNhc2UgIExH
U19GRUNfMF80OiAvKiBGRUMgMC40ICovCisJCXRyYW5zbGF0ZWRfZmVjID0gRkVDXzFfMjsKKwkJ
YnJlYWs7CisJY2FzZSAgTEdTX0ZFQ18wXzY6IC8qIEZFQyAwLjYgKi8KKwkJdHJhbnNsYXRlZF9m
ZWMgPSBGRUNfMl8zOworCQlicmVhazsKKwljYXNlICBMR1NfRkVDXzBfODogLyogRkVDIDAuOCAq
LworCQl0cmFuc2xhdGVkX2ZlYyA9IEZFQ181XzY7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXRy
YW5zbGF0ZWRfZmVjID0gRkVDXzFfMjsKKwl9CisJZmVfcGFyYW1zLT51Lm9mZG0uY29kZV9yYXRl
X0hQID0KKwlmZV9wYXJhbXMtPnUub2ZkbS5jb2RlX3JhdGVfTFAgPSB0cmFuc2xhdGVkX2ZlYzsK
KworCS8qIGNvbnN0ZWxsYXRpb24gKi8KKwlzd2l0Y2godCAmIFNDX01BU0spIHsKKwljYXNlIFND
X1FBTTY0OgorCQlmZV9wYXJhbXMtPnUub2ZkbS5jb25zdGVsbGF0aW9uID0gUUFNXzY0OworCQli
cmVhazsKKwljYXNlIFNDX1FBTTMyOgorCQlmZV9wYXJhbXMtPnUub2ZkbS5jb25zdGVsbGF0aW9u
ID0gUUFNXzMyOworCQlicmVhazsKKwljYXNlIFNDX1FBTTE2OgorCQlmZV9wYXJhbXMtPnUub2Zk
bS5jb25zdGVsbGF0aW9uID0gUUFNXzE2OworCQlicmVhazsKKwljYXNlIFNDX1FBTTQ6CisJY2Fz
ZSBTQ19RQU00TlI6CisJCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24gPSBRUFNLOwor
CQlicmVhazsKKwlkZWZhdWx0OgorCQlmZV9wYXJhbXMtPnUub2ZkbS5jb25zdGVsbGF0aW9uID0g
UUFNXzY0OworCX0KKworCS8qIHRyYW5zbWlzc2lvbiBtb2RlICovCisJZmVfcGFyYW1zLT51Lm9m
ZG0udHJhbnNtaXNzaW9uX21vZGUgPSBUUkFOU01JU1NJT05fTU9ERV84SzsKKworCS8qIGd1YXJk
IGludGVydmFsICovCisJZmVfcGFyYW1zLT51Lm9mZG0uZ3VhcmRfaW50ZXJ2YWwgPSBHVUFSRF9J
TlRFUlZBTF8xXzE2OworCisJLyogaGllcmFyY2h5ICovCisJZmVfcGFyYW1zLT51Lm9mZG0uaGll
cmFyY2h5X2luZm9ybWF0aW9uID0gSElFUkFSQ0hZX05PTkU7CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljCitpbnQgbGdzOGd4eF9nZXRfdHVuZV9zZXR0aW5ncyhzdHJ1Y3QgZHZiX2Zyb250ZW5k
ICpmZSwKKwkJCSAgICAgIHN0cnVjdCBkdmJfZnJvbnRlbmRfdHVuZV9zZXR0aW5ncyAqZmVzZXR0
aW5ncykKK3sKKwkvKiBGSVhNRTogY29weSBmcm9tIHRkYTEwMDR4LmMgKi8KKwlmZXNldHRpbmdz
LT5taW5fZGVsYXlfbXMgPSA4MDA7CisJLyogRHJpZnQgY29tcGVuc2F0aW9uIG1ha2VzIG5vIHNl
bnNlIGZvciBEVkItVCAqLworCWZlc2V0dGluZ3MtPnN0ZXBfc2l6ZSA9IDA7CisJZmVzZXR0aW5n
cy0+bWF4X2RyaWZ0ID0gMDsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X3Jl
YWRfc3RhdHVzKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCBmZV9zdGF0dXNfdCAqZmVfc3RhdHVz
KQoreworCXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7
CisJczggcmV0OworCXU4IHQ7CisKKwlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJcmV0
ID0gbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDRCLCAmdCk7CisJaWYgKHJldCAhPSAwKQorCQly
ZXR1cm4gLUVJTzsKKworCWRwcmludGsoIlJlZyAweDRCOiAweCUwMlhcbiIsIHQpOworCisJKmZl
X3N0YXR1cyA9IDA7CisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdT
ODkxMykgeworCQlpZiAoKHQgJiAweDQwKSA9PSAweDQwKQorCQkJKmZlX3N0YXR1cyB8PSBGRV9I
QVNfU0lHTkFMIHwgRkVfSEFTX0NBUlJJRVI7CisJCWlmICgodCAmIDB4ODApID09IDB4ODApCisJ
CQkqZmVfc3RhdHVzIHw9IEZFX0hBU19WSVRFUkJJIHwgRkVfSEFTX1NZTkMgfCBGRV9IQVNfTE9D
SzsKKwl9IGVsc2UgeworCQlpZiAoKHQgJiAweDgwKSA9PSAweDgwKQorCQkJKmZlX3N0YXR1cyB8
PSBGRV9IQVNfU0lHTkFMIHwgRkVfSEFTX0NBUlJJRVIgfAorCQkJCUZFX0hBU19WSVRFUkJJIHwg
RkVfSEFTX1NZTkMgfCBGRV9IQVNfTE9DSzsKKwl9CisKKwkvKiBzdWNjZXNzICovCisJZHByaW50
aygiJXM6IGZlX3N0YXR1cz0weCV4XG4iLCBfX2Z1bmNfXywgKmZlX3N0YXR1cyk7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9yZWFkX3NpZ25hbF9hZ2Moc3RydWN0IGxnczhn
eHhfc3RhdGUgKnByaXYsIHUxNiAqc2lnbmFsKQoreworCXUxNiB2OworCXU4IGFnY19sdmxbMl0s
IGNhdDsKKworCWRwcmludGsoIiVzKClcbiIsIF9fZnVuY19fKTsJCisJbGdzOGd4eF9yZWFkX3Jl
Zyhwcml2LCAweDNGLCAmYWdjX2x2bFswXSk7CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDNF
LCAmYWdjX2x2bFsxXSk7CisKKwl2ID0gYWdjX2x2bFswXTsKKwl2IDw8PSA4OworCXYgfD0gYWdj
X2x2bFsxXTsKKworCWRwcmludGsoImFnY19sdmw6IDB4JTA0WFxuIiwgdik7CisKKwlpZiAodiA8
IDB4MTAwICkKKwkJY2F0ID0gMDsKKwllbHNlIGlmICh2IDwgMHgxOTApCisJCWNhdCA9IDU7CisJ
ZWxzZSBpZiAodiA8IDB4MkE4KQorCQljYXQgPSA0OworCWVsc2UgaWYgKHYgPCAweDM4MSkKKwkJ
Y2F0ID0gMzsKKwllbHNlIGlmICh2IDwgMHg0MDApCisJCWNhdCA9IDI7CisJZWxzZSBpZiAodiA9
PSAweDQwMCkKKwkJY2F0ID0gMTsKKwllbHNlCisJCWNhdCA9IDA7CisJCQorCSpzaWduYWwgPSBj
YXQ7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4OTEzX3JlYWRfc2lnbmFsX3N0
cmVuZ3RoKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1MTYgKnNpZ25hbCkKK3sKKwl1OCB0
OyBzOCByZXQ7CisjaWZuZGVmIFVTRV9GQUtFX1NJR05BTF9TVFJFTkdUSAorCXMxNiBtYXhfc3Ry
ZW5ndGggPSAwOworCXU4IHN0cjsKKwl1MTYgaSwgZ2kgPSBwcml2LT5jdXJyX2dpOworI2VuZGlm
CisKKwlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJcmV0ID0gbGdzOGd4eF9yZWFkX3Jl
Zyhwcml2LCAweDRCLCAmdCk7CisJaWYgKHJldCAhPSAwKQorCQlyZXR1cm4gLUVJTzsKKworI2lm
ZGVmIFVTRV9GQUtFX1NJR05BTF9TVFJFTkdUSAorCWlmICgodCAmIDB4QzApID09IDB4QzApIHsK
KwkJZHByaW50aygiRmFrZSBzaWduYWwgc3RyZW5ndGggYXMgNTBcbiIpOworCQkqc2lnbmFsID0g
MHgzMjsKKwl9CisjZWxzZQorCWRwcmludGsoImdpID0gJWRcbiIsIGdpKTsKKwlmb3IgKGkgPSAw
OyBpIDwgZ2k7IGkrKykgeworCisJCWlmICgoaSAmIDB4RkYpID09IDApCisJCQlsZ3M4Z3h4X3dy
aXRlX3JlZyhwcml2LCAweDg0LCAweDAzICYgKGkgPj4gOCkpOworCQlsZ3M4Z3h4X3dyaXRlX3Jl
Zyhwcml2LCAweDgzLCBpICYgMHhGRik7CisKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDk0
LCAmc3RyKTsKKwkJaWYgKG1heF9zdHJlbmd0aCA8IHN0cikKKwkJCW1heF9zdHJlbmd0aCA9IHN0
cjsKKwl9CisKKwkqc2lnbmFsID0gbWF4X3N0cmVuZ3RoOworCWRwcmludGsoIiVzOiBzaWduYWw9
MHglMDJYXG4iLCBfX2Z1bmNfXywgKnNpZ25hbCk7CisjZW5kaWYKKworCWxnczhneHhfcmVhZF9y
ZWcocHJpdiwgMHg5NSwgJnQpOworCWRwcmludGsoIiVzOiBBVkcgTm9pc2U9MHglMDJYXG4iLCBf
X2Z1bmNfXywgdCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X3JlYWRf
c2lnbmFsX3N0cmVuZ3RoKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCB1MTYgKnNpZ25hbCkKK3sK
KwlzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCisJ
aWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTODkxMykKKwkJcmV0dXJu
IGxnczg5MTNfcmVhZF9zaWduYWxfc3RyZW5ndGgocHJpdiwgc2lnbmFsKTsKKwllbHNlCisJCXJl
dHVybiBsZ3M4Z3h4X3JlYWRfc2lnbmFsX2FnYyhwcml2LCBzaWduYWwpOworfQorCitzdGF0aWMg
aW50IGxnczhneHhfcmVhZF9zbnIoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsIHUxNiAqc25yKQor
eworCXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7CisJ
dTggdDsKKwkqc25yID0gMDsKKworCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg5NSwgJnQpOwor
CWRwcmludGsoIkFWRyBOb2lzZT0weCUwMlhcbiIsIHQpOworCSpzbnIgPSAyNTYgLSB0OworCSpz
bnIgPDw9IDg7CisJZHByaW50aygic25yPTB4JXhcbiIsICpzbnIpOworCQorCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IGxnczhneHhfcmVhZF91Y2Jsb2NrcyhzdHJ1Y3QgZHZiX2Zyb250ZW5k
ICpmZSwgdTMyICp1Y2Jsb2NrcykKK3sKKwkqdWNibG9ja3MgPSAwOworCWRwcmludGsoIiVzOiB1
Y2Jsb2Nrcz0weCV4XG4iLCBfX2Z1bmNfXywgKnVjYmxvY2tzKTsKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBsZ3M4Z3h4X3JlYWRfYmVyKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCB1MzIg
KmJlcikKK3sKKwlzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9w
cml2OworCXU4IHIwLCByMSwgcjIsIHIzOworCXUzMiB0b3RhbF9jbnQsIGVycl9jbnQ7CisKKwlk
cHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhj
NiwgMHgwMSk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhjNiwgMHg0MSk7CisJbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHhjNiwgMHgwMSk7CisKKwltc2xlZXAoMjAwKTsKKworCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4YzYsIDB4ODEpOworCWxnczhneHhfcmVhZF9yZWcocHJpdiwg
MHhkMCwgJnIwKTsKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDEsICZyMSk7CisJbGdzOGd4
eF9yZWFkX3JlZyhwcml2LCAweGQyLCAmcjIpOworCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhk
MywgJnIzKTsKKwl0b3RhbF9jbnQgPSAocjMgPDwgMjQpIHwgKHIyIDw8IDE2KSB8IChyMSA8PCA4
KSB8IChyMCk7CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweGQ0LCAmcjApOworCWxnczhneHhf
cmVhZF9yZWcocHJpdiwgMHhkNSwgJnIxKTsKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDYs
ICZyMik7CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweGQ3LCAmcjMpOworCWVycl9jbnQgPSAo
cjMgPDwgMjQpIHwgKHIyIDw8IDE2KSB8IChyMSA8PCA4KSB8IChyMCk7CisJZHByaW50aygiZXJy
b3I9JWQgdG90YWw9JWRcbiIsIGVycl9jbnQsIHRvdGFsX2NudCk7CisKKwlpZiAodG90YWxfY250
ID09IDApCisJCSpiZXIgPSAwOworCWVsc2UKKwkJKmJlciA9IGVycl9jbnQgKiAxMDAgLyB0b3Rh
bF9jbnQ7CisKKwlkcHJpbnRrKCIlczogYmVyPTB4JXhcbiIsIF9fZnVuY19fLCAqYmVyKTsKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X2kyY19nYXRlX2N0cmwoc3RydWN0IGR2
Yl9mcm9udGVuZCogZmUsIGludCBlbmFibGUpCit7CisJc3RydWN0IGxnczhneHhfc3RhdGUgKnBy
aXYgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKworCWlmIChwcml2LT5jb25maWctPnR1bmVyX2Fk
ZHJlc3MgPT0gMCkKKwkJcmV0dXJuIDA7CisJaWYgKGVuYWJsZSkgeworCQlyZXR1cm4gbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHgwMSwgMHg4MCB8IHByaXYtPmNvbmZpZy0+dHVuZXJfYWRkcmVz
cyk7CisJfSBlbHNlIHsKKwkJcmV0dXJuIGxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDEsIDAp
OworCX0KK30KKworc3RhdGljIHN0cnVjdCBkdmJfZnJvbnRlbmRfb3BzIGxnczhneHhfb3BzID0g
eworCS5pbmZvID0geworCQkubmFtZSA9ICJMZWdlbmQgU2lsaWNvbiBMR1M4OTEzL0xHUzhHWFgg
RE1CLVRIIiwKKwkJLnR5cGUgPSBGRV9PRkRNLAorCQkuZnJlcXVlbmN5X21pbiA9IDQ3NDAwMDAw
MCwKKwkJLmZyZXF1ZW5jeV9tYXggPSA4NTgwMDAwMDAsCisJCS5mcmVxdWVuY3lfc3RlcHNpemUg
PSAxMDAwMCwKKwkJLmNhcHMgPQorCQkgICAgRkVfQ0FOX0ZFQ18xXzIgfCBGRV9DQU5fRkVDXzJf
MyB8IEZFX0NBTl9GRUNfM180IHwKKwkJICAgIEZFX0NBTl9GRUNfNV82IHwgRkVfQ0FOX0ZFQ183
XzggfCBGRV9DQU5fRkVDX0FVVE8gfAorCQkgICAgRkVfQ0FOX1FQU0sgfAorCQkgICAgRkVfQ0FO
X1FBTV8xNiB8IEZFX0NBTl9RQU1fNjQgfCBGRV9DQU5fUUFNX0FVVE8gfAorCQkgICAgRkVfQ0FO
X1RSQU5TTUlTU0lPTl9NT0RFX0FVVE8gfCBGRV9DQU5fR1VBUkRfSU5URVJWQUxfQVVUTworCX0s
CisKKwkucmVsZWFzZSA9IGxnczhneHhfcmVsZWFzZSwKKworCS5pbml0ID0gbGdzOGd4eF9pbml0
LAorCS8vLnNsZWVwID0gbGdzOGd4eF9zbGVlcCwKKwkud3JpdGUgPSBsZ3M4Z3h4X3dyaXRlLAor
CS5pMmNfZ2F0ZV9jdHJsID0gbGdzOGd4eF9pMmNfZ2F0ZV9jdHJsLAorCisJLnNldF9mcm9udGVu
ZCA9IGxnczhneHhfc2V0X2ZlLAorCS5nZXRfZnJvbnRlbmQgPSBsZ3M4Z3h4X2dldF9mZSwKKwku
Z2V0X3R1bmVfc2V0dGluZ3MgPSBsZ3M4Z3h4X2dldF90dW5lX3NldHRpbmdzLAorCisJLnJlYWRf
c3RhdHVzID0gbGdzOGd4eF9yZWFkX3N0YXR1cywKKwkucmVhZF9iZXIgPSBsZ3M4Z3h4X3JlYWRf
YmVyLAorCS5yZWFkX3NpZ25hbF9zdHJlbmd0aCA9IGxnczhneHhfcmVhZF9zaWduYWxfc3RyZW5n
dGgsCisJLnJlYWRfc25yID0gbGdzOGd4eF9yZWFkX3NuciwKKwkucmVhZF91Y2Jsb2NrcyA9IGxn
czhneHhfcmVhZF91Y2Jsb2NrcywKK307CisKK3N0cnVjdCBkdmJfZnJvbnRlbmQgKmxnczhneHhf
YXR0YWNoKGNvbnN0IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnLAorCQkJCSAgICBzdHJ1
Y3QgaTJjX2FkYXB0ZXIgKmkyYykKK3sKKwlzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiA9IE5V
TEw7CisJdTggZGF0YSA9IDA7CisKKwlkcHJpbnRrKCIlcygpXG4iLF9fZnVuY19fKTsKKworCWlm
IChjb25maWcgPT0gTlVMTCB8fCBpMmMgPT0gTlVMTCkKKwkJcmV0dXJuIE5VTEw7CisKKwlwcml2
ID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGxnczhneHhfc3RhdGUpLCBHRlBfS0VSTkVMKTsKKwlp
ZiAocHJpdiA9PSBOVUxMKQorCQlnb3RvIGVycm9yX291dDsKKworCXByaXYtPmNvbmZpZyA9IGNv
bmZpZzsKKwlwcml2LT5pMmMgPSBpMmM7CisKKwkvKiBjaGVjayBpZiB0aGUgZGVtb2QgaXMgdGhl
cmUgKi8KKwlpZiAobGdzOGd4eF9yZWFkX3JlZyhwcml2LCAwLCAmZGF0YSkgIT0gMCAvKnx8CisJ
CWRhdGEgIT0gMHgwQiovKSB7CisJCWRwcmludGsoIiVzIGxnczhneHggbm90IGZvdW5kIGF0IGky
YyBhZGRyIDB4JTAyWFxuIiwKKwkJCV9fZnVuY19fLCBwcml2LT5jb25maWctPmRlbW9kX2FkZHJl
c3MpOworCQlnb3RvIGVycm9yX291dDsKKwl9CisKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDEs
ICZkYXRhKTsKKworCW1lbWNweSgmcHJpdi0+ZnJvbnRlbmQub3BzLCAmbGdzOGd4eF9vcHMsCisJ
ICAgICAgIHNpemVvZihzdHJ1Y3QgZHZiX2Zyb250ZW5kX29wcykpOworCXByaXYtPmZyb250ZW5k
LmRlbW9kdWxhdG9yX3ByaXYgPSBwcml2OworCisJcmV0dXJuICZwcml2LT5mcm9udGVuZDsKKwor
ZXJyb3Jfb3V0OgorCWRwcmludGsoIiVzKCkgZXJyb3Jfb3V0XG4iLCBfX2Z1bmNfXyk7CisJa2Zy
ZWUocHJpdik7CisJcmV0dXJuIE5VTEw7CisKK30KK0VYUE9SVF9TWU1CT0wobGdzOGd4eF9hdHRh
Y2gpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIkxlZ2VuZCBTaWxpY29uIExHUzg5MTMvTEdTOEdY
WCBETUItVEggZGVtb2R1bGF0b3IgZHJpdmVyIik7CitNT0RVTEVfQVVUSE9SKCJEYXZpZCBULiBM
LiBXb25nIDxkYXZpZHRsd29uZ0BnbWFpbC5jb20+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7
CmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9s
Z3M4Z3h4LmgKLS0tIC9kZXYvbnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAwIDE5NzAgKzAwMDAKKysr
IGIvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xnczhneHguaAlGcmkgTWFyIDIw
IDExOjUwOjI0IDIwMDkgKzA4MDAKQEAgLTAsMCArMSw5MCBAQAorLyoKKyAqICAgIFN1cHBvcnQg
Zm9yIExlZ2VuZCBTaWxpY29uIERNQi1USCBkZW1vZHVsYXRvcgorICogICAgTEdTODkxMywgTEdT
OEdMNQorICogICAgZXhwZXJpbWVudGFsIHN1cHBvcnQgTEdTOEc0MiwgTEdTOEc1MgorICoKKyAq
ICAgIENvcHlyaWdodCAoQykgMjAwNywyMDA4IERhdmlkIFQuTC4gV29uZyA8ZGF2aWR0bHdvbmdA
Z21haWwuY29tPgorICogICAgQ29weXJpZ2h0IChDKSAyMDA4IFNpcml1cyBJbnRlcm5hdGlvbmFs
IChIb25nIEtvbmcpIExpbWl0ZWQKKyAqICAgIFRpbW90aHkgTGVlIDx0aW1vdGh5LmxlZUBzaXJp
dXNoay5jb20+IChmb3IgaW5pdGlhbCB3b3JrIG9uIExHUzhHTDUpCisgKgorICogICAgVGhpcyBw
cm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBt
b2RpZnkKKyAqICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogICAgKGF0IHlvdXIg
b3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiAgICBUaGlzIHByb2dyYW0gaXMgZGlz
dHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqICAgIGJ1dCBX
SVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9m
CisgKiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBP
U0UuICBTZWUgdGhlCisgKiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgorICoKKyAqICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3Jh
bTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQorICogICAgRm91bmRhdGlvbiwg
SW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAyMTM5LCBVU0EuCisgKgorICovCisK
KyNpZm5kZWYgX19MR1M4R1hYX0hfXworI2RlZmluZSBfX0xHUzhHWFhfSF9fCisKKyNpbmNsdWRl
IDxsaW51eC9kdmIvZnJvbnRlbmQuaD4KKyNpbmNsdWRlIDxsaW51eC9pMmMuaD4KKworI2RlZmlu
ZSBMR1M4R1hYX1BST0RfTEdTODkxMyAwCisjZGVmaW5lIExHUzhHWFhfUFJPRF9MR1M4R0w1IDEK
KyNkZWZpbmUgTEdTOEdYWF9QUk9EX0xHUzhHNDIgMworI2RlZmluZSBMR1M4R1hYX1BST0RfTEdT
OEc1MiA0CisjZGVmaW5lIExHUzhHWFhfUFJPRF9MR1M4RzU0IDUKKworc3RydWN0IGxnczhneHhf
Y29uZmlnIHsKKworCS8qIHByb2R1Y3QgdHlwZSAqLworCXU4IHByb2Q7CisKKwkvKiB0aGUgZGVt
b2R1bGF0b3IncyBpMmMgYWRkcmVzcyAqLworCXU4IGRlbW9kX2FkZHJlc3M7CisKKwkvKiBwYXJh
bGxlbCBvciBzZXJpYWwgdHJhbnNwb3J0IHN0cmVhbSAqLworCXU4IHNlcmlhbF90czsKKworCS8q
IHRyYW5zcG9ydCBzdHJlYW0gcG9sYXJpdHkqLworCXU4IHRzX2Nsa19wb2w7CisKKwkvKiB0cmFu
c3BvcnQgc3RyZWFtIGNsb2NrIGdhdGVkIGJ5IHRzX3ZhbGlkICovCisJdTggdHNfY2xrX2dhdGVk
OworCisJLyogQS9EIENsb2NrIGZyZXF1ZW5jeSAqLworCXUzMiBpZl9jbGtfZnJlcTsgLyogaW4g
a0h6ICovCisKKwkvKiBJRiBmcmVxdWVuY3kgKi8KKwl1MzIgaWZfZnJlcTsgLyogaW4ga0h6ICov
CisKKwkvKlVzZSBFeHRlcm5hbCBBREMqLworCXU4IGV4dF9hZGM7CisKKwkvKkV4dGVybmFsIEFE
QyBvdXRwdXQgdHdvJ3MgY29tcGxlbWVudCovCisJdTggYWRjX3NpZ25lZDsKKworCS8qU2FtcGxl
IElGIGRhdGEgYXQgZmFsbGluZyBlZGdlIG9mIElGX0NMSyovCisJdTggaWZfbmVnX2VkZ2U7CisK
KwkvKklGIHVzZSBOZWdhdGl2ZSBjZW50ZXIgZnJlcXVlbmN5Ki8KKwl1OCBpZl9uZWdfY2VudGVy
OworCisJLyogc2xhdmUgYWRkcmVzcyBhbmQgY29uZmlndXJhdGlvbiBvZiB0aGUgdHVuZXIgKi8K
Kwl1OCB0dW5lcl9hZGRyZXNzOworfTsKKworI2lmIGRlZmluZWQoQ09ORklHX0RWQl9MR1M4R1hY
KSB8fCBcCisJKGRlZmluZWQoQ09ORklHX0RWQl9MR1M4R1hYX01PRFVMRSkgJiYgZGVmaW5lZChN
T0RVTEUpKQorZXh0ZXJuIHN0cnVjdCBkdmJfZnJvbnRlbmQgKmxnczhneHhfYXR0YWNoKGNvbnN0
IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnLAorCQkJCQkgICBzdHJ1Y3QgaTJjX2FkYXB0
ZXIgKmkyYyk7CisjZWxzZQorc3RhdGljIGlubGluZQorc3RydWN0IGR2Yl9mcm9udGVuZCAqbGdz
OGd4eF9hdHRhY2goY29uc3Qgc3RydWN0IGxnczhneHhfY29uZmlnICpjb25maWcsCisJCQkJICAg
IHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjKSB7CisJcHJpbnRrKEtFUk5fV0FSTklORyAiJXM6IGRy
aXZlciBkaXNhYmxlZCBieSBLY29uZmlnXG4iLCBfX2Z1bmNfXyk7CisJcmV0dXJuIE5VTEw7Cit9
CisjZW5kaWYgLyogQ09ORklHX0RWQl9MR1M4R1hYICovCisKKyNlbmRpZiAvKiBfX0xHUzhHWFhf
SF9fICovCmRpZmYgLXIgNmYwODg5ZmRhMzE3IGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250
ZW5kcy9sZ3M4Z3h4X3ByaXYuaAotLS0gL2Rldi9udWxsCVRodSBKYW4gMDEgMDA6MDA6MDAgMTk3
MCArMDAwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eF9w
cml2LmgJRnJpIE1hciAyMCAxMTo1MDoyNCAyMDA5ICswODAwCkBAIC0wLDAgKzEsNzAgQEAKKy8q
CisgKiAgICBTdXBwb3J0IGZvciBMZWdlbmQgU2lsaWNvbiBETUItVEggZGVtb2R1bGF0b3IKKyAq
ICAgIExHUzg5MTMsIExHUzhHTDUKKyAqICAgIGV4cGVyaW1lbnRhbCBzdXBwb3J0IExHUzhHNDIs
IExHUzhHNTIKKyAqCisgKiAgICBDb3B5cmlnaHQgKEMpIDIwMDcsMjAwOCBEYXZpZCBULkwuIFdv
bmcgPGRhdmlkdGx3b25nQGdtYWlsLmNvbT4KKyAqICAgIENvcHlyaWdodCAoQykgMjAwOCBTaXJp
dXMgSW50ZXJuYXRpb25hbCAoSG9uZyBLb25nKSBMaW1pdGVkCisgKiAgICBUaW1vdGh5IExlZSA8
dGltb3RoeS5sZWVAc2lyaXVzaGsuY29tPiAoZm9yIGluaXRpYWwgd29yayBvbiBMR1M4R0w1KQor
ICoKKyAqICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogICAgdGhlIEZyZWUg
U29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IK
KyAqICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogICAgVGhp
cyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2Vm
dWwsCisgKiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1w
bGllZCB3YXJyYW50eSBvZgorICogICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogICAgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2
ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogICAgYWxvbmcg
d2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKKyAq
ICAgIEZvdW5kYXRpb24sIEluYy4sIDY3NSBNYXNzIEF2ZSwgQ2FtYnJpZGdlLCBNQSAwMjEzOSwg
VVNBLgorICoKKyAqLworCisjaWZuZGVmIExHUzg5MTNfUFJJVl9ICisjZGVmaW5lIExHUzg5MTNf
UFJJVl9ICisKK3N0cnVjdCBsZ3M4Z3h4X3N0YXRlIHsKKwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmky
YzsKKwkvKiBjb25maWd1cmF0aW9uIHNldHRpbmdzICovCisJY29uc3Qgc3RydWN0IGxnczhneHhf
Y29uZmlnICpjb25maWc7CisJc3RydWN0IGR2Yl9mcm9udGVuZCBmcm9udGVuZDsKKwl1MTYgY3Vy
cl9naTsgLyogY3VycmVudCBndWFyZCBpbnRlcnZhbCAqLworfTsKKworI2RlZmluZSBTQ19NQVNL
CQkweDFDCS8qIFN1Yi1DYXJyaWVyIE1vZHVsYXRpb24gTWFzayAqLworI2RlZmluZSBTQ19RQU02
NAkweDEwCS8qIDY0UUFNIG1vZHVsYXRpb24gKi8KKyNkZWZpbmUgU0NfUUFNMzIJMHgwQwkvKiAz
MlFBTSBtb2R1bGF0aW9uICovCisjZGVmaW5lIFNDX1FBTTE2CTB4MDgJLyogMTZRQU0gbW9kdWxh
dGlvbiAqLworI2RlZmluZSBTQ19RQU00TlIJMHgwNAkvKiA0UUFNIG1vZHVsYXRpb24gKi8KKyNk
ZWZpbmUgU0NfUUFNNAkJMHgwMAkvKiA0UUFNIG1vZHVsYXRpb24gKi8KKworI2RlZmluZSBMR1Nf
RkVDX01BU0sJMHgwMwkvKiBGRUMgUmF0ZSBNYXNrICovCisjZGVmaW5lIExHU19GRUNfMF80CTB4
MDAJLyogRkVDIFJhdGUgMC40ICovCisjZGVmaW5lIExHU19GRUNfMF82CTB4MDEJLyogRkVDIFJh
dGUgMC42ICovCisjZGVmaW5lIExHU19GRUNfMF84CTB4MDIJLyogRkVDIFJhdGUgMC44ICovCisK
KyNkZWZpbmUgVElNX01BU0sJICAweDIwCS8qIFRpbWUgSW50ZXJsZWF2ZSBMZW5ndGggTWFzayAq
LworI2RlZmluZSBUSU1fTE9ORwkgIDB4MDAJLyogVGltZSBJbnRlcmxlYXZlIExlbmd0aCA9IDcy
MCAqLworI2RlZmluZSBUSU1fTUlERExFICAgICAweDIwICAgLyogVGltZSBJbnRlcmxlYXZlIExl
bmd0aCA9IDI0MCAqLworCisjZGVmaW5lIENGX01BU0sJMHg4MAkvKiBDb250cm9sIEZyYW1lIE1h
c2sgKi8KKyNkZWZpbmUgQ0ZfRU4JMHg4MAkvKiBDb250cm9sIEZyYW1lIE9uICovCisKKyNkZWZp
bmUgR0lfTUFTSwkweDAzCS8qIEd1YXJkIEludGVydmFsIE1hc2sgKi8KKyNkZWZpbmUgR0lfNDIw
CTB4MDAJLyogMS85IEd1YXJkIEludGVydmFsICovCisjZGVmaW5lIEdJXzU5NQkweDAxCQorI2Rl
ZmluZSBHSV85NDUJMHgwMgkvKiAxLzQgR3VhcmQgSW50ZXJ2YWwgKi8KKworCisjZGVmaW5lIFRT
X1BBUkFMTEVMCTB4MDAJLyogUGFyYWxsZWwgVFMgT3V0cHV0IGEuay5hLiBTUEkgKi8KKyNkZWZp
bmUgVFNfU0VSSUFMCTB4MDEJLyogU2VyaWFsIFRTIE91dHB1dCBhLmsuYS4gU1NJICovCisjZGVm
aW5lIFRTX0NMS19OT1JNQUwJCTB4MDAJLyogTVBFRyBDbG9jayBOb3JtYWwgKi8KKyNkZWZpbmUg
VFNfQ0xLX0lOVkVSVEVECQkweDAyCS8qIE1QRUcgQ2xvY2sgSW52ZXJ0ZWQgKi8KKyNkZWZpbmUg
VFNfQ0xLX0dBVEVECQkweDAwCS8qIE1QRUcgY2xvY2sgZ2F0ZWQgKi8KKyNkZWZpbmUgVFNfQ0xL
X0ZSRUVSVU4JCTB4MDQJLyogTVBFRyBjbG9jayBmcmVlIHJ1bm5pbmcqLworCisKKyNlbmRpZgo=
--000e0cd14d66926ca2046611c8d6--
