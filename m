Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-bk0-f46.google.com ([209.85.214.46]:52844 "EHLO
	mail-bk0-f46.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752306Ab2ANSoT (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Sat, 14 Jan 2012 13:44:19 -0500
Received: by bkuw12 with SMTP id w12so704333bku.19
        for <linux-media@vger.kernel.org>; Sat, 14 Jan 2012 10:44:18 -0800 (PST)
MIME-Version: 1.0
Date: Sat, 14 Jan 2012 19:44:18 +0100
Message-ID: <CAEN_-SDUfyu34YSV6Lr4yADkNmr6=+TALN0xvrCODFPeRedkFA@mail.gmail.com>
Subject: cx25840: improve audio for cx2388x drivers
From: =?ISO-8859-2?Q?Miroslav_Sluge=F2?= <thunder.mmm@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=000e0ce0f30670413704b6815ef1
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--000e0ce0f30670413704b6815ef1
Content-Type: text/plain; charset=ISO-8859-1

Searching for testers, this patch is big one, it was more then week of
work and testing, so i appriciate any comments and recommendations.

--000e0ce0f30670413704b6815ef1
Content-Type: text/x-patch; charset=US-ASCII; name="cx25840_audio_fixes.patch"
Content-Disposition: attachment; filename="cx25840_audio_fixes.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gxezgwis0

U2lnbmVkLW9mZi1ieTogTWlyb3NsYXYgU2x1Z2VuIDx0aHVuZGVyLm1tbUBnbWFpbC5jb20+CkZy
b206IE1pcm9zbGF2IFNsdWdlbiA8dGh1bmRlci5tbW1AZ21haWwuY29tPgpEYXRlOiBNb24sIDEy
IERlYyAyMDExIDAwOjE5OjM0ICswMTAwClN1YmplY3Q6IFtQQVRDSF0gVGhpcyBwYXRjaCBzaG91
bGQgZml4IG1hbnkgYW5hbG9nIGF1ZGlvIGlzc3VlcyBmb3IgY3gyMzg4NSBiYXNlZCBjYXJkcy4K
CjEuIFJld3JpdGUgcGFydCBvZiBzZXRfaW5wdXQgdG8gY3gyNTg0MF9hdWRpb19zZXRfcGF0aCwg
dGhpcyBwYXJ0IHNob3VsZCBiZQogc2V0IG9ubHkgd2hlbiBzb2Z0IHJlc2V0IGlzIGFzc2VydGVk
IGFuZCBtaWNyb2NvbnRyb2xlciBpcyBzdG9wcGVkLgogCjIuIFdoaWxlIHVzaW5nIEFVRElPNiBh
bmQgQVVESU83IGlucHV0cyB3ZSBzaG91bGQgYWx3YXlzIHN0b3AgbWljcm9jb250cm9sZXIsCiBi
ZWNhdXNlIHRoZXkgYXJlIG5vdCB0dW5lciBpbnB1dHMsIHRoaXMgc2hvdWxkIGZpeCBuby1hdWRp
byBmb3IgY29tcG9zaXRlCiBzLXZpZGVvIGFuZCBjb21wb25uZXQgaW5wdXQgb24gbWFueSB0eXBl
cyBvZiB0dW5lcnMuCgozLiBBZGQgcmFkaW9fZGVlbXBoYXNpcyBzdXBwb3J0LCBpbiBFdXJvcGUg
d2UgdXNlIDUwdXMsIHdpdGggNzV1cyBzb3VuZCBpcyBub3Qgc28gY29vbC4KCjQuIEFkZCBhdWRp
b19zdGFuZGFyZF9mb3JjZSBzdXBwb3J0LiBPbiBtYW55IHR5cGVzIG9mIGNhcmRzIGF1dG9kZXRl
Y3Rpb24gb2YKIGF1ZGlvIHN0YW5kYXJkIGp1c3QgZG9lc24ndCB3b3JrLCBteSByZXNlYXJjaCBp
biB0aGlzIHNob3dzIHRoYXQgaXQgY291bGQgYmUKIGp1c3QgaW4gd3JvbmcgcmVnaXN0ZXJzIHNl
dHRpbmdzIG9yIGluIGRldGVjdGlvbiBhbGdvcml0aG0sIHNvIGlmIHdlIHdhbnQgdG8KIGhhdmUg
YXVkaW8gb24gc3VjaCBicm9rZW4gdHVuZXJzIHdlIGhhdmUgdG8gZm9yY2UgYXVkaW8gc3RhbmRh
cmQsIHRoaXMgaXMgZG9uZQogaW4gaW5wdXRfY2hhbmdlIGFuZCBzaG91bGQgbm90IGludHJvZHVj
ZSBhbnkgcmVncmVzc2lvbiwgaSB0ZXN0ZWQgdGhpcyBiZWhhdmlvcgogb24gY2FyZCB3aXRoIHdv
cmtpbmcgYXV0b2RldGVjdGlvbiBMZWFkdGVrIERWUjMyMDBIX3hjNDAwMCBhbmQgd2l0aCBub3Qg
d29ya2luZwogRFZSMzIwMEhfeGMzMDI4LCBmaXJzdCBjYXJkIGhhcyBhdWRpbyBldmVuIHdpdGgg
cHJldmlvdXNlIGNvZGUsIGJ1dCB4YzMwMjgKIChvbGRlciBtb2RlbCkgaGFzIG5vIGF1ZGlvLCB0
byBnZXQgYXVkaW8gc3VwcG9ydCBpdCByZXF1aXJlIHRvIHNldCBBVURfU1RBTkRBUkQKIHJlZ2lz
dGVyLCBvZiBjb3Vyc2UgZm9yY2VkIG1vZGUgaXMgYXZhaWxhYmxlIGluIGRyaXZlciBsZXZlbCAo
cHZyMTUwX3dvcmthcm91bmQpCiBvciBhcyBvcHRpb24gdG8gbW9kdWxlLgogCjUuIEltcHJvdmUg
Zm9ybWF0IGRldGVjdGlvbiBhcyB3cml0ZW4gaW4gY3gyNTg0MCBkYXRhc2hlZXQsIHRoaXMgaXMg
ZG9uZSBpbgogY3gyMzg4NV9pbml0aWFsaXplIGFuZCBpbiBpbnB1dF9jaGFuZ2UgZnVuY3Rpb25z
LgogSW4gaW5pdCBpdCBpcyBuZWNlc2FyeSB0byByZXNldCB0dW5lciBhdXRvZGV0ZWN0aW9uIGFu
ZCB0dW5lci4KIEluIGlucHV0IGNoYW5nZSBpIGp1c3QgYWRkIG90aGVycyBmb3JtYXRzIGZyb20g
ZGF0YXNoZWV0LCBwcmV2aW91c2UgY29kZSB3YXMKIGp1c3QgZm9yIE5UU0MgZGV0ZWN0aW9uLCBh
bmQgaXQgaXMgYWxzbyBuZWNlc2FyeSB0byByZXNldCBtaWNyb2NvbnRyb2xlciwgYnV0CiBvbmx5
IGlmIGl0IGlzIHJ1bm5pbmcuCgotLS0KZGlmZiAtTmF1cnAgYS9kcml2ZXJzL21lZGlhL3ZpZGVv
L2N4MjU4NDAvY3gyNTg0MC1hdWRpby5jIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDI1ODQwL2N4
MjU4NDAtYXVkaW8uYwotLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MjU4NDAvY3gyNTg0MC1h
dWRpby5jCTIwMTItMDEtMDUgMDA6NTU6NDQuMDAwMDAwMDAwICswMTAwCisrKyBiL2RyaXZlcnMv
bWVkaWEvdmlkZW8vY3gyNTg0MC9jeDI1ODQwLWF1ZGlvLmMJMjAxMi0wMS0xNCAxNjowNTozOC42
MTYzNjY3NDcgKzAxMDAKQEAgLTQ0NiwxNCArNDQ2LDQ1IEBAIHZvaWQgY3gyNTg0MF9hdWRpb19z
ZXRfcGF0aChzdHJ1Y3QgaTJjX2MKIAogCQkvKiBNdXRlIGV2ZXJ5dGhpbmcgdG8gcHJldmVudCB0
aGUgUEZGVCEgKi8KIAkJY3gyNTg0MF93cml0ZShjbGllbnQsIDB4OGQzLCAweDFmKTsKKwkJY3gy
NTg0MF93cml0ZShjbGllbnQsIDB4OGUzLCAweDAzKTsKIAotCQlpZiAoc3RhdGUtPmF1ZF9pbnB1
dCA9PSBDWDI1ODQwX0FVRElPX1NFUklBTCkgeworCQlpZiAoaXNfY3gyMzF4eChzdGF0ZSkgfHwg
aXNfY3gyMzg4eChzdGF0ZSkpIHsKKwkJCS8qIFBhdGgxIHJlcXVpcmUgZGlmZmVyZW50IEdQSU8w
IHBpbiBtdXggKi8KKwkJCWlmICgoc3RhdGUtPmF1ZF9pbnB1dCA9PSBDWDI1ODQwX0FVRElPNikg
fHwKKwkJCSAgICAoc3RhdGUtPmF1ZF9pbnB1dCA9PSBDWDI1ODQwX0FVRElPNykpIHsKKwkJCQlj
eDI1ODQwX3dyaXRlKGNsaWVudCwgMHgxMjQsIDB4MDApOworCQkJfSBlbHNlIHsKKwkJCQkvKiBB
dWRpbyBjaGFubmVsIDEgc3JjIDogUGFyYWxsZWwgMSAqLworCQkJCWN4MjU4NDBfd3JpdGUoY2xp
ZW50LCAweDEyNCwgMHgwMyk7CisJCQl9CisKKwkJCS8qIFNlbGVjdCBBRkUgY2xvY2sgcGFkIG91
dHB1dCBzb3VyY2UgKi8KKwkJCWlmIChpc19jeDIzODh4KHN0YXRlKSkKKwkJCQljeDI1ODQwX3dy
aXRlKGNsaWVudCwgMHgxNDQsIDB4MDUpOworCisJCQkvKiBJMlNfSU5fQ1RMOiBJMlNfSU5fU09O
WV9NT0RFLCBMRUZUIFNBTVBMRSBvbiBXUz0xICovCisJCQljeDI1ODQwX3dyaXRlKGNsaWVudCwg
MHg5MTQsIDB4YTApOworCisJCQkvKiBJMlNfT1VUX0NUTDoKKwkJCSAqIEkyU19JTl9TT05ZX01P
REUsIExFRlQgU0FNUExFIG9uIFdTPTEKKwkJCSAqIEkyU19PVVRfTUFTVEVSX01PREUgPSBNYXN0
ZXIKKwkJCSAqLworCQkJY3gyNTg0MF93cml0ZShjbGllbnQsIDB4OTE4LCAweGEwKTsKKwkJCWN4
MjU4NDBfd3JpdGUoY2xpZW50LCAweDkxOSwgMHgwMSk7CisKKwkJCWlmICgoc3RhdGUtPmF1ZF9p
bnB1dCA9PSBDWDI1ODQwX0FVRElPNikgfHwKKwkJCSAgICAoc3RhdGUtPmF1ZF9pbnB1dCA9PSBD
WDI1ODQwX0FVRElPNykpIHsKKwkJCQljeDI1ODQwX3dyaXRlNChjbGllbnQsIDB4OTEwLCAwKTsK
KwkJCQljeDI1ODQwX3dyaXRlNChjbGllbnQsIDB4OGQwLCAweDAwMDYzMDczKTsKKwkJCQkvKiBS
ZXNldCBwYXRoMSB2b2x1bWUgY29udHJvbCAqLworCQkJCWN4MjU4NDBfd3JpdGU0KGNsaWVudCwg
MHg4ZDQsIDB4N2ZmZjAwMjQpOworCQkJfSBlbHNlIHsgLyogZGVmYXVsdCBmb3IgYWxsIHNvdXJj
ZXMsIG5vdCBvbmx5IEFVRElPOCAqLworCQkJCWN4MjU4NDBfd3JpdGU0KGNsaWVudCwgMHg5MTAs
IDB4MTJiMDAwYzkpOworCQkJCWN4MjU4NDBfd3JpdGU0KGNsaWVudCwgMHg4ZDAsIDB4MWYwNjM4
NzApOworCQkJfQorCQl9IGVsc2UgaWYgKHN0YXRlLT5hdWRfaW5wdXQgPT0gQ1gyNTg0MF9BVURJ
T19TRVJJQUwpIHsKIAkJCS8qIFNldCBQYXRoMSB0byBTZXJpYWwgQXVkaW8gSW5wdXQgKi8KIAkJ
CWN4MjU4NDBfd3JpdGU0KGNsaWVudCwgMHg4ZDAsIDB4MDEwMTEwMTIpOwotCi0JCQkvKiBUaGUg
bWljcm9jb250cm9sbGVyIHNob3VsZCBub3QgYmUgc3RhcnRlZCBmb3IgdGhlCi0JCQkgKiBub24t
dHVuZXIgaW5wdXRzOiBhdXRvZGV0ZWN0aW9uIGlzIHNwZWNpZmljIGZvcgotCQkJICogVFYgYXVk
aW8uICovCiAJCX0gZWxzZSB7CiAJCQkvKiBTZXQgUGF0aDEgdG8gQW5hbG9nIERlbW9kIE1haW4g
Q2hhbm5lbCAqLwogCQkJY3gyNTg0MF93cml0ZTQoY2xpZW50LCAweDhkMCwgMHgxZjA2Mzg3MCk7
CkBAIC00NjMsNyArNDk0LDEyIEBAIHZvaWQgY3gyNTg0MF9hdWRpb19zZXRfcGF0aChzdHJ1Y3Qg
aTJjX2MKIAlzZXRfYXVkY2xrX2ZyZXEoY2xpZW50LCBzdGF0ZS0+YXVkY2xrX2ZyZXEpOwogCiAJ
aWYgKCFpc19jeDI1ODN4KHN0YXRlKSkgewotCQlpZiAoc3RhdGUtPmF1ZF9pbnB1dCAhPSBDWDI1
ODQwX0FVRElPX1NFUklBTCkgeworCQkvKiBUaGUgbWljcm9jb250cm9sbGVyIHNob3VsZCBub3Qg
YmUgc3RhcnRlZCBmb3IgdGhlCisJCSAqIG5vbi10dW5lciBpbnB1dHM6IGF1dG9kZXRlY3Rpb24g
aXMgc3BlY2lmaWMgZm9yCisJCSAqIFRWIGF1ZGlvLiAqLworCQlpZiAoKHN0YXRlLT5hdWRfaW5w
dXQgIT0gQ1gyNTg0MF9BVURJT19TRVJJQUwpICYmCisJCSAgICAoc3RhdGUtPmF1ZF9pbnB1dCAh
PSBDWDI1ODQwX0FVRElPNikgJiYKKwkJICAgIChzdGF0ZS0+YXVkX2lucHV0ICE9IENYMjU4NDBf
QVVESU83KSkgewogCQkJLyogV2hlbiB0aGUgbWljcm9jb250cm9sbGVyIGRldGVjdHMgdGhlCiAJ
CQkgKiBhdWRpbyBmb3JtYXQsIGl0IHdpbGwgdW5tdXRlIHRoZSBsaW5lcyAqLwogCQkJY3gyNTg0
MF9hbmRfb3IoY2xpZW50LCAweDgwMywgfjB4MTAsIDB4MTApOwpAQCAtNDcxLDEwICs1MDcsNiBA
QCB2b2lkIGN4MjU4NDBfYXVkaW9fc2V0X3BhdGgoc3RydWN0IGkyY19jCiAKIAkJLyogZGVhc3Nl
cnQgc29mdCByZXNldCAqLwogCQljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4ODEwLCB+MHgxLCAw
eDAwKTsKLQotCQkvKiBFbnN1cmUgdGhlIGNvbnRyb2xsZXIgaXMgcnVubmluZyB3aGVuIHdlIGV4
aXQgKi8KLQkJaWYgKGlzX2N4MjM4OHgoc3RhdGUpIHx8IGlzX2N4MjMxeHgoc3RhdGUpKQotCQkJ
Y3gyNTg0MF9hbmRfb3IoY2xpZW50LCAweDgwMywgfjB4MTAsIDB4MTApOwogCX0KIH0KIApkaWZm
IC1OYXVycCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gyNTg0MC9jeDI1ODQwLWNvcmUuYyBiL2Ry
aXZlcnMvbWVkaWEvdmlkZW8vY3gyNTg0MC9jeDI1ODQwLWNvcmUuYwotLS0gYS9kcml2ZXJzL21l
ZGlhL3ZpZGVvL2N4MjU4NDAvY3gyNTg0MC1jb3JlLmMJMjAxMi0wMS0xNCAxODowMjo0MS45Njgz
NjY3NDcgKzAxMDAKKysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDI1ODQwL2N4MjU4NDAtY29y
ZS5jCTIwMTItMDEtMTQgMTg6MDM6MzMuMDI0MzY2NzQ2ICswMTAwCkBAIC03MywxMSArNzMsMTgg
QEAgTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwogI2RlZmluZSBDWDI1ODQwX0lSX0lSUUVOX1JFRwkw
eDIxNAogCiBzdGF0aWMgaW50IGN4MjU4NDBfZGVidWc7Ci0KLW1vZHVsZV9wYXJhbV9uYW1lZChk
ZWJ1ZyxjeDI1ODQwX2RlYnVnLCBpbnQsIDA2NDQpOwotCittb2R1bGVfcGFyYW1fbmFtZWQoZGVi
dWcsIGN4MjU4NDBfZGVidWcsIGludCwgMDY0NCk7CiBNT0RVTEVfUEFSTV9ERVNDKGRlYnVnLCAi
RGVidWdnaW5nIG1lc3NhZ2VzIFswPU9mZiAoZGVmYXVsdCkgMT1Pbl0iKTsKIAorc3RhdGljIHVu
c2lnbmVkIGludCByYWRpb19kZWVtcGhhc2lzID0gMDsKK21vZHVsZV9wYXJhbShyYWRpb19kZWVt
cGhhc2lzLCBpbnQsIDA2NDQpOworTU9EVUxFX1BBUk1fREVTQyhyYWRpb19kZWVtcGhhc2lzLCAi
UmFkaW8gZGVlbXBoYXNpcyB0aW1lIGNvbnN0YW50ICIKKwkJCQkgICAiWzA9NzV1cyAoVVNBKSAx
PTUwdXMgKGVsc2V3aGVyZSldIik7CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgYXVkaW9fc3RhbmRh
cmRfZm9yY2UgPSAwOworbW9kdWxlX3BhcmFtKGF1ZGlvX3N0YW5kYXJkX2ZvcmNlLCBpbnQsIDA2
NDQpOworTU9EVUxFX1BBUk1fREVTQyhhdWRpb19zdGFuZGFyZF9mb3JjZSwgIkZvcmNlIGF1ZGlv
IHN0YW5kYXJkIGZvciB0dW5lcnMgd2l0aCBicm9rZW4iCisJCQkJICAgICAgICJtaWNyb2NvbnRy
b2xlciBhdXRvZGV0ZWN0aW9uIFswPU9mZiAoZGVmYXVsdCkgMT1UViAyPVRWK0ZNXSIpOwogCiAv
KiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLSAqLwogCkBAIC00NzQsNyArNDgxLDcgQEAgc3RhdGljIHZvaWQgY3gy
Mzg4NV9pbml0aWFsaXplKHN0cnVjdCBpMgogCWN4MjU4NDBfYW5kX29yKGNsaWVudCwgMHgxMDIs
IH4weDAxLCAweDAxKTsKIAljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4MTAyLCB+MHgwMSwgMHgw
MCk7CiAKLQkvKiBTdG9wIG1pY3JvY29udHJvbGxlciAqLworCS8qIDIuIFN0b3AgbWljcm9jb250
cm9sbGVyICovCiAJY3gyNTg0MF9hbmRfb3IoY2xpZW50LCAweDgwMywgfjB4MTAsIDB4MDApOwog
CiAJLyogRElGIGluIHJlc2V0PyAqLwpAQCAtNTM2LDEyICs1NDMsNiBAQCBzdGF0aWMgdm9pZCBj
eDIzODg1X2luaXRpYWxpemUoc3RydWN0IGkyCiAJY3gyNTg0MF93cml0ZTQoY2xpZW50LCAweDEw
YywgMHgwMDJiZTJjOSk7CiAJY3gyNTg0MF93cml0ZTQoY2xpZW50LCAweDEwOCwgMHgwMDAwMDQw
Zik7CiAKLQkvKiBMdW1hICovCi0JY3gyNTg0MF93cml0ZTQoY2xpZW50LCAweDQxNCwgMHgwMDEw
N2QxMik7Ci0KLQkvKiBDaHJvbWEgKi8KLQljeDI1ODQwX3dyaXRlNChjbGllbnQsIDB4NDIwLCAw
eDNkMDA4MjgyKTsKLQogCS8qCiAJICogQXV4IFBMTAogCSAqIEluaXRpYWwgc2V0dXAgZm9yIGF1
ZGlvIHNhbXBsZSBjbG9jazoKQEAgLTU4NiwxMiArNTg3LDYgQEAgc3RhdGljIHZvaWQgY3gyMzg4
NV9pbml0aWFsaXplKHN0cnVjdCBpMgogCS8qIFZJTjEgJiBWSU41ICovCiAJY3gyNTg0MF93cml0
ZShjbGllbnQsIDB4MTAzLCAweDExKTsKIAotCS8qIEVuYWJsZSBmb3JtYXQgYXV0byBkZXRlY3Qg
Ki8KLQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg0MDAsIDApOwotCS8qIEZhc3Qgc3ViY2hyb21h
IGxvY2sgKi8KLQkvKiBXaGl0ZSBjcnVzaCwgQ2hyb21hIEFHQyAmIENocm9tYSBLaWxsZXIgZW5h
YmxlZCAqLwotCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDQwMSwgMHhlOCk7Ci0KIAkvKiBTZWxl
Y3QgQUZFIGNsb2NrIHBhZCBvdXRwdXQgc291cmNlICovCiAJY3gyNTg0MF93cml0ZShjbGllbnQs
IDB4MTQ0LCAweDA1KTsKIApAQCAtNjA0LDcgKzU5OSwxNCBAQCBzdGF0aWMgdm9pZCBjeDIzODg1
X2luaXRpYWxpemUoc3RydWN0IGkyCiAJY3gyNTg0MF93cml0ZShjbGllbnQsIDB4MTYwLCAweDFk
KTsKIAljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHgxNjQsIDB4MDApOwogCi0JLyogRG8gdGhlIGZp
cm13YXJlIGxvYWQgaW4gYSB3b3JrIGhhbmRsZXIgdG8gcHJldmVudC4KKwkvKiBFbmFibGUgZm9y
bWF0IGF1dG8gZGV0ZWN0ICovCisJY3gyNTg0MF93cml0ZShjbGllbnQsIDB4NDAwLCAwKTsKKwor
CS8qIDQuIFJlc2V0IHR1bmVyIGF1dG9kZXRlY3Rpb24gKi8KKwljeDI1ODQwX2FuZF9vcihjbGll
bnQsIDB4MTNjLCB+MHgwMSwgMHgwMSk7CisJY3gyNTg0MF9hbmRfb3IoY2xpZW50LCAweDEzYywg
fjB4MDEsIDB4MDApOworCisJLyogNS4gRG8gdGhlIGZpcm13YXJlIGxvYWQgaW4gYSB3b3JrIGhh
bmRsZXIgdG8gcHJldmVudC4KIAkgICBPdGhlcndpc2UgdGhlIGtlcm5lbCBpcyBibG9ja2VkIHdh
aXRpbmcgZm9yIHRoZQogCSAgIGJpdC1iYW5naW5nIGkyYyBpbnRlcmZhY2UgdG8gZmluaXNoIHVw
bG9hZGluZyB0aGUKIAkgICBmaXJtd2FyZS4gKi8KQEAgLTYxNywxMyArNjE5LDMyIEBAIHN0YXRp
YyB2b2lkIGN4MjM4ODVfaW5pdGlhbGl6ZShzdHJ1Y3QgaTIKIAlmaW5pc2hfd2FpdCgmc3RhdGUt
PmZ3X3dhaXQsICZ3YWl0KTsKIAlkZXN0cm95X3dvcmtxdWV1ZShxKTsKIAorCS8qIDcuIFJlc2V0
IGFuZCBpbml0aWFsaXplIHZpZGVvIGRlY29kZXIgKi8KKwljeDI1ODQwX3dyaXRlNChjbGllbnQs
IDB4NGE0LCAweDgwMDApOworCWN4MjU4NDBfd3JpdGU0KGNsaWVudCwgMHg0YTQsIDApOworCWN4
MjU4NDBfd3JpdGUoY2xpZW50LCAweDQwMiwgMHgwMCk7CisKKwkvKiA4LiBXaGl0ZSBjcnVzaCwg
Q2hyb21hIEFHQyAmIENocm9tYSBLaWxsZXIgZW5hYmxlZC4KKwkgKiBGcm9tIGRhdGFzaGVldCBh
bmQgc3BvdGVkIGZyb20gTGVhZHRlayBkcml2ZXJzIHdlCisJICogc2hvdWxkIG5vdCBzZXQgRmFz
dCBMb2NrIGFuZCBBdXRvIENocm9tYSBMb2NrIFNwZWVkLgorCSAqLworCWN4MjU4NDBfd3JpdGUo
Y2xpZW50LCAweDQwMSwgMHhlMCk7CisKKwkvKiBMdW1hICovCisJY3gyNTg0MF93cml0ZTQoY2xp
ZW50LCAweDQxNCwgMHgwMDEwN2QxMik7CisKKwkvKiBDaHJvbWEgKi8KKwljeDI1ODQwX3dyaXRl
NChjbGllbnQsIDB4NDIwLCAweDNkMDA4MjgyKTsKKwogCWN4MjU4NDBfc3RkX3NldHVwKGNsaWVu
dCk7CiAKIAkvKiAocmUpc2V0IGlucHV0ICovCiAJc2V0X2lucHV0KGNsaWVudCwgc3RhdGUtPnZp
ZF9pbnB1dCwgc3RhdGUtPmF1ZF9pbnB1dCk7CiAKLQkvKiBzdGFydCBtaWNyb2NvbnRyb2xsZXIg
Ki8KLQljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4ODAzLCB+MHgxMCwgMHgxMCk7CisJLyogc3Rh
cnQgbWljcm9jb250cm9sbGVyIG9ubHkgZm9yIHR1bmVyIGlucHV0cyAqLworCWlmICgoc3RhdGUt
PmF1ZF9pbnB1dCAhPSBDWDI1ODQwX0FVRElPNikgJiYKKwkgICAgKHN0YXRlLT5hdWRfaW5wdXQg
IT0gQ1gyNTg0MF9BVURJTzcpKQorCQljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4ODAzLCB+MHgx
MCwgMHgxMCk7CiAKIAkvKiBEaXNhYmxlIGFuZCBjbGVhciB2aWRlbyBpbnRlcnJ1cHRzIC0gd2Ug
ZG9uJ3QgdXNlIHRoZW0gKi8KIAljeDI1ODQwX3dyaXRlNChjbGllbnQsIENYMjU4NDBfVklEX0lO
VF9TVEFUX1JFRywgMHhmZmZmZmZmZik7CkBAIC02NzgsNiArNjk5LDcgQEAgc3RhdGljIHZvaWQg
Y3gyMzF4eF9pbml0aWFsaXplKHN0cnVjdCBpMgogCiAJLyogRW5hYmxlIGZvcm1hdCBhdXRvIGRl
dGVjdCAqLwogCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDQwMCwgMCk7CisKIAkvKiBGYXN0IHN1
YmNocm9tYSBsb2NrICovCiAJLyogV2hpdGUgY3J1c2gsIENocm9tYSBBR0MgJiBDaHJvbWEgS2ls
bGVyIGVuYWJsZWQgKi8KIAljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg0MDEsIDB4ZTgpOwpAQCAt
ODY2LDcyICs4ODgsMTEyIEBAIHN0YXRpYyB2b2lkIGlucHV0X2NoYW5nZShzdHJ1Y3QgaTJjX2Ns
aWUKIHsKIAlzdHJ1Y3QgY3gyNTg0MF9zdGF0ZSAqc3RhdGUgPSB0b19zdGF0ZShpMmNfZ2V0X2Ns
aWVudGRhdGEoY2xpZW50KSk7CiAJdjRsMl9zdGRfaWQgc3RkID0gc3RhdGUtPnN0ZDsKKwl1OCBm
bXQgPSBjeDI1ODQwX3JlYWQoY2xpZW50LCAweDQwRCk7CisJaW50IGh3X2ZpeCA9IChhdWRpb19z
dGFuZGFyZF9mb3JjZSA+IHN0YXRlLT5wdnIxNTBfd29ya2Fyb3VuZCkgPworCQkJYXVkaW9fc3Rh
bmRhcmRfZm9yY2UgOiBzdGF0ZS0+cHZyMTUwX3dvcmthcm91bmQ7CiAKIAkvKiBGb2xsb3cgc3Rl
cCA4YyBhbmQgOGQgb2Ygc2VjdGlvbiAzLjE2IGluIHRoZSBjeDI1ODQwIGRhdGFzaGVldCAqLwog
CWlmIChzdGQgJiBWNEwyX1NURF9TRUNBTSkgewogCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg0
MDIsIDApOwotCX0KLQllbHNlIHsKKwl9IGVsc2UgewogCQljeDI1ODQwX3dyaXRlKGNsaWVudCwg
MHg0MDIsIDB4MDQpOwogCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg0OWYsIChzdGQgJiBWNEwy
X1NURF9OVFNDKSA/IDB4MTQgOiAweDExKTsKIAl9Ci0JY3gyNTg0MF9hbmRfb3IoY2xpZW50LCAw
eDQwMSwgfjB4NjAsIDApOwotCWN4MjU4NDBfYW5kX29yKGNsaWVudCwgMHg0MDEsIH4weDYwLCAw
eDYwKTsKKworCS8qIFN0ZXAgOS4gSW1wcm92ZSBmb3JtYXQgZGV0ZWN0aW9uICovCisJaWYgKCgo
Zm10ICYgMHgwZikgPiAweDMpIHx8CisJICAgICgoZm10ICYgMHgwZikgPCAweDkpKSB7CisJCS8q
IFN3aXRjaCB0byBOVFNDIGFuZCBiYWNrICovCisJCXU4IHZhbCA9IGN4MjU4NDBfcmVhZChjbGll
bnQsIDB4NDAwKTsKKwkJY3gyNTg0MF9hbmRfb3IoY2xpZW50LCAweDQwMCwgfjB4MGYsIDB4MDEp
OworCQkvKiBEaXNhYmxlIExDT01CXzNMTl9FTiBhbmQgTENPTUJfMkxOX0VOICovCisJCWN4MjU4
NDBfYW5kX29yKGNsaWVudCwgMHg0N2IsIH4weDA2LCAwKTsKKwkJY3gyNTg0MF9hbmRfb3IoY2xp
ZW50LCAweDQwMCwgfjB4MGYsICh2YWwgJiAweDBmKSk7CisKKwkJLyogVG9nZ2xlIENBR0NFTiBh
bmQgQ0tJTExFTiAqLworCQljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4NDAxLCB+MHg2MCwgMCk7
CisJCWN4MjU4NDBfYW5kX29yKGNsaWVudCwgMHg0MDEsIH4weDYwLCAweDYwKTsKKwl9IGVsc2Ug
aWYgKChmbXQgJiAweDBmKSA9PSAweDkpIHsKKwkJLyogVG9nZ2xlIENLSUxMRU4gKi8KKwkJY3gy
NTg0MF9hbmRfb3IoY2xpZW50LCAweDQwMSwgfjB4MjAsIDApOworCQljeDI1ODQwX2FuZF9vcihj
bGllbnQsIDB4NDAxLCB+MHgyMCwgMHgyMCk7CisJCS8qIFN0YW5kYXJkIGF1dG9kZXRlY3Rpb24g
Ki8KKwkJY3gyNTg0MF9hbmRfb3IoY2xpZW50LCAweDQwMCwgfjB4MGYsIDB4MDApOworCX0gZWxz
ZSB7CisJCS8qIFRvZ2dsZSBDQUdDRU4gYW5kIENLSUxMRU4gKi8KKwkJY3gyNTg0MF9hbmRfb3Io
Y2xpZW50LCAweDQwMSwgfjB4NjAsIDApOworCQljeDI1ODQwX2FuZF9vcihjbGllbnQsIDB4NDAx
LCB+MHg2MCwgMHg2MCk7CisJfQogCiAJLyogRG9uJ3Qgd3JpdGUgaW50byBhdWRpbyByZWdpc3Rl
cnMgb24gY3gyNTgzeCBjaGlwcyAqLwogCWlmIChpc19jeDI1ODN4KHN0YXRlKSkKIAkJcmV0dXJu
OwogCisJLyogVG9nZ2xlIG1pY3JvY29udHJvbGxlciBvbmx5IHdoZW4gcnVubmluZyAqLworCWlm
IChjeDI1ODQwX3JlYWQoY2xpZW50LCAweDgwMykgJiAweDEwKSB7CisJCWN4MjU4NDBfYW5kX29y
KGNsaWVudCwgMHg4MDMsIH4weDEwLCAweDAwKTsKKwkJbXNsZWVwKDEpOworCQljeDI1ODQwX2Fu
ZF9vcihjbGllbnQsIDB4ODAzLCB+MHgxMCwgMHgxMCk7CisJfQorCiAJY3gyNTg0MF9hbmRfb3Io
Y2xpZW50LCAweDgxMCwgfjB4MDEsIDEpOwogCisJLyogVXNlIGRlZmF1bHQgYXVkaW8gZm9ybWF0
IGNvbnRyb2wgKi8KKwljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MGIsIDApOworCiAJaWYgKHN0
YXRlLT5yYWRpbykgewotCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MDgsIDB4ZjkpOwotCQlj
eDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MGIsIDB4MDApOwotCX0KLQllbHNlIGlmIChzdGQgJiBW
NEwyX1NURF81MjVfNjApIHsKLQkJLyogQ2VydGFpbiBIYXVwcGF1Z2UgUFZSMTUwIG1vZGVscyBo
YXZlIGEgaGFyZHdhcmUgYnVnCi0JCSAgIHRoYXQgY2F1c2VzIGF1ZGlvIHRvIGRyb3Agb3V0LiBG
b3IgdGhlc2UgbW9kZWxzIHRoZQotCQkgICBhdWRpbyBzdGFuZGFyZCBtdXN0IGJlIHNldCBleHBs
aWNpdGx5LgotCQkgICBUbyBiZSBwcmVjaXNlOiBpdCBhZmZlY3RzIGNhcmRzIHdpdGggdHVuZXIg
bW9kZWxzCi0JCSAgIDg1LCA5OSBhbmQgMTEyIChtb2RlbCBudW1iZXJzIGZyb20gdHZlZXByb20p
LiAqLwotCQlpbnQgaHdfZml4ID0gc3RhdGUtPnB2cjE1MF93b3JrYXJvdW5kOwotCi0JCWlmIChz
dGQgPT0gVjRMMl9TVERfTlRTQ19NX0pQKSB7Ci0JCQkvKiBKYXBhbiB1c2VzIEVJQUogYXVkaW8g
c3RhbmRhcmQgKi8KLQkJCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDgwOCwgaHdfZml4ID8gMHgy
ZiA6IDB4ZjcpOwotCQl9IGVsc2UgaWYgKHN0ZCA9PSBWNEwyX1NURF9OVFNDX01fS1IpIHsKLQkJ
CS8qIFNvdXRoIEtvcmVhIHVzZXMgQTIgYXVkaW8gc3RhbmRhcmQgKi8KLQkJCWN4MjU4NDBfd3Jp
dGUoY2xpZW50LCAweDgwOCwgaHdfZml4ID8gMHgzZiA6IDB4ZjgpOwotCQl9IGVsc2UgewotCQkJ
LyogT3RoZXJzIHVzZSB0aGUgQlRTQyBhdWRpbyBzdGFuZGFyZCAqLwotCQkJY3gyNTg0MF93cml0
ZShjbGllbnQsIDB4ODA4LCBod19maXggPyAweDFmIDogMHhmNik7Ci0JCX0KLQkJY3gyNTg0MF93
cml0ZShjbGllbnQsIDB4ODBiLCAweDAwKTsKLQl9IGVsc2UgaWYgKHN0ZCAmIFY0TDJfU1REX1BB
TCkgewotCQkvKiBBdXRvZGV0ZWN0IGF1ZGlvIHN0YW5kYXJkIGFuZCBhdWRpbyBzeXN0ZW0gKi8K
KwkJLyogRGlzYWJsZSBmbV9kZXZpYXRpb24sIHNldCBkZWVtcGhhc2lzLCBkb24ndCBtdXRlIGFu
ZCBwcmVmZXIgc3RlcmVvICovCisJCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDgwOSwgcmFkaW9f
ZGVlbXBoYXNpcyA/IDB4MjQgOiAweDA0KTsKKwkJLyogRm9yIEZNIG1vZGUgaHdfZml4IGlzIG5v
dCBuZWNlc3NhcnkgKi8KKwkJY3gyNTg0MF93cml0ZShjbGllbnQsIDB4ODA4LCAoaHdfZml4ID4g
MSkgPyAweGVmIDogMHhmOSk7CisJfSBlbHNlIGlmIChzdGQgPT0gVjRMMl9TVERfTlRTQ19NX0pQ
KSB7CisJCS8qIEphcGFuIHVzZXMgRUlBSiBhdWRpbyBzdGFuZGFyZCAqLworCQljeDI1ODQwX3dy
aXRlKGNsaWVudCwgMHg4MDgsIGh3X2ZpeCA/IDB4MmYgOiAweGY3KTsKKwl9IGVsc2UgaWYgKHN0
ZCA9PSBWNEwyX1NURF9OVFNDX01fS1IpIHsKKwkJLyogU291dGggS29yZWEgdXNlcyBBMiBhdWRp
byBzdGFuZGFyZCAqLworCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MDgsIGh3X2ZpeCA/IDB4
M2YgOiAweGY4KTsKKwl9IGVsc2UgaWYgKHN0ZCAmIChWNEwyX1NURF81MjVfNjAgfCBWNEwyX1NU
RF9QQUxfTiB8IFY0TDJfU1REX1BBTF9OYykpIHsKKwkJLyogTlRTQywgUEFMLTYwLCBQQUwtTSBh
bmQgUEFMLU4gdXNlcyBCVFNDIGF1ZGlvIHN0YW5kYXJkICovCisJCWN4MjU4NDBfd3JpdGUoY2xp
ZW50LCAweDgwOCwgaHdfZml4ID8gMHgxZiA6IDB4ZjYpOworCX0gZWxzZSBpZiAoKHN0ZCAmIChW
NEwyX1NURF9QQUxfQkcgfCBWNEwyX1NURF9QQUxfSCkpICYmCisJCSAgICEoc3RkICYgVjRMMl9T
VERfUEFMX0RLKSAmJgorCQkgICAhKHN0ZCAmIFY0TDJfU1REX1BBTF9JKSkgeworCQkvKiBBMi1C
RyAqLworCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MDgsIGh3X2ZpeCA/IDB4NGYgOiAweGYw
KTsKKwl9IGVsc2UgaWYgKCEoc3RkICYgKFY0TDJfU1REX1BBTF9CRyB8IFY0TDJfU1REX1BBTF9I
KSkgJiYKKwkJICAgIChzdGQgJiBWNEwyX1NURF9QQUxfREspICYmCisJCSAgICEoc3RkICYgVjRM
Ml9TVERfUEFMX0kpKSB7CisJCS8qIEEyLURLMSAqLworCQljeDI1ODQwX3dyaXRlKGNsaWVudCwg
MHg4MDgsIGh3X2ZpeCA/IDB4NWYgOiAweGYxKTsKKwl9IGVsc2UgaWYgKCEoc3RkICYgKFY0TDJf
U1REX1BBTF9CRyB8IFY0TDJfU1REX1BBTF9IKSkgJiYKKwkJICAgIShzdGQgJiBWNEwyX1NURF9Q
QUxfREspICYmCisJCSAgICAoc3RkICYgVjRMMl9TVERfUEFMX0kpKSB7CisJCS8qIEExICovCisJ
CWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDgwOCwgaHdfZml4ID8gMHg4ZiA6IDB4ZjQpOworCX0g
ZWxzZSBpZiAoKHN0ZCAmIChWNEwyX1NURF9TRUNBTV9CIHwgVjRMMl9TVERfU0VDQU1fRyB8IFY0
TDJfU1REX1NFQ0FNX0gpKSAmJgorCQkgICAhKHN0ZCAmIFY0TDJfU1REX1NFQ0FNX0RLKSAmJgor
CQkgICAhKHN0ZCAmIChWNEwyX1NURF9TRUNBTV9MIHwgVjRMMl9TVERfU0VDQU1fTEMpKSkgewor
CQkvKiBOSUNBTS1CRyAqLworCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MDgsIGh3X2ZpeCA/
IDB4YWYgOiAweGYwKTsKKwl9IGVsc2UgaWYgKCEoc3RkICYgKFY0TDJfU1REX1NFQ0FNX0IgfCBW
NEwyX1NURF9TRUNBTV9HIHwgVjRMMl9TVERfU0VDQU1fSCkpICYmCisJCSAgICAoc3RkICYgVjRM
Ml9TVERfU0VDQU1fREspICYmCisJCSAgICEoc3RkICYgKFY0TDJfU1REX1NFQ0FNX0wgfCBWNEwy
X1NURF9TRUNBTV9MQykpKSB7CisJCS8qIE5JQ0FNLURLICovCisJCWN4MjU4NDBfd3JpdGUoY2xp
ZW50LCAweDgwOCwgaHdfZml4ID8gMHhiZiA6IDB4ZjEpOworCX0gZWxzZSBpZiAoIShzdGQgJiAo
VjRMMl9TVERfU0VDQU1fQiB8IFY0TDJfU1REX1NFQ0FNX0cgfCBWNEwyX1NURF9TRUNBTV9IKSkg
JiYKKwkJICAgIShzdGQgJiBWNEwyX1NURF9TRUNBTV9ESykgJiYKKwkJICAgIChzdGQgJiAoVjRM
Ml9TVERfU0VDQU1fTCB8IFY0TDJfU1REX1NFQ0FNX0xDKSkpIHsKKwkJLyogNi41IE1IeiBjYXJy
aWVyIHRvIGJlIGludGVycHJldGVkIGFzIFN5c3RlbSBMICovCisJCWN4MjU4NDBfd3JpdGUoY2xp
ZW50LCAweDgwYiwgMHgwOCk7CisJCS8qIE5JQ0FNLUwgKi8KKwkJY3gyNTg0MF93cml0ZShjbGll
bnQsIDB4ODA4LCBod19maXggPyAweGRmIDogMHhmNSk7CisgICAgICAgIH0gZWxzZSBpZiAoc3Rk
ICYgVjRMMl9TVERfU0VDQU0pIHsKKwkJLyogNi41IE1IeiBjYXJyaWVyIHRvIGJlIGF1dG9kZXRl
Y3RlZCAqLworCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MGIsIDB4MTApOwogCQljeDI1ODQw
X3dyaXRlKGNsaWVudCwgMHg4MDgsIDB4ZmYpOwotCQkvKiBTaW5jZSBzeXN0ZW0gUEFMLUwgaXMg
cHJldHR5IG11Y2ggbm9uLWV4aXN0ZW50IGFuZAotCQkgICBub3QgdXNlZCBieSBhbnkgcHVibGlj
IGJyb2FkY2FzdCBuZXR3b3JrLCBmb3JjZQotCQkgICA2LjUgTUh6IGNhcnJpZXIgdG8gYmUgaW50
ZXJwcmV0ZWQgYXMgU3lzdGVtIERLLAotCQkgICB0aGlzIGF2b2lkcyBESyBhdWRpbyBkZXRlY3Rp
b24gaW5zdGFiaWxpdHkgKi8KLQkgICAgICAgY3gyNTg0MF93cml0ZShjbGllbnQsIDB4ODBiLCAw
eDAwKTsKLQl9IGVsc2UgaWYgKHN0ZCAmIFY0TDJfU1REX1NFQ0FNKSB7Ci0JCS8qIEF1dG9kZXRl
Y3QgYXVkaW8gc3RhbmRhcmQgYW5kIGF1ZGlvIHN5c3RlbSAqLworCX0gZWxzZSB7CisJCS8qIEF1
ZGlvIHN0YW5kYXJkIGF1dG9kZXRlY3Rpb24gLSBub3Qgd29ya2luZyBvbiBzb21lIGNhcmRzICov
CiAJCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDgwOCwgMHhmZik7Ci0JCS8qIElmIG9ubHkgb25l
IG9mIFNFQ0FNLURLIC8gU0VDQU0tTCBpcyByZXF1aXJlZCwgdGhlbiBmb3JjZQotCQkgIDYuNU1I
eiBjYXJyaWVyLCBlbHNlIGF1dG9kZXRlY3QgaXQgKi8KLQkJaWYgKChzdGQgJiBWNEwyX1NURF9T
RUNBTV9ESykgJiYKLQkJICAgICEoc3RkICYgKFY0TDJfU1REX1NFQ0FNX0wgfCBWNEwyX1NURF9T
RUNBTV9MQykpKSB7Ci0JCQkvKiA2LjUgTUh6IGNhcnJpZXIgdG8gYmUgaW50ZXJwcmV0ZWQgYXMg
U3lzdGVtIERLICovCi0JCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg4MGIsIDB4MDApOwotCSAg
ICAgICB9IGVsc2UgaWYgKCEoc3RkICYgVjRMMl9TVERfU0VDQU1fREspICYmCi0JCQkgIChzdGQg
JiAoVjRMMl9TVERfU0VDQU1fTCB8IFY0TDJfU1REX1NFQ0FNX0xDKSkpIHsKLQkJCS8qIDYuNSBN
SHogY2FycmllciB0byBiZSBpbnRlcnByZXRlZCBhcyBTeXN0ZW0gTCAqLwotCQkJY3gyNTg0MF93
cml0ZShjbGllbnQsIDB4ODBiLCAweDA4KTsKLQkgICAgICAgfSBlbHNlIHsKLQkJCS8qIDYuNSBN
SHogY2FycmllciB0byBiZSBhdXRvZGV0ZWN0ZWQgKi8KLQkJCWN4MjU4NDBfd3JpdGUoY2xpZW50
LCAweDgwYiwgMHgxMCk7Ci0JICAgICAgIH0KIAl9CiAKIAljeDI1ODQwX2FuZF9vcihjbGllbnQs
IDB4ODEwLCB+MHgwMSwgMCk7CkBAIC05NTAsNyArMTAxMiw3IEBAIHN0YXRpYyBpbnQgc2V0X2lu
cHV0KHN0cnVjdCBpMmNfY2xpZW50ICoKIAl1OCByZWc7CiAKIAl2NGxfZGJnKDEsIGN4MjU4NDBf
ZGVidWcsIGNsaWVudCwKLQkJImRlY29kZXIgc2V0IHZpZGVvIGlucHV0ICVkLCBhdWRpbyBpbnB1
dCAlZFxuIiwKKwkJImRlY29kZXIgc2V0IHZpZGVvIGlucHV0IDB4JXgsIGF1ZGlvIGlucHV0IDB4
JXhcbiIsCiAJCXZpZF9pbnB1dCwgYXVkX2lucHV0KTsKIAogCWlmICh2aWRfaW5wdXQgPj0gQ1gy
NTg0MF9WSU4xX0NIMSkgewpAQCAtMTA0Myw0OSArMTEwNSw2IEBAIHN0YXRpYyBpbnQgc2V0X2lu
cHV0KHN0cnVjdCBpMmNfY2xpZW50ICoKIAljeDI1ODQwX2F1ZGlvX3NldF9wYXRoKGNsaWVudCk7
CiAJaW5wdXRfY2hhbmdlKGNsaWVudCk7CiAKLQlpZiAoaXNfY3gyMzg4eChzdGF0ZSkpIHsKLQkJ
LyogQXVkaW8gY2hhbm5lbCAxIHNyYyA6IFBhcmFsbGVsIDEgKi8KLQkJY3gyNTg0MF93cml0ZShj
bGllbnQsIDB4MTI0LCAweDAzKTsKLQotCQkvKiBTZWxlY3QgQUZFIGNsb2NrIHBhZCBvdXRwdXQg
c291cmNlICovCi0JCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDE0NCwgMHgwNSk7Ci0KLQkJLyog
STJTX0lOX0NUTDogSTJTX0lOX1NPTllfTU9ERSwgTEVGVCBTQU1QTEUgb24gV1M9MSAqLwotCQlj
eDI1ODQwX3dyaXRlKGNsaWVudCwgMHg5MTQsIDB4YTApOwotCi0JCS8qIEkyU19PVVRfQ1RMOgot
CQkgKiBJMlNfSU5fU09OWV9NT0RFLCBMRUZUIFNBTVBMRSBvbiBXUz0xCi0JCSAqIEkyU19PVVRf
TUFTVEVSX01PREUgPSBNYXN0ZXIKLQkJICovCi0JCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDkx
OCwgMHhhMCk7Ci0JCWN4MjU4NDBfd3JpdGUoY2xpZW50LCAweDkxOSwgMHgwMSk7Ci0JfSBlbHNl
IGlmIChpc19jeDIzMXh4KHN0YXRlKSkgewotCQkvKiBBdWRpbyBjaGFubmVsIDEgc3JjIDogUGFy
YWxsZWwgMSAqLwotCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHgxMjQsIDB4MDMpOwotCi0JCS8q
IEkyU19JTl9DVEw6IEkyU19JTl9TT05ZX01PREUsIExFRlQgU0FNUExFIG9uIFdTPTEgKi8KLQkJ
Y3gyNTg0MF93cml0ZShjbGllbnQsIDB4OTE0LCAweGEwKTsKLQotCQkvKiBJMlNfT1VUX0NUTDoK
LQkJICogSTJTX0lOX1NPTllfTU9ERSwgTEVGVCBTQU1QTEUgb24gV1M9MQotCQkgKiBJMlNfT1VU
X01BU1RFUl9NT0RFID0gTWFzdGVyCi0JCSAqLwotCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg5
MTgsIDB4YTApOwotCQljeDI1ODQwX3dyaXRlKGNsaWVudCwgMHg5MTksIDB4MDEpOwotCX0KLQot
CWlmIChpc19jeDIzODh4KHN0YXRlKSAmJiAoKGF1ZF9pbnB1dCA9PSBDWDI1ODQwX0FVRElPNykg
fHwKLQkJKGF1ZF9pbnB1dCA9PSBDWDI1ODQwX0FVRElPNikpKSB7Ci0JCS8qIENvbmZpZ3VyZSBh
dWRpbyBmcm9tIExSMSBvciBMUjIgaW5wdXQgKi8KLQkJY3gyNTg0MF93cml0ZTQoY2xpZW50LCAw
eDkxMCwgMCk7Ci0JCWN4MjU4NDBfd3JpdGU0KGNsaWVudCwgMHg4ZDAsIDB4NjMwNzMpOwotCX0g
ZWxzZQotCWlmIChpc19jeDIzODh4KHN0YXRlKSAmJiAoYXVkX2lucHV0ID09IENYMjU4NDBfQVVE
SU84KSkgewotCQkvKiBDb25maWd1cmUgYXVkaW8gZnJvbSB0dW5lci9zaWYgaW5wdXQgKi8KLQkJ
Y3gyNTg0MF93cml0ZTQoY2xpZW50LCAweDkxMCwgMHgxMmIwMDBjOSk7Ci0JCWN4MjU4NDBfd3Jp
dGU0KGNsaWVudCwgMHg4ZDAsIDB4MWYwNjM4NzApOwotCX0KLQogCXJldHVybiAwOwogfQogCg==
--000e0ce0f30670413704b6815ef1--
