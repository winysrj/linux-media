Return-path: <linux-media-owner@vger.kernel.org>
Received: from moh2-ve1.go2.pl ([193.17.41.186]:47396 "EHLO moh2-ve1.go2.pl"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1752252Ab2JPJIz (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Tue, 16 Oct 2012 05:08:55 -0400
Received: from moh2-ve1.go2.pl (unknown [10.0.0.186])
	by moh2-ve1.go2.pl (Postfix) with ESMTP id EEC4B44C29F
	for <linux-media@vger.kernel.org>; Tue, 16 Oct 2012 11:08:44 +0200 (CEST)
Received: from unknown (unknown [10.0.0.142])
	by moh2-ve1.go2.pl (Postfix) with SMTP
	for <linux-media@vger.kernel.org>; Tue, 16 Oct 2012 11:08:44 +0200 (CEST)
Message-ID: <507D241B.40101@tlen.pl>
Date: Tue, 16 Oct 2012 11:08:43 +0200
From: Wojciech Myrda <vojcek@tlen.pl>
MIME-Version: 1.0
To: Gregor Jasny <gjasny@googlemail.com>
CC: linux-media@vger.kernel.org
Subject: Re: [segfault] running ir-keytable with v4l-utils 0.8.9
References: <507B1879.9020100@tlen.pl> <507D0ACB.6090802@googlemail.com>
In-Reply-To: <507D0ACB.6090802@googlemail.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

W dniu 16.10.2012 09:20, Gregor Jasny pisze:
> Hello,
>
> On 10/14/12 9:54 PM, Wojciech Myrda wrote:
>> On my system I have just installed using bumped Gentoo ebuilds v4l-utils
>> package
>>
>> [ebuild   R    ] media-libs/libv4l-0.8.9::bigvo  0 kB
>> [ebuild   R    ] media-tv/v4l-utils-0.8.9::bigvo  USE="-qt4" 0 kB
>>
>> ebuilds used for bumbing to version 0.8.9:
>> http://gentoo-portage.com/media-libs/libv4l/libv4l-0.8.8
>> http://gentoo-portage.com/media-tv/v4l-utils/v4l-utils-0.8.8-r1
>>
>> However I experienced a segfault trying to run this command:
>> ir-keytable --protocol=rc-6 --device
>> /dev/input/by-id/usb-15c2_0038-event-if00
>
> There seems to be some problems with options or file parsing. Valgrind
> is complaining, too. I'll have a look later.
>
> Is this segfault a regression over an older v4l-utils version?
>
> Thanks,
> Gregor
>

I just started using v4l-utils stuff so I wanted to use most recent
version available, hence I didn't try 0.8.8 previously, but seems
problem is there as well just with different lines of code appearing

mediapc@mediapc ~ $ gdb ir-keytable core
GNU gdb (Gentoo 7.5 p1) 7.5
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later
<http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>...
Reading symbols from /usr/bin/ir-keytable...done.
[New LWP 1094]

warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?
Core was generated by `ir-keytable --protocol=rc-6 --device
/dev/input/by-id/usb-15c2_0038-event-if00'.
Program terminated with signal 11, Segmentation fault.
#0  0x00007f95eaf04410 in __strcpy_chk () from /lib64/libc.so.6
(gdb) bt full
#0  0x00007f95eaf04410 in __strcpy_chk () from /lib64/libc.so.6
No symbol table info available.
#1  0x000000000040365c in strcpy (__src=<optimized out>,
__dest=0x7fff36b958e0 "") at /usr/include/bits/string3.h:105
No locals.
#2  v1_set_hw_protocols (rc_dev=<optimized out>) at keytable.c:744
        fp = <optimized out>
        name = '\000' <repeats 1480 times>, "`G\033\353\225\177", '\000'
<repeats 75 times>,
"p\031\000\000\000\000\000~m\031\000\000\000\000\000~m\031", '\000'
<repeats 13 times>,
"\005\000\000\000\000\000\000\000\000p9\000\000\000\000\000\000\320\071\000\000\000\000\000X\307\071\000\000\000\000\000`\f:\000\000\000\000\000\000p\031\000\000\000\000\000\003",
'\000' <repeats 271 times>,
"@\266<\353\225\177\000\000/\000\000\000\000\000\000\000\215\207\033\353\225\177\000\000\000\000\000\000\000\000\000\000\t\000\000\000\000\000\000\000\021\000\000\000\000\000\000\000\001",
'\000' <repeats 23 times>,
"@b\271\066\377\177\000\000\031\204\033\353\225\177\000\000\001\000\000\000\000\000\000\000X\266<\353\225\177\000\000@b\271\066\377\177\000\000\265F\033\353\225\177",
'\000' <repeats 26 times>...
#3  0x00000000004019af in set_proto (rc_dev=0x7fff36b96900) at
keytable.c:1119
        rc = 0
#4  main (argc=<optimized out>, argv=<optimized out>) at keytable.c:1497
        dev_from_class = <optimized out>
        write_cnt = 0
        fd = 3
        names = 0x0
        rc_dev = {sysfs_name = 0x0, input_name = 0x7f95eb3ce4e0
"@\344<\353\225\177", drv_name = 0x0, keytable_name = 0x100000000
<Address 0x100000000 out of bounds>,
          version = (unknown: 3946637104), type = (SOFTWARE_DECODER |
unknown: 32660), supported = 4196936, current = RC_6}

Regards,
Wojciech
