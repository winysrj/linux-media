Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.renesas.com ([202.234.163.13]:64808 "EHLO
	mail02.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1752837Ab0AEJ3B (ORCPT
	<rfc822;linux-media@vger.kernel.org>); Tue, 5 Jan 2010 04:29:01 -0500
Date: Tue, 05 Jan 2010 18:28:53 +0900
From: Kuninori Morimoto <morimoto.kuninori@renesas.com>
Subject: Re: [PATCH] soc-camera: ov772x: Add buswidth selection flags for
 platform
In-reply-to: <Pine.LNX.4.64.1001050848140.5259@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Cc: Linux-V4L2 <linux-media@vger.kernel.org>
Message-id: <u637ggasq.wl%morimoto.kuninori@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <u8wcdf9r8.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.1001050848140.5259@axis700.grange>
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>


Dear Guennadi

Thank you for checking patch

> Can you explain a bit why this patch is needed? Apart from a slight 
> stylistic improvement and a saving of 4 bytes of platform data per camera 
> instance? Is it going to be needed for some future changes?

This patch is not so important/necessary at once.
 -> for saving of 4 bytes.

> 	if (!is_power_of_2(priv->info->flags & (OV772X_FLAG_8BIT | OV772X_FLAG_10BIT)))
> 		return 0;
> 
> make sense here? Or even just modify your tests above to
(snip)
> Adding a "default:" case just above the "case OV772X_FLAG_10BIT:" line 
> would seem like a good idea to me too.

I understand.

> > +#define OV772X_FLAG_8BIT	(1 << 2) /*  8bit buswidth */
> > +#define OV772X_FLAG_10BIT	(1 << 3) /* 10bit buswidth */

May I suggest here ?
What do you think if it have only 10BIT flag,
and check/operation like this ?

	if (priv->info->flags & OV772X_FLAG_10BIT) {
 		flags |= SOCAM_DATAWIDTH_10;
 	else
 		flags |= SOCAM_DATAWIDTH_8;

This case, below check became not needed,
Does this operation make sense for you ?

> >  	/*
> > -	 * ov772x only use 8 or 10 bit bus width
> > -	 */
> > -	if (SOCAM_DATAWIDTH_10 != priv->info->buswidth &&
> > -	    SOCAM_DATAWIDTH_8  != priv->info->buswidth) {
> > -		dev_err(&client->dev, "bus width error\n");
> > -		return -ENODEV;
> > -	}


Best regards
--
Kuninori Morimoto
 
