Return-path: <linux-media-owner@vger.kernel.org>
Received: from moh2-ve1.go2.pl ([193.17.41.186]:38122 "EHLO moh2-ve1.go2.pl"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1752336Ab2JNTyl (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Sun, 14 Oct 2012 15:54:41 -0400
Received: from moh2-ve1.go2.pl (unknown [10.0.0.186])
	by moh2-ve1.go2.pl (Postfix) with ESMTP id 90BC644C4B7
	for <linux-media@vger.kernel.org>; Sun, 14 Oct 2012 21:54:34 +0200 (CEST)
Received: from unknown (unknown [10.0.0.42])
	by moh2-ve1.go2.pl (Postfix) with SMTP
	for <linux-media@vger.kernel.org>; Sun, 14 Oct 2012 21:54:34 +0200 (CEST)
Message-ID: <507B1879.9020100@tlen.pl>
Date: Sun, 14 Oct 2012 21:54:33 +0200
From: Wojciech Myrda <vojcek@tlen.pl>
MIME-Version: 1.0
To: linux-media@vger.kernel.org
Subject: [segfault] running ir-keytable with v4l-utils 0.8.9
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

On my system I have just installed using bumped Gentoo ebuilds v4l-utils
package

[ebuild   R    ] media-libs/libv4l-0.8.9::bigvo  0 kB
[ebuild   R    ] media-tv/v4l-utils-0.8.9::bigvo  USE="-qt4" 0 kB

ebuilds used for bumbing to version 0.8.9:
http://gentoo-portage.com/media-libs/libv4l/libv4l-0.8.8
http://gentoo-portage.com/media-tv/v4l-utils/v4l-utils-0.8.8-r1

However I experienced a segfault trying to run this command:
ir-keytable --protocol=rc-6 --device
/dev/input/by-id/usb-15c2_0038-event-if00

Trace I got in gdb:

gdb ir-keytable core
GNU gdb (Gentoo 7.5 p1) 7.5
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later
<http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>...
Reading symbols from /usr/bin/ir-keytable...done.
[New LWP 11090]

warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?
Core was generated by `ir-keytable --protocol=rc-6 --device
/dev/input/by-id/usb-15c2_0038-event-if00'.
Program terminated with signal 11, Segmentation fault.
#0  0x00007fd1c6bdd410 in __strcpy_chk () from /lib64/libc.so.6
(gdb) bt full
#0  0x00007fd1c6bdd410 in __strcpy_chk () from /lib64/libc.so.6
No symbol table info available.
#1  0x00000000004037bc in strcpy (__src=<optimized out>,
__dest=0x7fff0a823010 "")
    at /usr/include/bits/string3.h:105
No locals.
#2  v1_set_hw_protocols (rc_dev=<optimized out>) at keytable.c:758
        fp = <optimized out>
        name = '\000' <repeats 1480 times>, "`\327\350\306\321\177",
'\000' <repeats 75 times>,
"p\031\000\000\000\000\000~m\031\000\000\000\000\000~m\031", '\000'
<repeats 13 times>,
"\005\000\000\000\000\000\000\000\000p9\000\000\000\000\000\000\320\071\000\000\000\000\000X\307\071\000\000\000\000\000`\f:\000\000\000\000\000\000p\031\000\000\000\000\000\003",
'\000' <repeats 271 times>,
"@F\n\307\321\177\000\000/\000\000\000\000\000\000\000\215\027\351\306\321\177\000\000\000\000\000\000\000\000\000\000\t\000\000\000\000\000\000\000\021\000\000\000\000\000\000\000\001",
'\000' <repeats 23 times>,
"p9\202\n\377\177\000\000\031\024\351\306\321\177\000\000\001\000\000\000\000\000\000\000XF\n\307\321\177\000\000p9\202\n\377\177\000\000\265\326\350\306\321\177",
'\000' <repeats 26 times>...
#3  0x00000000004019af in set_proto (rc_dev=0x7fff0a824030) at
keytable.c:1153
        rc = 0
#4  main (argc=<optimized out>, argv=<optimized out>) at keytable.c:1531
        dev_from_class = <optimized out>
        write_cnt = 0
        fd = 3
        names = 0x0
        rc_dev = {sysfs_name = 0x0, input_name = 0x7fd1c70a74e0
"@t\n\307\321\177",
          drv_name = 0x0,
          keytable_name = 0x100000000 <Address 0x100000000 out of bounds>,
          version = (unknown: 3339351856), type = (SOFTWARE_DECODER |
unknown: 32720),
          supported = 4196936, current = RC_6}

------
ir-keytable
Found /sys/class/rc/rc0/ (/dev/input/event12) with:
    Driver imon, table rc-imon-pad
    Supported protocols: RC-6 other
    Enabled protocols:
    Repeat delay = 500 ms, repeat period = 125 ms
------
dmesg |grep imon
[    4.783532] Registered IR keymap rc-imon-pad
[    4.789794] imon 9-3:1.0: iMON device (15c2:0038, intf0) on usb<9:2>
initialized
[    4.789849] imon 9-3:1.1: iMON device (15c2:0038, intf1) on usb<9:2>
initialized
[    4.789885] usbcore: registered new interface driver imon


Please take a look what might be wrong here

Regards,
Wojciech Myrda




