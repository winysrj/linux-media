Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.renesas.com ([202.234.163.13]:56145 "EHLO
	mail01.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1752708AbZBSIH6 (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Thu, 19 Feb 2009 03:07:58 -0500
Date: Thu, 19 Feb 2009 17:07:33 +0900
From: morimoto.kuninori@renesas.com
Subject: Re: soc-camera : sh_mobile_ceu_camera race on free_buffer ?
In-reply-to: <Pine.LNX.4.64.0902190825040.4252@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Cc: Magnus Damm <magnus.damm@gmail.com>,
	Matthieu CASTET <matthieu.castet@parrot.com>,
	Linux Media Mailing List <linux-media@vger.kernel.org>
Message-id: <uskmakfy2.wl%morimoto.kuninori@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <497487F2.7070400@parrot.com>
 <aec7e5c30901192046j1a595day51da698181d034e5@mail.gmail.com>
 <497598ED.3050502@parrot.com>
 <aec7e5c30902130214k6a0fc8ck74b412f41fa63385@mail.gmail.com>
 <u7i3rgpeo.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.0902181938311.6371@axis700.grange>
 <uy6w3jl44.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.0902190825040.4252@axis700.grange>
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>


Dear Guennadi

> No, sorry, this is not the test I meant. "-c" doesn't really stress the 
> path we need. You really have to execute capture_example multiple times 
> completely. The race we're trying to catch happens on STREAMOFF, and for 
> that you have to run the example completely through. So, I would suggest 
> something like
> 
> for (( i=0; i<100; i++ )); do capture_example -d /dev/videoX -f -c 4; done

wow !!
sorry miss understanding.

OK. I re-tried test with your script (300 times).

sh_mobile_ceu_camera didn't crashe with
and without Magnus patch.

MigoR + ov772x + capture_example
MigoR + tw9910 + capture_example (VUYU fix)
AP325 + ov772x + capture_example

Best regards
--
Kuninori Morimoto
 
