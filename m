Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.renesas.com ([202.234.163.13]:60460 "EHLO
	mail05.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1752598Ab0GMBQX (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Mon, 12 Jul 2010 21:16:23 -0400
Date: Tue, 13 Jul 2010 10:16:17 +0900 (JST)
From: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Subject: Re: [PATCH] Add interlace support to sh_mobile_ceu_camera.c
In-reply-to: <Pine.LNX.4.64.1007120900430.7130@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Cc: Linux Media Mailing List <linux-media@vger.kernel.org>
Message-id: <w3pd3uskwpw.wl%kuninori.morimoto.gx@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <uvdtrmtin.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.1007120900430.7130@axis700.grange>
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>


Dear Guennadi

> I've got a question to you, regarding your interlaced support 
> implementation for the CEU: do I understand it right, that the kind of 
> support you actually have implemented is, that if an interlaced format is 
> now requested from the CEU, it will interpret incoming data as interlaced 
> and deinterlace it internally? 

It is correct excluding "interlaced format is now requested from the CEU". 
Now, the device which request interlace format is video device.
If you use Ecovec, it is tw9910.

> If this is really the case, then, I think, 
> it is a wrong way to implement this functionality. If a user requests 
> interlaced data, it means, (s)he wants it interlaced in memory. Whereas 
> deinterlacing should happen transparently - if the user requested 
> progressive data and your source provides interlaced, you can decide to 
> deinterlace it internally. Or am I misunderstanding your implementation?

Hmm...
Now only "CEU + tw9910" pair use interlace mode in CEU.
But it doesn't support interlace mode from "user space".
(I don't know how to request it from user space)
Now interlace mode is used internally.
This mean, it seems as "progressive mode" from user space.

> Regardless of theoretical correctness - does your patch still work? Have 
> you been able back then to get CEU to deinterlace data, and when have you 
> last tested it?

I tested CEU interlace mode by using Ecovec board.
I can watch correct video image on at least v2.6.34.

I used this command.

VIDIX="-vo fbdev:vidix:sh_veu"
SIZE="-tv width=1280:height=720"
NTSC="-tv norm=NTSC"
OUT="tv:// -tv outfmt=nv12"
DEVICE="-tv device=/dev/video0"
mplayer ${VIDIX} ${SIZE} ${NTSC} ${OUT} ${DEVICE}

Best regards
--
Kuninori Morimoto
 
