Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-vx0-f174.google.com ([209.85.220.174]:60582 "EHLO
	mail-vx0-f174.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1756656Ab2D3WFZ (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Mon, 30 Apr 2012 18:05:25 -0400
Received: by mail-vx0-f174.google.com with SMTP id p1so2391425vcq.19
        for <linux-media@vger.kernel.org>; Mon, 30 Apr 2012 15:05:24 -0700 (PDT)
MIME-Version: 1.0
In-Reply-To: <CAOcJUbxLdZoo36Jkk1kMOhSfPcneupF6bRsMKOmuY6F5xZcErQ@mail.gmail.com>
References: <CAOcJUbxHCo7xfGHJZdeEgReJrpCriweSb9s9+-_NfSODLz_NPQ@mail.gmail.com>
	<4F9014CD.1040005@redhat.com>
	<CAHAyoxx+Thhj+EwFbtJcXbkzks=0x+RfdudKOgQT=pqJzePcLw@mail.gmail.com>
	<CAOcJUbyDNGoSdVV0WMVKavJm=RK6tanQTXS8AFzsHmHkGHOGUw@mail.gmail.com>
	<CAOcJUbzyqkfOOR72xDc14B139EECjM9f5yCmC=d0yYQU6Js4jw@mail.gmail.com>
	<CAOcJUbyT7LqdMwWcYa7XRhEvvSQGVftVQmiNBxw4xy+tv4412Q@mail.gmail.com>
	<CAOcJUbxLdZoo36Jkk1kMOhSfPcneupF6bRsMKOmuY6F5xZcErQ@mail.gmail.com>
Date: Mon, 30 Apr 2012 18:05:22 -0400
Message-ID: <CAOcJUbxt1uwMN-ip76t2F5k--vrtOUD0iTJSzDbsM9T2ajRPJw@mail.gmail.com>
Subject: Re: ATSC-MH driver support for the Hauppauge WinTV Aero-m
From: Michael Krufky <mkrufky@kernellabs.com>
To: Mauro Carvalho Chehab <mchehab@redhat.com>
Cc: Mauro Carvalho Chehab <mchehab@infradead.org>,
	linux-media <linux-media@vger.kernel.org>
Content-Type: multipart/mixed; boundary=047d7b34403ca9029c04beeca66b
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--047d7b34403ca9029c04beeca66b
Content-Type: text/plain; charset=ISO-8859-1



--047d7b34403ca9029c04beeca66b
Content-Type: application/octet-stream;
	name="0005-DVB-add-support-for-the-LG2160-ATSC-MH-demodulator.patch"
Content-Disposition: attachment;
	filename="0005-DVB-add-support-for-the-LG2160-ATSC-MH-demodulator.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_h1o2tvnz1

RnJvbSAxMWY1NjcwNTgwMDFhMDQ5NWJmMzk1ZTk4ZmViNmI5OTE3MDZlZjQxIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBNaWNoYWVsIEtydWZreSA8bWtydWZreUBsaW51eHR2Lm9yZz4K
RGF0ZTogU3VuLCAyOSBKYW4gMjAxMiAxMzo0Njo0NiAtMDUwMApTdWJqZWN0OiBbUEFUQ0ggMDUv
MTBdIERWQjogYWRkIHN1cHBvcnQgZm9yIHRoZSBMRzIxNjAgQVRTQy1NSCBkZW1vZHVsYXRvcgoK
U2lnbmVkLW9mZi1ieTogTWljaGFlbCBLcnVma3kgPG1rcnVma3lAbGludXh0di5vcmc+Ci0tLQog
ZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL01ha2VmaWxlIHwgICAgMSArCiBkcml2ZXJzL21l
ZGlhL2R2Yi9mcm9udGVuZHMvbGcyMTYwLmMgfCAxNDY4ICsrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysKIGRyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9sZzIxNjAuaCB8ICAgODQg
KysKIDMgZmlsZXMgY2hhbmdlZCwgMTU1MyBpbnNlcnRpb25zKCspLCAwIGRlbGV0aW9ucygtKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9sZzIxNjAuYwog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9sZzIxNjAuaAoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9NYWtlZmlsZSBiL2RyaXZl
cnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9NYWtlZmlsZQppbmRleCA4NmZhODA4Li5mMTk3NzVkIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvTWFrZWZpbGUKKysrIGIvZHJp
dmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL01ha2VmaWxlCkBAIC01MCw2ICs1MCw3IEBAIG9iai0k
KENPTkZJR19EVkJfQkNNMzUxMCkgKz0gYmNtMzUxMC5vCiBvYmotJChDT05GSUdfRFZCX1M1SDE0
MjApICs9IHM1aDE0MjAubwogb2JqLSQoQ09ORklHX0RWQl9MR0RUMzMwWCkgKz0gbGdkdDMzMHgu
bwogb2JqLSQoQ09ORklHX0RWQl9MR0RUMzMwNSkgKz0gbGdkdDMzMDUubworb2JqLSQoQ09ORklH
X0RWQl9MRzIxNjApICs9IGxnMjE2MC5vCiBvYmotJChDT05GSUdfRFZCX0NYMjQxMjMpICs9IGN4
MjQxMjMubwogb2JqLSQoQ09ORklHX0RWQl9MTkJQMjEpICs9IGxuYnAyMS5vCiBvYmotJChDT05G
SUdfRFZCX0xOQlAyMikgKz0gbG5icDIyLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvZHZi
L2Zyb250ZW5kcy9sZzIxNjAuYyBiL2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9sZzIxNjAu
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4yNjlhYjdiCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xnMjE2MC5jCkBAIC0wLDAgKzEs
MTQ2OCBAQAorLyoKKyAqICAgIFN1cHBvcnQgZm9yIExHMjE2MCAtIEFUU0MvTUgKKyAqCisgKiAg
ICBDb3B5cmlnaHQgKEMpIDIwMTAgTWljaGFlbCBLcnVma3kgPG1rcnVma3lAbGludXh0di5vcmc+
CisgKgorICogICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICB0aGUgRnJl
ZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBv
cgorICogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiAgICBU
aGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVz
ZWZ1bCwKKyAqICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBp
bXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgICBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICAgIFlvdSBzaG91bGQgaGF2ZSByZWNl
aXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgICBhbG9u
ZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQor
ICogICAgRm91bmRhdGlvbiwgSW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAyMTM5
LCBVU0EuCisgKgorICovCisKKyNpbmNsdWRlIDxsaW51eC9qaWZmaWVzLmg+CisjaW5jbHVkZSA8
bGludXgvZHZiL2Zyb250ZW5kLmg+CisjaW5jbHVkZSAibGcyMTYwLmgiCisKK3N0YXRpYyBpbnQg
ZGVidWc7Cittb2R1bGVfcGFyYW0oZGVidWcsIGludCwgMDY0NCk7CitNT0RVTEVfUEFSTV9ERVND
KGRlYnVnLCAic2V0IGRlYnVnIGxldmVsIChpbmZvPTEsIHJlZz0yIChvci1hYmxlKSkiKTsKKwor
I2RlZmluZSBEQkdfSU5GTyAxCisjZGVmaW5lIERCR19SRUcgIDIKKworI2RlZmluZSBsZ19wcmlu
dGsoa2VybiwgZm10LCBhcmcuLi4pCQkJCQlcCisJcHJpbnRrKGtlcm4gIiVzOiAiIGZtdCwgX19m
dW5jX18sICMjYXJnKQorCisjZGVmaW5lIGxnX2luZm8oZm10LCBhcmcuLi4pCXByaW50ayhLRVJO
X0lORk8gImxnMjE2MDogIiBmbXQsICMjYXJnKQorI2RlZmluZSBsZ193YXJuKGZtdCwgYXJnLi4u
KQlsZ19wcmludGsoS0VSTl9XQVJOSU5HLCAgICAgICBmbXQsICMjYXJnKQorI2RlZmluZSBsZ19l
cnIoZm10LCBhcmcuLi4pCWxnX3ByaW50ayhLRVJOX0VSUiwgICAgICAgICAgIGZtdCwgIyNhcmcp
CisjZGVmaW5lIGxnX2RiZyhmbXQsIGFyZy4uLikgaWYgKGRlYnVnICYgREJHX0lORk8pCQkJXAor
CQkJCWxnX3ByaW50ayhLRVJOX0RFQlVHLCAgICAgICAgIGZtdCwgIyNhcmcpCisjZGVmaW5lIGxn
X3JlZyhmbXQsIGFyZy4uLikgaWYgKGRlYnVnICYgREJHX1JFRykJCQlcCisJCQkJbGdfcHJpbnRr
KEtFUk5fREVCVUcsICAgICAgICAgZm10LCAjI2FyZykKKworI2RlZmluZSBsZ19mYWlsKHJldCkJ
CQkJCQkJXAorKHsJCQkJCQkJCQlcCisJaW50IF9fcmV0OwkJCQkJCQlcCisJX19yZXQgPSAocmV0
IDwgMCk7CQkJCQkJXAorCWlmIChfX3JldCkJCQkJCQkJXAorCQlsZ19lcnIoImVycm9yICVkIG9u
IGxpbmUgJWRcbiIsCXJldCwgX19MSU5FX18pOwkJXAorCV9fcmV0OwkJCQkJCQkJXAorfSkKKwor
c3RydWN0IGxnMjE2eF9zdGF0ZSB7CisJc3RydWN0IGkyY19hZGFwdGVyICppMmNfYWRhcDsKKwlj
b25zdCBzdHJ1Y3QgbGcyMTYwX2NvbmZpZyAqY2ZnOworCisJc3RydWN0IGR2Yl9mcm9udGVuZCBm
cm9udGVuZDsKKworCXUzMiBjdXJyZW50X2ZyZXF1ZW5jeTsKKwl1OCBwYXJhZGVfaWQ7CisJdTgg
ZmljX3ZlcjsKKwl1bnNpZ25lZCBpbnQgbGFzdF9yZXNldDsKK307CisKKy8qIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSAqLworCitzdGF0aWMgaW50IGxnMjE2eF93cml0ZV9yZWcoc3RydWN0IGxnMjE2eF9zdGF0
ZSAqc3RhdGUsIHUxNiByZWcsIHU4IHZhbCkKK3sKKwlpbnQgcmV0OworCXU4IGJ1ZltdID0geyBy
ZWcgPj4gOCwgcmVnICYgMHhmZiwgdmFsIH07CisJc3RydWN0IGkyY19tc2cgbXNnID0geworCQku
YWRkciA9IHN0YXRlLT5jZmctPmkyY19hZGRyLCAuZmxhZ3MgPSAwLAorCQkuYnVmID0gYnVmLCAu
bGVuID0gMywKKwl9OworCisJbGdfcmVnKCJyZWc6IDB4JTA0eCwgdmFsOiAweCUwMnhcbiIsIHJl
ZywgdmFsKTsKKworCXJldCA9IGkyY190cmFuc2ZlcihzdGF0ZS0+aTJjX2FkYXAsICZtc2csIDEp
OworCisJaWYgKHJldCAhPSAxKSB7CisJCWxnX2VycigiZXJyb3IgKGFkZHIgJTAyeCAlMDJ4IDwt
ICUwMngsIGVyciA9ICVpKVxuIiwKKwkJICAgICAgIG1zZy5idWZbMF0sIG1zZy5idWZbMV0sIG1z
Zy5idWZbMl0sIHJldCk7CisJCWlmIChyZXQgPCAwKQorCQkJcmV0dXJuIHJldDsKKwkJZWxzZQor
CQkJcmV0dXJuIC1FUkVNT1RFSU87CisJfQorCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxn
MjE2eF9yZWFkX3JlZyhzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwgdTE2IHJlZywgdTggKnZh
bCkKK3sKKwlpbnQgcmV0OworCXU4IHJlZ19idWZbXSA9IHsgcmVnID4+IDgsIHJlZyAmIDB4ZmYg
fTsKKwlzdHJ1Y3QgaTJjX21zZyBtc2dbXSA9IHsKKwkJeyAuYWRkciA9IHN0YXRlLT5jZmctPmky
Y19hZGRyLAorCQkgIC5mbGFncyA9IDAsIC5idWYgPSByZWdfYnVmLCAubGVuID0gMiB9LAorCQl7
IC5hZGRyID0gc3RhdGUtPmNmZy0+aTJjX2FkZHIsCisJCSAgLmZsYWdzID0gSTJDX01fUkQsIC5i
dWYgPSB2YWwsIC5sZW4gPSAxIH0sCisJfTsKKworCWxnX3JlZygicmVnOiAweCUwNHhcbiIsIHJl
Zyk7CisKKwlyZXQgPSBpMmNfdHJhbnNmZXIoc3RhdGUtPmkyY19hZGFwLCBtc2csIDIpOworCisJ
aWYgKHJldCAhPSAyKSB7CisJCWxnX2VycigiZXJyb3IgKGFkZHIgJTAyeCByZWcgJTA0eCBlcnJv
ciAocmV0ID09ICVpKVxuIiwKKwkJICAgICAgIHN0YXRlLT5jZmctPmkyY19hZGRyLCByZWcsIHJl
dCk7CisJCWlmIChyZXQgPCAwKQorCQkJcmV0dXJuIHJldDsKKwkJZWxzZQorCQkJcmV0dXJuIC1F
UkVNT1RFSU87CisJfQorCXJldHVybiAwOworfQorCitzdHJ1Y3QgbGcyMTZ4X3JlZyB7CisJdTE2
IHJlZzsKKwl1OCB2YWw7Cit9OworCitzdGF0aWMgaW50IGxnMjE2eF93cml0ZV9yZWdzKHN0cnVj
dCBsZzIxNnhfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgbGcyMTZ4X3JlZyAqcmVncywg
aW50IGxlbikKK3sKKwlpbnQgaSwgcmV0OworCisJbGdfcmVnKCJ3cml0aW5nICVkIHJlZ2lzdGVy
cy4uLlxuIiwgbGVuKTsKKworCWZvciAoaSA9IDA7IGkgPCBsZW4gLSAxOyBpKyspIHsKKwkJcmV0
ID0gbGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgcmVnc1tpXS5yZWcsIHJlZ3NbaV0udmFsKTsKKwkJ
aWYgKGxnX2ZhaWwocmV0KSkKKwkJCXJldHVybiByZXQ7CisJfQorCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IGxnMjE2eF9zZXRfcmVnX2JpdChzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwK
KwkJCSAgICAgIHUxNiByZWcsIGludCBiaXQsIGludCBvbm9mZikKK3sKKwl1OCB2YWw7CisJaW50
IHJldDsKKworCWxnX3JlZygicmVnOiAweCUwNHgsIGJpdDogJWQsIGxldmVsOiAlZFxuIiwgcmVn
LCBiaXQsIG9ub2ZmKTsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0ZSwgcmVnLCAmdmFs
KTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwl2YWwgJj0gfigxIDw8IGJp
dCk7CisJdmFsIHw9IChvbm9mZiAmIDEpIDw8IGJpdDsKKworCXJldCA9IGxnMjE2eF93cml0ZV9y
ZWcoc3RhdGUsIHJlZywgdmFsKTsKKwlsZ19mYWlsKHJldCk7CitmYWlsOgorCXJldHVybiByZXQ7
Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCitzdGF0aWMgaW50IGxnMjE2eF9pMmNfZ2F0
ZV9jdHJsKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCBpbnQgZW5hYmxlKQoreworCXN0cnVjdCBs
ZzIxNnhfc3RhdGUgKnN0YXRlID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7CisJaW50IHJldDsKKwor
CWlmIChzdGF0ZS0+Y2ZnLT5kZW55X2kyY19ycHRyKQorCQlyZXR1cm4gMDsKKworCWxnX2RiZygi
KCVkKVxuIiwgZW5hYmxlKTsKKworCXJldCA9IGxnMjE2eF9zZXRfcmVnX2JpdChzdGF0ZSwgMHgw
MDAwLCAwLCBlbmFibGUgPyAwIDogMSk7CisKKwltc2xlZXAoMSk7CisKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMgaW50IGxnMjE2eF9zb2Z0X3Jlc2V0KHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0
YXRlKQoreworCWludCByZXQ7CisKKwlsZ19kYmcoIlxuIik7CisKKwlyZXQgPSBsZzIxNnhfd3Jp
dGVfcmVnKHN0YXRlLCAweDAwMDIsIDB4MDApOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8g
ZmFpbDsKKworCW1zbGVlcCgyMCk7CisJcmV0ID0gbGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgw
MDAyLCAweDAxKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwlzdGF0ZS0+
bGFzdF9yZXNldCA9IGppZmZpZXNfdG9fbXNlY3MoamlmZmllcyk7CitmYWlsOgorCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyBpbnQgbGcyMTZ4X2luaXRpYWxpemUoc3RydWN0IGxnMjE2eF9zdGF0
ZSAqc3RhdGUpCit7CisJaW50IHJldDsKKworCXN0YXRpYyBzdHJ1Y3QgbGcyMTZ4X3JlZyBsZzIx
NjBfaW5pdFtdID0geworI2lmIDAKKwkJeyAucmVnID0gMHgwMDE1LCAudmFsID0gMHhlNiB9LAor
I2Vsc2UKKwkJeyAucmVnID0gMHgwMDE1LCAudmFsID0gMHhmNyB9LAorCQl7IC5yZWcgPSAweDAw
MWIsIC52YWwgPSAweDUyIH0sCisJCXsgLnJlZyA9IDB4MDIwOCwgLnZhbCA9IDB4MDAgfSwKKwkJ
eyAucmVnID0gMHgwMjA5LCAudmFsID0gMHg4MiB9LAorCQl7IC5yZWcgPSAweDAyMTAsIC52YWwg
PSAweGY5IH0sCisJCXsgLnJlZyA9IDB4MDIwYSwgLnZhbCA9IDB4MDAgfSwKKwkJeyAucmVnID0g
MHgwMjBiLCAudmFsID0gMHg4MiB9LAorCQl7IC5yZWcgPSAweDAyMGQsIC52YWwgPSAweDI4IH0s
CisJCXsgLnJlZyA9IDB4MDIwZiwgLnZhbCA9IDB4MTQgfSwKKyNlbmRpZgorCX07CisKKwlzdGF0
aWMgc3RydWN0IGxnMjE2eF9yZWcgbGcyMTYxX2luaXRbXSA9IHsKKwkJeyAucmVnID0gMHgwMDAw
LCAudmFsID0gMHg0MSB9LAorCQl7IC5yZWcgPSAweDAwMDEsIC52YWwgPSAweGZiIH0sCisJCXsg
LnJlZyA9IDB4MDIxNiwgLnZhbCA9IDB4MDAgfSwKKwkJeyAucmVnID0gMHgwMjE5LCAudmFsID0g
MHgwMCB9LAorCQl7IC5yZWcgPSAweDAyMWIsIC52YWwgPSAweDU1IH0sCisJCXsgLnJlZyA9IDB4
MDYwNiwgLnZhbCA9IDB4MGEgfSwKKwl9OworCisJc3dpdGNoIChzdGF0ZS0+Y2ZnLT5sZ19jaGlw
KSB7CisJY2FzZSBMRzIxNjA6CisJCXJldCA9IGxnMjE2eF93cml0ZV9yZWdzKHN0YXRlLAorCQkJ
CQlsZzIxNjBfaW5pdCwgQVJSQVlfU0laRShsZzIxNjBfaW5pdCkpOworCQlicmVhazsKKwljYXNl
IExHMjE2MToKKwkJcmV0ID0gbGcyMTZ4X3dyaXRlX3JlZ3Moc3RhdGUsCisJCQkJCWxnMjE2MV9p
bml0LCBBUlJBWV9TSVpFKGxnMjE2MV9pbml0KSk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJl
dCA9IC1FSU5WQUw7CisJCWJyZWFrOworCX0KKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZh
aWw7CisKKwlyZXQgPSBsZzIxNnhfc29mdF9yZXNldChzdGF0ZSk7CisJbGdfZmFpbChyZXQpOwor
ZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KKworc3RhdGlj
IGludCBsZzIxNnhfc2V0X2lmKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlKQoreworCXU4IHZh
bDsKKwlpbnQgcmV0OworCisJbGdfZGJnKCIlZCBLSHpcbiIsIHN0YXRlLT5jZmctPmlmX2toeik7
CisKKwlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDEzMiwgJnZhbCk7CisJaWYgKGxn
X2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJdmFsICY9IDB4ZmI7CisJdmFsIHw9ICgwID09
IHN0YXRlLT5jZmctPmlmX2toeikgPyAweDA0IDogMHgwMDsKKworCXJldCA9IGxnMjE2eF93cml0
ZV9yZWcoc3RhdGUsIDB4MDEzMiwgdmFsKTsKKwlsZ19mYWlsKHJldCk7CisKKwkvKiBpZiBOT1Qg
emVybyBJRiwgNiBNSHogaXMgdGhlIGRlZmF1bHQgKi8KK2ZhaWw6CisJcmV0dXJuIHJldDsKK30K
KworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCisKK3N0YXRpYyBpbnQgbGcyMTYwX2FnY19maXgoc3Ry
dWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsCisJCQkgIGludCBpZl9hZ2NfZml4LCBpbnQgcmZfYWdj
X2ZpeCkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhz
dGF0ZSwgMHgwMTAwLCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisK
Kwl2YWwgJj0gMHhmMzsKKwl2YWwgfD0gKGlmX2FnY19maXgpID8gMHgwOCA6IDB4MDA7CisJdmFs
IHw9IChyZl9hZ2NfZml4KSA/IDB4MDQgOiAweDAwOworCisJcmV0ID0gbGcyMTZ4X3dyaXRlX3Jl
ZyhzdGF0ZSwgMHgwMTAwLCB2YWwpOworCWxnX2ZhaWwocmV0KTsKK2ZhaWw6CisJcmV0dXJuIHJl
dDsKK30KKworI2lmIDAKK3N0YXRpYyBpbnQgbGcyMTYwX2FnY19mcmVlemUoc3RydWN0IGxnMjE2
eF9zdGF0ZSAqc3RhdGUsCisJCQkgICAgIGludCBpZl9hZ2NfZnJlZXplLCBpbnQgcmZfYWdjX2Zy
ZWV6ZSkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhz
dGF0ZSwgMHgwMTAwLCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisK
Kwl2YWwgJj0gMHhjZjsKKwl2YWwgfD0gKGlmX2FnY19mcmVlemUpID8gMHgyMCA6IDB4MDA7CisJ
dmFsIHw9IChyZl9hZ2NfZnJlZXplKSA/IDB4MTAgOiAweDAwOworCisJcmV0ID0gbGcyMTZ4X3dy
aXRlX3JlZyhzdGF0ZSwgMHgwMTAwLCB2YWwpOworCWxnX2ZhaWwocmV0KTsKK2ZhaWw6CisJcmV0
dXJuIHJldDsKK30KKyNlbmRpZgorCitzdGF0aWMgaW50IGxnMjE2MF9hZ2NfcG9sYXJpdHkoc3Ry
dWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAgaW50IGlmX2FnY19wb2xhcml0eSwg
aW50IHJmX2FnY19wb2xhcml0eSkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxn
MjE2eF9yZWFkX3JlZyhzdGF0ZSwgMHgwMTAwLCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQor
CQlnb3RvIGZhaWw7CisKKwl2YWwgJj0gMHhmYzsKKwl2YWwgfD0gKGlmX2FnY19wb2xhcml0eSkg
PyAweDAyIDogMHgwMDsKKwl2YWwgfD0gKHJmX2FnY19wb2xhcml0eSkgPyAweDAxIDogMHgwMDsK
KworCXJldCA9IGxnMjE2eF93cml0ZV9yZWcoc3RhdGUsIDB4MDEwMCwgdmFsKTsKKwlsZ19mYWls
KHJldCk7CitmYWlsOgorCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbGcyMTYwX3R1bmVy
X3B3cl9zYXZlX3BvbGFyaXR5KHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLAorCQkJCQkgIGlu
dCBwb2xhcml0eSkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFk
X3JlZyhzdGF0ZSwgMHgwMDA4LCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZh
aWw7CisKKwl2YWwgJj0gMHhmZTsKKwl2YWwgfD0gKHBvbGFyaXR5KSA/IDB4MDEgOiAweDAwOwor
CisJcmV0ID0gbGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgwMDA4LCB2YWwpOworCWxnX2ZhaWwo
cmV0KTsKK2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNjBfc3BlY3Ry
dW1fcG9sYXJpdHkoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsCisJCQkJICAgIGludCBpbnZl
cnRlZCkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhz
dGF0ZSwgMHgwMTMyLCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisK
Kwl2YWwgJj0gMHhmZDsKKwl2YWwgfD0gKGludmVydGVkKSA/IDB4MDIgOiAweDAwOworCisJcmV0
ID0gbGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgwMTMyLCB2YWwpOworCWxnX2ZhaWwocmV0KTsK
K2ZhaWw6CisJcmV0dXJuIGxnMjE2eF9zb2Z0X3Jlc2V0KHN0YXRlKTsKK30KKworc3RhdGljIGlu
dCBsZzIxNjBfdHVuZXJfcHdyX3NhdmUoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsIGludCBv
bm9mZikKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhz
dGF0ZSwgMHgwMDA3LCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisK
Kwl2YWwgJj0gMHhiZjsKKwl2YWwgfD0gKG9ub2ZmKSA/IDB4NDAgOiAweDAwOworCisJcmV0ID0g
bGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgwMDA3LCB2YWwpOworCWxnX2ZhaWwocmV0KTsKK2Zh
aWw6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNnhfc2V0X3BhcmFkZShzdHJ1
Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwgaW50IGlkKQoreworCWludCByZXQ7CisKKwlyZXQgPSBs
ZzIxNnhfd3JpdGVfcmVnKHN0YXRlLCAweDAxM2UsIGlkICYgMHg3Zik7CisJaWYgKGxnX2ZhaWwo
cmV0KSkKKwkJZ290byBmYWlsOworCisJc3RhdGUtPnBhcmFkZV9pZCA9IGlkICYgMHg3ZjsKK2Zh
aWw6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNnhfc2V0X2Vuc2VtYmxlKHN0
cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLCBpbnQgaWQpCit7CisJaW50IHJldDsKKwl1MTYgcmVn
OworCXU4IHZhbDsKKworCXN3aXRjaCAoc3RhdGUtPmNmZy0+bGdfY2hpcCkgeworCWNhc2UgTEcy
MTYwOgorCQlyZWcgPSAweDA0MDA7CisJCWJyZWFrOworCWNhc2UgTEcyMTYxOgorCQlyZWcgPSAw
eDA1MDA7CisJCWJyZWFrOworCX0KKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0ZSwgcmVn
LCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwl2YWwgJj0gMHhm
ZTsKKwl2YWwgfD0gKGlkKSA/IDB4MDEgOiAweDAwOworCisJcmV0ID0gbGcyMTZ4X3dyaXRlX3Jl
ZyhzdGF0ZSwgcmVnLCB2YWwpOworCWxnX2ZhaWwocmV0KTsKK2ZhaWw6CisJcmV0dXJuIHJldDsK
K30KKworc3RhdGljIGludCBsZzIxNjBfc2V0X3NwaV9jbG9jayhzdHJ1Y3QgbGcyMTZ4X3N0YXRl
ICpzdGF0ZSkKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3Jl
ZyhzdGF0ZSwgMHgwMDE0LCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7
CisKKwl2YWwgJj0gMHhmMzsKKwl2YWwgfD0gKHN0YXRlLT5jZmctPnNwaV9jbG9jayA8PCAyKTsK
KworCXJldCA9IGxnMjE2eF93cml0ZV9yZWcoc3RhdGUsIDB4MDAxNCwgdmFsKTsKKwlsZ19mYWls
KHJldCk7CitmYWlsOgorCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbGcyMTYxX3NldF9v
dXRwdXRfaW50ZXJmYWNlKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlKQoreworCXU4IHZhbDsK
KwlpbnQgcmV0OworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAwMTQsICZ2YWwp
OworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCXZhbCAmPSB+MHgwNzsKKwl2
YWwgfD0gc3RhdGUtPmNmZy0+b3V0cHV0X2lmOyAvKiBGSVhNRTogbmVlZHMgc2FuaXR5IGNoZWNr
ICovCisKKwlyZXQgPSBsZzIxNnhfd3JpdGVfcmVnKHN0YXRlLCAweDAwMTQsIHZhbCk7CisJbGdf
ZmFpbChyZXQpOworZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGxnMjE2eF9l
bmFibGVfZmljKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLCBpbnQgb25vZmYpCit7CisJaW50
IHJldDsKKworCXJldCA9IGxnMjE2eF93cml0ZV9yZWcoc3RhdGUsIDB4MDAxNywgMHgyMyk7CisJ
aWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJcmV0ID0gbGcyMTZ4X3dyaXRlX3Jl
ZyhzdGF0ZSwgMHgwMDE2LCAweGZjKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7
CisKKwlzd2l0Y2ggKHN0YXRlLT5jZmctPmxnX2NoaXApIHsKKwljYXNlIExHMjE2MDoKKwkJcmV0
ID0gbGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgwMDE2LAorCQkJCSAgICAgICAweGZjIHwgKChv
bm9mZikgPyAweDAyIDogMHgwMCkpOworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJcmV0ID0g
bGcyMTZ4X3dyaXRlX3JlZyhzdGF0ZSwgMHgwMDE2LCAob25vZmYpID8gMHgxMCA6IDB4MDApOwor
CQlicmVhazsKKwl9CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJcmV0ID0g
bGcyMTZ4X2luaXRpYWxpemUoc3RhdGUpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFp
bDsKKworCWlmIChvbm9mZikgeworCQlyZXQgPSBsZzIxNnhfd3JpdGVfcmVnKHN0YXRlLCAweDAw
MTcsIDB4MDMpOworCQlsZ19mYWlsKHJldCk7CisJfQorZmFpbDoKKwlyZXR1cm4gcmV0OworfQor
CisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KKworc3RhdGljIGludCBsZzIxNnhfZ2V0X2ZpY192ZXJz
aW9uKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLCB1OCAqZmljdmVyKQoreworCXU4IHZhbDsK
KwlpbnQgcmV0OworCisJKmZpY3ZlciA9IDB4ZmY7IC8qIGludmFsaWQgdmFsdWUgKi8KKworCXJl
dCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0ZSwgMHgwMTI4LCAmdmFsKTsKKwlpZiAobGdfZmFpbChy
ZXQpKQorCQlnb3RvIGZhaWw7CisKKwkqZmljdmVyID0gKHZhbCA+PiAzKSAmIDB4MWY7CitmYWls
OgorCXJldHVybiByZXQ7Cit9CisKKyNpZiAwCitzdGF0aWMgaW50IGxnMjE2MF9nZXRfcGFyYWRl
X2lkKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLCB1OCAqaWQpCit7CisJdTggdmFsOworCWlu
dCByZXQ7CisKKwkqaWQgPSAweGZmOyAvKiBpbnZhbGlkIHZhbHVlICovCisKKwlyZXQgPSBsZzIx
NnhfcmVhZF9yZWcoc3RhdGUsIDB4MDEyMywgJnZhbCk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJ
Z290byBmYWlsOworCisJKmlkID0gdmFsICYgMHg3ZjsKK2ZhaWw6CisJcmV0dXJuIHJldDsKK30K
KyNlbmRpZgorCitzdGF0aWMgaW50IGxnMjE2eF9nZXRfbm9nKHN0cnVjdCBsZzIxNnhfc3RhdGUg
KnN0YXRlLCB1OCAqbm9nKQoreworCXU4IHZhbDsKKwlpbnQgcmV0OworCisJKm5vZyA9IDB4ZmY7
IC8qIGludmFsaWQgdmFsdWUgKi8KKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0ZSwgMHgw
MTI0LCAmdmFsKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwkqbm9nID0g
KCh2YWwgPj4gNCkgJiAweDA3KSArIDE7CitmYWlsOgorCXJldHVybiByZXQ7Cit9CisKK3N0YXRp
YyBpbnQgbGcyMTZ4X2dldF90bm9nKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLCB1OCAqdG5v
ZykKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCSp0bm9nID0gMHhmZjsgLyogaW52YWxpZCB2
YWx1ZSAqLworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAxMjUsICZ2YWwpOwor
CWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCSp0bm9nID0gdmFsICYgMHgxZjsK
K2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNnhfZ2V0X3NnbihzdHJ1
Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwgdTggKnNnbikKK3sKKwl1OCB2YWw7CisJaW50IHJldDsK
KworCSpzZ24gPSAweGZmOyAvKiBpbnZhbGlkIHZhbHVlICovCisKKwlyZXQgPSBsZzIxNnhfcmVh
ZF9yZWcoc3RhdGUsIDB4MDEyNCwgJnZhbCk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBm
YWlsOworCisJKnNnbiA9IHZhbCAmIDB4MGY7CitmYWlsOgorCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyBpbnQgbGcyMTZ4X2dldF9wcmMoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsIHU4ICpw
cmMpCit7CisJdTggdmFsOworCWludCByZXQ7CisKKwkqcHJjID0gMHhmZjsgLyogaW52YWxpZCB2
YWx1ZSAqLworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAxMjUsICZ2YWwpOwor
CWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCSpwcmMgPSAoKHZhbCA+PiA1KSAm
IDB4MDcpICsgMTsKK2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworLyogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
ICovCisKK3N0YXRpYyBpbnQgbGcyMTZ4X2dldF9yc19mcmFtZV9tb2RlKHN0cnVjdCBsZzIxNnhf
c3RhdGUgKnN0YXRlLAorCQkJCSAgICBlbnVtIGF0c2NtaF9yc19mcmFtZV9tb2RlICpyc19mcmFt
ZW1vZGUpCit7CisJdTggdmFsOworCWludCByZXQ7CisKKwlzd2l0Y2ggKHN0YXRlLT5jZmctPmxn
X2NoaXApIHsKKwljYXNlIExHMjE2MDoKKwkJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAw
eDA0MTAsICZ2YWwpOworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJcmV0ID0gbGcyMTZ4X3Jl
YWRfcmVnKHN0YXRlLCAweDA1MTMsICZ2YWwpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlyZXQg
PSAtRUlOVkFMOworCX0KKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwlzd2l0
Y2ggKCh2YWwgPj4gNCkgJiAweDAzKSB7CisjaWYgMQorCWRlZmF1bHQ6CisjZW5kaWYKKwljYXNl
IDB4MDA6CisJCSpyc19mcmFtZW1vZGUgPSBBVFNDTUhfUlNGUkFNRV9QUklfT05MWTsKKwkJYnJl
YWs7CisJY2FzZSAweDAxOgorCQkqcnNfZnJhbWVtb2RlID0gQVRTQ01IX1JTRlJBTUVfUFJJX1NF
QzsKKwkJYnJlYWs7CisjaWYgMAorCWRlZmF1bHQ6CisJCSpyc19mcmFtZW1vZGUgPSBBVFNDTUhf
UlNGUkFNRV9SRVM7CisJCWJyZWFrOworI2VuZGlmCisJfQorZmFpbDoKKwlyZXR1cm4gcmV0Owor
fQorCitzdGF0aWMKK2ludCBsZzIxNnhfZ2V0X3JzX2ZyYW1lX2Vuc2VtYmxlKHN0cnVjdCBsZzIx
Nnhfc3RhdGUgKnN0YXRlLAorCQkJCSBlbnVtIGF0c2NtaF9yc19mcmFtZV9lbnNlbWJsZSAqcnNf
ZnJhbWVfZW5zKQoreworCXU4IHZhbDsKKwlpbnQgcmV0OworCisJc3dpdGNoIChzdGF0ZS0+Y2Zn
LT5sZ19jaGlwKSB7CisJY2FzZSBMRzIxNjA6CisJCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0
ZSwgMHgwNDAwLCAmdmFsKTsKKwkJYnJlYWs7CisJY2FzZSBMRzIxNjE6CisJCXJldCA9IGxnMjE2
eF9yZWFkX3JlZyhzdGF0ZSwgMHgwNTAwLCAmdmFsKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJ
cmV0ID0gLUVJTlZBTDsKKwl9CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJ
dmFsICY9IDB4MDE7CisJKnJzX2ZyYW1lX2VucyA9IChlbnVtIGF0c2NtaF9yc19mcmFtZV9lbnNl
bWJsZSkgdmFsOworZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGxnMjE2eF9n
ZXRfcnNfY29kZV9tb2RlKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLAorCQkJCSAgIGVudW0g
YXRzY21oX3JzX2NvZGVfbW9kZSAqcnNfY29kZV9wcmksCisJCQkJICAgZW51bSBhdHNjbWhfcnNf
Y29kZV9tb2RlICpyc19jb2RlX3NlYykKK3sKKwl1OCB2YWw7CisJaW50IHJldDsKKworCXN3aXRj
aCAoc3RhdGUtPmNmZy0+bGdfY2hpcCkgeworCWNhc2UgTEcyMTYwOgorCQlyZXQgPSBsZzIxNnhf
cmVhZF9yZWcoc3RhdGUsIDB4MDQxMCwgJnZhbCk7CisJCWJyZWFrOworCWNhc2UgTEcyMTYxOgor
CQlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDUxMywgJnZhbCk7CisJCWJyZWFrOwor
CWRlZmF1bHQ6CisJCXJldCA9IC1FSU5WQUw7CisJfQorCWlmIChsZ19mYWlsKHJldCkpCisJCWdv
dG8gZmFpbDsKKworCSpyc19jb2RlX3ByaSA9IChlbnVtIGF0c2NtaF9yc19jb2RlX21vZGUpICgo
dmFsID4+IDIpICYgMHgwMyk7CisJKnJzX2NvZGVfc2VjID0gKGVudW0gYXRzY21oX3JzX2NvZGVf
bW9kZSkgKHZhbCAmIDB4MDMpOworZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IGxnMjE2eF9nZXRfc2NjY19ibG9ja19tb2RlKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLAor
CQkJCSAgICAgIGVudW0gYXRzY21oX3NjY2NfYmxvY2tfbW9kZSAqc2NjY19ibG9jaykKK3sKKwl1
OCB2YWw7CisJaW50IHJldDsKKworCXN3aXRjaCAoc3RhdGUtPmNmZy0+bGdfY2hpcCkgeworCWNh
c2UgTEcyMTYwOgorCQlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDMxNSwgJnZhbCk7
CisJCWJyZWFrOworCWNhc2UgTEcyMTYxOgorCQlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUs
IDB4MDUxMSwgJnZhbCk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldCA9IC1FSU5WQUw7CisJ
fQorCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCXN3aXRjaCAodmFsICYgMHgw
MykgeworCWNhc2UgMHgwMDoKKwkJKnNjY2NfYmxvY2sgPSBBVFNDTUhfU0NDQ19CTEtfU0VQOwor
CQlicmVhazsKKwljYXNlIDB4MDE6CisJCSpzY2NjX2Jsb2NrID0gQVRTQ01IX1NDQ0NfQkxLX0NP
TUI7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCSpzY2NjX2Jsb2NrID0gQVRTQ01IX1NDQ0NfQkxL
X1JFUzsKKwkJYnJlYWs7CisJfQorZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IGxnMjE2eF9nZXRfc2NjY19jb2RlX21vZGUoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsCisJ
CQkJICAgICBlbnVtIGF0c2NtaF9zY2NjX2NvZGVfbW9kZSAqbW9kZV9hLAorCQkJCSAgICAgZW51
bSBhdHNjbWhfc2NjY19jb2RlX21vZGUgKm1vZGVfYiwKKwkJCQkgICAgIGVudW0gYXRzY21oX3Nj
Y2NfY29kZV9tb2RlICptb2RlX2MsCisJCQkJICAgICBlbnVtIGF0c2NtaF9zY2NjX2NvZGVfbW9k
ZSAqbW9kZV9kKQoreworCXU4IHZhbDsKKwlpbnQgcmV0OworCisJc3dpdGNoIChzdGF0ZS0+Y2Zn
LT5sZ19jaGlwKSB7CisJY2FzZSBMRzIxNjA6CisJCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhzdGF0
ZSwgMHgwMzE2LCAmdmFsKTsKKwkJYnJlYWs7CisJY2FzZSBMRzIxNjE6CisJCXJldCA9IGxnMjE2
eF9yZWFkX3JlZyhzdGF0ZSwgMHgwNTEyLCAmdmFsKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJ
cmV0ID0gLUVJTlZBTDsKKwl9CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJ
c3dpdGNoICgodmFsID4+IDYpICYgMHgwMykgeworCWNhc2UgMHgwMDoKKwkJKm1vZGVfYSA9IEFU
U0NNSF9TQ0NDX0NPREVfSExGOworCQlicmVhazsKKwljYXNlIDB4MDE6CisJCSptb2RlX2EgPSBB
VFNDTUhfU0NDQ19DT0RFX1FUUjsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJKm1vZGVfYSA9IEFU
U0NNSF9TQ0NDX0NPREVfUkVTOworCQlicmVhazsKKwl9CisKKwlzd2l0Y2ggKCh2YWwgPj4gNCkg
JiAweDAzKSB7CisJY2FzZSAweDAwOgorCQkqbW9kZV9iID0gQVRTQ01IX1NDQ0NfQ09ERV9ITEY7
CisJCWJyZWFrOworCWNhc2UgMHgwMToKKwkJKm1vZGVfYiA9IEFUU0NNSF9TQ0NDX0NPREVfUVRS
OworCQlicmVhazsKKwlkZWZhdWx0OgorCQkqbW9kZV9iID0gQVRTQ01IX1NDQ0NfQ09ERV9SRVM7
CisJCWJyZWFrOworCX0KKworCXN3aXRjaCAoKHZhbCA+PiAyKSAmIDB4MDMpIHsKKwljYXNlIDB4
MDA6CisJCSptb2RlX2MgPSBBVFNDTUhfU0NDQ19DT0RFX0hMRjsKKwkJYnJlYWs7CisJY2FzZSAw
eDAxOgorCQkqbW9kZV9jID0gQVRTQ01IX1NDQ0NfQ09ERV9RVFI7CisJCWJyZWFrOworCWRlZmF1
bHQ6CisJCSptb2RlX2MgPSBBVFNDTUhfU0NDQ19DT0RFX1JFUzsKKwkJYnJlYWs7CisJfQorCisJ
c3dpdGNoICh2YWwgJiAweDAzKSB7CisJY2FzZSAweDAwOgorCQkqbW9kZV9kID0gQVRTQ01IX1ND
Q0NfQ09ERV9ITEY7CisJCWJyZWFrOworCWNhc2UgMHgwMToKKwkJKm1vZGVfZCA9IEFUU0NNSF9T
Q0NDX0NPREVfUVRSOworCQlicmVhazsKKwlkZWZhdWx0OgorCQkqbW9kZV9kID0gQVRTQ01IX1ND
Q0NfQ09ERV9SRVM7CisJCWJyZWFrOworCX0KK2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworLyog
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tICovCisKK3N0YXRpYyBpbnQgbGcyMTZ4X3JlYWRfZmljX2Vycl9jb3Vu
dChzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwgdTggKmVycikKK3sKKwl1OCBmaWNfZXJyOwor
CWludCByZXQ7CisKKwkqZXJyID0gMDsKKworCXN3aXRjaCAoc3RhdGUtPmNmZy0+bGdfY2hpcCkg
eworCWNhc2UgTEcyMTYwOgorCQlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDAxMiwg
JmZpY19lcnIpOworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJcmV0ID0gbGcyMTZ4X3JlYWRf
cmVnKHN0YXRlLCAweDAwMWUsICZmaWNfZXJyKTsKKwkJYnJlYWs7CisJfQorCWlmIChsZ19mYWls
KHJldCkpCisJCWdvdG8gZmFpbDsKKworCSplcnIgPSBmaWNfZXJyOworZmFpbDoKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IGxnMjE2MF9yZWFkX2NyY19lcnJfY291bnQoc3RydWN0IGxn
MjE2eF9zdGF0ZSAqc3RhdGUsIHUxNiAqZXJyKQoreworCXU4IGNyY19lcnIxLCBjcmNfZXJyMjsK
KwlpbnQgcmV0OworCisJKmVyciA9IDA7CisKKwlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUs
IDB4MDQxMSwgJmNyY19lcnIxKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisK
KwlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDQxMiwgJmNyY19lcnIyKTsKKwlpZiAo
bGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwkqZXJyID0gKHUxNikoKChjcmNfZXJyMiAm
IDB4MGYpIDw8IDgpIHwgY3JjX2VycjEpOworZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0
aWMgaW50IGxnMjE2MV9yZWFkX2NyY19lcnJfY291bnQoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3Rh
dGUsIHUxNiAqZXJyKQoreworCXU4IGNyY19lcnI7CisJaW50IHJldDsKKworCSplcnIgPSAwOwor
CisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDA2MTIsICZjcmNfZXJyKTsKKwlpZiAo
bGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwkqZXJyID0gKHUxNiljcmNfZXJyOworZmFp
bDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGxnMjE2eF9yZWFkX2NyY19lcnJfY291
bnQoc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUsIHUxNiAqZXJyKQoreworCWludCByZXQ7CisJ
c3dpdGNoIChzdGF0ZS0+Y2ZnLT5sZ19jaGlwKSB7CisJY2FzZSBMRzIxNjA6CisJCXJldCA9IGxn
MjE2MF9yZWFkX2NyY19lcnJfY291bnQoc3RhdGUsIGVycik7CisJCWJyZWFrOworCWNhc2UgTEcy
MTYxOgorCQlyZXQgPSBsZzIxNjFfcmVhZF9jcmNfZXJyX2NvdW50KHN0YXRlLCBlcnIpOworCQli
cmVhazsKKwlkZWZhdWx0OgorCQlyZXQgPSAtRUlOVkFMOworCQlicmVhazsKKwl9CisJcmV0dXJu
IHJldDsKK30KKworc3RhdGljIGludCBsZzIxNjBfcmVhZF9yc19lcnJfY291bnQoc3RydWN0IGxn
MjE2eF9zdGF0ZSAqc3RhdGUsIHUxNiAqZXJyKQoreworCXU4IHJzX2VycjEsIHJzX2VycjI7CisJ
aW50IHJldDsKKworCSplcnIgPSAwOworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAw
eDA0MTMsICZyc19lcnIxKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwly
ZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDQxNCwgJnJzX2VycjIpOworCWlmIChsZ19m
YWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCSplcnIgPSAodTE2KSgoKHJzX2VycjIgJiAweDBm
KSA8PCA4KSB8IHJzX2VycjEpOworZmFpbDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50
IGxnMjE2MV9yZWFkX3JzX2Vycl9jb3VudChzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwgdTE2
ICplcnIpCit7CisJdTggcnNfZXJyMSwgcnNfZXJyMjsKKwlpbnQgcmV0OworCisJKmVyciA9IDA7
CisKKwlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDYxMywgJnJzX2VycjEpOworCWlm
IChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCXJldCA9IGxnMjE2eF9yZWFkX3JlZyhz
dGF0ZSwgMHgwNjE0LCAmcnNfZXJyMik7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWls
OworCisJKmVyciA9ICh1MTYpKChyc19lcnIxIDw8IDgpIHwgcnNfZXJyMik7CitmYWlsOgorCXJl
dHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgbGcyMTZ4X3JlYWRfcnNfZXJyX2NvdW50KHN0cnVj
dCBsZzIxNnhfc3RhdGUgKnN0YXRlLCB1MTYgKmVycikKK3sKKwlpbnQgcmV0OworCXN3aXRjaCAo
c3RhdGUtPmNmZy0+bGdfY2hpcCkgeworCWNhc2UgTEcyMTYwOgorCQlyZXQgPSBsZzIxNjBfcmVh
ZF9yc19lcnJfY291bnQoc3RhdGUsIGVycik7CisJCWJyZWFrOworCWNhc2UgTEcyMTYxOgorCQly
ZXQgPSBsZzIxNjFfcmVhZF9yc19lcnJfY291bnQoc3RhdGUsIGVycik7CisJCWJyZWFrOworCWRl
ZmF1bHQ6CisJCXJldCA9IC1FSU5WQUw7CisJCWJyZWFrOworCX0KKwlyZXR1cm4gcmV0OworfQor
CisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KKworc3RhdGljIGludCBsZzIxNnhfZ2V0X2Zyb250ZW5k
KHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLAorCQkJICAgICAgIHN0cnVjdCBkdmJfZnJvbnRlbmRf
cGFyYW1ldGVycyAqcGFyYW0pCit7CisJc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUgPSBmZS0+
ZGVtb2R1bGF0b3JfcHJpdjsKKwlpbnQgcmV0OworCisJbGdfZGJnKCJcbiIpOworCisJcGFyYW0t
PnUudnNiLm1vZHVsYXRpb24gPSBWU0JfODsgLyogRklYTUUgKE1IKSAqLworCXBhcmFtLT5mcmVx
dWVuY3kgPSBzdGF0ZS0+Y3VycmVudF9mcmVxdWVuY3k7CisKKwlmZS0+ZHR2X3Byb3BlcnR5X2Nh
Y2hlLmRlbGl2ZXJ5X3N5c3RlbSA9IFNZU19BVFNDTUg7CisKKwlyZXQgPSBsZzIxNnhfZ2V0X2Zp
Y192ZXJzaW9uKHN0YXRlLAorCQkJCSAgICAgJmZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21o
X2ZpY192ZXIpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKwlpZiAoc3RhdGUt
PmZpY192ZXIgIT0gZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5hdHNjbWhfZmljX3ZlcikgeworCQlz
dGF0ZS0+ZmljX3ZlciA9IGZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX2ZpY192ZXI7CisK
KyNpZiAwCisJCXJldCA9IGxnMjE2MF9nZXRfcGFyYWRlX2lkKHN0YXRlLAorCQkJCSZmZS0+ZHR2
X3Byb3BlcnR5X2NhY2hlLmF0c2NtaF9wYXJhZGVfaWQpOworCQlpZiAobGdfZmFpbChyZXQpKQor
CQkJZ290byBmYWlsOworLyogI2Vsc2UgKi8KKwkJZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5hdHNj
bWhfcGFyYWRlX2lkID0gc3RhdGUtPnBhcmFkZV9pZDsKKyNlbmRpZgorCQlyZXQgPSBsZzIxNnhf
Z2V0X25vZyhzdGF0ZSwKKwkJCQkgICAgICZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2NtaF9u
b2cpOworCQlpZiAobGdfZmFpbChyZXQpKQorCQkJZ290byBmYWlsOworCQlyZXQgPSBsZzIxNnhf
Z2V0X3Rub2coc3RhdGUsCisJCQkJICAgICAgJmZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21o
X3Rub2cpOworCQlpZiAobGdfZmFpbChyZXQpKQorCQkJZ290byBmYWlsOworCQlyZXQgPSBsZzIx
NnhfZ2V0X3NnbihzdGF0ZSwKKwkJCQkgICAgICZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2Nt
aF9zZ24pOworCQlpZiAobGdfZmFpbChyZXQpKQorCQkJZ290byBmYWlsOworCQlyZXQgPSBsZzIx
NnhfZ2V0X3ByYyhzdGF0ZSwKKwkJCQkgICAgICZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2Nt
aF9wcmMpOworCQlpZiAobGdfZmFpbChyZXQpKQorCQkJZ290byBmYWlsOworCisJCXJldCA9IGxn
MjE2eF9nZXRfcnNfZnJhbWVfbW9kZShzdGF0ZSwKKwkJCShlbnVtIGF0c2NtaF9yc19mcmFtZV9t
b2RlICopCisJCQkmZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5hdHNjbWhfcnNfZnJhbWVfbW9kZSk7
CisJCWlmIChsZ19mYWlsKHJldCkpCisJCQlnb3RvIGZhaWw7CisJCXJldCA9IGxnMjE2eF9nZXRf
cnNfZnJhbWVfZW5zZW1ibGUoc3RhdGUsCisJCQkoZW51bSBhdHNjbWhfcnNfZnJhbWVfZW5zZW1i
bGUgKikKKwkJCSZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2NtaF9yc19mcmFtZV9lbnNlbWJs
ZSk7CisJCWlmIChsZ19mYWlsKHJldCkpCisJCQlnb3RvIGZhaWw7CisJCXJldCA9IGxnMjE2eF9n
ZXRfcnNfY29kZV9tb2RlKHN0YXRlLAorCQkJKGVudW0gYXRzY21oX3JzX2NvZGVfbW9kZSAqKQor
CQkJJmZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX3JzX2NvZGVfbW9kZV9wcmksCisJCQko
ZW51bSBhdHNjbWhfcnNfY29kZV9tb2RlICopCisJCQkmZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5h
dHNjbWhfcnNfY29kZV9tb2RlX3NlYyk7CisJCWlmIChsZ19mYWlsKHJldCkpCisJCQlnb3RvIGZh
aWw7CisJCXJldCA9IGxnMjE2eF9nZXRfc2NjY19ibG9ja19tb2RlKHN0YXRlLAorCQkJKGVudW0g
YXRzY21oX3NjY2NfYmxvY2tfbW9kZSAqKQorCQkJJmZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRz
Y21oX3NjY2NfYmxvY2tfbW9kZSk7CisJCWlmIChsZ19mYWlsKHJldCkpCisJCQlnb3RvIGZhaWw7
CisJCXJldCA9IGxnMjE2eF9nZXRfc2NjY19jb2RlX21vZGUoc3RhdGUsCisJCQkoZW51bSBhdHNj
bWhfc2NjY19jb2RlX21vZGUgKikKKwkJCSZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2NtaF9z
Y2NjX2NvZGVfbW9kZV9hLAorCQkJKGVudW0gYXRzY21oX3NjY2NfY29kZV9tb2RlICopCisJCQkm
ZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5hdHNjbWhfc2NjY19jb2RlX21vZGVfYiwKKwkJCShlbnVt
IGF0c2NtaF9zY2NjX2NvZGVfbW9kZSAqKQorCQkJJmZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRz
Y21oX3NjY2NfY29kZV9tb2RlX2MsCisJCQkoZW51bSBhdHNjbWhfc2NjY19jb2RlX21vZGUgKikK
KwkJCSZmZS0+ZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2NtaF9zY2NjX2NvZGVfbW9kZV9kKTsKKwkJ
aWYgKGxnX2ZhaWwocmV0KSkKKwkJCWdvdG8gZmFpbDsKKwl9CisJcmV0ID0gbGcyMTZ4X3JlYWRf
ZmljX2Vycl9jb3VudChzdGF0ZSwKKwkJCQkodTggKikmZmUtPmR0dl9wcm9wZXJ0eV9jYWNoZS5h
dHNjbWhfZmljX2Vycik7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCXJldCA9
IGxnMjE2eF9yZWFkX2NyY19lcnJfY291bnQoc3RhdGUsCisJCQkJJmZlLT5kdHZfcHJvcGVydHlf
Y2FjaGUuYXRzY21oX2NyY19lcnIpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsK
KwlyZXQgPSBsZzIxNnhfcmVhZF9yc19lcnJfY291bnQoc3RhdGUsCisJCQkJJmZlLT5kdHZfcHJv
cGVydHlfY2FjaGUuYXRzY21oX3JzX2Vycik7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBm
YWlsOworCisJc3dpdGNoIChzdGF0ZS0+Y2ZnLT5sZ19jaGlwKSB7CisJY2FzZSBMRzIxNjA6CisJ
CWlmICgoKGZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX3JzX2VyciA+PSAyNDApICYmCisJ
CSAgICAgKGZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX2NyY19lcnIgPj0gMjQwKSkgJiYK
KwkJICAgICgoamlmZmllc190b19tc2VjcyhqaWZmaWVzKSAtIHN0YXRlLT5sYXN0X3Jlc2V0KSA+
IDYwMDApKQorCQkJcmV0ID0gbGcyMTZ4X3NvZnRfcmVzZXQoc3RhdGUpOworCQlicmVhazsKKwlj
YXNlIExHMjE2MToKKwkJLyogbm8gZml4IG5lZWRlZCBoZXJlIChhcyBmYXIgYXMgd2Uga25vdykg
Ki8KKwkJcmV0ID0gMDsKKwkJYnJlYWs7CisJfQorCWxnX2ZhaWwocmV0KTsKK2ZhaWw6CisJcmV0
dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNnhfZ2V0X3Byb3BlcnR5KHN0cnVjdCBkdmJf
ZnJvbnRlbmQgKmZlLAorCQkJICAgICAgIHN0cnVjdCBkdHZfcHJvcGVydHkgKnR2cCkKK3sKKwlz
dHJ1Y3QgZHZiX2Zyb250ZW5kX3BhcmFtZXRlcnMgcGFyYW07CisKKwlyZXR1cm4gKERUVl9BVFND
TUhfRklDX1ZFUiA9PSB0dnAtPmNtZCkgPworCQlsZzIxNnhfZ2V0X2Zyb250ZW5kKGZlLCAmcGFy
YW0pIDogMDsKK30KKworCitzdGF0aWMgaW50IGxnMjE2MF9zZXRfZnJvbnRlbmQoc3RydWN0IGR2
Yl9mcm9udGVuZCAqZmUsCisJCQkgICAgICAgc3RydWN0IGR2Yl9mcm9udGVuZF9wYXJhbWV0ZXJz
ICpwYXJhbSkKK3sKKwlzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSA9IGZlLT5kZW1vZHVsYXRv
cl9wcml2OworCWludCByZXQ7CisKKwlsZ19kYmcoIiglZCwgJWQpXG4iLCBwYXJhbS0+ZnJlcXVl
bmN5LCBwYXJhbS0+dS52c2IubW9kdWxhdGlvbik7CisKKwlpZiAoZmUtPm9wcy50dW5lcl9vcHMu
c2V0X3BhcmFtcykgeworCQlyZXQgPSBmZS0+b3BzLnR1bmVyX29wcy5zZXRfcGFyYW1zKGZlLCBw
YXJhbSk7CisJCWlmIChmZS0+b3BzLmkyY19nYXRlX2N0cmwpCisJCQlmZS0+b3BzLmkyY19nYXRl
X2N0cmwoZmUsIDApOworCQlpZiAobGdfZmFpbChyZXQpKQorCQkJZ290byBmYWlsOworCQlzdGF0
ZS0+Y3VycmVudF9mcmVxdWVuY3kgPSBwYXJhbS0+ZnJlcXVlbmN5OworCX0KKworCXJldCA9IGxn
MjE2MF9hZ2NfZml4KHN0YXRlLCAwLCAwKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZh
aWw7CisJcmV0ID0gbGcyMTYwX2FnY19wb2xhcml0eShzdGF0ZSwgMCwgMCk7CisJaWYgKGxnX2Zh
aWwocmV0KSkKKwkJZ290byBmYWlsOworCXJldCA9IGxnMjE2MF90dW5lcl9wd3Jfc2F2ZV9wb2xh
cml0eShzdGF0ZSwgMSk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCXJldCA9
IGxnMjE2eF9zZXRfaWYoc3RhdGUpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsK
KwlyZXQgPSBsZzIxNjBfc3BlY3RydW1fcG9sYXJpdHkoc3RhdGUsIHN0YXRlLT5jZmctPnNwZWN0
cmFsX2ludmVyc2lvbik7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJLyog
YmUgdHVuZWQgYmVmb3JlIHRoaXMgcG9pbnQgKi8KKwlyZXQgPSBsZzIxNnhfc29mdF9yZXNldChz
dGF0ZSk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJcmV0ID0gbGcyMTYw
X3R1bmVyX3B3cl9zYXZlKHN0YXRlLCAwKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZh
aWw7CisKKwlzd2l0Y2ggKHN0YXRlLT5jZmctPmxnX2NoaXApIHsKKwljYXNlIExHMjE2MDoKKwkJ
cmV0ID0gbGcyMTYwX3NldF9zcGlfY2xvY2soc3RhdGUpOworCQlpZiAobGdfZmFpbChyZXQpKQor
CQkJZ290byBmYWlsOworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJcmV0ID0gbGcyMTYxX3Nl
dF9vdXRwdXRfaW50ZXJmYWNlKHN0YXRlKTsKKwkJaWYgKGxnX2ZhaWwocmV0KSkKKwkJCWdvdG8g
ZmFpbDsKKwkJYnJlYWs7CisJfQorCisJcmV0ID0gbGcyMTZ4X3NldF9wYXJhZGUoc3RhdGUsIGZl
LT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX3BhcmFkZV9pZCk7CisJaWYgKGxnX2ZhaWwocmV0
KSkKKwkJZ290byBmYWlsOworCisJcmV0ID0gbGcyMTZ4X3NldF9lbnNlbWJsZShzdGF0ZSwKKwkJ
CWZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX3JzX2ZyYW1lX2Vuc2VtYmxlKTsKKwlpZiAo
bGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwlyZXQgPSBsZzIxNnhfaW5pdGlhbGl6ZShz
dGF0ZSk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290byBmYWlsOworCisJcmV0ID0gbGcyMTZ4
X2VuYWJsZV9maWMoc3RhdGUsIDEpOworCWxnX2ZhaWwocmV0KTsKKworCWxnMjE2eF9nZXRfZnJv
bnRlbmQoZmUsIHBhcmFtKTsKK2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworLyogLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tICovCisKK3N0YXRpYyBpbnQgbGcyMTYwX3JlYWRfbG9ja19zdGF0dXMoc3RydWN0IGxn
MjE2eF9zdGF0ZSAqc3RhdGUsCisJCQkJICAgaW50ICphY3FfbG9jaywgaW50ICpzeW5jX2xvY2sp
Cit7CisJdTggdmFsOworCWludCByZXQ7CisKKwkqYWNxX2xvY2sgPSAwOworCSpzeW5jX2xvY2sg
PSAwOworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAxMWIsICZ2YWwpOworCWlm
IChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCSpzeW5jX2xvY2sgPSAodmFsICYgMHgy
MCkgPyAwIDogMTsKKwkqYWNxX2xvY2sgID0gKHZhbCAmIDB4NDApID8gMCA6IDE7CitmYWlsOgor
CXJldHVybiByZXQ7Cit9CisKKyNpZmRlZiBVU0VfTEcyMTYxX0xPQ0tfQklUUworc3RhdGljIGlu
dCBsZzIxNjFfcmVhZF9sb2NrX3N0YXR1cyhzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpzdGF0ZSwKKwkJ
CQkgICBpbnQgKmFjcV9sb2NrLCBpbnQgKnN5bmNfbG9jaykKK3sKKwl1OCB2YWw7CisJaW50IHJl
dDsKKworCSphY3FfbG9jayA9IDA7CisJKnN5bmNfbG9jayA9IDA7CisKKwlyZXQgPSBsZzIxNnhf
cmVhZF9yZWcoc3RhdGUsIDB4MDMwNCwgJnZhbCk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290
byBmYWlsOworCisJKnN5bmNfbG9jayA9ICh2YWwgJiAweDgwKSA/IDAgOiAxOworCisJcmV0ID0g
bGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAxMWIsICZ2YWwpOworCWlmIChsZ19mYWlsKHJldCkp
CisJCWdvdG8gZmFpbDsKKworCSphY3FfbG9jayAgPSAodmFsICYgMHg0MCkgPyAwIDogMTsKK2Zh
aWw6CisJcmV0dXJuIHJldDsKK30KKyNlbmRpZgorCitzdGF0aWMgaW50IGxnMjE2eF9yZWFkX2xv
Y2tfc3RhdHVzKHN0cnVjdCBsZzIxNnhfc3RhdGUgKnN0YXRlLAorCQkJCSAgIGludCAqYWNxX2xv
Y2ssIGludCAqc3luY19sb2NrKQoreworI2lmZGVmIFVTRV9MRzIxNjFfTE9DS19CSVRTCisJaW50
IHJldDsKKwlzd2l0Y2ggKHN0YXRlLT5jZmctPmxnX2NoaXApIHsKKwljYXNlIExHMjE2MDoKKwkJ
cmV0ID0gbGcyMTYwX3JlYWRfbG9ja19zdGF0dXMoc3RhdGUsIGFjcV9sb2NrLCBzeW5jX2xvY2sp
OworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJcmV0ID0gbGcyMTYxX3JlYWRfbG9ja19zdGF0
dXMoc3RhdGUsIGFjcV9sb2NrLCBzeW5jX2xvY2spOworCQlicmVhazsKKwlkZWZhdWx0OgorCQly
ZXQgPSAtRUlOVkFMOworCQlicmVhazsKKwl9CisJcmV0dXJuIHJldDsKKyNlbHNlCisJcmV0dXJu
IGxnMjE2MF9yZWFkX2xvY2tfc3RhdHVzKHN0YXRlLCBhY3FfbG9jaywgc3luY19sb2NrKTsKKyNl
bmRpZgorfQorCitzdGF0aWMgaW50IGxnMjE2eF9yZWFkX3N0YXR1cyhzdHJ1Y3QgZHZiX2Zyb250
ZW5kICpmZSwgZmVfc3RhdHVzX3QgKnN0YXR1cykKK3sKKwlzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpz
dGF0ZSA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCWludCByZXQsIGFjcV9sb2NrLCBzeW5jX2xv
Y2s7CisKKwkqc3RhdHVzID0gMDsKKworCXJldCA9IGxnMjE2eF9yZWFkX2xvY2tfc3RhdHVzKHN0
YXRlLCAmYWNxX2xvY2ssICZzeW5jX2xvY2spOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8g
ZmFpbDsKKworCWxnX2RiZygiJXMlc1xuIiwKKwkgICAgICAgYWNxX2xvY2sgID8gIlNJR05BTEVY
SVNUICIgOiAiIiwKKwkgICAgICAgc3luY19sb2NrID8gIlNZTkNMT0NLIiAgICAgOiAiIik7CisK
KwlpZiAoYWNxX2xvY2spCisJCSpzdGF0dXMgfD0gRkVfSEFTX1NJR05BTDsKKwlpZiAoc3luY19s
b2NrKQorCQkqc3RhdHVzIHw9IEZFX0hBU19TWU5DOworCisJaWYgKCpzdGF0dXMpCisJCSpzdGF0
dXMgfD0gRkVfSEFTX0NBUlJJRVIgfCBGRV9IQVNfVklURVJCSSB8IEZFX0hBU19MT0NLOworCitm
YWlsOgorCXJldHVybiByZXQ7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCitzdGF0aWMg
aW50IGxnMjE2MF9yZWFkX3NucihzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTE2ICpzbnIpCit7
CisJc3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKwl1
OCBzbnIxLCBzbnIyOworCWludCByZXQ7CisKKwkqc25yID0gMDsKKworCXJldCA9IGxnMjE2eF9y
ZWFkX3JlZyhzdGF0ZSwgMHgwMjAyLCAmc25yMSk7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJZ290
byBmYWlsOworCisJcmV0ID0gbGcyMTZ4X3JlYWRfcmVnKHN0YXRlLCAweDAyMDMsICZzbnIyKTsK
KwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisKKwlpZiAoKHNucjEgPT0gMHhiYSkg
fHwgKHNucjIgPT0gMHhkZikpCisJCSpzbnIgPSAwOworCWVsc2UKKyNpZiAxCisJKnNuciA9ICAo
KHNucjEgPj4gNCkgKiAxMDApICsgKChzbnIxICYgMHgwZikgKiAxMCkgKyAoc25yMiA+PiA0KTsK
KyNlbHNlIC8qIEJDRCAqLworCSpzbnIgPSAgKHNucjIgfCAoc25yMSA8PCA4KSk7CisjZW5kaWYK
K2ZhaWw6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBsZzIxNjFfcmVhZF9zbnIoc3Ry
dWN0IGR2Yl9mcm9udGVuZCAqZmUsIHUxNiAqc25yKQoreworCXN0cnVjdCBsZzIxNnhfc3RhdGUg
KnN0YXRlID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7CisJdTggc25yMSwgc25yMjsKKwlpbnQgcmV0
OworCisJKnNuciA9IDA7CisKKwlyZXQgPSBsZzIxNnhfcmVhZF9yZWcoc3RhdGUsIDB4MDMwMiwg
JnNucjEpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKworCXJldCA9IGxnMjE2
eF9yZWFkX3JlZyhzdGF0ZSwgMHgwMzAzLCAmc25yMik7CisJaWYgKGxnX2ZhaWwocmV0KSkKKwkJ
Z290byBmYWlsOworCisJaWYgKChzbnIxID09IDB4YmEpIHx8IChzbnIyID09IDB4ZmQpKQorCQkq
c25yID0gMDsKKwllbHNlCisKKwkqc25yID0gICgoc25yMSA+PiA0KSAqIDEwMCkgKyAoKHNucjEg
JiAweDBmKSAqIDEwKSArIChzbnIyICYgMHgwZik7CitmYWlsOgorCXJldHVybiByZXQ7Cit9CisK
K3N0YXRpYyBpbnQgbGcyMTZ4X3JlYWRfc2lnbmFsX3N0cmVuZ3RoKHN0cnVjdCBkdmJfZnJvbnRl
bmQgKmZlLAorCQkJCSAgICAgICB1MTYgKnN0cmVuZ3RoKQoreworI2lmIDAKKwkvKiBib3Jyb3dl
ZCBmcm9tIGxnZHQzMzB4LmMKKwkgKgorCSAqIENhbGN1bGF0ZSBzdHJlbmd0aCBmcm9tIFNOUiB1
cCB0byAzNWRCCisJICogRXZlbiB0aG91Z2ggdGhlIFNOUiBjYW4gZ28gaGlnaGVyIHRoYW4gMzVk
QiwKKwkgKiB0aGVyZSBpcyBzb21lIGNvbWZvcnQgZmFjdG9yIGluIGhhdmluZyBhIHJhbmdlIG9m
CisJICogc3Ryb25nIHNpZ25hbHMgdGhhdCBjYW4gc2hvdyBhdCAxMDAlCisJICovCisJc3RydWN0
IGxnMjE2eF9zdGF0ZSAqc3RhdGUgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKwl1MTYgc25yOwor
CWludCByZXQ7CisjZW5kaWYKKwkqc3RyZW5ndGggPSAwOworI2lmIDAKKwlyZXQgPSBmZS0+b3Bz
LnJlYWRfc25yKGZlLCAmc25yKTsKKwlpZiAobGdfZmFpbChyZXQpKQorCQlnb3RvIGZhaWw7CisJ
LyogUmF0aGVyIHRoYW4gdXNlIHRoZSA4LjggdmFsdWUgc25yLCB1c2Ugc3RhdGUtPnNuciB3aGlj
aCBpcyA4LjI0ICovCisJLyogc2NhbGUgdGhlIHJhbmdlIDAgLSAzNSoyXjI0IGludG8gMCAtIDY1
NTM1ICovCisJaWYgKHN0YXRlLT5zbnIgPj0gODk2MCAqIDB4MTAwMDApCisJCSpzdHJlbmd0aCA9
IDB4ZmZmZjsKKwllbHNlCisJCSpzdHJlbmd0aCA9IHN0YXRlLT5zbnIgLyA4OTYwOworZmFpbDoK
KwlyZXR1cm4gcmV0OworI2Vsc2UKKwlyZXR1cm4gMDsKKyNlbmRpZgorfQorCisvKiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0gKi8KKworc3RhdGljIGludCBsZzIxNnhfcmVhZF91Y2Jsb2NrcyhzdHJ1Y3QgZHZi
X2Zyb250ZW5kICpmZSwgdTMyICp1Y2Jsb2NrcykKK3sKKwlzdHJ1Y3QgbGcyMTZ4X3N0YXRlICpz
dGF0ZSA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCWludCByZXQ7CisKKwlyZXQgPSBsZzIxNnhf
cmVhZF9yc19lcnJfY291bnQoc3RhdGUsCisJCQkJICAgICAgICZmZS0+ZHR2X3Byb3BlcnR5X2Nh
Y2hlLmF0c2NtaF9yc19lcnIpOworCWlmIChsZ19mYWlsKHJldCkpCisJCWdvdG8gZmFpbDsKKwor
CSp1Y2Jsb2NrcyA9IGZlLT5kdHZfcHJvcGVydHlfY2FjaGUuYXRzY21oX3JzX2VycjsKK2ZhaWw6
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGcyMTZ4X2dldF90dW5lX3NldHRpbmdzKHN0
cnVjdCBkdmJfZnJvbnRlbmQgKmZlLAorCQkJCSAgICBzdHJ1Y3QgZHZiX2Zyb250ZW5kX3R1bmVf
c2V0dGluZ3MKKwkJCQkgICAgKmZlX3R1bmVfc2V0dGluZ3MpCit7CisJZmVfdHVuZV9zZXR0aW5n
cy0+bWluX2RlbGF5X21zID0gNTAwOworCWxnX2RiZygiXG4iKTsKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIHZvaWQgbGcyMTZ4X3JlbGVhc2Uoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUpCit7CisJ
c3RydWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKwlsZ19k
YmcoIlxuIik7CisJa2ZyZWUoc3RhdGUpOworfQorCitzdGF0aWMgc3RydWN0IGR2Yl9mcm9udGVu
ZF9vcHMgbGcyMTYwX29wcyA9IHsKKwkuZGVsc3lzID0geyBTWVNfQVRTQ01IIH0sCisJLmluZm8g
PSB7CisJCS5uYW1lID0gIkxHIEVsZWN0cm9uaWNzIExHMjE2MCBBVFNDL01IIEZyb250ZW5kIiwK
KwkJLnR5cGUgICAgICAgICAgICAgICA9IEZFX0FUU0MsCisJCS5mcmVxdWVuY3lfbWluICAgICAg
PSA1NDAwMDAwMCwKKwkJLmZyZXF1ZW5jeV9tYXggICAgICA9IDg1ODAwMDAwMCwKKwkJLmZyZXF1
ZW5jeV9zdGVwc2l6ZSA9IDYyNTAwLAorCQkuY2FwcyA9IEZFX0NBTl84VlNCIHwgRkVfSEFTX0VY
VEVOREVEX0NBUFMgLyogRklYTUUgKE1IKSAqLworCX0sCisJLmkyY19nYXRlX2N0cmwgICAgICAg
ID0gbGcyMTZ4X2kyY19nYXRlX2N0cmwsCisjaWYgMAorCS5pbml0ICAgICAgICAgICAgICAgICA9
IGxnMjE2eF9pbml0LAorCS5zbGVlcCAgICAgICAgICAgICAgICA9IGxnMjE2eF9zbGVlcCwKKyNl
bmRpZgorCS5nZXRfcHJvcGVydHkgICAgICAgICA9IGxnMjE2eF9nZXRfcHJvcGVydHksCisKKwku
c2V0X2Zyb250ZW5kICAgICAgICAgPSBsZzIxNjBfc2V0X2Zyb250ZW5kLAorCS5nZXRfZnJvbnRl
bmQgICAgICAgICA9IGxnMjE2eF9nZXRfZnJvbnRlbmQsCisJLmdldF90dW5lX3NldHRpbmdzICAg
ID0gbGcyMTZ4X2dldF90dW5lX3NldHRpbmdzLAorCS5yZWFkX3N0YXR1cyAgICAgICAgICA9IGxn
MjE2eF9yZWFkX3N0YXR1cywKKyNpZiAwCisJLnJlYWRfYmVyICAgICAgICAgICAgID0gbGcyMTZ4
X3JlYWRfYmVyLAorI2VuZGlmCisJLnJlYWRfc2lnbmFsX3N0cmVuZ3RoID0gbGcyMTZ4X3JlYWRf
c2lnbmFsX3N0cmVuZ3RoLAorCS5yZWFkX3NuciAgICAgICAgICAgICA9IGxnMjE2MF9yZWFkX3Nu
ciwKKwkucmVhZF91Y2Jsb2NrcyAgICAgICAgPSBsZzIxNnhfcmVhZF91Y2Jsb2NrcywKKwkucmVs
ZWFzZSAgICAgICAgICAgICAgPSBsZzIxNnhfcmVsZWFzZSwKK307CisKK3N0YXRpYyBzdHJ1Y3Qg
ZHZiX2Zyb250ZW5kX29wcyBsZzIxNjFfb3BzID0geworCS5kZWxzeXMgPSB7IFNZU19BVFNDTUgg
fSwKKwkuaW5mbyA9IHsKKwkJLm5hbWUgPSAiTEcgRWxlY3Ryb25pY3MgTEcyMTYxIEFUU0MvTUgg
RnJvbnRlbmQiLAorCQkudHlwZSAgICAgICAgICAgICAgID0gRkVfQVRTQywKKwkJLmZyZXF1ZW5j
eV9taW4gICAgICA9IDU0MDAwMDAwLAorCQkuZnJlcXVlbmN5X21heCAgICAgID0gODU4MDAwMDAw
LAorCQkuZnJlcXVlbmN5X3N0ZXBzaXplID0gNjI1MDAsCisJCS5jYXBzID0gRkVfQ0FOXzhWU0Ig
fCBGRV9IQVNfRVhURU5ERURfQ0FQUyAvKiBGSVhNRSAoTUgpICovCisJfSwKKwkuaTJjX2dhdGVf
Y3RybCAgICAgICAgPSBsZzIxNnhfaTJjX2dhdGVfY3RybCwKKyNpZiAwCisJLmluaXQgICAgICAg
ICAgICAgICAgID0gbGcyMTZ4X2luaXQsCisJLnNsZWVwICAgICAgICAgICAgICAgID0gbGcyMTZ4
X3NsZWVwLAorI2VuZGlmCisJLmdldF9wcm9wZXJ0eSAgICAgICAgID0gbGcyMTZ4X2dldF9wcm9w
ZXJ0eSwKKworCS5zZXRfZnJvbnRlbmQgICAgICAgICA9IGxnMjE2MF9zZXRfZnJvbnRlbmQsCisJ
LmdldF9mcm9udGVuZCAgICAgICAgID0gbGcyMTZ4X2dldF9mcm9udGVuZCwKKwkuZ2V0X3R1bmVf
c2V0dGluZ3MgICAgPSBsZzIxNnhfZ2V0X3R1bmVfc2V0dGluZ3MsCisJLnJlYWRfc3RhdHVzICAg
ICAgICAgID0gbGcyMTZ4X3JlYWRfc3RhdHVzLAorI2lmIDAKKwkucmVhZF9iZXIgICAgICAgICAg
ICAgPSBsZzIxNnhfcmVhZF9iZXIsCisjZW5kaWYKKwkucmVhZF9zaWduYWxfc3RyZW5ndGggPSBs
ZzIxNnhfcmVhZF9zaWduYWxfc3RyZW5ndGgsCisJLnJlYWRfc25yICAgICAgICAgICAgID0gbGcy
MTYxX3JlYWRfc25yLAorCS5yZWFkX3VjYmxvY2tzICAgICAgICA9IGxnMjE2eF9yZWFkX3VjYmxv
Y2tzLAorCS5yZWxlYXNlICAgICAgICAgICAgICA9IGxnMjE2eF9yZWxlYXNlLAorfTsKKworc3Ry
dWN0IGR2Yl9mcm9udGVuZCAqbGcyMTYwX2F0dGFjaChjb25zdCBzdHJ1Y3QgbGcyMTYwX2NvbmZp
ZyAqY29uZmlnLAorCQkJCSAgIHN0cnVjdCBpMmNfYWRhcHRlciAqaTJjX2FkYXApCit7CisJc3Ry
dWN0IGxnMjE2eF9zdGF0ZSAqc3RhdGUgPSBOVUxMOworCisJbGdfZGJnKCIoJWQtJTA0eClcbiIs
CisJICAgICAgIGkyY19hZGFwID8gaTJjX2FkYXB0ZXJfaWQoaTJjX2FkYXApIDogMCwKKwkgICAg
ICAgY29uZmlnID8gY29uZmlnLT5pMmNfYWRkciA6IDApOworCisJc3RhdGUgPSBremFsbG9jKHNp
emVvZihzdHJ1Y3QgbGcyMTZ4X3N0YXRlKSwgR0ZQX0tFUk5FTCk7CisJaWYgKHN0YXRlID09IE5V
TEwpCisJCWdvdG8gZmFpbDsKKworCXN0YXRlLT5jZmcgPSBjb25maWc7CisJc3RhdGUtPmkyY19h
ZGFwID0gaTJjX2FkYXA7CisJc3RhdGUtPmZpY192ZXIgPSAweGZmOworCXN0YXRlLT5wYXJhZGVf
aWQgPSAweGZmOworCisJc3dpdGNoIChjb25maWctPmxnX2NoaXApIHsKKwlkZWZhdWx0OgorCQls
Z193YXJuKCJpbnZhbGlkIGNoaXAgcmVxdWVzdGVkLCBkZWZhdWx0aW5nIHRvIExHMjE2MCIpOwor
CQkvKiBmYWxsLXRocnUgKi8KKwljYXNlIExHMjE2MDoKKwkJbWVtY3B5KCZzdGF0ZS0+ZnJvbnRl
bmQub3BzLCAmbGcyMTYwX29wcywKKwkJICAgICAgIHNpemVvZihzdHJ1Y3QgZHZiX2Zyb250ZW5k
X29wcykpOworCQlicmVhazsKKwljYXNlIExHMjE2MToKKwkJbWVtY3B5KCZzdGF0ZS0+ZnJvbnRl
bmQub3BzLCAmbGcyMTYxX29wcywKKwkJICAgICAgIHNpemVvZihzdHJ1Y3QgZHZiX2Zyb250ZW5k
X29wcykpOworCQlicmVhazsKKwl9CisKKwlzdGF0ZS0+ZnJvbnRlbmQuZGVtb2R1bGF0b3JfcHJp
diA9IHN0YXRlOworCXN0YXRlLT5jdXJyZW50X2ZyZXF1ZW5jeSA9IC0xOworCS8qIHBhcmFkZSAx
IGJ5IGRlZmF1bHQgKi8KKwlzdGF0ZS0+ZnJvbnRlbmQuZHR2X3Byb3BlcnR5X2NhY2hlLmF0c2Nt
aF9wYXJhZGVfaWQgPSAxOworCisJcmV0dXJuICZzdGF0ZS0+ZnJvbnRlbmQ7CitmYWlsOgorCWxn
X3dhcm4oInVuYWJsZSB0byBkZXRlY3QgTEcyMTZ4IGhhcmR3YXJlXG4iKTsKKwlrZnJlZShzdGF0
ZSk7CisJcmV0dXJuIE5VTEw7Cit9CitFWFBPUlRfU1lNQk9MKGxnMjE2MF9hdHRhY2gpOworCitN
T0RVTEVfREVTQ1JJUFRJT04oIkxHIEVsZWN0cm9uaWNzIExHMjE2eCBBVFNDL01IIERlbW9kdWxh
dG9yIERyaXZlciIpOworTU9EVUxFX0FVVEhPUigiTWljaGFlbCBLcnVma3kgPG1rcnVma3lAbGlu
dXh0di5vcmc+Iik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CitNT0RVTEVfVkVSU0lPTigiMC4z
Iik7CisKKy8qCisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBjLWJhc2ljLW9mZnNldDogOAorICog
RW5kOgorICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGcyMTYw
LmggYi9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGcyMTYwLmgKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMC4uOWUyYzBmNAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
bWVkaWEvZHZiL2Zyb250ZW5kcy9sZzIxNjAuaApAQCAtMCwwICsxLDg0IEBACisvKgorICogICAg
U3VwcG9ydCBmb3IgTEcyMTYwIC0gQVRTQy9NSAorICoKKyAqICAgIENvcHlyaWdodCAoQykgMjAx
MCBNaWNoYWVsIEtydWZreSA8bWtydWZreUBsaW51eHR2Lm9yZz4KKyAqCisgKiAgICBUaGlzIHBy
b2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1v
ZGlmeQorICogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRp
b247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgICAoYXQgeW91ciBv
cHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogICAgYnV0IFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YK
KyAqICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUKKyAqICAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCisgKgorICogICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUg
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAgICBGb3VuZGF0aW9uLCBJ
bmMuLCA2NzUgTWFzcyBBdmUsIENhbWJyaWRnZSwgTUEgMDIxMzksIFVTQS4KKyAqCisgKi8KKwor
I2lmbmRlZiBfTEcyMTYwX0hfCisjZGVmaW5lIF9MRzIxNjBfSF8KKworI2luY2x1ZGUgPGxpbnV4
L2kyYy5oPgorI2luY2x1ZGUgImR2Yl9mcm9udGVuZC5oIgorCitlbnVtIGxnX2NoaXBfdHlwZSB7
CisJTEcyMTYwID0gMCwKKwlMRzIxNjEgPSAxLAorfTsKKworI2RlZmluZSBMRzIxNjFfMTAxOSBM
RzIxNjEKKyNkZWZpbmUgTEcyMTYxXzEwNDAgTEcyMTYxCisKK2VudW0gbGcyMTYwX3NwaV9jbG9j
ayB7CisJTEcyMTYwX1NQSV8zXzEyNV9NSFogPSAwLAorCUxHMjE2MF9TUElfNl8yNV9NSFogPSAx
LAorCUxHMjE2MF9TUElfMTJfNV9NSFogPSAyLAorfTsKKworI2lmIDAKK2VudW0gbGcyMTYxX29p
ZiB7CisJTEcyMTYxX09JRl9FQkkyX1NMQSAgPSAxLAorCUxHMjE2MV9PSUZfU0RJT19TTEEgID0g
MiwKKwlMRzIxNjFfT0lGX1NQSV9TTEEgICA9IDMsCisJTEcyMTYxX09JRl9TUElfTUFTICAgPSA0
LAorCUxHMjE2MV9PSUZfU0VSSUFMX1RTID0gNywKK307CisjZW5kaWYKKworc3RydWN0IGxnMjE2
MF9jb25maWcgeworCXU4IGkyY19hZGRyOworCisJLyogdXNlciBkZWZpbmVkIElGIGZyZXF1ZW5j
eSBpbiBLSHogKi8KKwl1MTYgaWZfa2h6OworCisJLyogZGlzYWJsZSBpMmMgcmVwZWF0ZXIgLSAw
OnJlcGVhdGVyIGVuYWJsZWQgMTpyZXBlYXRlciBkaXNhYmxlZCAqLworCWludCBkZW55X2kyY19y
cHRyOjE7CisKKwkvKiBzcGVjdHJhbCBpbnZlcnNpb24gLSAwOmRpc2FibGVkIDE6ZW5hYmxlZCAq
LworCWludCBzcGVjdHJhbF9pbnZlcnNpb246MTsKKworCXVuc2lnbmVkIGludCBvdXRwdXRfaWY7
CisJZW51bSBsZzIxNjBfc3BpX2Nsb2NrIHNwaV9jbG9jazsKKwllbnVtIGxnX2NoaXBfdHlwZSBs
Z19jaGlwOworfTsKKworI2lmIGRlZmluZWQoQ09ORklHX0RWQl9MRzIxNjApIHx8IChkZWZpbmVk
KENPTkZJR19EVkJfTEcyMTYwX01PRFVMRSkgJiYgXAorCQkJCSAgICAgZGVmaW5lZChNT0RVTEUp
KQorZXh0ZXJuCitzdHJ1Y3QgZHZiX2Zyb250ZW5kICpsZzIxNjBfYXR0YWNoKGNvbnN0IHN0cnVj
dCBsZzIxNjBfY29uZmlnICpjb25maWcsCisJCQkJICAgICBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmky
Y19hZGFwKTsKKyNlbHNlCitzdGF0aWMgaW5saW5lCitzdHJ1Y3QgZHZiX2Zyb250ZW5kICpsZzIx
NjBfYXR0YWNoKGNvbnN0IHN0cnVjdCBsZzIxNjBfY29uZmlnICpjb25maWcsCisJCQkJICAgICBz
dHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyY19hZGFwKQoreworCXByaW50ayhLRVJOX1dBUk5JTkcgIiVz
OiBkcml2ZXIgZGlzYWJsZWQgYnkgS2NvbmZpZ1xuIiwgX19mdW5jX18pOworCXJldHVybiBOVUxM
OworfQorI2VuZGlmIC8qIENPTkZJR19EVkJfTEcyMTYwICovCisKKyNlbmRpZiAvKiBfTEcyMTYw
X0hfICovCi0tIAoxLjcuNS40Cgo=
--047d7b34403ca9029c04beeca66b--
