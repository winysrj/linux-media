Return-path: <mchehab@gaivota>
Received: from proofpoint-cluster.metrocast.net ([65.175.128.136]:7553 "EHLO
	proofpoint-cluster.metrocast.net" rhost-flags-OK-OK-OK-OK)
	by vger.kernel.org with ESMTP id S1752410Ab0LLSJ2 (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Sun, 12 Dec 2010 13:09:28 -0500
Date: Sun, 12 Dec 2010 13:09:36 -0500
Subject: Re: [RFC/PATCH 03/19] cx18: Use the control framework.
Message-ID: <8lcku8q5u511tsmore3i7sls.1292177376794@email.android.com>
From: Andy Walls <awalls@md.metrocast.net>
To: Hans Verkuil <hverkuil@xs4all.nl>, linux-media@vger.kernel.org
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: base64
List-ID: <linux-media.vger.kernel.org>
Sender: Mauro Carvalho Chehab <mchehab@gaivota>

SGFucywKClRoaXMgaGFzIGF0IGxlYXN0IHRoZSBzYW1lIHR3byBwcm9ibGVtcyB0aGUgY2hhbmdl
IGZvciBjeDI1ODQwIGhhZDoKCjEuIFZvbHVtZSBjb250cm9sIGluaXQgc2hvdWxkIHVzZSA2NTUz
NSBub3QgNjUzMzUKCjIuIFlvdSBjYW5ub3QgdHJ1c3QgcmVnIDB4OGQ0IHRvIGhhdmUgYSB2YWx1
ZSBpbiBpdCBmb3IgdGhlIGRlZmF1bHQgdm9sdW1lIHRoYXQgd29uJ3QgZ2l2ZSBhbiBFUkFOR0Ug
ZXJyb3Igd2hlbiB5b3UgZ28gdG8gaW5pdCB0aGUgdm9sdW1lIGNvbnRyb2wuICBTdWJkZXYgcHJv
YmUgd2lsbCBmYWlsLiBTZWUgbXkgcHJldmlvdXMgY3gyNTg0MCBwYXRjaGVzIHNlbnQgdG8gdGhl
IGxpc3QsIGF3YWl0aW5nIGFjdGlvbi4KCihUaGUgY3gyNTg0MCBjb2RlIHRoYXQgdHJ1c3RzIHRo
ZSB2b2x1bWUgcmVnaXN0ZXIgdG8gYmUgaW4gcmFuZ2UgaXMgYWxyZWFkeSBpbiAyLjYuMzYgYW5k
IGJyZWFrcyBJUiBhbmQgYW5hbG9nIGZvciBDWDIzODg1LzcvOCBjaGlwcy4pCgpJJ2xsIGdpdmUg
dGhpcyB3aG9sZSBwYXRjaCBhIGhhcmRlciBsb29rIGxhdGVyIHRoaXMgZXZlbmluZyBpZiBJIGNh
bi4KClJlZ2FyZHMsCkFuZHkKCkhhbnMgVmVya3VpbCA8aHZlcmt1aWxAeHM0YWxsLm5sPiB3cm90
ZToKCj5TaWduZWQtb2ZmLWJ5OiBIYW5zIFZlcmt1aWwgPGh2ZXJrdWlsQHhzNGFsbC5ubD4KPi0t
LQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWF2LWF1ZGlvLmMgfCAgIDkyICsrLS0t
LS0tLS0tCj4gZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtYXYtY29yZS5jICB8ICAxNjIg
KysrKysrLS0tLS0tLS0tLS0KPiBkcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1hdi1jb3Jl
LmggIHwgICAxMiArLQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWNvbnRyb2xzLmMg
fCAgMjg1ICsrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+IGRyaXZlcnMvbWVkaWEvdmlk
ZW8vY3gxOC9jeDE4LWNvbnRyb2xzLmggfCAgICA3ICstCj4gZHJpdmVycy9tZWRpYS92aWRlby9j
eDE4L2N4MTgtZHJpdmVyLmMgICB8ICAgMzAgKystLQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gx
OC9jeDE4LWRyaXZlci5oICAgfCAgICAyICstCj4gZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4
MTgtZmlsZW9wcy5jICB8ICAgMzIgKy0tLQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4
LWlvY3RsLmMgICAgfCAgIDI0ICstLQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LW1h
aWxib3guYyAgfCAgICA1ICstCj4gZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtbWFpbGJv
eC5oICB8ICAgIDUgLQo+IGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LXN0cmVhbXMuYyAg
fCAgIDE2ICstCj4gMTIgZmlsZXMgY2hhbmdlZCwgMTYwIGluc2VydGlvbnMoKyksIDUxMiBkZWxl
dGlvbnMoLSkKPgo+ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWF2
LWF1ZGlvLmMgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1hdi1hdWRpby5jCj5pbmRl
eCA0M2QwOWEyLi40YTI0ZmZiIDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4
L2N4MTgtYXYtYXVkaW8uYwo+KysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtYXYt
YXVkaW8uYwo+QEAgLTM0MiwxNyArMzQyLDYgQEAgdm9pZCBjeDE4X2F2X2F1ZGlvX3NldF9wYXRo
KHN0cnVjdCBjeDE4ICpjeCkKPiAJfQo+IH0KPiAKPi1zdGF0aWMgaW50IGdldF92b2x1bWUoc3Ry
dWN0IGN4MTggKmN4KQo+LXsKPi0JLyogVm9sdW1lIHJ1bnMgKzE4ZEIgdG8gLTk2ZEIgaW4gMS8y
ZEIgc3RlcHMKPi0JICogY2hhbmdlIHRvIGZpdCB0aGUgbXNwMzQwMCAtMTE0ZEIgdG8gKzEyZEIg
cmFuZ2UgKi8KPi0KPi0JLyogY2hlY2sgUEFUSDFfVk9MVU1FICovCj4tCWludCB2b2wgPSAyMjgg
LSBjeDE4X2F2X3JlYWQoY3gsIDB4OGQ0KTsKPi0Jdm9sID0gKHZvbCAvIDIpICsgMjM7Cj4tCXJl
dHVybiB2b2wgPDwgOTsKPi19Cj4tCj4gc3RhdGljIHZvaWQgc2V0X3ZvbHVtZShzdHJ1Y3QgY3gx
OCAqY3gsIGludCB2b2x1bWUpCj4gewo+IAkvKiBGaXJzdCBjb252ZXJ0IHRoZSB2b2x1bWUgdG8g
bXNwMzQwMCB2YWx1ZXMgKDAtMTI3KSAqLwo+QEAgLTM2OSw1MiArMzU4LDE4IEBAIHN0YXRpYyB2
b2lkIHNldF92b2x1bWUoc3RydWN0IGN4MTggKmN4LCBpbnQgdm9sdW1lKQo+IAljeDE4X2F2X3dy
aXRlKGN4LCAweDhkNCwgMjI4IC0gKHZvbCAqIDIpKTsKPiB9Cj4gCj4tc3RhdGljIGludCBnZXRf
YmFzcyhzdHJ1Y3QgY3gxOCAqY3gpCj4tewo+LQkvKiBiYXNzIGlzIDQ5IHN0ZXBzICsxMmRCIHRv
IC0xMmRCICovCj4tCj4tCS8qIGNoZWNrIFBBVEgxX0VRX0JBU1NfVk9MICovCj4tCWludCBiYXNz
ID0gY3gxOF9hdl9yZWFkKGN4LCAweDhkOSkgJiAweDNmOwo+LQliYXNzID0gKCgoNDggLSBiYXNz
KSAqIDB4ZmZmZikgKyA0NykgLyA0ODsKPi0JcmV0dXJuIGJhc3M7Cj4tfQo+LQo+IHN0YXRpYyB2
b2lkIHNldF9iYXNzKHN0cnVjdCBjeDE4ICpjeCwgaW50IGJhc3MpCj4gewo+IAkvKiBQQVRIMV9F
UV9CQVNTX1ZPTCAqLwo+IAljeDE4X2F2X2FuZF9vcihjeCwgMHg4ZDksIH4weDNmLCA0OCAtIChi
YXNzICogNDggLyAweGZmZmYpKTsKPiB9Cj4gCj4tc3RhdGljIGludCBnZXRfdHJlYmxlKHN0cnVj
dCBjeDE4ICpjeCkKPi17Cj4tCS8qIHRyZWJsZSBpcyA0OSBzdGVwcyArMTJkQiB0byAtMTJkQiAq
Lwo+LQo+LQkvKiBjaGVjayBQQVRIMV9FUV9UUkVCTEVfVk9MICovCj4tCWludCB0cmVibGUgPSBj
eDE4X2F2X3JlYWQoY3gsIDB4OGRiKSAmIDB4M2Y7Cj4tCXRyZWJsZSA9ICgoKDQ4IC0gdHJlYmxl
KSAqIDB4ZmZmZikgKyA0NykgLyA0ODsKPi0JcmV0dXJuIHRyZWJsZTsKPi19Cj4tCj4gc3RhdGlj
IHZvaWQgc2V0X3RyZWJsZShzdHJ1Y3QgY3gxOCAqY3gsIGludCB0cmVibGUpCj4gewo+IAkvKiBQ
QVRIMV9FUV9UUkVCTEVfVk9MICovCj4gCWN4MThfYXZfYW5kX29yKGN4LCAweDhkYiwgfjB4M2Ys
IDQ4IC0gKHRyZWJsZSAqIDQ4IC8gMHhmZmZmKSk7Cj4gfQo+IAo+LXN0YXRpYyBpbnQgZ2V0X2Jh
bGFuY2Uoc3RydWN0IGN4MTggKmN4KQo+LXsKPi0JLyogYmFsYW5jZSBpcyA3IGJpdCwgMCB0byAt
OTZkQiAqLwo+LQo+LQkvKiBjaGVjayBQQVRIMV9CQUxfTEVWRUwgKi8KPi0JaW50IGJhbGFuY2Ug
PSBjeDE4X2F2X3JlYWQoY3gsIDB4OGQ1KSAmIDB4N2Y7Cj4tCS8qIGNoZWNrIFBBVEgxX0JBTF9M
RUZUICovCj4tCWlmICgoY3gxOF9hdl9yZWFkKGN4LCAweDhkNSkgJiAweDgwKSA9PSAwKQo+LQkJ
YmFsYW5jZSA9IDB4ODAgLSBiYWxhbmNlOwo+LQllbHNlCj4tCQliYWxhbmNlID0gMHg4MCArIGJh
bGFuY2U7Cj4tCXJldHVybiBiYWxhbmNlIDw8IDg7Cj4tfQo+LQo+IHN0YXRpYyB2b2lkIHNldF9i
YWxhbmNlKHN0cnVjdCBjeDE4ICpjeCwgaW50IGJhbGFuY2UpCj4gewo+IAlpbnQgYmFsID0gYmFs
YW5jZSA+PiA4Owo+QEAgLTQzMSwxMiArMzg2LDYgQEAgc3RhdGljIHZvaWQgc2V0X2JhbGFuY2Uo
c3RydWN0IGN4MTggKmN4LCBpbnQgYmFsYW5jZSkKPiAJfQo+IH0KPiAKPi1zdGF0aWMgaW50IGdl
dF9tdXRlKHN0cnVjdCBjeDE4ICpjeCkKPi17Cj4tCS8qIGNoZWNrIFNSQzFfTVVURV9FTiAqLwo+
LQlyZXR1cm4gY3gxOF9hdl9yZWFkKGN4LCAweDhkMykgJiAweDIgPyAxIDogMDsKPi19Cj4tCj4g
c3RhdGljIHZvaWQgc2V0X211dGUoc3RydWN0IGN4MTggKmN4LCBpbnQgbXV0ZSkKPiB7Cj4gCXN0
cnVjdCBjeDE4X2F2X3N0YXRlICpzdGF0ZSA9ICZjeC0+YXZfc3RhdGU7Cj5AQCAtNDkwLDUwICs0
MzksMzMgQEAgaW50IGN4MThfYXZfc19jbG9ja19mcmVxKHN0cnVjdCB2NGwyX3N1YmRldiAqc2Qs
IHUzMiBmcmVxKQo+IAlyZXR1cm4gcmV0dmFsOwo+IH0KPiAKPi1pbnQgY3gxOF9hdl9hdWRpb19n
X2N0cmwoc3RydWN0IGN4MTggKmN4LCBzdHJ1Y3QgdjRsMl9jb250cm9sICpjdHJsKQo+K3N0YXRp
YyBpbnQgY3gxOF9hdl9hdWRpb19zX2N0cmwoc3RydWN0IHY0bDJfY3RybCAqY3RybCkKPiB7Cj4t
CXN3aXRjaCAoY3RybC0+aWQpIHsKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19WT0xVTUU6Cj4tCQlj
dHJsLT52YWx1ZSA9IGdldF92b2x1bWUoY3gpOwo+LQkJYnJlYWs7Cj4tCWNhc2UgVjRMMl9DSURf
QVVESU9fQkFTUzoKPi0JCWN0cmwtPnZhbHVlID0gZ2V0X2Jhc3MoY3gpOwo+LQkJYnJlYWs7Cj4t
CWNhc2UgVjRMMl9DSURfQVVESU9fVFJFQkxFOgo+LQkJY3RybC0+dmFsdWUgPSBnZXRfdHJlYmxl
KGN4KTsKPi0JCWJyZWFrOwo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0JBTEFOQ0U6Cj4tCQljdHJs
LT52YWx1ZSA9IGdldF9iYWxhbmNlKGN4KTsKPi0JCWJyZWFrOwo+LQljYXNlIFY0TDJfQ0lEX0FV
RElPX01VVEU6Cj4tCQljdHJsLT52YWx1ZSA9IGdldF9tdXRlKGN4KTsKPi0JCWJyZWFrOwo+LQlk
ZWZhdWx0Ogo+LQkJcmV0dXJuIC1FSU5WQUw7Cj4tCX0KPi0JcmV0dXJuIDA7Cj4tfQo+KwlzdHJ1
Y3QgdjRsMl9zdWJkZXYgKnNkID0gdG9fc2QoY3RybCk7Cj4rCXN0cnVjdCBjeDE4ICpjeCA9IHY0
bDJfZ2V0X3N1YmRldmRhdGEoc2QpOwo+IAo+LWludCBjeDE4X2F2X2F1ZGlvX3NfY3RybChzdHJ1
Y3QgY3gxOCAqY3gsIHN0cnVjdCB2NGwyX2NvbnRyb2wgKmN0cmwpCj4tewo+IAlzd2l0Y2ggKGN0
cmwtPmlkKSB7Cj4gCWNhc2UgVjRMMl9DSURfQVVESU9fVk9MVU1FOgo+LQkJc2V0X3ZvbHVtZShj
eCwgY3RybC0+dmFsdWUpOwo+KwkJc2V0X3ZvbHVtZShjeCwgY3RybC0+dmFsKTsKPiAJCWJyZWFr
Owo+IAljYXNlIFY0TDJfQ0lEX0FVRElPX0JBU1M6Cj4tCQlzZXRfYmFzcyhjeCwgY3RybC0+dmFs
dWUpOwo+KwkJc2V0X2Jhc3MoY3gsIGN0cmwtPnZhbCk7Cj4gCQlicmVhazsKPiAJY2FzZSBWNEwy
X0NJRF9BVURJT19UUkVCTEU6Cj4tCQlzZXRfdHJlYmxlKGN4LCBjdHJsLT52YWx1ZSk7Cj4rCQlz
ZXRfdHJlYmxlKGN4LCBjdHJsLT52YWwpOwo+IAkJYnJlYWs7Cj4gCWNhc2UgVjRMMl9DSURfQVVE
SU9fQkFMQU5DRToKPi0JCXNldF9iYWxhbmNlKGN4LCBjdHJsLT52YWx1ZSk7Cj4rCQlzZXRfYmFs
YW5jZShjeCwgY3RybC0+dmFsKTsKPiAJCWJyZWFrOwo+IAljYXNlIFY0TDJfQ0lEX0FVRElPX01V
VEU6Cj4tCQlzZXRfbXV0ZShjeCwgY3RybC0+dmFsdWUpOwo+KwkJc2V0X211dGUoY3gsIGN0cmwt
PnZhbCk7Cj4gCQlicmVhazsKPiAJZGVmYXVsdDoKPiAJCXJldHVybiAtRUlOVkFMOwo+IAl9Cj4g
CXJldHVybiAwOwo+IH0KPisKPitjb25zdCBzdHJ1Y3QgdjRsMl9jdHJsX29wcyBjeDE4X2F2X2F1
ZGlvX2N0cmxfb3BzID0gewo+Kwkuc19jdHJsID0gY3gxOF9hdl9hdWRpb19zX2N0cmwsCj4rfTsK
PmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1hdi1jb3JlLmMgYi9k
cml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1hdi1jb3JlLmMKPmluZGV4IGE0MTk1MWMuLmUx
ZjU4ZjEgMTAwNjQ0Cj4tLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1hdi1jb3Jl
LmMKPisrKyBiL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWF2LWNvcmUuYwo+QEAgLTEy
OSw2ICsxMjksNyBAQCBzdGF0aWMgdm9pZCBjeDE4X2F2X2luaXRpYWxpemUoc3RydWN0IHY0bDJf
c3ViZGV2ICpzZCkKPiB7Cj4gCXN0cnVjdCBjeDE4X2F2X3N0YXRlICpzdGF0ZSA9IHRvX2N4MThf
YXZfc3RhdGUoc2QpOwo+IAlzdHJ1Y3QgY3gxOCAqY3ggPSB2NGwyX2dldF9zdWJkZXZkYXRhKHNk
KTsKPisJaW50IGRlZmF1bHRfdm9sdW1lOwo+IAl1MzIgdjsKPiAKPiAJY3gxOF9hdl9sb2FkZnco
Y3gpOwo+QEAgLTI0Nyw4ICsyNDgsMTAgQEAgc3RhdGljIHZvaWQgY3gxOF9hdl9pbml0aWFsaXpl
KHN0cnVjdCB2NGwyX3N1YmRldiAqc2QpCj4gLyogICAgICAJQ3hEZXZXclJlZyhDWEFERUNfU1JD
X0NPTUJfQ0ZHLCAweDY2MjgwMjFGKTsgKi8KPiAvKiAgICB9ICovCj4gCWN4MThfYXZfd3JpdGU0
KGN4LCBDWEFERUNfU1JDX0NPTUJfQ0ZHLCAweDY2MjgwMjFGKTsKPi0Jc3RhdGUtPmRlZmF1bHRf
dm9sdW1lID0gMjI4IC0gY3gxOF9hdl9yZWFkKGN4LCAweDhkNCk7Cj4tCXN0YXRlLT5kZWZhdWx0
X3ZvbHVtZSA9ICgoc3RhdGUtPmRlZmF1bHRfdm9sdW1lIC8gMikgKyAyMykgPDwgOTsKPisJZGVm
YXVsdF92b2x1bWUgPSAyMjggLSBjeDE4X2F2X3JlYWQoY3gsIDB4OGQ0KTsKPisJZGVmYXVsdF92
b2x1bWUgPSAoKGRlZmF1bHRfdm9sdW1lIC8gMikgKyAyMykgPDwgOTsKPisJc3RhdGUtPnZvbHVt
ZS0+Y3VyLnZhbCA9IHN0YXRlLT52b2x1bWUtPmRlZmF1bHRfdmFsdWUgPSBkZWZhdWx0X3ZvbHVt
ZTsKPisJdjRsMl9jdHJsX2hhbmRsZXJfc2V0dXAoJnN0YXRlLT5oZGwpOwo+IH0KPiAKPiBzdGF0
aWMgaW50IGN4MThfYXZfcmVzZXQoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwgdTMyIHZhbCkKPkBA
IC05MDEsMTI2ICs5MDQsMzUgQEAgc3RhdGljIGludCBjeDE4X2F2X3NfcmFkaW8oc3RydWN0IHY0
bDJfc3ViZGV2ICpzZCkKPiAJcmV0dXJuIDA7Cj4gfQo+IAo+LXN0YXRpYyBpbnQgY3gxOF9hdl9z
X2N0cmwoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwgc3RydWN0IHY0bDJfY29udHJvbCAqY3RybCkK
PitzdGF0aWMgaW50IGN4MThfYXZfc19jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwpCj4gewo+
KwlzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkID0gdG9fc2QoY3RybCk7Cj4gCXN0cnVjdCBjeDE4ICpj
eCA9IHY0bDJfZ2V0X3N1YmRldmRhdGEoc2QpOwo+IAo+IAlzd2l0Y2ggKGN0cmwtPmlkKSB7Cj4g
CWNhc2UgVjRMMl9DSURfQlJJR0hUTkVTUzoKPi0JCWlmIChjdHJsLT52YWx1ZSA8IDAgfHwgY3Ry
bC0+dmFsdWUgPiAyNTUpIHsKPi0JCQlDWDE4X0VSUl9ERVYoc2QsICJpbnZhbGlkIGJyaWdodG5l
c3Mgc2V0dGluZyAlZFxuIiwKPi0JCQkJICAgICBjdHJsLT52YWx1ZSk7Cj4tCQkJcmV0dXJuIC1F
UkFOR0U7Cj4tCQl9Cj4tCj4tCQljeDE4X2F2X3dyaXRlKGN4LCAweDQxNCwgY3RybC0+dmFsdWUg
LSAxMjgpOwo+KwkJY3gxOF9hdl93cml0ZShjeCwgMHg0MTQsIGN0cmwtPnZhbCAtIDEyOCk7Cj4g
CQlicmVhazsKPiAKPiAJY2FzZSBWNEwyX0NJRF9DT05UUkFTVDoKPi0JCWlmIChjdHJsLT52YWx1
ZSA8IDAgfHwgY3RybC0+dmFsdWUgPiAxMjcpIHsKPi0JCQlDWDE4X0VSUl9ERVYoc2QsICJpbnZh
bGlkIGNvbnRyYXN0IHNldHRpbmcgJWRcbiIsCj4tCQkJCSAgICAgY3RybC0+dmFsdWUpOwo+LQkJ
CXJldHVybiAtRVJBTkdFOwo+LQkJfQo+LQo+LQkJY3gxOF9hdl93cml0ZShjeCwgMHg0MTUsIGN0
cmwtPnZhbHVlIDw8IDEpOwo+KwkJY3gxOF9hdl93cml0ZShjeCwgMHg0MTUsIGN0cmwtPnZhbCA8
PCAxKTsKPiAJCWJyZWFrOwo+IAo+IAljYXNlIFY0TDJfQ0lEX1NBVFVSQVRJT046Cj4tCQlpZiAo
Y3RybC0+dmFsdWUgPCAwIHx8IGN0cmwtPnZhbHVlID4gMTI3KSB7Cj4tCQkJQ1gxOF9FUlJfREVW
KHNkLCAiaW52YWxpZCBzYXR1cmF0aW9uIHNldHRpbmcgJWRcbiIsCj4tCQkJCSAgICAgY3RybC0+
dmFsdWUpOwo+LQkJCXJldHVybiAtRVJBTkdFOwo+LQkJfQo+LQo+LQkJY3gxOF9hdl93cml0ZShj
eCwgMHg0MjAsIGN0cmwtPnZhbHVlIDw8IDEpOwo+LQkJY3gxOF9hdl93cml0ZShjeCwgMHg0MjEs
IGN0cmwtPnZhbHVlIDw8IDEpOwo+KwkJY3gxOF9hdl93cml0ZShjeCwgMHg0MjAsIGN0cmwtPnZh
bCA8PCAxKTsKPisJCWN4MThfYXZfd3JpdGUoY3gsIDB4NDIxLCBjdHJsLT52YWwgPDwgMSk7Cj4g
CQlicmVhazsKPiAKPiAJY2FzZSBWNEwyX0NJRF9IVUU6Cj4tCQlpZiAoY3RybC0+dmFsdWUgPCAt
MTI4IHx8IGN0cmwtPnZhbHVlID4gMTI3KSB7Cj4tCQkJQ1gxOF9FUlJfREVWKHNkLCAiaW52YWxp
ZCBodWUgc2V0dGluZyAlZFxuIiwKPi0JCQkJICAgICBjdHJsLT52YWx1ZSk7Cj4tCQkJcmV0dXJu
IC1FUkFOR0U7Cj4tCQl9Cj4tCj4tCQljeDE4X2F2X3dyaXRlKGN4LCAweDQyMiwgY3RybC0+dmFs
dWUpOwo+KwkJY3gxOF9hdl93cml0ZShjeCwgMHg0MjIsIGN0cmwtPnZhbCk7Cj4gCQlicmVhazsK
PiAKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19WT0xVTUU6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9f
QkFTUzoKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19UUkVCTEU6Cj4tCWNhc2UgVjRMMl9DSURfQVVE
SU9fQkFMQU5DRToKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19NVVRFOgo+LQkJcmV0dXJuIGN4MThf
YXZfYXVkaW9fc19jdHJsKGN4LCBjdHJsKTsKPi0KPiAJZGVmYXVsdDoKPiAJCXJldHVybiAtRUlO
VkFMOwo+IAl9Cj4gCXJldHVybiAwOwo+IH0KPiAKPi1zdGF0aWMgaW50IGN4MThfYXZfZ19jdHJs
KHN0cnVjdCB2NGwyX3N1YmRldiAqc2QsIHN0cnVjdCB2NGwyX2NvbnRyb2wgKmN0cmwpCj4tewo+
LQlzdHJ1Y3QgY3gxOCAqY3ggPSB2NGwyX2dldF9zdWJkZXZkYXRhKHNkKTsKPi0KPi0Jc3dpdGNo
IChjdHJsLT5pZCkgewo+LQljYXNlIFY0TDJfQ0lEX0JSSUdIVE5FU1M6Cj4tCQljdHJsLT52YWx1
ZSA9IChzOCljeDE4X2F2X3JlYWQoY3gsIDB4NDE0KSArIDEyODsKPi0JCWJyZWFrOwo+LQljYXNl
IFY0TDJfQ0lEX0NPTlRSQVNUOgo+LQkJY3RybC0+dmFsdWUgPSBjeDE4X2F2X3JlYWQoY3gsIDB4
NDE1KSA+PiAxOwo+LQkJYnJlYWs7Cj4tCWNhc2UgVjRMMl9DSURfU0FUVVJBVElPTjoKPi0JCWN0
cmwtPnZhbHVlID0gY3gxOF9hdl9yZWFkKGN4LCAweDQyMCkgPj4gMTsKPi0JCWJyZWFrOwo+LQlj
YXNlIFY0TDJfQ0lEX0hVRToKPi0JCWN0cmwtPnZhbHVlID0gKHM4KWN4MThfYXZfcmVhZChjeCwg
MHg0MjIpOwo+LQkJYnJlYWs7Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fVk9MVU1FOgo+LQljYXNl
IFY0TDJfQ0lEX0FVRElPX0JBU1M6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fVFJFQkxFOgo+LQlj
YXNlIFY0TDJfQ0lEX0FVRElPX0JBTEFOQ0U6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fTVVURToK
Pi0JCXJldHVybiBjeDE4X2F2X2F1ZGlvX2dfY3RybChjeCwgY3RybCk7Cj4tCWRlZmF1bHQ6Cj4t
CQlyZXR1cm4gLUVJTlZBTDsKPi0JfQo+LQlyZXR1cm4gMDsKPi19Cj4tCj4tc3RhdGljIGludCBj
eDE4X2F2X3F1ZXJ5Y3RybChzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCBzdHJ1Y3QgdjRsMl9xdWVy
eWN0cmwgKnFjKQo+LXsKPi0Jc3RydWN0IGN4MThfYXZfc3RhdGUgKnN0YXRlID0gdG9fY3gxOF9h
dl9zdGF0ZShzZCk7Cj4tCj4tCXN3aXRjaCAocWMtPmlkKSB7Cj4tCWNhc2UgVjRMMl9DSURfQlJJ
R0hUTkVTUzoKPi0JCXJldHVybiB2NGwyX2N0cmxfcXVlcnlfZmlsbChxYywgMCwgMjU1LCAxLCAx
MjgpOwo+LQljYXNlIFY0TDJfQ0lEX0NPTlRSQVNUOgo+LQljYXNlIFY0TDJfQ0lEX1NBVFVSQVRJ
T046Cj4tCQlyZXR1cm4gdjRsMl9jdHJsX3F1ZXJ5X2ZpbGwocWMsIDAsIDEyNywgMSwgNjQpOwo+
LQljYXNlIFY0TDJfQ0lEX0hVRToKPi0JCXJldHVybiB2NGwyX2N0cmxfcXVlcnlfZmlsbChxYywg
LTEyOCwgMTI3LCAxLCAwKTsKPi0JZGVmYXVsdDoKPi0JCWJyZWFrOwo+LQl9Cj4tCj4tCXN3aXRj
aCAocWMtPmlkKSB7Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fVk9MVU1FOgo+LQkJcmV0dXJuIHY0
bDJfY3RybF9xdWVyeV9maWxsKHFjLCAwLCA2NTUzNSwKPi0JCQk2NTUzNSAvIDEwMCwgc3RhdGUt
PmRlZmF1bHRfdm9sdW1lKTsKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19NVVRFOgo+LQkJcmV0dXJu
IHY0bDJfY3RybF9xdWVyeV9maWxsKHFjLCAwLCAxLCAxLCAwKTsKPi0JY2FzZSBWNEwyX0NJRF9B
VURJT19CQUxBTkNFOgo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0JBU1M6Cj4tCWNhc2UgVjRMMl9D
SURfQVVESU9fVFJFQkxFOgo+LQkJcmV0dXJuIHY0bDJfY3RybF9xdWVyeV9maWxsKHFjLCAwLCA2
NTUzNSwgNjU1MzUgLyAxMDAsIDMyNzY4KTsKPi0JZGVmYXVsdDoKPi0JCXJldHVybiAtRUlOVkFM
Owo+LQl9Cj4tCXJldHVybiAtRUlOVkFMOwo+LX0KPi0KPiBzdGF0aWMgaW50IGN4MThfYXZfc19t
YnVzX2ZtdChzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCBzdHJ1Y3QgdjRsMl9tYnVzX2ZyYW1lZm10
ICpmbXQpCj4gewo+IAlzdHJ1Y3QgY3gxOF9hdl9zdGF0ZSAqc3RhdGUgPSB0b19jeDE4X2F2X3N0
YXRlKHNkKTsKPkBAIC0xMzU2LDE0ICsxMjY4LDIyIEBAIHN0YXRpYyBpbnQgY3gxOF9hdl9zX3Jl
Z2lzdGVyKHN0cnVjdCB2NGwyX3N1YmRldiAqc2QsCj4gfQo+ICNlbmRpZgo+IAo+K3N0YXRpYyBj
b25zdCBzdHJ1Y3QgdjRsMl9jdHJsX29wcyBjeDE4X2F2X2N0cmxfb3BzID0gewo+Kwkuc19jdHJs
ID0gY3gxOF9hdl9zX2N0cmwsCj4rfTsKPisKPiBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfc3Vi
ZGV2X2NvcmVfb3BzIGN4MThfYXZfZ2VuZXJhbF9vcHMgPSB7Cj4gCS5nX2NoaXBfaWRlbnQgPSBj
eDE4X2F2X2dfY2hpcF9pZGVudCwKPiAJLmxvZ19zdGF0dXMgPSBjeDE4X2F2X2xvZ19zdGF0dXMs
Cj4gCS5sb2FkX2Z3ID0gY3gxOF9hdl9sb2FkX2Z3LAo+IAkucmVzZXQgPSBjeDE4X2F2X3Jlc2V0
LAo+LQkucXVlcnljdHJsID0gY3gxOF9hdl9xdWVyeWN0cmwsCj4tCS5nX2N0cmwgPSBjeDE4X2F2
X2dfY3RybCwKPi0JLnNfY3RybCA9IGN4MThfYXZfc19jdHJsLAo+KwkuZ19jdHJsID0gdjRsMl9z
dWJkZXZfZ19jdHJsLAo+Kwkuc19jdHJsID0gdjRsMl9zdWJkZXZfc19jdHJsLAo+Kwkuc19leHRf
Y3RybHMgPSB2NGwyX3N1YmRldl9zX2V4dF9jdHJscywKPisJLnRyeV9leHRfY3RybHMgPSB2NGwy
X3N1YmRldl90cnlfZXh0X2N0cmxzLAo+KwkuZ19leHRfY3RybHMgPSB2NGwyX3N1YmRldl9nX2V4
dF9jdHJscywKPisJLnF1ZXJ5Y3RybCA9IHY0bDJfc3ViZGV2X3F1ZXJ5Y3RybCwKPisJLnF1ZXJ5
bWVudSA9IHY0bDJfc3ViZGV2X3F1ZXJ5bWVudSwKPiAJLnNfc3RkID0gY3gxOF9hdl9zX3N0ZCwK
PiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwo+IAkuZ19yZWdpc3RlciA9IGN4MThfYXZf
Z19yZWdpc3RlciwKPkBAIC0xNDI3LDggKzEzNDcsNDIgQEAgaW50IGN4MThfYXZfcHJvYmUoc3Ry
dWN0IGN4MTggKmN4KQo+IAlzbnByaW50ZihzZC0+bmFtZSwgc2l6ZW9mKHNkLT5uYW1lKSwKPiAJ
CSAiJXMgJTAzeCIsIGN4LT52NGwyX2Rldi5uYW1lLCAoc3RhdGUtPnJldiA+PiA0KSk7Cj4gCXNk
LT5ncnBfaWQgPSBDWDE4X0hXXzQxOF9BVjsKPisJdjRsMl9jdHJsX2hhbmRsZXJfaW5pdCgmc3Rh
dGUtPmhkbCwgOSk7Cj4rCXY0bDJfY3RybF9uZXdfc3RkKCZzdGF0ZS0+aGRsLCAmY3gxOF9hdl9j
dHJsX29wcywKPisJCQlWNEwyX0NJRF9CUklHSFRORVNTLCAwLCAyNTUsIDEsIDEyOCk7Cj4rCXY0
bDJfY3RybF9uZXdfc3RkKCZzdGF0ZS0+aGRsLCAmY3gxOF9hdl9jdHJsX29wcywKPisJCQlWNEwy
X0NJRF9DT05UUkFTVCwgMCwgMTI3LCAxLCA2NCk7Cj4rCXY0bDJfY3RybF9uZXdfc3RkKCZzdGF0
ZS0+aGRsLCAmY3gxOF9hdl9jdHJsX29wcywKPisJCQlWNEwyX0NJRF9TQVRVUkFUSU9OLCAwLCAx
MjcsIDEsIDY0KTsKPisJdjRsMl9jdHJsX25ld19zdGQoJnN0YXRlLT5oZGwsICZjeDE4X2F2X2N0
cmxfb3BzLAo+KwkJCVY0TDJfQ0lEX0hVRSwgLTEyOCwgMTI3LCAxLCAwKTsKPisKPisJc3RhdGUt
PnZvbHVtZSA9IHY0bDJfY3RybF9uZXdfc3RkKCZzdGF0ZS0+aGRsLAo+KwkJCSZjeDE4X2F2X2F1
ZGlvX2N0cmxfb3BzLCBWNEwyX0NJRF9BVURJT19WT0xVTUUsCj4rCQkJMCwgNjUzMzUsIDY1NTM1
IC8gMTAwLCAwKTsKPisJdjRsMl9jdHJsX25ld19zdGQoJnN0YXRlLT5oZGwsCj4rCQkJJmN4MThf
YXZfYXVkaW9fY3RybF9vcHMsIFY0TDJfQ0lEX0FVRElPX01VVEUsCj4rCQkJMCwgMSwgMSwgMCk7
Cj4rCXY0bDJfY3RybF9uZXdfc3RkKCZzdGF0ZS0+aGRsLCAmY3gxOF9hdl9hdWRpb19jdHJsX29w
cywKPisJCQlWNEwyX0NJRF9BVURJT19CQUxBTkNFLAo+KwkJCTAsIDY1NTM1LCA2NTUzNSAvIDEw
MCwgMzI3NjgpOwo+Kwl2NGwyX2N0cmxfbmV3X3N0ZCgmc3RhdGUtPmhkbCwgJmN4MThfYXZfYXVk
aW9fY3RybF9vcHMsCj4rCQkJVjRMMl9DSURfQVVESU9fQkFTUywKPisJCQkwLCA2NTUzNSwgNjU1
MzUgLyAxMDAsIDMyNzY4KTsKPisJdjRsMl9jdHJsX25ld19zdGQoJnN0YXRlLT5oZGwsICZjeDE4
X2F2X2F1ZGlvX2N0cmxfb3BzLAo+KwkJCVY0TDJfQ0lEX0FVRElPX1RSRUJMRSwKPisJCQkwLCA2
NTUzNSwgNjU1MzUgLyAxMDAsIDMyNzY4KTsKPisJc2QtPmN0cmxfaGFuZGxlciA9ICZzdGF0ZS0+
aGRsOwo+KwlpZiAoc3RhdGUtPmhkbC5lcnJvcikgewo+KwkJaW50IGVyciA9IHN0YXRlLT5oZGwu
ZXJyb3I7Cj4rCj4rCQl2NGwyX2N0cmxfaGFuZGxlcl9mcmVlKCZzdGF0ZS0+aGRsKTsKPisJCXJl
dHVybiBlcnI7Cj4rCX0KPiAJZXJyID0gdjRsMl9kZXZpY2VfcmVnaXN0ZXJfc3ViZGV2KCZjeC0+
djRsMl9kZXYsIHNkKTsKPi0JaWYgKCFlcnIpCj4rCWlmIChlcnIpCj4rCQl2NGwyX2N0cmxfaGFu
ZGxlcl9mcmVlKCZzdGF0ZS0+aGRsKTsKPisJZWxzZQo+IAkJY3gxOF9hdl9pbml0KGN4KTsKPiAJ
cmV0dXJuIGVycjsKPiB9Cj5kaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4
MTgtYXYtY29yZS5oIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtYXYtY29yZS5oCj5p
bmRleCAxOTU2OTkxLi4xODhjOWMzIDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRpYS92aWRlby9j
eDE4L2N4MTgtYXYtY29yZS5oCj4rKysgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1h
di1jb3JlLmgKPkBAIC0yNiw2ICsyNiw3IEBACj4gI2RlZmluZSBfQ1gxOF9BVl9DT1JFX0hfCj4g
Cj4gI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2aWNlLmg+Cj4rI2luY2x1ZGUgPG1lZGlhL3Y0bDIt
Y3RybHMuaD4KPiAKPiBzdHJ1Y3QgY3gxODsKPiAKPkBAIC05NSwxMyArOTYsMTQgQEAgZW51bSBj
eDE4X2F2X2F1ZGlvX2lucHV0IHsKPiAKPiBzdHJ1Y3QgY3gxOF9hdl9zdGF0ZSB7Cj4gCXN0cnVj
dCB2NGwyX3N1YmRldiBzZDsKPisJc3RydWN0IHY0bDJfY3RybF9oYW5kbGVyIGhkbDsKPisJc3Ry
dWN0IHY0bDJfY3RybCAqdm9sdW1lOwo+IAlpbnQgcmFkaW87Cj4gCXY0bDJfc3RkX2lkIHN0ZDsK
PiAJZW51bSBjeDE4X2F2X3ZpZGVvX2lucHV0IHZpZF9pbnB1dDsKPiAJZW51bSBjeDE4X2F2X2F1
ZGlvX2lucHV0IGF1ZF9pbnB1dDsKPiAJdTMyIGF1ZGNsa19mcmVxOwo+IAlpbnQgYXVkbW9kZTsK
Pi0JaW50IGRlZmF1bHRfdm9sdW1lOwo+IAl1MzIgaWQ7Cj4gCXUzMiByZXY7Cj4gCWludCBpc19p
bml0aWFsaXplZDsKPkBAIC0zNDcsNiArMzQ5LDExIEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGN4
MThfYXZfc3RhdGUgKnRvX2N4MThfYXZfc3RhdGUoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCkKPiAJ
cmV0dXJuIGNvbnRhaW5lcl9vZihzZCwgc3RydWN0IGN4MThfYXZfc3RhdGUsIHNkKTsKPiB9Cj4g
Cj4rc3RhdGljIGlubGluZSBzdHJ1Y3QgdjRsMl9zdWJkZXYgKnRvX3NkKHN0cnVjdCB2NGwyX2N0
cmwgKmN0cmwpCj4rewo+KwlyZXR1cm4gJmNvbnRhaW5lcl9vZihjdHJsLT5oYW5kbGVyLCBzdHJ1
Y3QgY3gxOF9hdl9zdGF0ZSwgaGRsKS0+c2Q7Cj4rfQo+Kwo+IC8qIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICov
Cj4gLyogY3gxOF9hdi1jb3JlLmMgCQkJCQkJCSAgICovCj4gaW50IGN4MThfYXZfd3JpdGUoc3Ry
dWN0IGN4MTggKmN4LCB1MTYgYWRkciwgdTggdmFsdWUpOwo+QEAgLTM2OSwxMCArMzc2LDkgQEAg
aW50IGN4MThfYXZfbG9hZGZ3KHN0cnVjdCBjeDE4ICpjeCk7Cj4gCj4gLyogLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0gKi8KPiAvKiBjeDE4X2F2LWF1ZGlvLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAqLwo+LWludCBjeDE4X2F2X2F1ZGlvX2dfY3RybChz
dHJ1Y3QgY3gxOCAqY3gsIHN0cnVjdCB2NGwyX2NvbnRyb2wgKmN0cmwpOwo+LWludCBjeDE4X2F2
X2F1ZGlvX3NfY3RybChzdHJ1Y3QgY3gxOCAqY3gsIHN0cnVjdCB2NGwyX2NvbnRyb2wgKmN0cmwp
Owo+IGludCBjeDE4X2F2X3NfY2xvY2tfZnJlcShzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCB1MzIg
ZnJlcSk7Cj4gdm9pZCBjeDE4X2F2X2F1ZGlvX3NldF9wYXRoKHN0cnVjdCBjeDE4ICpjeCk7Cj4r
ZXh0ZXJuIGNvbnN0IHN0cnVjdCB2NGwyX2N0cmxfb3BzIGN4MThfYXZfYXVkaW9fY3RybF9vcHM7
Cj4gCj4gLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KPiAvKiBjeDE4X2F2LXZiaS5jICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLwo+ZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWNvbnRyb2xzLmMgYi9kcml2ZXJz
L21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1jb250cm9scy5jCj5pbmRleCA2NzA0M2M3Li4yODJhM2Qy
IDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtY29udHJvbHMuYwo+
KysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtY29udHJvbHMuYwo+QEAgLTMwLDE1
MiArMzAsMTEgQEAKPiAjaW5jbHVkZSAiY3gxOC1tYWlsYm94LmgiCj4gI2luY2x1ZGUgImN4MTgt
Y29udHJvbHMuaCIKPiAKPi0vKiBNdXN0IGJlIHNvcnRlZCBmcm9tIGxvdyB0byBoaWdoIGNvbnRy
b2wgSUQhICovCj4tc3RhdGljIGNvbnN0IHUzMiB1c2VyX2N0cmxzW10gPSB7Cj4tCVY0TDJfQ0lE
X1VTRVJfQ0xBU1MsCj4tCVY0TDJfQ0lEX0JSSUdIVE5FU1MsCj4tCVY0TDJfQ0lEX0NPTlRSQVNU
LAo+LQlWNEwyX0NJRF9TQVRVUkFUSU9OLAo+LQlWNEwyX0NJRF9IVUUsCj4tCVY0TDJfQ0lEX0FV
RElPX1ZPTFVNRSwKPi0JVjRMMl9DSURfQVVESU9fQkFMQU5DRSwKPi0JVjRMMl9DSURfQVVESU9f
QkFTUywKPi0JVjRMMl9DSURfQVVESU9fVFJFQkxFLAo+LQlWNEwyX0NJRF9BVURJT19NVVRFLAo+
LQlWNEwyX0NJRF9BVURJT19MT1VETkVTUywKPi0JMAo+LX07Cj4tCj4tc3RhdGljIGNvbnN0IHUz
MiAqY3RybF9jbGFzc2VzW10gPSB7Cj4tCXVzZXJfY3RybHMsCj4tCWN4MjM0MXhfbXBlZ19jdHJs
cywKPi0JTlVMTAo+LX07Cj4tCj4taW50IGN4MThfcXVlcnljdHJsKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfcXVlcnljdHJsICpxY3RybCkKPi17Cj4tCXN0cnVjdCBj
eDE4ICpjeCA9ICgoc3RydWN0IGN4MThfb3Blbl9pZCAqKWZoKS0+Y3g7Cj4tCWNvbnN0IGNoYXIg
Km5hbWU7Cj4tCj4tCXFjdHJsLT5pZCA9IHY0bDJfY3RybF9uZXh0KGN0cmxfY2xhc3NlcywgcWN0
cmwtPmlkKTsKPi0JaWYgKHFjdHJsLT5pZCA9PSAwKQo+LQkJcmV0dXJuIC1FSU5WQUw7Cj4tCj4t
CXN3aXRjaCAocWN0cmwtPmlkKSB7Cj4tCS8qIFN0YW5kYXJkIFY0TDIgY29udHJvbHMgKi8KPi0J
Y2FzZSBWNEwyX0NJRF9VU0VSX0NMQVNTOgo+LQkJcmV0dXJuIHY0bDJfY3RybF9xdWVyeV9maWxs
KHFjdHJsLCAwLCAwLCAwLCAwKTsKPi0JY2FzZSBWNEwyX0NJRF9CUklHSFRORVNTOgo+LQljYXNl
IFY0TDJfQ0lEX0hVRToKPi0JY2FzZSBWNEwyX0NJRF9TQVRVUkFUSU9OOgo+LQljYXNlIFY0TDJf
Q0lEX0NPTlRSQVNUOgo+LQkJaWYgKHY0bDJfc3ViZGV2X2NhbGwoY3gtPnNkX2F2LCBjb3JlLCBx
dWVyeWN0cmwsIHFjdHJsKSkKPi0JCQlxY3RybC0+ZmxhZ3MgfD0gVjRMMl9DVFJMX0ZMQUdfRElT
QUJMRUQ7Cj4tCQlyZXR1cm4gMDsKPi0KPi0JY2FzZSBWNEwyX0NJRF9BVURJT19WT0xVTUU6Cj4t
CWNhc2UgVjRMMl9DSURfQVVESU9fTVVURToKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19CQUxBTkNF
Ogo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0JBU1M6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fVFJF
QkxFOgo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0xPVURORVNTOgo+LQkJaWYgKHY0bDJfc3ViZGV2
X2NhbGwoY3gtPnNkX2F2LCBjb3JlLCBxdWVyeWN0cmwsIHFjdHJsKSkKPi0JCQlxY3RybC0+Zmxh
Z3MgfD0gVjRMMl9DVFJMX0ZMQUdfRElTQUJMRUQ7Cj4tCQlyZXR1cm4gMDsKPi0KPi0JZGVmYXVs
dDoKPi0JCWlmIChjeDIzNDF4X2N0cmxfcXVlcnkoJmN4LT5wYXJhbXMsIHFjdHJsKSkKPi0JCQlx
Y3RybC0+ZmxhZ3MgfD0gVjRMMl9DVFJMX0ZMQUdfRElTQUJMRUQ7Cj4tCQlyZXR1cm4gMDsKPi0J
fQo+LQlzdHJuY3B5KHFjdHJsLT5uYW1lLCBuYW1lLCBzaXplb2YocWN0cmwtPm5hbWUpIC0gMSk7
Cj4tCXFjdHJsLT5uYW1lW3NpemVvZihxY3RybC0+bmFtZSkgLSAxXSA9IDA7Cj4tCXJldHVybiAw
Owo+LX0KPi0KPi1pbnQgY3gxOF9xdWVyeW1lbnUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9xdWVyeW1lbnUgKnFtZW51KQo+K3N0YXRpYyBpbnQgY3gxOF9zX3N0cmVh
bV92YmlfZm10KHN0cnVjdCBjeDIzNDF4X2hhbmRsZXIgKmN4aGRsLCB1MzIgZm10KQo+IHsKPi0J
c3RydWN0IGN4MTggKmN4ID0gKChzdHJ1Y3QgY3gxOF9vcGVuX2lkICopZmgpLT5jeDsKPi0Jc3Ry
dWN0IHY0bDJfcXVlcnljdHJsIHFjdHJsOwo+LQo+LQlxY3RybC5pZCA9IHFtZW51LT5pZDsKPi0J
Y3gxOF9xdWVyeWN0cmwoZmlsZSwgZmgsICZxY3RybCk7Cj4tCXJldHVybiB2NGwyX2N0cmxfcXVl
cnlfbWVudShxbWVudSwgJnFjdHJsLAo+LQkJCWN4MjM0MXhfY3RybF9nZXRfbWVudSgmY3gtPnBh
cmFtcywgcW1lbnUtPmlkKSk7Cj4tfQo+LQo+LXN0YXRpYyBpbnQgY3gxOF90cnlfY3RybChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCj4tCQkJCQlzdHJ1Y3QgdjRsMl9leHRfY29udHJvbCAq
dmN0cmwpCj4tewo+LQlzdHJ1Y3QgdjRsMl9xdWVyeWN0cmwgcWN0cmw7Cj4tCWNvbnN0IGNoYXIg
KiptZW51X2l0ZW1zID0gTlVMTDsKPi0JaW50IGVycjsKPi0KPi0JcWN0cmwuaWQgPSB2Y3RybC0+
aWQ7Cj4tCWVyciA9IGN4MThfcXVlcnljdHJsKGZpbGUsIGZoLCAmcWN0cmwpOwo+LQlpZiAoZXJy
KQo+LQkJcmV0dXJuIGVycjsKPi0JaWYgKHFjdHJsLnR5cGUgPT0gVjRMMl9DVFJMX1RZUEVfTUVO
VSkKPi0JCW1lbnVfaXRlbXMgPSB2NGwyX2N0cmxfZ2V0X21lbnUocWN0cmwuaWQpOwo+LQlyZXR1
cm4gdjRsMl9jdHJsX2NoZWNrKHZjdHJsLCAmcWN0cmwsIG1lbnVfaXRlbXMpOwo+LX0KPi0KPi1z
dGF0aWMgaW50IGN4MThfc19jdHJsKHN0cnVjdCBjeDE4ICpjeCwgc3RydWN0IHY0bDJfY29udHJv
bCAqdmN0cmwpCj4tewo+LQlzd2l0Y2ggKHZjdHJsLT5pZCkgewo+LQkJLyogU3RhbmRhcmQgVjRM
MiBjb250cm9scyAqLwo+LQljYXNlIFY0TDJfQ0lEX0JSSUdIVE5FU1M6Cj4tCWNhc2UgVjRMMl9D
SURfSFVFOgo+LQljYXNlIFY0TDJfQ0lEX1NBVFVSQVRJT046Cj4tCWNhc2UgVjRMMl9DSURfQ09O
VFJBU1Q6Cj4tCQlyZXR1cm4gdjRsMl9zdWJkZXZfY2FsbChjeC0+c2RfYXYsIGNvcmUsIHNfY3Ry
bCwgdmN0cmwpOwo+LQo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX1ZPTFVNRToKPi0JY2FzZSBWNEwy
X0NJRF9BVURJT19NVVRFOgo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0JBTEFOQ0U6Cj4tCWNhc2Ug
VjRMMl9DSURfQVVESU9fQkFTUzoKPi0JY2FzZSBWNEwyX0NJRF9BVURJT19UUkVCTEU6Cj4tCWNh
c2UgVjRMMl9DSURfQVVESU9fTE9VRE5FU1M6Cj4tCQlyZXR1cm4gdjRsMl9zdWJkZXZfY2FsbChj
eC0+c2RfYXYsIGNvcmUsIHNfY3RybCwgdmN0cmwpOwo+LQo+LQlkZWZhdWx0Ogo+LQkJQ1gxOF9E
RUJVR19JT0NUTCgiaW52YWxpZCBjb250cm9sIDB4JXhcbiIsIHZjdHJsLT5pZCk7Cj4tCQlyZXR1
cm4gLUVJTlZBTDsKPi0JfQo+LQlyZXR1cm4gMDsKPi19Cj4tCj4tc3RhdGljIGludCBjeDE4X2df
Y3RybChzdHJ1Y3QgY3gxOCAqY3gsIHN0cnVjdCB2NGwyX2NvbnRyb2wgKnZjdHJsKQo+LXsKPi0J
c3dpdGNoICh2Y3RybC0+aWQpIHsKPi0JCS8qIFN0YW5kYXJkIFY0TDIgY29udHJvbHMgKi8KPi0J
Y2FzZSBWNEwyX0NJRF9CUklHSFRORVNTOgo+LQljYXNlIFY0TDJfQ0lEX0hVRToKPi0JY2FzZSBW
NEwyX0NJRF9TQVRVUkFUSU9OOgo+LQljYXNlIFY0TDJfQ0lEX0NPTlRSQVNUOgo+LQkJcmV0dXJu
IHY0bDJfc3ViZGV2X2NhbGwoY3gtPnNkX2F2LCBjb3JlLCBnX2N0cmwsIHZjdHJsKTsKPi0KPi0J
Y2FzZSBWNEwyX0NJRF9BVURJT19WT0xVTUU6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fTVVURToK
Pi0JY2FzZSBWNEwyX0NJRF9BVURJT19CQUxBTkNFOgo+LQljYXNlIFY0TDJfQ0lEX0FVRElPX0JB
U1M6Cj4tCWNhc2UgVjRMMl9DSURfQVVESU9fVFJFQkxFOgo+LQljYXNlIFY0TDJfQ0lEX0FVRElP
X0xPVURORVNTOgo+LQkJcmV0dXJuIHY0bDJfc3ViZGV2X2NhbGwoY3gtPnNkX2F2LCBjb3JlLCBn
X2N0cmwsIHZjdHJsKTsKPisJc3RydWN0IGN4MTggKmN4ID0gY29udGFpbmVyX29mKGN4aGRsLCBz
dHJ1Y3QgY3gxOCwgY3hoZGwpOwo+KwlpbnQgdHlwZSA9IGN4aGRsLT5zdHJlYW1fdHlwZS0+dmFs
Owo+IAo+LQlkZWZhdWx0Ogo+LQkJQ1gxOF9ERUJVR19JT0NUTCgiaW52YWxpZCBjb250cm9sIDB4
JXhcbiIsIHZjdHJsLT5pZCk7Cj4tCQlyZXR1cm4gLUVJTlZBTDsKPi0JfQo+LQlyZXR1cm4gMDsK
Pi19Cj4tCj4tc3RhdGljIGludCBjeDE4X3NldHVwX3ZiaV9mbXQoc3RydWN0IGN4MTggKmN4LAo+
LQkJCSAgICAgIGVudW0gdjRsMl9tcGVnX3N0cmVhbV92YmlfZm10IGZtdCwKPi0JCQkgICAgICBl
bnVtIHY0bDJfbXBlZ19zdHJlYW1fdHlwZSB0eXBlKQo+LXsKPi0JaWYgKCEoY3gtPnY0bDJfY2Fw
ICYgVjRMMl9DQVBfU0xJQ0VEX1ZCSV9DQVBUVVJFKSkKPi0JCXJldHVybiAtRUlOVkFMOwo+IAlp
ZiAoYXRvbWljX3JlYWQoJmN4LT5hbmFfY2FwdHVyaW5nKSA+IDApCj4gCQlyZXR1cm4gLUVCVVNZ
Owo+IAo+QEAgLTIzMCwxMjEgKzg5LDQzIEBAIHN0YXRpYyBpbnQgY3gxOF9zZXR1cF92YmlfZm10
KHN0cnVjdCBjeDE4ICpjeCwKPiAJcmV0dXJuIDA7Cj4gfQo+IAo+LWludCBjeDE4X2dfZXh0X2N0
cmxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xz
ICpjKQo+K3N0YXRpYyBpbnQgY3gxOF9zX3ZpZGVvX2VuY29kaW5nKHN0cnVjdCBjeDIzNDF4X2hh
bmRsZXIgKmN4aGRsLCB1MzIgdmFsKQo+IHsKPi0Jc3RydWN0IGN4MTggKmN4ID0gKChzdHJ1Y3Qg
Y3gxOF9vcGVuX2lkICopZmgpLT5jeDsKPi0Jc3RydWN0IHY0bDJfY29udHJvbCBjdHJsOwo+LQo+
LQlpZiAoYy0+Y3RybF9jbGFzcyA9PSBWNEwyX0NUUkxfQ0xBU1NfVVNFUikgewo+LQkJaW50IGk7
Cj4tCQlpbnQgZXJyID0gMDsKPi0KPi0JCWZvciAoaSA9IDA7IGkgPCBjLT5jb3VudDsgaSsrKSB7
Cj4tCQkJY3RybC5pZCA9IGMtPmNvbnRyb2xzW2ldLmlkOwo+LQkJCWN0cmwudmFsdWUgPSBjLT5j
b250cm9sc1tpXS52YWx1ZTsKPi0JCQllcnIgPSBjeDE4X2dfY3RybChjeCwgJmN0cmwpOwo+LQkJ
CWMtPmNvbnRyb2xzW2ldLnZhbHVlID0gY3RybC52YWx1ZTsKPi0JCQlpZiAoZXJyKSB7Cj4tCQkJ
CWMtPmVycm9yX2lkeCA9IGk7Cj4tCQkJCWJyZWFrOwo+LQkJCX0KPi0JCX0KPi0JCXJldHVybiBl
cnI7Cj4tCX0KPi0JaWYgKGMtPmN0cmxfY2xhc3MgPT0gVjRMMl9DVFJMX0NMQVNTX01QRUcpCj4t
CQlyZXR1cm4gY3gyMzQxeF9leHRfY3RybHMoJmN4LT5wYXJhbXMsIDAsIGMsIFZJRElPQ19HX0VY
VF9DVFJMUyk7Cj4tCXJldHVybiAtRUlOVkFMOwo+KwlzdHJ1Y3QgY3gxOCAqY3ggPSBjb250YWlu
ZXJfb2YoY3hoZGwsIHN0cnVjdCBjeDE4LCBjeGhkbCk7Cj4rCWludCBpc19tcGVnMSA9IHZhbCA9
PSBWNEwyX01QRUdfVklERU9fRU5DT0RJTkdfTVBFR18xOwo+KwlzdHJ1Y3QgdjRsMl9tYnVzX2Zy
YW1lZm10IGZtdDsKPisKPisJLyogZml4IHZpZGVvZGVjb2RlciByZXNvbHV0aW9uICovCj4rCWZt
dC53aWR0aCA9IGN4aGRsLT53aWR0aCAvIChpc19tcGVnMSA/IDIgOiAxKTsKPisJZm10LmhlaWdo
dCA9IGN4aGRsLT5oZWlnaHQ7Cj4rCWZtdC5jb2RlID0gVjRMMl9NQlVTX0ZNVF9GSVhFRDsKPisJ
djRsMl9zdWJkZXZfY2FsbChjeC0+c2RfYXYsIHZpZGVvLCBzX21idXNfZm10LCAmZm10KTsKPisJ
cmV0dXJuIDA7Cj4gfQo+IAo+LWludCBjeDE4X3NfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjKQo+K3N0YXRpYyBpbnQgY3gx
OF9zX2F1ZGlvX3NhbXBsaW5nX2ZyZXEoc3RydWN0IGN4MjM0MXhfaGFuZGxlciAqY3hoZGwsIHUz
MiBpZHgpCj4gewo+LQlzdHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZoOwo+LQlzdHJ1Y3QgY3gx
OCAqY3ggPSBpZC0+Y3g7Cj4tCWludCByZXQ7Cj4tCXN0cnVjdCB2NGwyX2NvbnRyb2wgY3RybDsK
Pi0KPi0JcmV0ID0gdjRsMl9wcmlvX2NoZWNrKCZjeC0+cHJpbywgaWQtPnByaW8pOwo+LQlpZiAo
cmV0KQo+LQkJcmV0dXJuIHJldDsKPi0KPi0JaWYgKGMtPmN0cmxfY2xhc3MgPT0gVjRMMl9DVFJM
X0NMQVNTX1VTRVIpIHsKPi0JCWludCBpOwo+LQkJaW50IGVyciA9IDA7Cj4tCj4tCQlmb3IgKGkg
PSAwOyBpIDwgYy0+Y291bnQ7IGkrKykgewo+LQkJCWN0cmwuaWQgPSBjLT5jb250cm9sc1tpXS5p
ZDsKPi0JCQljdHJsLnZhbHVlID0gYy0+Y29udHJvbHNbaV0udmFsdWU7Cj4tCQkJZXJyID0gY3gx
OF9zX2N0cmwoY3gsICZjdHJsKTsKPi0JCQljLT5jb250cm9sc1tpXS52YWx1ZSA9IGN0cmwudmFs
dWU7Cj4tCQkJaWYgKGVycikgewo+LQkJCQljLT5lcnJvcl9pZHggPSBpOwo+LQkJCQlicmVhazsK
Pi0JCQl9Cj4tCQl9Cj4tCQlyZXR1cm4gZXJyOwo+LQl9Cj4tCWlmIChjLT5jdHJsX2NsYXNzID09
IFY0TDJfQ1RSTF9DTEFTU19NUEVHKSB7Cj4tCQlzdGF0aWMgdTMyIGZyZXFzWzNdID0geyA0NDEw
MCwgNDgwMDAsIDMyMDAwIH07Cj4tCQlzdHJ1Y3QgY3gxOF9hcGlfZnVuY19wcml2YXRlIHByaXY7
Cj4tCQlzdHJ1Y3QgY3gyMzQxeF9tcGVnX3BhcmFtcyBwID0gY3gtPnBhcmFtczsKPi0JCWludCBl
cnIgPSBjeDIzNDF4X2V4dF9jdHJscygmcCwgYXRvbWljX3JlYWQoJmN4LT5hbmFfY2FwdHVyaW5n
KSwKPi0JCQkJCQljLCBWSURJT0NfU19FWFRfQ1RSTFMpOwo+LQkJdW5zaWduZWQgaW50IGlkeDsK
Pi0KPi0JCWlmIChlcnIpCj4tCQkJcmV0dXJuIGVycjsKPisJc3RhdGljIGNvbnN0IHUzMiBmcmVx
c1szXSA9IHsgNDQxMDAsIDQ4MDAwLCAzMjAwMCB9Owo+KwlzdHJ1Y3QgY3gxOCAqY3ggPSBjb250
YWluZXJfb2YoY3hoZGwsIHN0cnVjdCBjeDE4LCBjeGhkbCk7Cj4gCj4tCQlpZiAocC52aWRlb19l
bmNvZGluZyAhPSBjeC0+cGFyYW1zLnZpZGVvX2VuY29kaW5nKSB7Cj4tCQkJaW50IGlzX21wZWcx
ID0gcC52aWRlb19lbmNvZGluZyA9PQo+LQkJCQkJCVY0TDJfTVBFR19WSURFT19FTkNPRElOR19N
UEVHXzE7Cj4tCQkJc3RydWN0IHY0bDJfbWJ1c19mcmFtZWZtdCBmbXQ7Cj4tCj4tCQkJLyogZml4
IHZpZGVvZGVjb2RlciByZXNvbHV0aW9uICovCj4tCQkJZm10LndpZHRoID0gY3gtPnBhcmFtcy53
aWR0aCAvIChpc19tcGVnMSA/IDIgOiAxKTsKPi0JCQlmbXQuaGVpZ2h0ID0gY3gtPnBhcmFtcy5o
ZWlnaHQ7Cj4tCQkJZm10LmNvZGUgPSBWNEwyX01CVVNfRk1UX0ZJWEVEOwo+LQkJCXY0bDJfc3Vi
ZGV2X2NhbGwoY3gtPnNkX2F2LCB2aWRlbywgc19tYnVzX2ZtdCwgJmZtdCk7Cj4tCQl9Cj4tCQlw
cml2LmN4ID0gY3g7Cj4tCQlwcml2LnMgPSAmY3gtPnN0cmVhbXNbaWQtPnR5cGVdOwo+LQkJZXJy
ID0gY3gyMzQxeF91cGRhdGUoJnByaXYsIGN4MThfYXBpX2Z1bmMsICZjeC0+cGFyYW1zLCAmcCk7
Cj4tCQlpZiAoIWVyciAmJgo+LQkJICAgIChjeC0+cGFyYW1zLnN0cmVhbV92YmlfZm10ICE9IHAu
c3RyZWFtX3ZiaV9mbXQgfHwKPi0JCSAgICAgY3gtPnBhcmFtcy5zdHJlYW1fdHlwZSAhPSBwLnN0
cmVhbV90eXBlKSkKPi0JCQllcnIgPSBjeDE4X3NldHVwX3ZiaV9mbXQoY3gsIHAuc3RyZWFtX3Zi
aV9mbXQsCj4tCQkJCQkJIHAuc3RyZWFtX3R5cGUpOwo+LQkJY3gtPnBhcmFtcyA9IHA7Cj4tCQlj
eC0+ZHVhbHdhdGNoX3N0ZXJlb19tb2RlID0gcC5hdWRpb19wcm9wZXJ0aWVzICYgMHgwMzAwOwo+
LQkJaWR4ID0gcC5hdWRpb19wcm9wZXJ0aWVzICYgMHgwMzsKPi0JCS8qIFRoZSBhdWRpbyBjbG9j
ayBvZiB0aGUgZGlnaXRpemVyIG11c3QgbWF0Y2ggdGhlIGNvZGVjIHNhbXBsZQo+LQkJICAgcmF0
ZSBvdGhlcndpc2UgeW91IGdldCBzb21lIHZlcnkgc3RyYW5nZSBlZmZlY3RzLiAqLwo+LQkJaWYg
KGlkeCA8IEFSUkFZX1NJWkUoZnJlcXMpKQo+LQkJCWN4MThfY2FsbF9hbGwoY3gsIGF1ZGlvLCBz
X2Nsb2NrX2ZyZXEsIGZyZXFzW2lkeF0pOwo+LQkJcmV0dXJuIGVycjsKPi0JfQo+LQlyZXR1cm4g
LUVJTlZBTDsKPisJLyogVGhlIGF1ZGlvIGNsb2NrIG9mIHRoZSBkaWdpdGl6ZXIgbXVzdCBtYXRj
aCB0aGUgY29kZWMgc2FtcGxlCj4rCSAgIHJhdGUgb3RoZXJ3aXNlIHlvdSBnZXQgc29tZSB2ZXJ5
IHN0cmFuZ2UgZWZmZWN0cy4gKi8KPisJaWYgKGlkeCA8IEFSUkFZX1NJWkUoZnJlcXMpKQo+KwkJ
Y3gxOF9jYWxsX2FsbChjeCwgYXVkaW8sIHNfY2xvY2tfZnJlcSwgZnJlcXNbaWR4XSk7Cj4rCXJl
dHVybiAwOwo+IH0KPiAKPi1pbnQgY3gxOF90cnlfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjKQo+K3N0YXRpYyBpbnQgY3gx
OF9zX2F1ZGlvX21vZGUoc3RydWN0IGN4MjM0MXhfaGFuZGxlciAqY3hoZGwsIHUzMiB2YWwpCj4g
ewo+LQlzdHJ1Y3QgY3gxOCAqY3ggPSAoKHN0cnVjdCBjeDE4X29wZW5faWQgKilmaCktPmN4Owo+
KwlzdHJ1Y3QgY3gxOCAqY3ggPSBjb250YWluZXJfb2YoY3hoZGwsIHN0cnVjdCBjeDE4LCBjeGhk
bCk7Cj4gCj4tCWlmIChjLT5jdHJsX2NsYXNzID09IFY0TDJfQ1RSTF9DTEFTU19VU0VSKSB7Cj4t
CQlpbnQgaTsKPi0JCWludCBlcnIgPSAwOwo+LQo+LQkJZm9yIChpID0gMDsgaSA8IGMtPmNvdW50
OyBpKyspIHsKPi0JCQllcnIgPSBjeDE4X3RyeV9jdHJsKGZpbGUsIGZoLCAmYy0+Y29udHJvbHNb
aV0pOwo+LQkJCWlmIChlcnIpIHsKPi0JCQkJYy0+ZXJyb3JfaWR4ID0gaTsKPi0JCQkJYnJlYWs7
Cj4tCQkJfQo+LQkJfQo+LQkJcmV0dXJuIGVycjsKPi0JfQo+LQlpZiAoYy0+Y3RybF9jbGFzcyA9
PSBWNEwyX0NUUkxfQ0xBU1NfTVBFRykKPi0JCXJldHVybiBjeDIzNDF4X2V4dF9jdHJscygmY3gt
PnBhcmFtcywKPi0JCQkJCQlhdG9taWNfcmVhZCgmY3gtPmFuYV9jYXB0dXJpbmcpLAo+LQkJCQkJ
CWMsIFZJRElPQ19UUllfRVhUX0NUUkxTKTsKPi0JcmV0dXJuIC1FSU5WQUw7Cj4rCWN4LT5kdWFs
d2F0Y2hfc3RlcmVvX21vZGUgPSB2YWw7Cj4rCXJldHVybiAwOwo+IH0KPisKPitzdHJ1Y3QgY3gy
MzQxeF9oYW5kbGVyX29wcyBjeDE4X2N4aGRsX29wcyA9IHsKPisJLnNfYXVkaW9fbW9kZSA9IGN4
MThfc19hdWRpb19tb2RlLAo+Kwkuc19hdWRpb19zYW1wbGluZ19mcmVxID0gY3gxOF9zX2F1ZGlv
X3NhbXBsaW5nX2ZyZXEsCj4rCS5zX3ZpZGVvX2VuY29kaW5nID0gY3gxOF9zX3ZpZGVvX2VuY29k
aW5nLAo+Kwkuc19zdHJlYW1fdmJpX2ZtdCA9IGN4MThfc19zdHJlYW1fdmJpX2ZtdCwKPit9Owo+
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWNvbnRyb2xzLmggYi9k
cml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1jb250cm9scy5oCj5pbmRleCBlNDYzMjM3Li5j
YjVkZmM3IDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtY29udHJv
bHMuaAo+KysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtY29udHJvbHMuaAo+QEAg
LTIxLDkgKzIxLDQgQEAKPiAgKiAgMDIxMTEtMTMwNyAgVVNBCj4gICovCj4gCj4taW50IGN4MThf
cXVlcnljdHJsKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfcXVlcnlj
dHJsICphKTsKPi1pbnQgY3gxOF9nX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2V4dF9jb250cm9scyAqYSk7Cj4taW50IGN4MThfc19leHRfY3RybHMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9leHRfY29udHJvbHMgKmEp
Owo+LWludCBjeDE4X3RyeV9leHRfY3RybHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAo+
LQkJCXN0cnVjdCB2NGwyX2V4dF9jb250cm9scyAqYSk7Cj4taW50IGN4MThfcXVlcnltZW51KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfcXVlcnltZW51ICphKTsKPitl
eHRlcm4gc3RydWN0IGN4MjM0MXhfaGFuZGxlcl9vcHMgY3gxOF9jeGhkbF9vcHM7Cj5kaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtZHJpdmVyLmMgYi9kcml2ZXJzL21l
ZGlhL3ZpZGVvL2N4MTgvY3gxOC1kcml2ZXIuYwo+aW5kZXggOThhYzJlOS4uOGVhNzExMCAxMDA2
NDQKPi0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWRyaXZlci5jCj4rKysgYi9k
cml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1kcml2ZXIuYwo+QEAgLTM2LDYgKzM2LDcgQEAK
PiAjaW5jbHVkZSAiY3gxOC1zY2IuaCIKPiAjaW5jbHVkZSAiY3gxOC1tYWlsYm94LmgiCj4gI2lu
Y2x1ZGUgImN4MTgtaW9jdGwuaCIKPisjaW5jbHVkZSAiY3gxOC1jb250cm9scy5oIgo+ICNpbmNs
dWRlICJ0dW5lci14YzIwMjguaCIKPiAKPiAjaW5jbHVkZSA8bWVkaWEvdHZlZXByb20uaD4KPkBA
IC03MjAsMTUgKzcyMSwyMSBAQCBzdGF0aWMgaW50IF9fZGV2aW5pdCBjeDE4X2luaXRfc3RydWN0
MShzdHJ1Y3QgY3gxOCAqY3gpCj4gCWN4LT5vcGVuX2lkID0gMTsKPiAKPiAJLyogSW5pdGlhbCBz
ZXR0aW5ncyAqLwo+LQljeDIzNDF4X2ZpbGxfZGVmYXVsdHMoJmN4LT5wYXJhbXMpOwo+LQljeC0+
dGVtcG9yYWxfc3RyZW5ndGggPSBjeC0+cGFyYW1zLnZpZGVvX3RlbXBvcmFsX2ZpbHRlcjsKPi0J
Y3gtPnNwYXRpYWxfc3RyZW5ndGggPSBjeC0+cGFyYW1zLnZpZGVvX3NwYXRpYWxfZmlsdGVyOwo+
LQljeC0+ZmlsdGVyX21vZGUgPSBjeC0+cGFyYW1zLnZpZGVvX3NwYXRpYWxfZmlsdGVyX21vZGUg
fAo+LQkJKGN4LT5wYXJhbXMudmlkZW9fdGVtcG9yYWxfZmlsdGVyX21vZGUgPDwgMSkgfAo+LQkJ
KGN4LT5wYXJhbXMudmlkZW9fbWVkaWFuX2ZpbHRlcl90eXBlIDw8IDIpOwo+LQljeC0+cGFyYW1z
LnBvcnQgPSBDWDIzNDFYX1BPUlRfTUVNT1JZOwo+LQljeC0+cGFyYW1zLmNhcGFiaWxpdGllcyA9
Cj4tCQkJCUNYMjM0MVhfQ0FQX0hBU19UUyB8IENYMjM0MVhfQ0FQX0hBU19TTElDRURfVkJJOwo+
KwljeC0+Y3hoZGwucG9ydCA9IENYMjM0MVhfUE9SVF9NRU1PUlk7Cj4rCWN4LT5jeGhkbC5jYXBh
YmlsaXRpZXMgPSBDWDIzNDFYX0NBUF9IQVNfVFMgfCBDWDIzNDFYX0NBUF9IQVNfU0xJQ0VEX1ZC
STsKPisJY3gtPmN4aGRsLm9wcyA9ICZjeDE4X2N4aGRsX29wczsKPisJY3gtPmN4aGRsLmZ1bmMg
PSBjeDE4X2FwaV9mdW5jOwo+KwlyZXQgPSBjeDIzNDF4X2hhbmRsZXJfaW5pdCgmY3gtPmN4aGRs
LCA1MCk7Cj4rCWlmIChyZXQpCj4rCQlyZXR1cm4gcmV0Owo+KwljeC0+djRsMl9kZXYuY3RybF9o
YW5kbGVyID0gJmN4LT5jeGhkbC5oZGw7Cj4rCj4rCWN4LT50ZW1wb3JhbF9zdHJlbmd0aCA9IGN4
LT5jeGhkbC52aWRlb190ZW1wb3JhbF9maWx0ZXItPmN1ci52YWw7Cj4rCWN4LT5zcGF0aWFsX3N0
cmVuZ3RoID0gY3gtPmN4aGRsLnZpZGVvX3NwYXRpYWxfZmlsdGVyLT5jdXIudmFsOwo+KwljeC0+
ZmlsdGVyX21vZGUgPSBjeC0+Y3hoZGwudmlkZW9fc3BhdGlhbF9maWx0ZXJfbW9kZS0+Y3VyLnZh
bCB8Cj4rCQkoY3gtPmN4aGRsLnZpZGVvX3RlbXBvcmFsX2ZpbHRlcl9tb2RlLT5jdXIudmFsIDw8
IDEpIHwKPisJCShjeC0+Y3hoZGwudmlkZW9fbWVkaWFuX2ZpbHRlcl90eXBlLT5jdXIudmFsIDw8
IDIpOwo+Kwo+IAlpbml0X3dhaXRxdWV1ZV9oZWFkKCZjeC0+Y2FwX3cpOwo+IAlpbml0X3dhaXRx
dWV1ZV9oZWFkKCZjeC0+bWJfYXB1X3dhaXRxKTsKPiAJaW5pdF93YWl0cXVldWVfaGVhZCgmY3gt
Pm1iX2NwdV93YWl0cSk7Cj5AQCAtMTAzNSw3ICsxMDQyLDcgQEAgc3RhdGljIGludCBfX2Rldmlu
aXQgY3gxOF9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGNpX2RldiwKPiAJZWxzZQo+IAkJY3gtPmlz
XzUwaHogPSAxOwo+IAo+LQljeC0+cGFyYW1zLnZpZGVvX2dvcF9zaXplID0gY3gtPmlzXzYwaHog
PyAxNSA6IDEyOwo+KwljeDIzNDF4X2hhbmRsZXJfc2V0XzUwaHooJmN4LT5jeGhkbCwgIWN4LT5p
c182MGh6KTsKPiAKPiAJaWYgKGN4LT5vcHRpb25zLnJhZGlvID4gMCkKPiAJCWN4LT52NGwyX2Nh
cCB8PSBWNEwyX0NBUF9SQURJTzsKPkBAIC0xMDgxLDcgKzEwODgsNiBAQCBzdGF0aWMgaW50IF9f
ZGV2aW5pdCBjeDE4X3Byb2JlKHN0cnVjdCBwY2lfZGV2ICpwY2lfZGV2LAo+IAo+IAkvKiBMb2Fk
IGN4MTggc3VibW9kdWxlcyAoY3gxOC1hbHNhKSAqLwo+IAlyZXF1ZXN0X21vZHVsZXMoY3gpOwo+
LQo+IAlyZXR1cm4gMDsKPiAKPiBmcmVlX3N0cmVhbXM6Cj5AQCAtMTI2NCw2ICsxMjcwLDggQEAg
c3RhdGljIHZvaWQgY3gxOF9yZW1vdmUoc3RydWN0IHBjaV9kZXYgKnBjaV9kZXYpCj4gCQlmb3Ig
KGkgPSAwOyBpIDwgQ1gxOF9WQklfRlJBTUVTOyBpKyspCj4gCQkJa2ZyZWUoY3gtPnZiaS5zbGlj
ZWRfbXBlZ19kYXRhW2ldKTsKPiAKPisJdjRsMl9jdHJsX2hhbmRsZXJfZnJlZSgmY3gtPmF2X3N0
YXRlLmhkbCk7Cj4rCj4gCUNYMThfSU5GTygiUmVtb3ZlZCAlc1xuIiwgY3gtPmNhcmRfbmFtZSk7
Cj4gCj4gCXY0bDJfZGV2aWNlX3VucmVnaXN0ZXIodjRsMl9kZXYpOwo+ZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LWRyaXZlci5oIGIvZHJpdmVycy9tZWRpYS92aWRl
by9jeDE4L2N4MTgtZHJpdmVyLmgKPmluZGV4IGNmNGYyMGUuLmNiZDI3NTMgMTAwNjQ0Cj4tLS0g
YS9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1kcml2ZXIuaAo+KysrIGIvZHJpdmVycy9t
ZWRpYS92aWRlby9jeDE4L2N4MTgtZHJpdmVyLmgKPkBAIC01NjMsNyArNTYzLDcgQEAgc3RydWN0
IGN4MTggewo+IAlzdHJ1Y3QgY3gxOF9hdl9zdGF0ZSBhdl9zdGF0ZTsKPiAKPiAJLyogY29kZWMg
c2V0dGluZ3MgKi8KPi0Jc3RydWN0IGN4MjM0MXhfbXBlZ19wYXJhbXMgcGFyYW1zOwo+KwlzdHJ1
Y3QgY3gyMzQxeF9oYW5kbGVyIGN4aGRsOwo+IAl1MzIgZmlsdGVyX21vZGU7Cj4gCXUzMiB0ZW1w
b3JhbF9zdHJlbmd0aDsKPiAJdTMyIHNwYXRpYWxfc3RyZW5ndGg7Cj5kaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtZmlsZW9wcy5jIGIvZHJpdmVycy9tZWRpYS92aWRl
by9jeDE4L2N4MTgtZmlsZW9wcy5jCj5pbmRleCA5ZjIzYjkwLi45OGVmMzNlIDEwMDY0NAo+LS0t
IGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtZmlsZW9wcy5jCj4rKysgYi9kcml2ZXJz
L21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1maWxlb3BzLmMKPkBAIC0xNjAsMTMgKzE2MCwxMCBAQCBF
WFBPUlRfU1lNQk9MKGN4MThfcmVsZWFzZV9zdHJlYW0pOwo+IHN0YXRpYyB2b2lkIGN4MThfZHVh
bHdhdGNoKHN0cnVjdCBjeDE4ICpjeCkKPiB7Cj4gCXN0cnVjdCB2NGwyX3R1bmVyIHZ0Owo+LQl1
MzIgbmV3X2JpdG1hcDsKPiAJdTMyIG5ld19zdGVyZW9fbW9kZTsKPi0JY29uc3QgdTMyIHN0ZXJl
b19tYXNrID0gMHgwMzAwOwo+IAljb25zdCB1MzIgZHVhbCA9IDB4MDIwMDsKPi0JdTMyIGg7Cj4g
Cj4tCW5ld19zdGVyZW9fbW9kZSA9IGN4LT5wYXJhbXMuYXVkaW9fcHJvcGVydGllcyAmIHN0ZXJl
b19tYXNrOwo+KwluZXdfc3RlcmVvX21vZGUgPSB2NGwyX2N0cmxfZ19jdHJsKGN4LT5jeGhkbC5h
dWRpb19tb2RlKTsKPiAJbWVtc2V0KCZ2dCwgMCwgc2l6ZW9mKHZ0KSk7Cj4gCWN4MThfY2FsbF9h
bGwoY3gsIHR1bmVyLCBnX3R1bmVyLCAmdnQpOwo+IAlpZiAodnQuYXVkbW9kZSA9PSBWNEwyX1RV
TkVSX01PREVfTEFORzFfTEFORzIgJiYKPkBAIC0xNzYsMjUgKzE3MywxMCBAQCBzdGF0aWMgdm9p
ZCBjeDE4X2R1YWx3YXRjaChzdHJ1Y3QgY3gxOCAqY3gpCj4gCWlmIChuZXdfc3RlcmVvX21vZGUg
PT0gY3gtPmR1YWx3YXRjaF9zdGVyZW9fbW9kZSkKPiAJCXJldHVybjsKPiAKPi0JbmV3X2JpdG1h
cCA9IG5ld19zdGVyZW9fbW9kZQo+LQkJCXwgKGN4LT5wYXJhbXMuYXVkaW9fcHJvcGVydGllcyAm
IH5zdGVyZW9fbWFzayk7Cj4tCj4tCUNYMThfREVCVUdfSU5GTygiZHVhbHdhdGNoOiBjaGFuZ2Ug
c3RlcmVvIGZsYWcgZnJvbSAweCV4IHRvIDB4JXguICIKPi0JCQkibmV3IGF1ZGlvX2JpdG1hc2s9
MHgldXhcbiIsCj4tCQkJY3gtPmR1YWx3YXRjaF9zdGVyZW9fbW9kZSwgbmV3X3N0ZXJlb19tb2Rl
LCBuZXdfYml0bWFwKTsKPi0KPi0JaCA9IGN4MThfZmluZF9oYW5kbGUoY3gpOwo+LQlpZiAoaCA9
PSBDWDE4X0lOVkFMSURfVEFTS19IQU5ETEUpIHsKPi0JCUNYMThfREVCVUdfSU5GTygiZHVhbHdh
dGNoOiBjYW4ndCBmaW5kIHZhbGlkIHRhc2sgaGFuZGxlXG4iKTsKPi0JCXJldHVybjsKPi0JfQo+
LQo+LQlpZiAoY3gxOF92YXBpKGN4LAo+LQkJICAgICAgQ1gxOF9DUFVfU0VUX0FVRElPX1BBUkFN
RVRFUlMsIDIsIGgsIG5ld19iaXRtYXApID09IDApIHsKPi0JCWN4LT5kdWFsd2F0Y2hfc3RlcmVv
X21vZGUgPSBuZXdfc3RlcmVvX21vZGU7Cj4tCQlyZXR1cm47Cj4tCX0KPi0JQ1gxOF9ERUJVR19J
TkZPKCJkdWFsd2F0Y2g6IGNoYW5naW5nIHN0ZXJlbyBmbGFnIGZhaWxlZFxuIik7Cj4rCUNYMThf
REVCVUdfSU5GTygiZHVhbHdhdGNoOiBjaGFuZ2Ugc3RlcmVvIGZsYWcgZnJvbSAweCV4IHRvIDB4
JXguXG4iLAo+KwkJCSAgIGN4LT5kdWFsd2F0Y2hfc3RlcmVvX21vZGUsIG5ld19zdGVyZW9fbW9k
ZSk7Cj4rCWlmICh2NGwyX2N0cmxfc19jdHJsKGN4LT5jeGhkbC5hdWRpb19tb2RlLCBuZXdfc3Rl
cmVvX21vZGUpKQo+KwkJQ1gxOF9ERUJVR19JTkZPKCJkdWFsd2F0Y2g6IGNoYW5naW5nIHN0ZXJl
byBmbGFnIGZhaWxlZFxuIik7Cj4gfQo+IAo+IAo+QEAgLTcyNCw4ICs3MDYsOCBAQCBpbnQgY3gx
OF92NGwyX2Nsb3NlKHN0cnVjdCBmaWxlICpmaWxwKQo+IAkJaWYgKGF0b21pY19yZWFkKCZjeC0+
YW5hX2NhcHR1cmluZykgPiAwKSB7Cj4gCQkJLyogVW5kbyB2aWRlbyBtdXRlICovCj4gCQkJY3gx
OF92YXBpKGN4LCBDWDE4X0NQVV9TRVRfVklERU9fTVVURSwgMiwgcy0+aGFuZGxlLAo+LQkJCQlj
eC0+cGFyYW1zLnZpZGVvX211dGUgfAo+LQkJCQkJKGN4LT5wYXJhbXMudmlkZW9fbXV0ZV95dXYg
PDwgOCkpOwo+KwkJCSAgICAodjRsMl9jdHJsX2dfY3RybChjeC0+Y3hoZGwudmlkZW9fbXV0ZSkg
fAo+KwkJCSAgICAodjRsMl9jdHJsX2dfY3RybChjeC0+Y3hoZGwudmlkZW9fbXV0ZV95dXYpIDw8
IDgpKSk7Cj4gCQl9Cj4gCQkvKiBEb25lISBVbm11dGUgYW5kIGNvbnRpbnVlLiAqLwo+IAkJY3gx
OF91bm11dGUoY3gpOwo+ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4
LWlvY3RsLmMgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1pb2N0bC5jCj5pbmRleCA3
MTUwMTk1Li4zNmIwMThjIDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4
MTgtaW9jdGwuYwo+KysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtaW9jdGwuYwo+
QEAgLTE1Miw4ICsxNTIsOCBAQCBzdGF0aWMgaW50IGN4MThfZ19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCj4gCXN0cnVjdCBjeDE4ICpjeCA9IGlkLT5jeDsKPiAJc3Ry
dWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4Zm10ID0gJmZtdC0+Zm10LnBpeDsKPiAKPi0JcGl4Zm10
LT53aWR0aCA9IGN4LT5wYXJhbXMud2lkdGg7Cj4tCXBpeGZtdC0+aGVpZ2h0ID0gY3gtPnBhcmFt
cy5oZWlnaHQ7Cj4rCXBpeGZtdC0+d2lkdGggPSBjeC0+Y3hoZGwud2lkdGg7Cj4rCXBpeGZtdC0+
aGVpZ2h0ID0gY3gtPmN4aGRsLmhlaWdodDsKPiAJcGl4Zm10LT5jb2xvcnNwYWNlID0gVjRMMl9D
T0xPUlNQQUNFX1NNUFRFMTcwTTsKPiAJcGl4Zm10LT5maWVsZCA9IFY0TDJfRklFTERfSU5URVJM
QUNFRDsKPiAJcGl4Zm10LT5wcml2ID0gMDsKPkBAIC0yODcsMTQgKzI4NywxNCBAQCBzdGF0aWMg
aW50IGN4MThfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCj4gCXcg
PSBmbXQtPmZtdC5waXgud2lkdGg7Cj4gCWggPSBmbXQtPmZtdC5waXguaGVpZ2h0Owo+IAo+LQlp
ZiAoY3gtPnBhcmFtcy53aWR0aCA9PSB3ICYmIGN4LT5wYXJhbXMuaGVpZ2h0ID09IGgpCj4rCWlm
IChjeC0+Y3hoZGwud2lkdGggPT0gdyAmJiBjeC0+Y3hoZGwuaGVpZ2h0ID09IGgpCj4gCQlyZXR1
cm4gMDsKPiAKPiAJaWYgKGF0b21pY19yZWFkKCZjeC0+YW5hX2NhcHR1cmluZykgPiAwKQo+IAkJ
cmV0dXJuIC1FQlVTWTsKPiAKPi0JbWJ1c19mbXQud2lkdGggPSBjeC0+cGFyYW1zLndpZHRoID0g
dzsKPi0JbWJ1c19mbXQuaGVpZ2h0ID0gY3gtPnBhcmFtcy5oZWlnaHQgPSBoOwo+KwltYnVzX2Zt
dC53aWR0aCA9IGN4LT5jeGhkbC53aWR0aCA9IHc7Cj4rCW1idXNfZm10LmhlaWdodCA9IGN4LT5j
eGhkbC5oZWlnaHQgPSBoOwo+IAltYnVzX2ZtdC5jb2RlID0gVjRMMl9NQlVTX0ZNVF9GSVhFRDsK
PiAJdjRsMl9zdWJkZXZfY2FsbChjeC0+c2RfYXYsIHZpZGVvLCBzX21idXNfZm10LCAmbWJ1c19m
bXQpOwo+IAlyZXR1cm4gY3gxOF9nX2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmbXQpOwo+QEAgLTY5
Niw5ICs2OTYsMTAgQEAgaW50IGN4MThfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCB2NGwyX3N0ZF9pZCAqc3RkKQo+IAo+IAljeC0+c3RkID0gKnN0ZDsKPiAJY3gtPmlzXzYwaHog
PSAoKnN0ZCAmIFY0TDJfU1REXzUyNV82MCkgPyAxIDogMDsKPi0JY3gtPnBhcmFtcy5pc181MGh6
ID0gY3gtPmlzXzUwaHogPSAhY3gtPmlzXzYwaHo7Cj4tCWN4LT5wYXJhbXMud2lkdGggPSA3MjA7
Cj4tCWN4LT5wYXJhbXMuaGVpZ2h0ID0gY3gtPmlzXzUwaHogPyA1NzYgOiA0ODA7Cj4rCWN4LT5p
c181MGh6ID0gIWN4LT5pc182MGh6Owo+KwljeDIzNDF4X2hhbmRsZXJfc2V0XzUwaHooJmN4LT5j
eGhkbCwgY3gtPmlzXzUwaHopOwo+KwljeC0+Y3hoZGwud2lkdGggPSA3MjA7Cj4rCWN4LT5jeGhk
bC5oZWlnaHQgPSBjeC0+aXNfNTBoeiA/IDU3NiA6IDQ4MDsKPiAJY3gtPnZiaS5jb3VudCA9IGN4
LT5pc181MGh6ID8gMTggOiAxMjsKPiAJY3gtPnZiaS5zdGFydFswXSA9IGN4LT5pc181MGh6ID8g
NiA6IDEwOwo+IAljeC0+dmJpLnN0YXJ0WzFdID0gY3gtPmlzXzUwaHogPyAzMTggOiAyNzM7Cj5A
QCAtMTAzNSw3ICsxMDM2LDcgQEAgc3RhdGljIGludCBjeDE4X2xvZ19zdGF0dXMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoKQo+IAltdXRleF91bmxvY2soJmN4LT5ncGlvX2xvY2spOwo+IAlD
WDE4X0lORk8oIlR1bmVyOiAlc1xuIiwKPiAJCXRlc3RfYml0KENYMThfRl9JX1JBRElPX1VTRVIs
ICZjeC0+aV9mbGFncykgPyAgIlJhZGlvIiA6ICJUViIpOwo+LQljeDIzNDF4X2xvZ19zdGF0dXMo
JmN4LT5wYXJhbXMsIGN4LT52NGwyX2Rldi5uYW1lKTsKPisJdjRsMl9jdHJsX2hhbmRsZXJfbG9n
X3N0YXR1cygmY3gtPmN4aGRsLmhkbCwgY3gtPnY0bDJfZGV2Lm5hbWUpOwo+IAlDWDE4X0lORk8o
IlN0YXR1cyBmbGFnczogMHglMDhseFxuIiwgY3gtPmlfZmxhZ3MpOwo+IAlmb3IgKGkgPSAwOyBp
IDwgQ1gxOF9NQVhfU1RSRUFNUzsgaSsrKSB7Cj4gCQlzdHJ1Y3QgY3gxOF9zdHJlYW0gKnMgPSAm
Y3gtPnN0cmVhbXNbaV07Cj5AQCAtMTEzNiwxMSArMTEzNyw2IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgdjRsMl9pb2N0bF9vcHMgY3gxOF9pb2N0bF9vcHMgPSB7Cj4gCS52aWRpb2Nfc19yZWdpc3Rl
ciAgICAgICAgICAgICAgPSBjeDE4X3NfcmVnaXN0ZXIsCj4gI2VuZGlmCj4gCS52aWRpb2NfZGVm
YXVsdCAgICAgICAgICAgICAgICAgPSBjeDE4X2RlZmF1bHQsCj4tCS52aWRpb2NfcXVlcnljdHJs
ICAgICAgICAgICAgICAgPSBjeDE4X3F1ZXJ5Y3RybCwKPi0JLnZpZGlvY19xdWVyeW1lbnUgICAg
ICAgICAgICAgICA9IGN4MThfcXVlcnltZW51LAo+LQkudmlkaW9jX2dfZXh0X2N0cmxzICAgICAg
ICAgICAgID0gY3gxOF9nX2V4dF9jdHJscywKPi0JLnZpZGlvY19zX2V4dF9jdHJscyAgICAgICAg
ICAgICA9IGN4MThfc19leHRfY3RybHMsCj4tCS52aWRpb2NfdHJ5X2V4dF9jdHJscyAgICAgICAg
ICAgPSBjeDE4X3RyeV9leHRfY3RybHMsCj4gfTsKPiAKPiB2b2lkIGN4MThfc2V0X2Z1bmNzKHN0
cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYpCj5kaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRl
by9jeDE4L2N4MTgtbWFpbGJveC5jIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtbWFp
bGJveC5jCj5pbmRleCA5NTZhYTE5Li5kMzY2ZDY1IDEwMDY0NAo+LS0tIGEvZHJpdmVycy9tZWRp
YS92aWRlby9jeDE4L2N4MTgtbWFpbGJveC5jCj4rKysgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4
MTgvY3gxOC1tYWlsYm94LmMKPkBAIC03MTYsOSArNzE2LDggQEAgc3RhdGljIGludCBjeDE4X3Nl
dF9maWx0ZXJfcGFyYW0oc3RydWN0IGN4MThfc3RyZWFtICpzKQo+IGludCBjeDE4X2FwaV9mdW5j
KHZvaWQgKnByaXYsIHUzMiBjbWQsIGludCBpbiwgaW50IG91dCwKPiAJCXUzMiBkYXRhW0NYMjM0
MVhfTUJPWF9NQVhfREFUQV0pCj4gewo+LQlzdHJ1Y3QgY3gxOF9hcGlfZnVuY19wcml2YXRlICph
cGlfcHJpdiA9IHByaXY7Cj4tCXN0cnVjdCBjeDE4ICpjeCA9IGFwaV9wcml2LT5jeDsKPi0Jc3Ry
dWN0IGN4MThfc3RyZWFtICpzID0gYXBpX3ByaXYtPnM7Cj4rCXN0cnVjdCBjeDE4X3N0cmVhbSAq
cyA9IHByaXY7Cj4rCXN0cnVjdCBjeDE4ICpjeCA9IHMtPmN4Owo+IAo+IAlzd2l0Y2ggKGNtZCkg
ewo+IAljYXNlIENYMjM0MVhfRU5DX1NFVF9PVVRQVVRfUE9SVDoKPmRpZmYgLS1naXQgYS9kcml2
ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1tYWlsYm94LmggYi9kcml2ZXJzL21lZGlhL3ZpZGVv
L2N4MTgvY3gxOC1tYWlsYm94LmgKPmluZGV4IDA3Nzk1MmYuLjA1ZmU2YmQgMTAwNjQ0Cj4tLS0g
YS9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4MTgvY3gxOC1tYWlsYm94LmgKPisrKyBiL2RyaXZlcnMv
bWVkaWEvdmlkZW8vY3gxOC9jeDE4LW1haWxib3guaAo+QEAgLTgxLDExICs4MSw2IEBAIHN0cnVj
dCBjeDE4X21haWxib3ggewo+IAo+IHN0cnVjdCBjeDE4X3N0cmVhbTsKPiAKPi1zdHJ1Y3QgY3gx
OF9hcGlfZnVuY19wcml2YXRlIHsKPi0Jc3RydWN0IGN4MTggKmN4Owo+LQlzdHJ1Y3QgY3gxOF9z
dHJlYW0gKnM7Cj4tfTsKPi0KPiBpbnQgY3gxOF9hcGkoc3RydWN0IGN4MTggKmN4LCB1MzIgY21k
LCBpbnQgYXJncywgdTMyIGRhdGFbXSk7Cj4gaW50IGN4MThfdmFwaV9yZXN1bHQoc3RydWN0IGN4
MTggKmN4LCB1MzIgZGF0YVtNQVhfTUJfQVJHVU1FTlRTXSwgdTMyIGNtZCwKPiAJCWludCBhcmdz
LCAuLi4pOwo+ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LXN0cmVh
bXMuYyBiL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4LXN0cmVhbXMuYwo+aW5kZXggOTA0
NWYxZS4uZDBjOTIzZSAxMDA2NDQKPi0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gxOC9jeDE4
LXN0cmVhbXMuYwo+KysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDE4L2N4MTgtc3RyZWFtcy5j
Cj5AQCAtNTU1LDcgKzU1NSw3IEBAIHN0YXRpYyB2b2lkIGN4MThfc3RyZWFtX2NvbmZpZ3VyZV9t
ZGxzKHN0cnVjdCBjeDE4X3N0cmVhbSAqcykKPiAJCSAqIFNldCB0aGUgTURMIHNpemUgdG8gdGhl
IGV4YWN0IHNpemUgbmVlZGVkIGZvciBvbmUgZnJhbWUuCj4gCQkgKiBVc2UgZW5vdWdoIGJ1ZmZl
cnMgcGVyIE1ETCB0byBjb3ZlciB0aGUgTURMIHNpemUKPiAJCSAqLwo+LQkJcy0+bWRsX3NpemUg
PSA3MjAgKiBzLT5jeC0+cGFyYW1zLmhlaWdodCAqIDMgLyAyOwo+KwkJcy0+bWRsX3NpemUgPSA3
MjAgKiBzLT5jeC0+Y3hoZGwuaGVpZ2h0ICogMyAvIDI7Cj4gCQlzLT5idWZzX3Blcl9tZGwgPSBz
LT5tZGxfc2l6ZSAvIHMtPmJ1Zl9zaXplOwo+IAkJaWYgKHMtPm1kbF9zaXplICUgcy0+YnVmX3Np
emUpCj4gCQkJcy0+YnVmc19wZXJfbWRsKys7Cj5AQCAtNTkwLDcgKzU5MCw2IEBAIGludCBjeDE4
X3N0YXJ0X3Y0bDJfZW5jb2RlX3N0cmVhbShzdHJ1Y3QgY3gxOF9zdHJlYW0gKnMpCj4gCXUzMiBk
YXRhW01BWF9NQl9BUkdVTUVOVFNdOwo+IAlzdHJ1Y3QgY3gxOCAqY3ggPSBzLT5jeDsKPiAJaW50
IGNhcHR5cGUgPSAwOwo+LQlzdHJ1Y3QgY3gxOF9hcGlfZnVuY19wcml2YXRlIHByaXY7Cj4gCXN0
cnVjdCBjeDE4X3N0cmVhbSAqc19pZHg7Cj4gCj4gCWlmICghY3gxOF9zdHJlYW1fZW5hYmxlZChz
KSkKPkBAIC02MDMsNyArNjAyLDcgQEAgaW50IGN4MThfc3RhcnRfdjRsMl9lbmNvZGVfc3RyZWFt
KHN0cnVjdCBjeDE4X3N0cmVhbSAqcykKPiAJCWNhcHR5cGUgPSBDQVBUVVJFX0NIQU5ORUxfVFlQ
RV9NUEVHOwo+IAkJY3gtPm1wZ19kYXRhX3JlY2VpdmVkID0gY3gtPnZiaV9kYXRhX2luc2VydGVk
ID0gMDsKPiAJCWN4LT5kdWFsd2F0Y2hfamlmZmllcyA9IGppZmZpZXM7Cj4tCQljeC0+ZHVhbHdh
dGNoX3N0ZXJlb19tb2RlID0gY3gtPnBhcmFtcy5hdWRpb19wcm9wZXJ0aWVzICYgMHgzMDA7Cj4r
CQljeC0+ZHVhbHdhdGNoX3N0ZXJlb19tb2RlID0gdjRsMl9jdHJsX2dfY3RybChjeC0+Y3hoZGwu
YXVkaW9fbW9kZSk7Cj4gCQljeC0+c2VhcmNoX3BhY2tfaGVhZGVyID0gMDsKPiAJCWJyZWFrOwo+
IAo+QEAgLTY5MywyMSArNjkyLDIxIEBAIGludCBjeDE4X3N0YXJ0X3Y0bDJfZW5jb2RlX3N0cmVh
bShzdHJ1Y3QgY3gxOF9zdHJlYW0gKnMpCj4gCQkJCSBzLT5oYW5kbGUsIGN4MThfc3RyZWFtX2Vu
YWJsZWQoc19pZHgpID8gNyA6IDApOwo+IAo+IAkJLyogQ2FsbCBvdXQgdG8gdGhlIGNvbW1vbiBD
WDIzNDF4IEFQSSBzZXR1cCBmb3IgdXNlciBjb250cm9scyAqLwo+LQkJcHJpdi5jeCA9IGN4Owo+
LQkJcHJpdi5zID0gczsKPi0JCWN4MjM0MXhfdXBkYXRlKCZwcml2LCBjeDE4X2FwaV9mdW5jLCBO
VUxMLCAmY3gtPnBhcmFtcyk7Cj4rCQljeC0+Y3hoZGwucHJpdiA9IHM7Cj4rCQljeDIzNDF4X2hh
bmRsZXJfc2V0dXAoJmN4LT5jeGhkbCk7Cj4gCj4gCQkvKgo+IAkJICogV2hlbiBzdGFydGluZyBh
IGNhcHR1cmUgYW5kIHdlJ3JlIHNldCBmb3IgcmFkaW8sCj4gCQkgKiBlbnN1cmUgdGhlIHZpZGVv
IGlzIG11dGVkLCBkZXNwaXRlIHRoZSB1c2VyIGNvbnRyb2wuCj4gCQkgKi8KPi0JCWlmICghY3gt
PnBhcmFtcy52aWRlb19tdXRlICYmCj4rCQlpZiAoIWN4LT5jeGhkbC52aWRlb19tdXRlICYmCj4g
CQkgICAgdGVzdF9iaXQoQ1gxOF9GX0lfUkFESU9fVVNFUiwgJmN4LT5pX2ZsYWdzKSkKPiAJCQlj
eDE4X3ZhcGkoY3gsIENYMThfQ1BVX1NFVF9WSURFT19NVVRFLCAyLCBzLT5oYW5kbGUsCj4tCQkJ
CSAgKGN4LT5wYXJhbXMudmlkZW9fbXV0ZV95dXYgPDwgOCkgfCAxKTsKPisJCQkgICh2NGwyX2N0
cmxfZ19jdHJsKGN4LT5jeGhkbC52aWRlb19tdXRlX3l1dikgPDwgOCkgfCAxKTsKPiAJfQo+IAo+
IAlpZiAoYXRvbWljX3JlYWQoJmN4LT50b3RfY2FwdHVyaW5nKSA9PSAwKSB7Cj4rCQljeDIzNDF4
X2hhbmRsZXJfc2V0X2J1c3koJmN4LT5jeGhkbCwgMSk7Cj4gCQljbGVhcl9iaXQoQ1gxOF9GX0lf
RU9TLCAmY3gtPmlfZmxhZ3MpOwo+IAkJY3gxOF93cml0ZV9yZWcoY3gsIDcsIENYMThfRFNQMF9J
TlRFUlJVUFRfTUFTSyk7Cj4gCX0KPkBAIC04MDksNiArODA4LDcgQEAgaW50IGN4MThfc3RvcF92
NGwyX2VuY29kZV9zdHJlYW0oc3RydWN0IGN4MThfc3RyZWFtICpzLCBpbnQgZ29wX2VuZCkKPiAJ
aWYgKGF0b21pY19yZWFkKCZjeC0+dG90X2NhcHR1cmluZykgPiAwKQo+IAkJcmV0dXJuIDA7Cj4g
Cj4rCWN4MjM0MXhfaGFuZGxlcl9zZXRfYnVzeSgmY3gtPmN4aGRsLCAwKTsKPiAJY3gxOF93cml0
ZV9yZWcoY3gsIDUsIENYMThfRFNQMF9JTlRFUlJVUFRfTUFTSyk7Cj4gCXdha2VfdXAoJnMtPndh
aXRxKTsKPiAKPi0tIAo+MS43LjAuNAo+Cj4tLQo+VG8gdW5zdWJzY3JpYmUgZnJvbSB0aGlzIGxp
c3Q6IHNlbmQgdGhlIGxpbmUgInVuc3Vic2NyaWJlIGxpbnV4LW1lZGlhIiBpbgo+dGhlIGJvZHkg
b2YgYSBtZXNzYWdlIHRvIG1ham9yZG9tb0B2Z2VyLmtlcm5lbC5vcmcKPk1vcmUgbWFqb3Jkb21v
IGluZm8gYXQgIGh0dHA6Ly92Z2VyLmtlcm5lbC5vcmcvbWFqb3Jkb21vLWluZm8uaHRtbAo=

