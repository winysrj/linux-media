Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-yw0-f46.google.com ([209.85.213.46]:62681 "EHLO
	mail-yw0-f46.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752800Ab2EUOgR (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Mon, 21 May 2012 10:36:17 -0400
Received: by yhmm54 with SMTP id m54so4419789yhm.19
        for <linux-media@vger.kernel.org>; Mon, 21 May 2012 07:36:17 -0700 (PDT)
MIME-Version: 1.0
Date: Mon, 21 May 2012 16:36:16 +0200
Message-ID: <CAGGh5h0Mg6srzBrmKoDERu3H+7kBGeAke-iuOLSzxHdqo0zcrQ@mail.gmail.com>
Subject: [RFC Patch] omap3isp : support CFA pattern when not GRBG
From: jean-philippe francois <jp.francois@cynove.com>
To: linux-media <linux-media@vger.kernel.org>
Content-Type: multipart/mixed; boundary=14dae93406011d1ab804c08cd3cd
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--14dae93406011d1ab804c08cd3cd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

omap3 ISP previewer block can convert a raw bayer image
into a UYVY image. Debayering coefficient are stored in
an undocumented table. In the current form, only
GRBG format are converted correctly.

However, the other CFA arrangement can be transformed
in GRBG arrangement by shifting the image window one pixel
to the left or to the bottom.

Here is a patch against vanilla 3.2.17.
If such a patch can find it's way into mainline, I will
try to port it against a suitable git tree.

This was only tested with a BGGR arrangement.

Thank you,

Jean-Philippe Fran=E7ois

--14dae93406011d1ab804c08cd3cd
Content-Type: application/octet-stream; name="isppreview_bayer.patch"
Content-Disposition: attachment; filename="isppreview_bayer.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_h2hmxuyn0

SW5kZXg6IGIvZHJpdmVycy9tZWRpYS92aWRlby9vbWFwM2lzcC9pc3BwcmV2aWV3LmMKPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQotLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAzaXNwL2lzcHByZXZpZXcuYworKysg
Yi9kcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAzaXNwL2lzcHByZXZpZXcuYwpAQCAtOTYsMjEgKzk2
LDI2IEBACiAgKgkJCQkJICAyIGxpbmVzIGluIG90aGVyIG1vZGVzCiAgKiBDb2xvciBzdXBwcmVz
c2lvbgkJMiBwaXhlbHMKICAqIG9yIGx1bWEgZW5oYW5jZW1lbnQKKyAqCisgKiBCYXllciBwYXR0
ZXJuIHNoaWZ0aW5nIDIgcGl4ZWxzLCAxIGxpbmUKICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLSAqIE1heGltdW0gdG90YWwJ
CTE0IHBpeGVscywgOCBsaW5lcworICogTWF4aW11bSB0b3RhbAkJMTggcGl4ZWxzLCA5IGxpbmVz
CiAgKgogICogVGhlIGNvbG9yIHN1cHByZXNzaW9uIGFuZCBsdW1hIGVuaGFuY2VtZW50IGZpbHRl
cnMgYXJlIGFwcGxpZWQgYWZ0ZXIgYmF5ZXIgdG8KICAqIFlVViBjb252ZXJzaW9uLiBUaGV5IHRo
dXMgY2FuIGNyb3Agb25lIHBpeGVsIG9uIHRoZSBsZWZ0IGFuZCBvbmUgcGl4ZWwgb24gdGhlCiAg
KiByaWdodCBzaWRlIG9mIHRoZSBpbWFnZSB3aXRob3V0IGNoYW5naW5nIHRoZSBjb2xvciBwYXR0
ZXJuLiBXaGVuIGJvdGggdGhvc2UKICAqIGZpbHRlcnMgYXJlIGRpc2FibGVkLCB0aGUgZHJpdmVy
IG11c3QgY3JvcCB0aGUgdHdvIHBpeGVscyBvbiB0aGUgc2FtZSBzaWRlIG9mCi0gKiB0aGUgaW1h
Z2UgdG8gYXZvaWQgY2hhbmdpbmcgdGhlIGJheWVyIHBhdHRlcm4uIFRoZSBsZWZ0IG1hcmdpbiBp
cyB0aHVzIHNldCB0bwotICogOCBwaXhlbHMgYW5kIHRoZSByaWdodCBtYXJnaW4gdG8gNiBwaXhl
bHMuCisgKiB0aGUgaW1hZ2UgdG8gYXZvaWQgY2hhbmdpbmcgdGhlIGJheWVyIHBhdHRlcm4uCisg
KgorICogQmF5ZXIgcGF0dGVybiBzaGlmdGluZyBpcyBuZWVkZWQgZm9yIHNvbWUgYmF5ZXIgcGF0
dGVybi4gU2hpZnRpbmcKKyAqIHdpbGwgYmUgaW4gdGhlIHJpZ2h0IGFuZCBib3R0b20gZGlyZWN0
aW9uLgorICogVGhlIGxlZnQgbWFyZ2luIGlzIHRodXMgc2V0IHRvIDggcGl4ZWxzIGFuZCB0aGUg
cmlnaHQgbWFyZ2luIHRvIDEwIHBpeGVscy4KICAqLwogCiAjZGVmaW5lIFBSRVZfTUFSR0lOX0xF
RlQJOAotI2RlZmluZSBQUkVWX01BUkdJTl9SSUdIVAk2CisjZGVmaW5lIFBSRVZfTUFSR0lOX1JJ
R0hUCTEwCiAjZGVmaW5lIFBSRVZfTUFSR0lOX1RPUAkJNAotI2RlZmluZSBQUkVWX01BUkdJTl9C
T1RUT00JNAorI2RlZmluZSBQUkVWX01BUkdJTl9CT1RUT00JNQogCiAjZGVmaW5lIFBSRVZfTUlO
X0lOX1dJRFRICTY0CiAjZGVmaW5lIFBSRVZfTUlOX0lOX0hFSUdIVAk4CkBAIC0xMDM4LDYgKzEw
NDMsMzQgQEAKIAkJZXBoICs9IDI7CiAJCXNsdiAtPSAyOwogCQllbHYgKz0gMjsKKwkJLyogQ0ZB
IHRhYmxlIGNvZWYgb25seSBoYW5kbGUgR1JCRyBmb3JtYXQuIE90aGVyIGZvcm1hdAorCQkgKiBj
YW4gYmUgdHJhbnNmb3JtZWQgaW4gR1JCRyBieSBzaGlmdGluZyB0aGUgcGF0dGVybiA6CisJCSAq
IEJHR1IgLT4gR1JCRyBpcyBvYnRhaW5lZCBieSBhIDEgcm93IHNoaWZ0CisJCSAqIFJHR0IgLT4g
R1JCRyBpcyBvYnRhaW5lZCBieSBhIDEgY29sdW1uIHNoaWZ0CisJCSAqIEdCUkcgLT4gR1JCRyBp
cyBvYnRhaW5lZCBieSBhIHJvdyBhbmQgY29sdW1uIHNoaWZ0CisJCSAqLworCQlzd2l0Y2gocHJl
di0+Zm9ybWF0c1tQUkVWX1BBRF9TSU5LXS5jb2RlKSB7CisJCWNhc2UgVjRMMl9NQlVTX0ZNVF9T
UkdHQjEwXzFYMTA6CisJCQlzcGggKz0gMTsKKwkJCWVwaCArPSAxOworCQkJYnJlYWs7CisKKwkJ
Y2FzZSBWNEwyX01CVVNfRk1UX1NCR0dSMTBfMVgxMDoKKwkJCXNsdiArPSAxOworCQkJZWx2ICs9
IDE7CisJCQlicmVhazsKKworCQljYXNlIFY0TDJfTUJVU19GTVRfU0dCUkcxMF8xWDEwOgorCQkJ
c3BoICs9IDE7CisJCQllcGggKz0gMTsKKwkJCXNsdiArPSAxOworCQkJZWx2ICs9IDE7CisJCQli
cmVhazsKKworCQlkZWZhdWx0OgorCQkJYnJlYWs7CisJCX0KKwogCX0KIAlpZiAocGFyYW1zLT5m
ZWF0dXJlcyAmIChQUkVWX0RFRkVDVF9DT1IgfCBQUkVWX05PSVNFX0ZJTFRFUikpIHsKIAkJc3Bo
IC09IDI7Cg==
--14dae93406011d1ab804c08cd3cd--
