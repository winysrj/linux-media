Return-path: <linux-media-owner@vger.kernel.org>
Received: from bombadil.infradead.org ([198.137.202.133]:58420 "EHLO
        bombadil.infradead.org" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1751231AbeDDSy3 (ORCPT
        <rfc822;linux-media@vger.kernel.org>); Wed, 4 Apr 2018 14:54:29 -0400
Date: Wed, 4 Apr 2018 15:54:19 -0300
From: Mauro Carvalho Chehab <mchehab@kernel.org>
To: Jaak Ristioja <jaak@ristioja.ee>, Peter Geis <pgwipeout@gmail.com>
Cc: Jani Nikula <jani.nikula@linux.intel.com>,
        linux-media@vger.kernel.org, linux-input@vger.kernel.org,
        Dmitry Torokhov <dmitry.torokhov@gmail.com>,
        intel-gfx@lists.freedesktop.org
Subject: Re: Linux 4.16 Kernel Boot Crash
Message-ID: <20180404155419.0740c805@vento.lan>
References: <6a0009be-cbf8-671e-9d7d-c78340e93f58@gmail.com>
        <87in97up15.fsf@intel.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: quoted-printable
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

Em Wed, 4 Apr 2018 16:26:22 +0300
Jaak Ristioja <jaak@ristioja.ee> escreveu:

> Hello, all!
>=20
> I experience the same issue with a Lenovo ThinkPad T440p (LENOVO
> 20AN006VMS/20AN006VMS, BIOS GLET90WW (2.44 ) 09/13/2017). I tried to
> bisect v4.15..v4.16 but failed.

Could you post the complete dmesg? I also need the .config used
to build the Kernel.

=46rom its call trace:

[   43.177492] Call Trace:
[   43.177498]  ? devres_add+0x5f/0x70
[   43.177502]  rmi_f54_probe+0x437/0x470 [rmi_core]
[   43.177505]  rmi_function_probe+0x25/0x30 [rmi_core]
[   43.177507]  driver_probe_device+0x310/0x480

It looks that this was generated by an input driver=20
drivers/input/rmi4/rmi_f54.c, with could be doing something wrong when
registering at the media core.

=46rom the logs, the warn on is happening at=20
drivers/media/v4l2-core/v4l2-dev.c:945, e. g:

        /* Should not happen since we thought this minor was free */
        WARN_ON(video_device[vdev->minor] !=3D NULL);

That was probably called here:

	drivers/input/rmi4/rmi_f54.c:   ret =3D video_register_device(&f54->vdev, =
VFL_TYPE_TOUCH, -1);

Thanks,
Mauro
