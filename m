Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-ey0-f174.google.com ([209.85.215.174]:34709 "EHLO
	mail-ey0-f174.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752745Ab1LQBl2 (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Fri, 16 Dec 2011 20:41:28 -0500
Received: by eaaj10 with SMTP id j10so3374307eaa.19
        for <linux-media@vger.kernel.org>; Fri, 16 Dec 2011 17:41:26 -0800 (PST)
MIME-Version: 1.0
Date: Sat, 17 Dec 2011 02:41:26 +0100
Message-ID: <CAEN_-SB7up09S6MKeUp=ZeZx18Dvjsj7rU34PGyLmofHZXvfsg@mail.gmail.com>
Subject: cx23885: Add basic analog radio support (try 1)
From: =?ISO-8859-2?Q?Miroslav_Sluge=F2?= <thunder.mmm@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=e0cb4efe3052d6eaf404b43fd0f4
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--e0cb4efe3052d6eaf404b43fd0f4
Content-Type: text/plain; charset=ISO-8859-1

Basic implemenetation of radio support, also working support for
DVR3200H tuners (xc2028 and xc4000).

Fixed issue with wrong radio_type on line 566, try 1.

--e0cb4efe3052d6eaf404b43fd0f4
Content-Type: text/x-patch; charset=US-ASCII;
	name="0001-Add-support-for-radio-tuners-to-cx23885-driver-and-a.patch"
Content-Disposition: attachment;
	filename="0001-Add-support-for-radio-tuners-to-cx23885-driver-and-a.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gw9yldyf0

RnJvbSBmMmNkMzYxNjEzNTI2ZDNmYjQwMGJlY2Y4ZDY2MTg3NDVmNDRlNTlkIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBNaXJvc2xhdiA8dGh1bmRlci5tQGVtYWlsLmN6PgpEYXRlOiBT
YXQsIDE3IERlYyAyMDExIDAxOjIzOjIyICswMTAwClN1YmplY3Q6IFtQQVRDSF0gQWRkIHN1cHBv
cnQgZm9yIHJhZGlvIHR1bmVycyB0byBjeDIzODg1IGRyaXZlciwgYW5kIGFkZCBleGFtcGxlIG9m
IHJhZGlvIHN1cHBvcnQKIGZvciBMZWFkdGVrIERWUjMyMDAgSCB0dW5lcnMuCgotLS0KIGRyaXZl
cnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LWNhcmRzLmMgfCAgMTYwICsrKysrKysrKysr
KysrKysrKy0KIGRyaXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LXZpZGVvLmMgfCAg
MjIyICsrKysrKysrKysrKysrKysrKysrKysrKy0tLQogZHJpdmVycy9tZWRpYS92aWRlby9jeDIz
ODg1L2N4MjM4ODUuaCAgICAgICB8ICAgMjMgKysrLQogMyBmaWxlcyBjaGFuZ2VkLCAzNzQgaW5z
ZXJ0aW9ucygrKSwgMzEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92
aWRlby9jeDIzODg1L2N4MjM4ODUtY2FyZHMuYyBiL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4
NS9jeDIzODg1LWNhcmRzLmMKaW5kZXggMTg3YzQ2Mi4uMjQwZTdkZCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9tZWRpYS92aWRlby9jeDIzODg1L2N4MjM4ODUtY2FyZHMuYworKysgYi9kcml2ZXJzL21l
ZGlhL3ZpZGVvL2N4MjM4ODUvY3gyMzg4NS1jYXJkcy5jCkBAIC0yMDUsMzUgKzIwNSw3OSBAQCBz
dHJ1Y3QgY3gyMzg4NV9ib2FyZCBjeDIzODg1X2JvYXJkc1tdID0gewogCX0sCiAJW0NYMjM4ODVf
Qk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZSMzIwMF9IXSA9IHsKIAkJLm5hbWUJCT0gIkxlYWR0
ZWsgV2luZmFzdCBQeERWUjMyMDAgSCIsCisJCS5wb3J0YQkJPSBDWDIzODg1X0FOQUxPR19WSURF
TywKKwkJLnBvcnRiCQk9IENYMjM4ODVfTVBFR19FTkNPREVSLAogCQkucG9ydGMJCT0gQ1gyMzg4
NV9NUEVHX0RWQiwKKwkJLnR1bmVyX3R5cGUJPSBUVU5FUl9YQzIwMjgsCisJCS50dW5lcl9hZGRy
CT0gMHg2MSwKKwkJLnJhZGlvX3R5cGUJPSBVTlNFVCwKKwkJLnJhZGlvX2FkZHIJPSBBRERSX1VO
U0VULAorCQkudHVuZXJfYnVzCT0gMSwKKwkJLmlucHV0CQk9IHt7CisJCQkudHlwZQk9IENYMjM4
ODVfVk1VWF9URUxFVklTSU9OLAorCQkJLnZtdXgJPSBDWDI1ODQwX1ZJTjJfQ0gxIHwKKwkJCQkg
IENYMjU4NDBfVklONV9DSDIgfAorCQkJCSAgQ1gyNTg0MF9OT05FMF9DSDMsCisJCQkuZ3BpbzAJ
PSAwLAorCQl9LCB7CisJCQkudHlwZQk9IENYMjM4ODVfVk1VWF9DT01QT1NJVEUxLAorCQkJLnZt
dXgJPSBDWDI1ODQwX0NPTVBPU0lURTEsCisJCQkuZ3BpbzAJPSAwLAorCQl9LCB7CisJCQkudHlw
ZQk9IENYMjM4ODVfVk1VWF9TVklERU8sCisJCQkudm11eAk9IENYMjU4NDBfU1ZJREVPX0xVTUEz
IHwKKwkJCQkgIENYMjU4NDBfU1ZJREVPX0NIUk9NQTQsCisJCQkuZ3BpbzAJPSAwLAorCQl9LCB7
CisJCQkudHlwZQk9IENYMjM4ODVfVk1VWF9DT01QT05FTlQsCisJCQkudm11eAk9IENYMjU4NDBf
VklON19DSDEgfAorCQkJCSAgQ1gyNTg0MF9WSU42X0NIMiB8CisJCQkJICBDWDI1ODQwX1ZJTjhf
Q0gzIHwKKwkJCQkgIENYMjU4NDBfQ09NUE9ORU5UX09OLAorCQkJLmdwaW8wCT0gMCwKKwkJfSB9
LAorCQkucmFkaW8gPSB7CisJCQkudHlwZQk9IENYMjM4ODVfUkFESU8sCisJCQkuZ3BpbzAJPSAw
LAorCQl9LAogCX0sCiAJW0NYMjM4ODVfQk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZSMzIwMF9I
X1hDNDAwMF0gPSB7CiAJCS5uYW1lCQk9ICJMZWFkdGVrIFdpbmZhc3QgUHhEVlIzMjAwIEggWEM0
MDAwIiwKIAkJLnBvcnRhCQk9IENYMjM4ODVfQU5BTE9HX1ZJREVPLAorCQkucG9ydGIJCT0gQ1gy
Mzg4NV9NUEVHX0VOQ09ERVIsCiAJCS5wb3J0YwkJPSBDWDIzODg1X01QRUdfRFZCLAogCQkudHVu
ZXJfdHlwZQk9IFRVTkVSX1hDNDAwMCwKIAkJLnR1bmVyX2FkZHIJPSAweDYxLAogCQkucmFkaW9f
dHlwZQk9IFVOU0VULAogCQkucmFkaW9fYWRkcgk9IEFERFJfVU5TRVQsCisJCS50dW5lcl9idXMJ
PSAxLAogCQkuaW5wdXQJCT0ge3sKIAkJCS50eXBlCT0gQ1gyMzg4NV9WTVVYX1RFTEVWSVNJT04s
CiAJCQkudm11eAk9IENYMjU4NDBfVklOMl9DSDEgfAogCQkJCSAgQ1gyNTg0MF9WSU41X0NIMiB8
CiAJCQkJICBDWDI1ODQwX05PTkUwX0NIMywKKwkJCS5ncGlvMAk9IDAsCiAJCX0sIHsKIAkJCS50
eXBlCT0gQ1gyMzg4NV9WTVVYX0NPTVBPU0lURTEsCiAJCQkudm11eAk9IENYMjU4NDBfQ09NUE9T
SVRFMSwKKwkJCS5ncGlvMAk9IDAsCiAJCX0sIHsKIAkJCS50eXBlCT0gQ1gyMzg4NV9WTVVYX1NW
SURFTywKIAkJCS52bXV4CT0gQ1gyNTg0MF9TVklERU9fTFVNQTMgfAogCQkJCSAgQ1gyNTg0MF9T
VklERU9fQ0hST01BNCwKKwkJCS5ncGlvMAk9IDAsCiAJCX0sIHsKIAkJCS50eXBlCT0gQ1gyMzg4
NV9WTVVYX0NPTVBPTkVOVCwKIAkJCS52bXV4CT0gQ1gyNTg0MF9WSU43X0NIMSB8CiAJCQkJICBD
WDI1ODQwX1ZJTjZfQ0gyIHwKIAkJCQkgIENYMjU4NDBfVklOOF9DSDMgfAogCQkJCSAgQ1gyNTg0
MF9DT01QT05FTlRfT04sCisJCQkuZ3BpbzAJPSAwLAogCQl9IH0sCisJCS5yYWRpbyA9IHsKKwkJ
CS50eXBlCT0gQ1gyMzg4NV9SQURJTywKKwkJCS5ncGlvMAk9IDAsCisJCX0sCiAJfSwKIAlbQ1gy
Mzg4NV9CT0FSRF9DT01QUk9fVklERU9NQVRFX0U2NTBGXSA9IHsKIAkJLm5hbWUJCT0gIkNvbXBy
byBWaWRlb01hdGUgRTY1MEYiLApAQCAtODE4LDI3ICs4NjIsOTUgQEAgc3RhdGljIHZvaWQgaGF1
cHBhdWdlX2VlcHJvbShzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiwgdTggKmVlcHJvbV9kYXRhKQog
CQkJZGV2LT5uYW1lLCB0di5tb2RlbCk7CiB9CiAKK3N0YXRpYyBpbnQgY3gyMzg4NV94YzIwMjhf
bGVhZHRla19jYWxsYmFjayhzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiwKKwkJCQkJICAgaW50IGNv
bW1hbmQsIGludCBhcmcpCit7CisJc3dpdGNoIChjb21tYW5kKSB7CisJY2FzZSBYQzIwMjhfVFVO
RVJfUkVTRVQ6CisJCS8qIEdQSU8gMTIgKHhjMjAyOCB0dW5lciByZXNldCkgKi8KKwkJY3hfc2V0
KEdQMF9JTywgMHgwMDA0MDAwMCk7CisJCW1kZWxheSg1MCk7CisJCWN4X2NsZWFyKEdQMF9JTywg
MHgwMDAwMDAwNCk7CisJCW1kZWxheSg3NSk7CisJCWN4X3NldChHUDBfSU8sIDB4MDAwNDAwMDQp
OworCQltZGVsYXkoNzUpOworCQlyZXR1cm4gMDsKKwljYXNlIFhDMjAyOF9SRVNFVF9DTEs6CisJ
Y2FzZSBYQzIwMjhfSTJDX0ZMVVNIOgorCQlicmVhazsKKwl9CisJcmV0dXJuIC1FSU5WQUw7Cit9
CisKK3N0YXRpYyBpbnQgY3gyMzg4NV94YzQwMDBfbGVhZHRla19jYWxsYmFjayhzdHJ1Y3QgY3gy
Mzg4NV9kZXYgKmRldiwKKwkJCQkJICAgaW50IGNvbW1hbmQsIGludCBhcmcpCit7CisJc3dpdGNo
IChjb21tYW5kKSB7CisJY2FzZSBYQzQwMDBfVFVORVJfUkVTRVQ6CisJCS8qIEdQSU8gMTIgKHhj
NDAwMCB0dW5lciByZXNldCkgKi8KKwkJY3hfc2V0KEdQMF9JTywgMHgwMDA0MDAwMCk7CisJCW1k
ZWxheSg1MCk7CisJCWN4X2NsZWFyKEdQMF9JTywgMHgwMDAwMDAwNCk7CisJCW1kZWxheSg3NSk7
CisJCWN4X3NldChHUDBfSU8sIDB4MDAwNDAwMDQpOworCQltZGVsYXkoNzUpOworCQlyZXR1cm4g
MDsKKwl9CisJcmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgY3gyMzg4NV94YzIwMjhf
dHVuZXJfY2FsbGJhY2soc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYsCisJCQkJCSBpbnQgY29tbWFu
ZCwgaW50IGFyZykKK3sKKwkvKiBCb2FyZC1zcGVjaWZpYyBjYWxsYmFja3MgKi8KKwlzd2l0Y2gg
KGRldi0+Ym9hcmQpIHsKKwljYXNlIENYMjM4ODVfQk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZS
MzIwMF9IOgorCQlyZXR1cm4gY3gyMzg4NV94YzIwMjhfbGVhZHRla19jYWxsYmFjayhkZXYsIGNv
bW1hbmQsIGFyZyk7CisJfQorCisJcmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgY3gy
Mzg4NV94YzQwMDBfdHVuZXJfY2FsbGJhY2soc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYsCisJCQkJ
CSBpbnQgY29tbWFuZCwgaW50IGFyZykKK3sKKwkvKiBCb2FyZC1zcGVjaWZpYyBjYWxsYmFja3Mg
Ki8KKwlzd2l0Y2ggKGRldi0+Ym9hcmQpIHsKKwljYXNlIENYMjM4ODVfQk9BUkRfTEVBRFRFS19X
SU5GQVNUX1BYRFZSMzIwMF9IX1hDNDAwMDoKKwkJcmV0dXJuIGN4MjM4ODVfeGM0MDAwX2xlYWR0
ZWtfY2FsbGJhY2soZGV2LCBjb21tYW5kLCBhcmcpOworCX0KKworCXJldHVybiAtRUlOVkFMOwor
fQorCiBpbnQgY3gyMzg4NV90dW5lcl9jYWxsYmFjayh2b2lkICpwcml2LCBpbnQgY29tcG9uZW50
LCBpbnQgY29tbWFuZCwgaW50IGFyZykKIHsKIAlzdHJ1Y3QgY3gyMzg4NV90c3BvcnQgKnBvcnQg
PSBwcml2OwotCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gcG9ydC0+ZGV2OworCXN0cnVjdCBj
eDIzODg1X2RldiAqZGV2OwogCXUzMiBiaXRtYXNrID0gMDsKIAotCWlmIChjb21tYW5kID09IFhD
MjAyOF9SRVNFVF9DTEspCi0JCXJldHVybiAwOworCWlmICghcG9ydCkgeworCQlwcmludGsoS0VS
Tl9FUlIgImN4MjM4ODU6IEVycm9yIC0gcHJpdmF0ZSBkYXRhIHVuZGVmaW5lZC5cbiIpOworCQly
ZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlkZXYgPSBwb3J0LT5kZXY7CiAKLQlpZiAoY29tbWFuZCAh
PSAwKSB7Ci0JCXByaW50ayhLRVJOX0VSUiAiJXMoKTogVW5rbm93biBjb21tYW5kIDB4JXguXG4i
LAotCQkJX19mdW5jX18sIGNvbW1hbmQpOworCWlmICghZGV2KSB7CisJCXByaW50ayhLRVJOX0VS
UiAiY3gyMzg4NTogRXJyb3IgLSBkZXZpY2Ugc3RydWN0IHVuZGVmaW5lZC5cbiIpOwogCQlyZXR1
cm4gLUVJTlZBTDsKIAl9CiAKIAlzd2l0Y2ggKGRldi0+Ym9hcmQpIHsKKwljYXNlIENYMjM4ODVf
Qk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZSMzIwMF9IOgorCQlwcmludGsoS0VSTl9JTkZPICIl
czogQ2FsbGluZyBYQzIwMjgvMzAyOCBjYWxsYmFja1xuIiwgZGV2LT5uYW1lKTsKKwkJcmV0dXJu
IGN4MjM4ODVfeGMyMDI4X3R1bmVyX2NhbGxiYWNrKGRldiwgY29tbWFuZCwgYXJnKTsKKwljYXNl
IENYMjM4ODVfQk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZSMzIwMF9IX1hDNDAwMDoKKwkJcHJp
bnRrKEtFUk5fSU5GTyAiJXM6IENhbGxpbmcgWEM0MDAwIGNhbGxiYWNrXG4iLCBkZXYtPm5hbWUp
OworCQlyZXR1cm4gY3gyMzg4NV94YzQwMDBfdHVuZXJfY2FsbGJhY2soZGV2LCBjb21tYW5kLCBh
cmcpOwogCWNhc2UgQ1gyMzg4NV9CT0FSRF9IQVVQUEFVR0VfSFZSMTQwMDoKIAljYXNlIENYMjM4
ODVfQk9BUkRfSEFVUFBBVUdFX0hWUjE1MDA6CiAJY2FzZSBDWDIzODg1X0JPQVJEX0hBVVBQQVVH
RV9IVlIxNTAwUToKLQljYXNlIENYMjM4ODVfQk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYRFZSMzIw
MF9IOgotCWNhc2UgQ1gyMzg4NV9CT0FSRF9MRUFEVEVLX1dJTkZBU1RfUFhEVlIzMjAwX0hfWEM0
MDAwOgogCWNhc2UgQ1gyMzg4NV9CT0FSRF9DT01QUk9fVklERU9NQVRFX0U2NTBGOgogCWNhc2Ug
Q1gyMzg4NV9CT0FSRF9DT01QUk9fVklERU9NQVRFX0U4MDA6CiAJY2FzZSBDWDIzODg1X0JPQVJE
X0xFQURURUtfV0lORkFTVF9QWFRWMTIwMDoKQEAgLTg2MSw2ICs5NzMsOSBAQCBpbnQgY3gyMzg4
NV90dW5lcl9jYWxsYmFjayh2b2lkICpwcml2LCBpbnQgY29tcG9uZW50LCBpbnQgY29tbWFuZCwg
aW50IGFyZykKIAljYXNlIENYMjM4ODVfQk9BUkRfTkVUVVBfRFVBTF9EVkJfVF9DX0NJX1JGOgog
CQlhbHRlcmFfY2lfdHVuZXJfcmVzZXQoZGV2LCBwb3J0LT5ucik7CiAJCWJyZWFrOworCWRlZmF1
bHQ6CisJCXByaW50ayhLRVJOX0VSUiAiY3gyMzg4NTogRXJyb3I6IENhbGxpbmcgY2FsbGJhY2sg
Zm9yIGNhcmQgJWRcbiIsIGRldi0+Ym9hcmQpOworCQlicmVhazsKIAl9CiAKIAlpZiAoYml0bWFz
aykgewpAQCAtODcyLDYgKzk4Nyw3IEBAIGludCBjeDIzODg1X3R1bmVyX2NhbGxiYWNrKHZvaWQg
KnByaXYsIGludCBjb21wb25lbnQsIGludCBjb21tYW5kLCBpbnQgYXJnKQogCiAJcmV0dXJuIDA7
CiB9CitFWFBPUlRfU1lNQk9MKGN4MjM4ODVfdHVuZXJfY2FsbGJhY2spOwogCiB2b2lkIGN4MjM4
ODVfZ3Bpb19zZXR1cChzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldikKIHsKQEAgLTk5OSw3ICsxMTE1
LDExIEBAIHZvaWQgY3gyMzg4NV9ncGlvX3NldHVwKHN0cnVjdCBjeDIzODg1X2RldiAqZGV2KQog
CQljeF9zZXQoR1AwX0lPLCAweDAwMGYwMDBmKTsKIAkJYnJlYWs7CiAJY2FzZSBDWDIzODg1X0JP
QVJEX0xFQURURUtfV0lORkFTVF9QWERWUjMyMDBfSDoKKwkJY3gyMzg4NV94YzIwMjhfbGVhZHRl
a19jYWxsYmFjayhkZXYsIFhDMjAyOF9UVU5FUl9SRVNFVCwgMCk7CisJCWJyZWFrOwogCWNhc2Ug
Q1gyMzg4NV9CT0FSRF9MRUFEVEVLX1dJTkZBU1RfUFhEVlIzMjAwX0hfWEM0MDAwOgorCQljeDIz
ODg1X3hjNDAwMF9sZWFkdGVrX2NhbGxiYWNrKGRldiwgWEM0MDAwX1RVTkVSX1JFU0VULCAwKTsK
KwkJYnJlYWs7CiAJY2FzZSBDWDIzODg1X0JPQVJEX0NPTVBST19WSURFT01BVEVfRTY1MEY6CiAJ
Y2FzZSBDWDIzODg1X0JPQVJEX0NPTVBST19WSURFT01BVEVfRTgwMDoKIAljYXNlIENYMjM4ODVf
Qk9BUkRfTEVBRFRFS19XSU5GQVNUX1BYVFYxMjAwOgpAQCAtMTMxMiw2ICsxNDMyLDMwIEBAIHZv
aWQgY3gyMzg4NV9pcl9wY2lfaW50X2VuYWJsZShzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldikKIAl9
CiB9CiAKK3ZvaWQgY3gyMzg4NV9zZXR1cF94YzMwMjgoc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYs
IHN0cnVjdCB4YzIwMjhfY3RybCAqY3RsKQoreworCW1lbXNldChjdGwsIDAsIHNpemVvZigqY3Rs
KSk7CisKKwljdGwtPmZuYW1lICAgPSBYQzIwMjhfREVGQVVMVF9GSVJNV0FSRTsKKwljdGwtPm1h
eF9sZW4gPSA2NDsKKworCXN3aXRjaCAoZGV2LT5ib2FyZCkgeworCWNhc2UgQ1gyMzg4NV9CT0FS
RF9MRUFEVEVLX1dJTkZBU1RfUFhUVjEyMDA6CisJCWJyZWFrOworCWNhc2UgQ1gyMzg4NV9CT0FS
RF9DT01QUk9fVklERU9NQVRFX0U2NTBGOgorCWNhc2UgQ1gyMzg4NV9CT0FSRF9DT01QUk9fVklE
RU9NQVRFX0U4MDA6CisJY2FzZSBDWDIzODg1X0JPQVJEX0xFQURURUtfV0lORkFTVF9QWERWUjMy
MDBfSDoKKwljYXNlIENYMjM4ODVfQk9BUkRfRFZJQ09fRlVTSU9OSERUVl9EVkJfVF9EVUFMX0VY
UDoKKwkJY3RsLT5kZW1vZCA9IFhDMzAyOF9GRV9aQVJMSU5LNDU2OworCQlicmVhazsKKwlkZWZh
dWx0OgorCQljdGwtPmRlbW9kID0gWEMzMDI4X0ZFX09SRU41Mzg7CisJCWN0bC0+bXRzID0gMTsK
KwkJYnJlYWs7CisJfQorfQorRVhQT1JUX1NZTUJPTF9HUEwoY3gyMzg4NV9zZXR1cF94YzMwMjgp
OworCiB2b2lkIGN4MjM4ODVfY2FyZF9zZXR1cChzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldikKIHsK
IAlzdHJ1Y3QgY3gyMzg4NV90c3BvcnQgKnRzMSA9ICZkZXYtPnRzMTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LXZpZGVvLmMgYi9kcml2ZXJzL21lZGlh
L3ZpZGVvL2N4MjM4ODUvY3gyMzg4NS12aWRlby5jCmluZGV4IGU3MzBiOTIuLjlhOGZhYjEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LXZpZGVvLmMKKysr
IGIvZHJpdmVycy9tZWRpYS92aWRlby9jeDIzODg1L2N4MjM4ODUtdmlkZW8uYwpAQCAtMzYsNiAr
MzYsNyBAQAogI2luY2x1ZGUgPG1lZGlhL3Y0bDItaW9jdGwuaD4KICNpbmNsdWRlICJjeDIzODg1
LWlvY3RsLmgiCiAjaW5jbHVkZSAidHVuZXIteGMyMDI4LmgiCisjaW5jbHVkZSAieGM0MDAwLmgi
CiAKICNpbmNsdWRlIDxtZWRpYS9jeDI1ODQwLmg+CiAKQEAgLTUwMSw3ICs1MDIsNiBAQCBzdGF0
aWMgaW50IGN4MjM4ODVfdmlkZW9fbXV4KHN0cnVjdCBjeDIzODg1X2RldiAqZGV2LCB1bnNpZ25l
ZCBpbnQgaW5wdXQpCiAJLyogVGVsbCB0aGUgaW50ZXJuYWwgQS9WIGRlY29kZXIgKi8KIAl2NGwy
X3N1YmRldl9jYWxsKGRldi0+c2RfY3gyNTg0MCwgdmlkZW8sIHNfcm91dGluZywKIAkJCUlOUFVU
KGlucHV0KS0+dm11eCwgMCwgMCk7Ci0KIAlpZiAoKGRldi0+Ym9hcmQgPT0gQ1gyMzg4NV9CT0FS
RF9IQVVQUEFVR0VfSFZSMTgwMCkgfHwKIAkJKGRldi0+Ym9hcmQgPT0gQ1gyMzg4NV9CT0FSRF9N
UFg4ODUpKSB7CiAJCS8qIENvbmZpZ3VyZSBhdWRpbyByb3V0aW5nICovCkBAIC04NzEsMjAgKzg3
MSwzNyBAQCBzdGF0aWMgaW50IHZpZGVvX29wZW4oc3RydWN0IGZpbGUgKmZpbGUpCiAJZmgtPmhl
aWdodCAgID0gMjQwOwogCWZoLT5mbXQgICAgICA9IGZvcm1hdF9ieV9mb3VyY2MoVjRMMl9QSVhf
Rk1UX1lVWVYpOwogCisJbXV0ZXhfbG9jaygmZGV2LT5sb2NrKTsKKwogCXZpZGVvYnVmX3F1ZXVl
X3NnX2luaXQoJmZoLT52aWRxLCAmY3gyMzg4NV92aWRlb19xb3BzLAogCQkJICAgICZkZXYtPnBj
aS0+ZGV2LCAmZGV2LT5zbG9jaywKIAkJCSAgICBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUs
CiAJCQkgICAgVjRMMl9GSUVMRF9JTlRFUkxBQ0VELAogCQkJICAgIHNpemVvZihzdHJ1Y3QgY3gy
Mzg4NV9idWZmZXIpLAogCQkJICAgIGZoLCBOVUxMKTsKLQogCXZpZGVvYnVmX3F1ZXVlX3NnX2lu
aXQoJmZoLT52YmlxLCAmY3gyMzg4NV92YmlfcW9wcywKLQkJJmRldi0+cGNpLT5kZXYsICZkZXYt
PnNsb2NrLAotCQlWNEwyX0JVRl9UWVBFX1ZCSV9DQVBUVVJFLAotCQlWNEwyX0ZJRUxEX1NFUV9U
QiwKLQkJc2l6ZW9mKHN0cnVjdCBjeDIzODg1X2J1ZmZlciksCi0JCWZoLCBOVUxMKTsKKwkJCSAg
ICAmZGV2LT5wY2ktPmRldiwgJmRldi0+c2xvY2ssCisJCQkgICAgVjRMMl9CVUZfVFlQRV9WQklf
Q0FQVFVSRSwKKwkJCSAgICBWNEwyX0ZJRUxEX1NFUV9UQiwKKwkJCSAgICBzaXplb2Yoc3RydWN0
IGN4MjM4ODVfYnVmZmVyKSwKKwkJCSAgICBmaCwgTlVMTCk7CiAKKwlpZiAoZmgtPnJhZGlvKSB7
CisJCWRwcmludGsoMSwidmlkZW9fb3Blbjogc2V0dGluZyByYWRpbyBkZXZpY2VcbiIpOworCQlj
eF93cml0ZShHUElPXzMsIGN4MjM4ODVfYm9hcmRzW2Rldi0+Ym9hcmRdLnJhZGlvLmdwaW8zKTsK
KwkJY3hfd3JpdGUoR1BJT18wLCBjeDIzODg1X2JvYXJkc1tkZXYtPmJvYXJkXS5yYWRpby5ncGlv
MCk7CisJCWN4X3dyaXRlKEdQSU9fMSwgY3gyMzg4NV9ib2FyZHNbZGV2LT5ib2FyZF0ucmFkaW8u
Z3BpbzEpOworCQljeF93cml0ZShHUElPXzIsIGN4MjM4ODVfYm9hcmRzW2Rldi0+Ym9hcmRdLnJh
ZGlvLmdwaW8yKTsKKwkJaWYgKGN4MjM4ODVfYm9hcmRzW2Rldi0+Ym9hcmRdLnJhZGlvLmFtdXgp
IHsKKwkJCS8qIHN3aXRjaCBhdWRpbyBpbnB1dCBhbmQgc2V0IHR2YXVkaW8gaGVyZSAqLworCQl9
IGVsc2UgeworCQkJLyogc2V0IHR2YXVkaW8gaGVyZSAqLworCQl9CisJCWNhbGxfYWxsKGRldiwg
dHVuZXIsIHNfcmFkaW8pOworCX0KKworCWRldi0+dXNlcnMrKzsKKwltdXRleF91bmxvY2soJmRl
di0+bG9jayk7CiAKIAlkcHJpbnRrKDEsICJwb3N0IHZpZGVvYnVmX3F1ZXVlX2luaXQoKVxuIik7
CiAKQEAgLTk4MSwxMyArOTk4LDI0IEBAIHN0YXRpYyBpbnQgdmlkZW9fcmVsZWFzZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSkKIAl9CiAKIAl2aWRlb2J1Zl9tbWFwX2ZyZWUoJmZoLT52aWRxKTsKKwl2aWRl
b2J1Zl9tbWFwX2ZyZWUoJmZoLT52YmlxKTsKKworCW11dGV4X2xvY2soJmRldi0+bG9jayk7CiAJ
ZmlsZS0+cHJpdmF0ZV9kYXRhID0gTlVMTDsKIAlrZnJlZShmaCk7CiAKKwlkZXYtPnVzZXJzLS07
CisKIAkvKiBXZSBhcmUgbm90IHB1dHRpbmcgdGhlIHR1bmVyIHRvIHNsZWVwIGhlcmUgb24gZXhp
dCwgYmVjYXVzZQogCSAqIHdlIHdhbnQgdG8gdXNlIHRoZSBtcGVnIGVuY29kZXIgaW4gYW5vdGhl
ciBzZXNzaW9uIHRvIGNhcHR1cmUKIAkgKiB0dW5lciB2aWRlby4gQ2xvc2luZyB0aGlzIHdpbGwg
cmVzdWx0IGluIG5vIHZpZGVvIHRvIHRoZSBlbmNvZGVyLgogCSAqLworI2lmIDAKKwlpZiAoIWRl
di0+dXNlcnMpCisJCWNhbGxfYWxsKGRldiwgY29yZSwgc19wb3dlciwgMCk7CisjZW5kaWYKKwor
CW11dGV4X3VubG9jaygmZGV2LT5sb2NrKTsKIAogCXJldHVybiAwOwogfQpAQCAtMTI1NSwxNyAr
MTI4MywxMyBAQCBzdGF0aWMgaW50IGN4MjM4ODVfZW51bV9pbnB1dChzdHJ1Y3QgY3gyMzg4NV9k
ZXYgKmRldiwgc3RydWN0IHY0bDJfaW5wdXQgKmkpCiAJCVtDWDIzODg1X1ZNVVhfRFZCXSAgICAg
ICAgPSAiRFZCIiwKIAkJW0NYMjM4ODVfVk1VWF9ERUJVR10gICAgICA9ICJmb3IgZGVidWcgb25s
eSIsCiAJfTsKLQl1bnNpZ25lZCBpbnQgbjsKKwl1bnNpZ25lZCBpbnQgbiA9IGktPmluZGV4Owog
CWRwcmludGsoMSwgIiVzKClcbiIsIF9fZnVuY19fKTsKIAotCW4gPSBpLT5pbmRleDsKIAlpZiAo
biA+PSBNQVhfQ1gyMzg4NV9JTlBVVCkKIAkJcmV0dXJuIC1FSU5WQUw7Ci0KIAlpZiAoMCA9PSBJ
TlBVVChuKS0+dHlwZSkKIAkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlpLT5pbmRleCA9IG47CiAJaS0+
dHlwZSAgPSBWNEwyX0lOUFVUX1RZUEVfQ0FNRVJBOwogCXN0cmNweShpLT5uYW1lLCBpbmFtZVtJ
TlBVVChuKS0+dHlwZV0pOwogCWlmICgoQ1gyMzg4NV9WTVVYX1RFTEVWSVNJT04gPT0gSU5QVVQo
biktPnR5cGUpIHx8CkBAIC0xNTA1LDYgKzE1MjksMTA4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3Nf
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogCiAvKiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwor
LyogUkFESU8gRVNQRUNJRklDIElPQ1RMUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKi8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tICovCisKK3N0YXRpYyBpbnQgcmFkaW9fcXVlcnljYXAgKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICAqcHJpdiwKKwkJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQoreworCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ICA9ICgoc3RydWN0IGN4MjM4ODVfZmggKilw
cml2KS0+ZGV2OworCisJc3RyY3B5KGNhcC0+ZHJpdmVyLCAiY3gyMzg4NSIpOworCXN0cmxjcHko
Y2FwLT5jYXJkLCBjeDIzODg1X2JvYXJkc1tkZXYtPmJvYXJkXS5uYW1lLCBzaXplb2YoY2FwLT5j
YXJkKSk7CisJc3ByaW50ZihjYXAtPmJ1c19pbmZvLCJQQ0llOiVzIiwgcGNpX25hbWUoZGV2LT5w
Y2kpKTsKKwljYXAtPmNhcGFiaWxpdGllcyA9IFY0TDJfQ0FQX1RVTkVSOworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IHJhZGlvX2dfdHVuZXIgKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorCQkJCXN0cnVjdCB2NGwyX3R1bmVyICp0KQoreworCXN0cnVjdCBjeDIzODg1X2RldiAq
ZGV2ICA9ICgoc3RydWN0IGN4MjM4ODVfZmggKilwcml2KS0+ZGV2OworCisJaWYgKHVubGlrZWx5
KHQtPmluZGV4ID4gMCkpCisJCXJldHVybiAtRUlOVkFMOworCisJc3RyY3B5KHQtPm5hbWUsICJS
YWRpbyIpOworCXQtPnR5cGUgPSBWNEwyX1RVTkVSX1JBRElPOworCisJY2FsbF9hbGwoZGV2LCB0
dW5lciwgZ190dW5lciwgdCk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcmFkaW9fZW51
bV9pbnB1dCAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJCQkJc3RydWN0IHY0bDJf
aW5wdXQgKmkpCit7CisJaWYgKGktPmluZGV4ICE9IDApCisJCXJldHVybiAtRUlOVkFMOworCXN0
cmNweShpLT5uYW1lLCJSYWRpbyIpOworCWktPnR5cGUgPSBWNEwyX0lOUFVUX1RZUEVfVFVORVI7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByYWRpb19nX2F1ZGlvIChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYXVkaW8gKmEpCit7CisJaWYgKHVubGlr
ZWx5KGEtPmluZGV4KSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzdHJjcHkoYS0+bmFtZSwiUmFk
aW8iKTsKKwlyZXR1cm4gMDsKK30KKworLyogRklYTUU6IFNob3VsZCBhZGQgYSBzdGFuZGFyZCBm
b3IgcmFkaW8gKi8KKworc3RhdGljIGludCByYWRpb19zX3R1bmVyIChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKKwkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdCkKK3sKKwlzdHJ1Y3QgY3gy
Mzg4NV9kZXYgKmRldiAgPSAoKHN0cnVjdCBjeDIzODg1X2ZoICopcHJpdiktPmRldjsKKworCWlm
ICgwICE9IHQtPmluZGV4KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWNhbGxfYWxsKGRldiwgdHVu
ZXIsIHNfdHVuZXIsIHQpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcmFkaW9fc19h
dWRpbyAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorCQkJICBzdHJ1Y3QgdjRsMl9hdWRp
byAqYSkKK3sKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCByYWRpb19zX2lucHV0IChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpKQoreworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IHJhZGlvX3F1ZXJ5Y3RybCAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCisJCQkgICAgc3RydWN0IHY0bDJfcXVlcnljdHJsICpjKQoreworCWludCBpOworCisJ
aWYgKGMtPmlkIDwgVjRMMl9DSURfQkFTRSB8fAorCQljLT5pZCA+PSBWNEwyX0NJRF9MQVNUUDEp
CisJCXJldHVybiAtRUlOVkFMOworCWlmIChjLT5pZCA9PSBWNEwyX0NJRF9BVURJT19NVVRFIHx8
CisJCWMtPmlkID09IFY0TDJfQ0lEX0FVRElPX1ZPTFVNRSB8fAorCQljLT5pZCA9PSBWNEwyX0NJ
RF9BVURJT19CQUxBTkNFKSB7CisJCWZvciAoaSA9IDA7IGkgPCBDWDIzODg1X0NUTFM7IGkrKykg
eworCQkJaWYgKGN4MjM4ODVfY3Rsc1tpXS52LmlkID09IGMtPmlkKQorCQkJCWJyZWFrOworCQl9
CisJCWlmIChpID09IENYMjM4ODVfQ1RMUykgeworCQkJKmMgPSBub19jdGw7CisJCQlyZXR1cm4g
MDsKKwkJfQorCQkqYyA9IGN4MjM4ODVfY3Rsc1tpXS52OworCX0gZWxzZQorCQkqYyA9IG5vX2N0
bDsKKwlyZXR1cm4gMDsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KIAogc3RhdGljIHZvaWQgY3gyMzg4NV92aWRf
dGltZW91dCh1bnNpZ25lZCBsb25nIGRhdGEpCiB7CkBAIC0xNjUyLDEyICsxNzc4LDQzIEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9maWxlX29wZXJhdGlvbnMgcmFkaW9fZm9wcyA9IHsKIAku
aW9jdGwgICAgICAgICA9IHZpZGVvX2lvY3RsMiwKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
djRsMl9pb2N0bF9vcHMgcmFkaW9faW9jdGxfb3BzID0geworCS52aWRpb2NfcXVlcnljYXAgICAg
ICA9IHJhZGlvX3F1ZXJ5Y2FwLAorCS52aWRpb2NfZ190dW5lciAgICAgICA9IHJhZGlvX2dfdHVu
ZXIsCisJLnZpZGlvY19lbnVtX2lucHV0ICAgID0gcmFkaW9fZW51bV9pbnB1dCwKKwkudmlkaW9j
X2dfYXVkaW8gICAgICAgPSByYWRpb19nX2F1ZGlvLAorCS52aWRpb2Nfc190dW5lciAgICAgICA9
IHJhZGlvX3NfdHVuZXIsCisJLnZpZGlvY19zX2F1ZGlvICAgICAgID0gcmFkaW9fc19hdWRpbywK
KwkudmlkaW9jX3NfaW5wdXQgICAgICAgPSByYWRpb19zX2lucHV0LAorCS52aWRpb2NfcXVlcnlj
dHJsICAgICA9IHJhZGlvX3F1ZXJ5Y3RybCwKKwkudmlkaW9jX2dfY3RybCAgICAgICAgPSB2aWRp
b2NfZ19jdHJsLAorCS52aWRpb2Nfc19jdHJsICAgICAgICA9IHZpZGlvY19zX2N0cmwsCisJLnZp
ZGlvY19nX2ZyZXF1ZW5jeSAgID0gdmlkaW9jX2dfZnJlcXVlbmN5LAorCS52aWRpb2Nfc19mcmVx
dWVuY3kgICA9IHZpZGlvY19zX2ZyZXF1ZW5jeSwKKyNpZmRlZiBDT05GSUdfVklERU9fQURWX0RF
QlVHCisJLnZpZGlvY19nX3JlZ2lzdGVyICAgID0gY3gyMzg4NV9nX3JlZ2lzdGVyLAorCS52aWRp
b2Nfc19yZWdpc3RlciAgICA9IGN4MjM4ODVfc19yZWdpc3RlciwKKyNlbmRpZgorfTsKKworc3Rh
dGljIHN0cnVjdCB2aWRlb19kZXZpY2UgY3gyMzg4NV9yYWRpb190ZW1wbGF0ZSA9IHsKKwkubmFt
ZSAgICAgICAgICAgICAgICAgPSAiY3gyMzg4NS1yYWRpbyIsCisJLmZvcHMgICAgICAgICAgICAg
ICAgID0gJnJhZGlvX2ZvcHMsCisJLmlvY3RsX29wcyAgICAgICAgICAgID0gJnJhZGlvX2lvY3Rs
X29wcywKK307CiAKIHZvaWQgY3gyMzg4NV92aWRlb191bnJlZ2lzdGVyKHN0cnVjdCBjeDIzODg1
X2RldiAqZGV2KQogewogCWRwcmludGsoMSwgIiVzKClcbiIsIF9fZnVuY19fKTsKIAljeDIzODg1
X2lycV9yZW1vdmUoZGV2LCAweDAxKTsKIAorCWlmIChkZXYtPnJhZGlvX2RldikgeworCQlpZiAo
dmlkZW9faXNfcmVnaXN0ZXJlZChkZXYtPnJhZGlvX2RldikpCisJCQl2aWRlb191bnJlZ2lzdGVy
X2RldmljZShkZXYtPnJhZGlvX2Rldik7CisJCWVsc2UKKwkJCXZpZGVvX2RldmljZV9yZWxlYXNl
KGRldi0+cmFkaW9fZGV2KTsKKwkJZGV2LT5yYWRpb19kZXYgPSBOVUxMOworCX0KIAlpZiAoZGV2
LT52YmlfZGV2KSB7CiAJCWlmICh2aWRlb19pc19yZWdpc3RlcmVkKGRldi0+dmJpX2RldikpCiAJ
CQl2aWRlb191bnJlZ2lzdGVyX2RldmljZShkZXYtPnZiaV9kZXYpOwpAQCAtMTczMCwyMiArMTg4
NywyOCBAQCBpbnQgY3gyMzg4NV92aWRlb19yZWdpc3RlcihzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRl
dikKIAkJCXN0cnVjdCB0dW5lcl9zZXR1cCB0dW5fc2V0dXA7CiAKIAkJCW1lbXNldCgmdHVuX3Nl
dHVwLCAwLCBzaXplb2YodHVuX3NldHVwKSk7Ci0JCQl0dW5fc2V0dXAubW9kZV9tYXNrID0gVF9B
TkFMT0dfVFY7CisKKwkJCXR1bl9zZXR1cC5tb2RlX21hc2sgPSBUX0FOQUxPR19UViB8IFRfUkFE
SU87CiAJCQl0dW5fc2V0dXAudHlwZSA9IGRldi0+dHVuZXJfdHlwZTsKIAkJCXR1bl9zZXR1cC5h
ZGRyID0gdjRsMl9pMmNfc3ViZGV2X2FkZHIoc2QpOworCiAJCQl0dW5fc2V0dXAudHVuZXJfY2Fs
bGJhY2sgPSBjeDIzODg1X3R1bmVyX2NhbGxiYWNrOwogCiAJCQl2NGwyX3N1YmRldl9jYWxsKHNk
LCB0dW5lciwgc190eXBlX2FkZHIsICZ0dW5fc2V0dXApOwogCi0JCQlpZiAoZGV2LT5ib2FyZCA9
PSBDWDIzODg1X0JPQVJEX0xFQURURUtfV0lORkFTVF9QWFRWMTIwMCkgewotCQkJCXN0cnVjdCB4
YzIwMjhfY3RybCBjdHJsID0gewotCQkJCQkuZm5hbWUgPSBYQzIwMjhfREVGQVVMVF9GSVJNV0FS
RSwKLQkJCQkJLm1heF9sZW4gPSA2NAotCQkJCX07Ci0JCQkJc3RydWN0IHY0bDJfcHJpdl90dW5f
Y29uZmlnIGNmZyA9IHsKLQkJCQkJLnR1bmVyID0gZGV2LT50dW5lcl90eXBlLAotCQkJCQkucHJp
diA9ICZjdHJsCi0JCQkJfTsKKwkJCWlmIChkZXYtPnR1bmVyX3R5cGUgPT0gVFVORVJfWEMyMDI4
KSB7CisJCQkJc3RydWN0IHY0bDJfcHJpdl90dW5fY29uZmlnICBjZmc7CisJCQkJc3RydWN0IHhj
MjAyOF9jdHJsICAgICAgICAgICBjdGw7CisKKwkJCQkvKiBGaWxscyBkZXZpY2UtZGVwZW5kZW50
IGluaXRpYWxpemF0aW9uIHBhcmFtZXRlcnMgKi8KKwkJCQljeDIzODg1X3NldHVwX3hjMzAyOChk
ZXYsICZjdGwpOworCisJCQkJbWVtc2V0KCZjZmcsIDAsIHNpemVvZihjZmcpKTsKKwkJCQljZmcu
dHVuZXIgPSBUVU5FUl9YQzIwMjg7CisJCQkJY2ZnLnByaXYgID0gJmN0bDsKKworCQkJCXByaW50
ayhLRVJOX0lORk8gIiVzOiBBc2tpbmcgeGMyMDI4LzMwMjggdG8gbG9hZCBmaXJtd2FyZSAlc1xu
IiwKKwkJCQkgICAgICAgZGV2LT5uYW1lLCBjdGwuZm5hbWUpOwogCQkJCXY0bDJfc3ViZGV2X2Nh
bGwoc2QsIHR1bmVyLCBzX2NvbmZpZywgJmNmZyk7CiAJCQl9CiAJCX0KQEAgLTE3NzcsNiArMTk0
MCwyMSBAQCBpbnQgY3gyMzg4NV92aWRlb19yZWdpc3RlcihzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRl
dikKIAlwcmludGsoS0VSTl9JTkZPICIlczogcmVnaXN0ZXJlZCBkZXZpY2UgJXNcbiIsCiAJICAg
ICAgIGRldi0+bmFtZSwgdmlkZW9fZGV2aWNlX25vZGVfbmFtZShkZXYtPnZiaV9kZXYpKTsKIAor
CWlmIChjeDIzODg1X2JvYXJkc1tkZXYtPmJvYXJkXS5yYWRpby50eXBlID09IENYMjM4ODVfUkFE
SU8pIHsKKwkJZGV2LT5yYWRpb19kZXYgPSBjeDIzODg1X3ZkZXZfaW5pdChkZXYsIGRldi0+cGNp
LAorCQkJCQkJJmN4MjM4ODVfcmFkaW9fdGVtcGxhdGUsICJyYWRpbyIpOworCQl2aWRlb19zZXRf
ZHJ2ZGF0YShkZXYtPnJhZGlvX2RldiwgZGV2KTsKKwkJZXJyID0gdmlkZW9fcmVnaXN0ZXJfZGV2
aWNlKGRldi0+cmFkaW9fZGV2LCBWRkxfVFlQRV9SQURJTywKKwkJCQkJICAgIHJhZGlvX25yW2Rl
di0+bnJdKTsKKwkJaWYgKGVyciA8IDApIHsKKwkJCXByaW50ayhLRVJOX0VSUiAiJXM6IGNhbid0
IHJlZ2lzdGVyIHJhZGlvIGRldmljZVxuIiwKKwkJCSAgICAgICBkZXYtPm5hbWUpOworCQkJZ290
byBmYWlsX3VucmVnOworCQl9CisJCXByaW50ayhLRVJOX0lORk8gIiVzOiByZWdpc3RlcmVkIGRl
dmljZSAlc1xuIiwKKwkJICAgICAgIGRldi0+bmFtZSwgdmlkZW9fZGV2aWNlX25vZGVfbmFtZShk
ZXYtPnJhZGlvX2RldikpOworCX0KKwogCS8qIFJlZ2lzdGVyIEFMU0EgYXVkaW8gZGV2aWNlICov
CiAJZGV2LT5hdWRpb19kZXYgPSBjeDIzODg1X2F1ZGlvX3JlZ2lzdGVyKGRldik7CiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LmggYi9kcml2ZXJzL21l
ZGlhL3ZpZGVvL2N4MjM4ODUvY3gyMzg4NS5oCmluZGV4IGI0OTAzNmYuLjVmZTk3N2UgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vY3gyMzg4NS9jeDIzODg1LmgKKysrIGIvZHJpdmVy
cy9tZWRpYS92aWRlby9jeDIzODg1L2N4MjM4ODUuaApAQCAtMzUsNiArMzUsNyBAQAogI2luY2x1
ZGUgImJ0Y3gtcmlzYy5oIgogI2luY2x1ZGUgImN4MjM4ODUtcmVnLmgiCiAjaW5jbHVkZSAibWVk
aWEvY3gyMzQxeC5oIgorI2luY2x1ZGUgInR1bmVyLXhjMjAyOC5oIgogCiAjaW5jbHVkZSA8bGlu
dXgvbXV0ZXguaD4KIApAQCAtMjI1LDYgKzIyNiw3IEBAIHN0cnVjdCBjeDIzODg1X2JvYXJkIHsK
IAkgKi8KIAl1MzIJCQljbGtfZnJlcTsKIAlzdHJ1Y3QgY3gyMzg4NV9pbnB1dCAgICBpbnB1dFtN
QVhfQ1gyMzg4NV9JTlBVVF07CisJc3RydWN0IGN4MjM4ODVfaW5wdXQgICAgcmFkaW87CiAJaW50
CQkJY2lfdHlwZTsgLyogZm9yIE5ldFVQICovCiB9OwogCkBAIC0yMzQsNiArMjM2LDIwIEBAIHN0
cnVjdCBjeDIzODg1X3N1YmlkIHsKIAl1MzIgICAgIGNhcmQ7CiB9OwogCitlbnVtIGN4MjM4ODVf
dHZhdWRpbyB7CisJV1dfTk9ORSA9IDEsCisJV1dfQlRTQywKKwlXV19CRywKKwlXV19ESywKKwlX
V19JLAorCVdXX0wsCisJV1dfRUlBSiwKKwlXV19JMlNQVCwKKwlXV19GTSwKKwlXV19JMlNBREMs
CisJV1dfTQorfTsKKwogc3RydWN0IGN4MjM4ODVfaTJjIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYg
KmRldjsKIApAQCAtMzkzLDcgKzQwOSw3IEBAIHN0cnVjdCBjeDIzODg1X2RldiB7CiAJdTMyICAg
ICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzOwogCXVuc2lnbmVkIGludCAgICAgICAgICAg
ICAgIGlucHV0OwogCXVuc2lnbmVkIGludCAgICAgICAgICAgICAgIGF1ZGlucHV0OyAvKiBTZWxl
Y3RhYmxlIGF1ZGlvIGlucHV0ICovCi0JdTMyICAgICAgICAgICAgICAgICAgICAgICAgdHZhdWRp
bzsKKwllbnVtIGN4MjM4ODVfdHZhdWRpbyAgICAgICB0dmF1ZGlvOwogCXY0bDJfc3RkX2lkICAg
ICAgICAgICAgICAgIHR2bm9ybTsKIAl1bnNpZ25lZCBpbnQgICAgICAgICAgICAgICB0dW5lcl90
eXBlOwogCXVuc2lnbmVkIGNoYXIgICAgICAgICAgICAgIHR1bmVyX2FkZHI7CkBAIC00MTYsNiAr
NDMyLDkgQEAgc3RydWN0IGN4MjM4ODVfZGV2IHsKIAogCS8qIFY0bCAqLwogCXUzMiAgICAgICAg
ICAgICAgICAgICAgICAgIGZyZXE7CisJaW50ICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnM7
CisJaW50ICAgICAgICAgICAgICAgICAgICAgICAgbXBlZ191c2VyczsKKwogCXN0cnVjdCB2aWRl
b19kZXZpY2UgICAgICAgICp2aWRlb19kZXY7CiAJc3RydWN0IHZpZGVvX2RldmljZSAgICAgICAg
KnZiaV9kZXY7CiAJc3RydWN0IHZpZGVvX2RldmljZSAgICAgICAgKnJhZGlvX2RldjsKQEAgLTU1
NCw2ICs1NzMsOCBAQCBleHRlcm4gdm9pZCBjeDIzODg1X2dwaW9fc2V0dXAoc3RydWN0IGN4MjM4
ODVfZGV2ICpkZXYpOwogZXh0ZXJuIHZvaWQgY3gyMzg4NV9jYXJkX3NldHVwKHN0cnVjdCBjeDIz
ODg1X2RldiAqZGV2KTsKIGV4dGVybiB2b2lkIGN4MjM4ODVfY2FyZF9zZXR1cF9wcmVfaTJjKHN0
cnVjdCBjeDIzODg1X2RldiAqZGV2KTsKIAorZXh0ZXJuIHZvaWQgY3gyMzg4NV9zZXR1cF94YzMw
Mjgoc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYsIHN0cnVjdCB4YzIwMjhfY3RybCAqY3RsKTsKKwog
ZXh0ZXJuIGludCBjeDIzODg1X2R2Yl9yZWdpc3RlcihzdHJ1Y3QgY3gyMzg4NV90c3BvcnQgKnBv
cnQpOwogZXh0ZXJuIGludCBjeDIzODg1X2R2Yl91bnJlZ2lzdGVyKHN0cnVjdCBjeDIzODg1X3Rz
cG9ydCAqcG9ydCk7CiAKLS0gCjEuNy4yLjMKCg==
--e0cb4efe3052d6eaf404b43fd0f4--
