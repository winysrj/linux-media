Return-path: <linux-media-owner@vger.kernel.org>
Received: from mx2.suse.de ([195.135.220.15]:57425 "EHLO mx2.suse.de"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1752199AbcLFHMD (ORCPT <rfc822;linux-media@vger.kernel.org>);
        Tue, 6 Dec 2016 02:12:03 -0500
Date: Tue, 06 Dec 2016 08:11:59 +0100
Message-ID: <s5h4m2h5y68.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Shuah Khan" <shuahkh@osg.samsung.com>
Cc: <mchehab@kernel.org>, <geliangtang@163.com>,
        <alsa-devel@alsa-project.org>, <hans.verkuil@cisco.com>,
        <chehabrafael@gmail.com>, <mahasler@gmail.com>,
        <g.liakhovetski@gmx.de>, <laurent.pinchart@ideasonboard.com>,
        <sakari.ailus@iki.fi>, <clemens@ladisch.de>, <k@oikw.org>,
        <javier@osg.samsung.com>, <perex@perex.cz>, <vdronov@redhat.com>,
        "Oliver Neukum" <ONeukum@suse.com>, <linux-kernel@vger.kernel.org>,
        <linux-media@vger.kernel.org>, <daniel@zonque.org>
Subject: Re: [PATCH v6 3/3] sound/usb: Use Media Controller API to share media resources
In-Reply-To: <69ad05a8-8572-43e7-ef76-7510edd904c6@osg.samsung.com>
References: <cover.1480539942.git.shuahkh@osg.samsung.com>
        <ebeaa42019b102f76d87a2fc4aa7793e1f87072c.1480539942.git.shuahkh@osg.samsung.com>
        <69ad05a8-8572-43e7-ef76-7510edd904c6@osg.samsung.com>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

On Mon, 05 Dec 2016 23:44:30 +0100,
Shuah Khan wrote:
> 
> On 11/30/2016 03:01 PM, Shuah Khan wrote:
> > Change ALSA driver to use Media Controller API to share media resources
> > with DVB, and V4L2 drivers on a AU0828 media device.
> > 
> > Media Controller specific initialization is done after sound card is
> > registered. ALSA creates Media interface and entity function graph
> > nodes for Control, Mixer, PCM Playback, and PCM Capture devices.
> > 
> > snd_usb_hw_params() will call Media Controller enable source handler
> > interface to request the media resource. If resource request is granted,
> > it will release it from snd_usb_hw_free(). If resource is busy, -EBUSY is
> > returned.
> > 
> > Media specific cleanup is done in usb_audio_disconnect().
> > 
> > Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>
> 
> Hi Takashi,
> 
> If you are good with this patch, could you please Ack it, so Mauro
> can pull it into media tree with the other two patches in this series,
> when he is ready to do so.

Sorry for the late review.

The biggest concern right now is the way the driver is probed.  As
mentioned in the review reply, we need to consider the cases where the
probe is called multiple times.  Other things are minor.


thanks,

Takashi
