Return-path: <linux-media-owner@vger.kernel.org>
Received: from cantor2.suse.de ([195.135.220.15]:48224 "EHLO mx2.suse.de"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1751906AbaJPOBR (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Thu, 16 Oct 2014 10:01:17 -0400
Date: Thu, 16 Oct 2014 16:01:16 +0200
Message-ID: <s5h38aow1ub.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Shuah Khan <shuahkh@osg.samsung.com>
Cc: Lars-Peter Clausen <lars@metafoo.de>, m.chehab@samsung.com,
	akpm@linux-foundation.org, gregkh@linuxfoundation.org,
	crope@iki.fi, olebowle@gmx.com, dheitmueller@kernellabs.com,
	hverkuil@xs4all.nl, ramakrmu@cisco.com,
	sakari.ailus@linux.intel.com, laurent.pinchart@ideasonboard.com,
	perex@perex.cz, prabhakar.csengg@gmail.com,
	tim.gardner@canonical.com, linux@eikelenboom.it,
	linux-kernel@vger.kernel.org, alsa-devel@alsa-project.org,
	linux-media@vger.kernel.org
Subject: Re: [alsa-devel] [PATCH v2 5/6] sound/usb: pcm changes to use media token api
In-Reply-To: <543FC3CD.8050805@osg.samsung.com>
References: <cover.1413246370.git.shuahkh@osg.samsung.com>
	<cf1059cc2606f20d921e5691e3d59945a19a7871.1413246372.git.shuahkh@osg.samsung.com>
	<543FB374.8020604@metafoo.de>
	<543FC3CD.8050805@osg.samsung.com>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

At Thu, 16 Oct 2014 07:10:37 -0600,
Shuah Khan wrote:
> 
> On 10/16/2014 06:00 AM, Lars-Peter Clausen wrote:
> > On 10/14/2014 04:58 PM, Shuah Khan wrote:
> > [...]
> >>       switch (cmd) {
> >>       case SNDRV_PCM_TRIGGER_START:
> >> +        err = media_get_audio_tkn(&subs->dev->dev);
> >> +        if (err == -EBUSY) {
> >> +            dev_info(&subs->dev->dev, "%s device is busy\n",
> >> +                    __func__);
> > 
> > In my opinion this should not dev_info() as this is out of band error
> > signaling and also as the potential to spam the log. The userspace
> > application is already properly notified by the return code.
> > 
> 
> Yes it has the potential to flood the dmesg especially with alsa,
> I will remove the dev_info().

Yes.  And, I think doing this in the trigger isn't the best.
Why not in open & close?

Also, is this token restriction needed only for PCM?  No mixer or
other controls?


Takashi
