Return-path: <linux-media-owner@vger.kernel.org>
Received: from rv-out-0506.google.com ([209.85.198.235]:6135 "EHLO
	rv-out-0506.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1754294AbZCQPzI (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Tue, 17 Mar 2009 11:55:08 -0400
Received: by rv-out-0506.google.com with SMTP id g37so60382rvb.1
        for <linux-media@vger.kernel.org>; Tue, 17 Mar 2009 08:55:06 -0700 (PDT)
MIME-Version: 1.0
Date: Tue, 17 Mar 2009 23:55:05 +0800
Message-ID: <15ed362e0903170855k2ec1e5afm613de692c237e34d@mail.gmail.com>
Subject: [PATCH] Support for Legend Silicon LGS8913/LGS8GL5/LGS8GXX China
	DMB-TH digital demodulator
From: David Wong <davidtlwong@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=000e0cd17cc03d84b00465529717
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--000e0cd17cc03d84b00465529717
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

This patch contains the unified driver for Legend Silicon LGS8913 and
LGS8GL5. It should replace lgs8gl5.c in media/dvb/frontends

David T.L. Wong

--000e0cd17cc03d84b00465529717
Content-Type: text/x-patch; charset=US-ASCII; name="lgs8gxx.patch"
Content-Disposition: attachment; filename="lgs8gxx.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_fsergnle0

ZGlmZiAtciA2MjZjMTM2ZWMyMjEgbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL0tj
b25maWcKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL0tjb25maWcJRnJp
IE1hciAxMyAxNDozNToxNCAyMDA5IC0wNzAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZi
L2Zyb250ZW5kcy9LY29uZmlnCVR1ZSBNYXIgMTcgMjM6MDc6NTcgMjAwOSArMDgwMApAQCAtNTEz
LDYgKzUxMywxMyBAQAogCWhlbHAKIAkgIEEgRE1CLVRIIHR1bmVyIG1vZHVsZS4gU2F5IFkgd2hl
biB5b3Ugd2FudCB0byBzdXBwb3J0IHRoaXMgZnJvbnRlbmQuCiAKK2NvbmZpZyBEVkJfTEdTOEdY
WAorCXRyaXN0YXRlICJMZWdlbmQgU2lsaWNvbiBMR1M4OTEzL0xHUzhHTDUvTEdTOEdYWCBETUIt
VEggZGVtb2R1bGF0b3IiCisJZGVwZW5kcyBvbiBEVkJfQ09SRSAmJiBJMkMKKwlkZWZhdWx0IG0g
aWYgRFZCX0ZFX0NVU1RPTUlTRQorCWhlbHAKKwkgIEEgRE1CLVRIIHR1bmVyIG1vZHVsZS4gU2F5
IFkgd2hlbiB5b3Ugd2FudCB0byBzdXBwb3J0IHRoaXMgZnJvbnRlbmQuCisKIGNvbW1lbnQgIlRv
b2xzIHRvIGRldmVsb3AgbmV3IGZyb250ZW5kcyIKIAogY29uZmlnIERWQl9EVU1NWV9GRQpkaWZm
IC1yIDYyNmMxMzZlYzIyMSBsaW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvTWFrZWZp
bGUKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL01ha2VmaWxlCUZyaSBN
YXIgMTMgMTQ6MzU6MTQgMjAwOSAtMDcwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9m
cm9udGVuZHMvTWFrZWZpbGUJVHVlIE1hciAxNyAyMzowNzo1NyAyMDA5ICswODAwCkBAIC02MCw2
ICs2MCw3IEBACiBvYmotJChDT05GSUdfRFZCX1RVTkVSX0NYMjQxMTMpICs9IGN4MjQxMTMubwog
b2JqLSQoQ09ORklHX0RWQl9TNUgxNDExKSArPSBzNWgxNDExLm8KIG9iai0kKENPTkZJR19EVkJf
TEdTOEdMNSkgKz0gbGdzOGdsNS5vCitvYmotJChDT05GSUdfRFZCX0xHUzhHWFgpICs9IGxnczhn
eHgubwogb2JqLSQoQ09ORklHX0RWQl9EVU1NWV9GRSkgKz0gZHZiX2R1bW15X2ZlLm8KIG9iai0k
KENPTkZJR19EVkJfQUY5MDEzKSArPSBhZjkwMTMubwogb2JqLSQoQ09ORklHX0RWQl9DWDI0MTE2
KSArPSBjeDI0MTE2Lm8KZGlmZiAtciA2MjZjMTM2ZWMyMjEgbGludXgvZHJpdmVycy9tZWRpYS9k
dmIvZnJvbnRlbmRzL2xnczhneHguYwotLS0gL2Rldi9udWxsCVRodSBKYW4gMDEgMDA6MDA6MDAg
MTk3MCArMDAwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4
eC5jCVR1ZSBNYXIgMTcgMjM6MDc6NTcgMjAwOSArMDgwMApAQCAtMCwwICsxLDkwNyBAQAorLyoK
KyAqICAgIFN1cHBvcnQgZm9yIExlZ2VuZCBTaWxpY29uIERNQi1USCBkZW1vZHVsYXRvcgorICog
ICAgTEdTODkxMywgTEdTOEdMNQorICogICAgZXhwZXJpbWVudGFsIHN1cHBvcnQgTEdTOEc0Miwg
TEdTOEc1MgorICoKKyAqICAgIENvcHlyaWdodCAoQykgMjAwNywyMDA4IERhdmlkIFQuTC4gV29u
ZyA8ZGF2aWR0bHdvbmdAZ21haWwuY29tPgorICogICAgQ29weXJpZ2h0IChDKSAyMDA4IFNpcml1
cyBJbnRlcm5hdGlvbmFsIChIb25nIEtvbmcpIExpbWl0ZWQKKyAqICAgIFRpbW90aHkgTGVlIDx0
aW1vdGh5LmxlZUBzaXJpdXNoay5jb20+IChmb3IgaW5pdGlhbCB3b3JrIG9uIExHUzhHTDUpCisg
KgorICogICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmli
dXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAgICB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgor
ICogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiAgICBUaGlz
IHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1
bCwKKyAqICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBs
aWVkIHdhcnJhbnR5IG9mCisgKiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQ
QVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZl
ZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgICBhbG9uZyB3
aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQorICog
ICAgRm91bmRhdGlvbiwgSW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAyMTM5LCBV
U0EuCisgKgorICovCisKKyNpbmNsdWRlIDxhc20vZGl2NjQuaD4KKworI2luY2x1ZGUgImR2Yl9m
cm9udGVuZC5oIgorCisjaW5jbHVkZSAibGdzOGd4eC5oIgorI2luY2x1ZGUgImxnczhneHhfcHJp
di5oIgorCisjZGVmaW5lIGRwcmludGsoYXJncy4uLikgXAorCWRvIHsgXAorCQlpZiAoZGVidWcp
IFwKKwkJCXByaW50ayhLRVJOX0RFQlVHICJsZ3M4Z3h4OiAiIGFyZ3MpOyBcCisJfSB3aGlsZSAo
MCkKKworI3VuZGVmIFVTRV9GQUtFX1NJR05BTF9TVFJFTkdUSAorCitzdGF0aWMgdm9pZCBsZ3M4
Z3h4X2F1dG9fbG9jayhzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdik7CisKK3N0YXRpYyBpbnQg
ZGVidWcgPSAwOworCittb2R1bGVfcGFyYW0oZGVidWcsIGludCwgMDY0NCk7CitNT0RVTEVfUEFS
TV9ERVNDKGRlYnVnLCAiVHVybiBvbi9vZmYgZnJvbnRlbmQgZGVidWdnaW5nIChkZWZhdWx0Om9m
ZikuIik7CisKKy8qIExHUzhHWFggaW50ZXJuYWwgaGVscGVyIGZ1bmN0aW9ucyAqLworCitzdGF0
aWMgaW50IGxnczhneHhfd3JpdGVfcmVnKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1OCBy
ZWcsIHU4IGRhdGEpCit7CisJaW50IHJldDsKKwl1OCBidWZbXSA9IHsgcmVnLCBkYXRhIH07CisJ
c3RydWN0IGkyY19tc2cgbXNnID0geyAuZmxhZ3MgPSAwLCAuYnVmID0gYnVmLCAubGVuID0gMiB9
OworCisJbXNnLmFkZHIgPSBwcml2LT5jb25maWctPmRlbW9kX2FkZHJlc3M7CisJaWYgKHJlZyA+
PSAweEMwKQorCQltc2cuYWRkciArPSAweDAyOworCisJaWYgKGRlYnVnID49IDIpCisJCXByaW50
aygiJXM6IHJlZz0weCUwMlgsIGRhdGE9MHglMDJYXG4iLCBfX2Z1bmNfXywgcmVnLCBkYXRhKTsK
KworCXJldCA9IGkyY190cmFuc2Zlcihwcml2LT5pMmMsICZtc2csIDEpOworCisJaWYgKHJldCAh
PSAxKQorCQlkcHJpbnRrKCIlczogZXJyb3IgcmVnPTB4JXgsIGRhdGE9MHgleCwgcmV0PSVpXG4i
LAorCQkJX19mdW5jX18sIHJlZywgZGF0YSwgcmV0KTsKKworCXJldHVybiAocmV0ICE9IDEpID8g
LTEgOiAwOworfQorCitzdGF0aWMgaW50IGxnczhneHhfcmVhZF9yZWcoc3RydWN0IGxnczhneHhf
c3RhdGUgKnByaXYsIHU4IHJlZywgdTggKnBfZGF0YSkKK3sKKwlpbnQgcmV0OworCXU4IGRldl9h
ZGRyOworCisJdTggYjBbXSA9IHsgcmVnIH07CisJdTggYjFbXSA9IHsgMCB9OworCXN0cnVjdCBp
MmNfbXNnIG1zZ1tdID0geworCQl7IC5mbGFncyA9IDAsIC5idWYgPSBiMCwgLmxlbiA9IDEgfSwK
KwkJeyAuZmxhZ3MgPSBJMkNfTV9SRCwgLmJ1ZiA9IGIxLCAubGVuID0gMSB9LAorCX07CisKKwlk
ZXZfYWRkciA9IHByaXYtPmNvbmZpZy0+ZGVtb2RfYWRkcmVzczsKKwlpZiAocmVnID49IDB4QzAp
CisJCWRldl9hZGRyICs9IDB4MDI7CisJbXNnWzFdLmFkZHIgPSAgbXNnWzBdLmFkZHIgPSBkZXZf
YWRkcjsKKworCXJldCA9IGkyY190cmFuc2Zlcihwcml2LT5pMmMsIG1zZywgMik7CisJaWYgKHJl
dCAhPSAyKSB7CisJCWRwcmludGsoIiVzOiBlcnJvciByZWc9MHgleCwgcmV0PSVpXG4iLCBfX2Z1
bmNfXywgcmVnLCByZXQpOworCQlyZXR1cm4gLTE7CisJfQorCisJKnBfZGF0YSA9IGIxWzBdOwor
CWlmIChkZWJ1ZyA+PSAyKQorCQlwcmludGsoIiVzOiByZWc9MHglMDJYLCBkYXRhPTB4JTAyWFxu
IiwgX19mdW5jX18sIHJlZywgYjFbMF0pOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxn
czhneHhfc29mdF9yZXNldChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdikKK3sKKwlsZ3M4Z3h4
X3dyaXRlX3JlZyhwcml2LCAweDAyLCAweDAwKTsKKwltc2xlZXAoMSk7CisJbGdzOGd4eF93cml0
ZV9yZWcocHJpdiwgMHgwMiwgMHgwMSk7CisJbXNsZWVwKDEwMCk7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBsZ3M4Z3h4X3NldF9hZF9tb2RlKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpw
cml2KQoreworCWNvbnN0IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnID0gcHJpdi0+Y29u
ZmlnOworCXU4IGlmX2NvbmY7CisKKwlpZl9jb25mID0gMHgxMDsgLy8gQUdDIG91dHB1dCBvbjsK
KworCWlmX2NvbmYgfD0KKwkJKChjb25maWctPmV4dF9hZGMpID8gMHg4MDoweDAwKSB8CisJCSgo
Y29uZmlnLT5pZl9uZWdfY2VudGVyKSA/IDB4MDQ6MHgwMCkgfAorCQkoKGNvbmZpZy0+aWZfZnJl
cSA9PSAwKSA/IDB4MDg6MHgwMCkgfCAvKiBCYXNlYmFuZCAqLworCQkoKGNvbmZpZy0+ZXh0X2Fk
YyAmJiBjb25maWctPmFkY19zaWduZWQpID8gMHgwMjoweDAwKSB8CisJCSgoY29uZmlnLT5leHRf
YWRjICYmIGNvbmZpZy0+aWZfbmVnX2VkZ2UpID8gMHgwMToweDAwKTsKKworCWlmIChjb25maWct
PmV4dF9hZGMgJiYKKwkJKGNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc1MikpIHsK
KwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhCQSwgMHg0MCk7CisJfQorCisJbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHgwNywgaWZfY29uZik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IGludCBsZ3M4Z3h4X3NldF9pZl9mcmVxKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1MzIg
ZnJlcSAvKmluIGtIeiovKQoreworCXU2NCB2YWw7CisJdTMyIHYzMjsKKwl1MzIgaWZfY2xrOwor
CisJaWZfY2xrID0gcHJpdi0+Y29uZmlnLT5pZl9jbGtfZnJlcTsKKworCXZhbCA9IGZyZXE7CisJ
aWYgKGZyZXEgIT0gMCkgeworCQl2YWwgKj0gKHU2NCkxIDw8IDMyOworCQlpZiAoaWZfY2xrICE9
IDApCisJCQlkb19kaXYodmFsLCBpZl9jbGspOworCQl2MzIgPSB2YWwgJiAweEZGRkZGRkZGOwor
CQlkcHJpbnRrKCJTZXQgSUYgRnJlcSB0byAlZGtIelxuIiwgZnJlcSk7CisJfSBlbHNlIHsKKwkJ
djMyID0gMDsKKwkJZHByaW50aygiU2V0IElGIEZyZXEgdG8gYmFzZWJhbmRcbiIpOworCX0KKwlk
cHJpbnRrKCJBRkNfSU5JVF9GUkVRID0gMHglMDhYXG4iLCB2MzIpOworCisJbGdzOGd4eF93cml0
ZV9yZWcocHJpdiwgMHgwOSwgMHhGRiAmICh2MzIpKTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2
LCAweDBBLCAweEZGICYgKHYzMiA+PiA4KSk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgw
QiwgMHhGRiAmICh2MzIgPj4gMTYpKTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDBDLCAw
eEZGICYgKHYzMiA+PiAyNCkpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4
eF9zZXRfbW9kZV9hdXRvKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2KQoreworCXU4IHQ7CisK
KwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKSB7CisJCWxn
czhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzYsIDB4MDEpOworCX0KKworCWxnczhneHhfcmVhZF9y
ZWcocHJpdiwgMHg3RSwgJnQpOworCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4N0UsIHQgfCAw
eDAxKTsKKworCS8vIGNsZWFyIEZFQyBzZWxmIHJlc2V0CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2
LCAweEM1LCAmdCk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDNSwgdCAmIDB4RTApOwor
CisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTODkxMykgeworCQkv
KiBGRUMgYXV0byBkZXRlY3QgKi8KKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDMSwgMHgw
Myk7CisKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDdDLCAmdCk7CisJCXQgPSAodCAmIDB4
OEMpIHwgMHgwMzsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHg3QywgdCk7CisJfQorCisK
KwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKSB7CisJCS8q
IEJFUiB0ZXN0IG1vZGUgKi8KKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweEMzLCAmdCk7CisJ
CXQgPSAodCAmIDB4RUYpIHwgIDB4MTA7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzMs
IHQpOworCX0KKworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhH
NTIpIHsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhEOSwgMHg0MCk7CisJfQorCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9zZXRfbW9kZV9tYW51YWwoc3RydWN0IGxn
czhneHhfc3RhdGUgKnByaXYpCit7CisJaW50IHJldCA9IDA7CisJdTggdDsKKworCS8qIHR1cm4g
b2ZmIGF1dG8tZGV0ZWN0OyBtYW51YWwgc2V0dGluZ3MqLworCWxnczhneHhfd3JpdGVfcmVnKHBy
aXYsIDB4N0UsIDApOworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xH
Uzg5MTMpCisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzEsIDApOworCisJcmV0ID0gbGdz
OGd4eF9yZWFkX3JlZyhwcml2LCAweEM1LCAmdCk7CisJdCA9ICh0ICYgMHhFMCkgfCAweDA2Owor
CWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzUsIHQpOworCisJbGdzOGd4eF9zb2Z0X3Jlc2V0
KHByaXYpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9pc19sb2NrZWQo
c3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYsIHU4ICpsb2NrZWQpCit7CisJaW50IHJldCA9IDA7
CisJdTggdDsKKworCXJldCA9IGxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg0QiwgJnQpOworCWlm
IChyZXQgIT0gMCkKKwkJcmV0dXJuIHJldDsKKworCSpsb2NrZWQgPSAoKHQgJiAweEMwKSA9PSAw
eEMwKSA/IDEgOiAwOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxnczhneHhfaXNfYXV0
b2RldGVjdF9maW5pc2hlZChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiwKKwkJCQkJICB1OCAq
ZmluaXNoZWQpCit7CisJaW50IHJldCA9IDA7CisJdTggdDsKKworCXJldCA9IGxnczhneHhfcmVh
ZF9yZWcocHJpdiwgMHhBNCwgJnQpOworCWlmIChyZXQgIT0gMCkKKwkJcmV0dXJuIHJldDsKKwor
CSpmaW5pc2hlZCA9ICgodCAmIDB4MykgPT0gMHgxKSA/IDEgOiAwOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9hdXRvbG9ja19naShzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAq
cHJpdiwgdTggZ2ksIHU4ICpsb2NrZWQpCit7CisJaW50IGVycjsgCisJdTggYWRfZmluaSA9IDA7
CisKKwlpZiAoZ2kgPT0gR0lfOTQ1KQorCQlkcHJpbnRrKCJ0cnkgR0kgOTQ1XG4iKTsKKwllbHNl
IGlmIChnaSA9PSBHSV81OTUpCisJCWRwcmludGsoInRyeSBHSSA1OTVcbiIpOworCWVsc2UgaWYg
KGdpID09IEdJXzQyMCkKKwkJZHByaW50aygidHJ5IEdJIDQyMFxuIik7CisJbGdzOGd4eF93cml0
ZV9yZWcocHJpdiwgMHgwNCwgZ2kpOworCWxnczhneHhfc29mdF9yZXNldChwcml2KTsKKwltc2xl
ZXAoNTApOworCWVyciA9IGxnczhneHhfaXNfYXV0b2RldGVjdF9maW5pc2hlZChwcml2LCAmYWRf
ZmluaSk7CisJaWYgKGVyciAhPSAwKQorCQlyZXR1cm4gZXJyOworCWlmIChhZF9maW5pKSB7CisJ
CWVyciA9IGxnczhneHhfaXNfbG9ja2VkKHByaXYsIGxvY2tlZCk7CisJCWlmIChlcnIgIT0gMCkK
KwkJCXJldHVybiBlcnI7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4
eF9hdXRvX2RldGVjdChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiwKKwkJCSAgICAgICB1OCAq
ZGV0ZWN0ZWRfcGFyYW0sIHU4ICpnaSkKK3sKKwlpbnQgaSxqOworCWludCBlcnIgPSAwOworCXU4
IGxvY2tlZCA9IDAsIHRtcF9naTsKKworCWRwcmludGsoIiVzXG4iLCBfX2Z1bmNfXyk7CisKKwls
Z3M4Z3h4X3NldF9tb2RlX2F1dG8ocHJpdik7CisJLyogR3VhcmQgSW50ZXJ2YWwgKi8KKwlsZ3M4
Z3h4X3dyaXRlX3JlZyhwcml2LCAweDAzLCAwMCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgMjsgaSsr
KSB7CisJCWZvciAoaiA9MCA7IGogPCAyOyBqKyspIHsKKwkJCXRtcF9naSA9IEdJXzk0NTsKKwkJ
CWVyciA9IGxnczhneHhfYXV0b2xvY2tfZ2kocHJpdiwgR0lfOTQ1LCAmbG9ja2VkKTsKKwkJCWlm
IChlcnIpIGdvdG8gb3V0OworCQkJaWYgKGxvY2tlZCkgZ290byBsb2NrZWQ7CisJCX0KKwkJZm9y
IChqID0wIDsgaiA8IDI7IGorKykgeworCQkJdG1wX2dpID0gR0lfNDIwOworCQkJZXJyID0gbGdz
OGd4eF9hdXRvbG9ja19naShwcml2LCBHSV80MjAsICZsb2NrZWQpOworCQkJaWYgKGVycikgZ290
byBvdXQ7CisJCQlpZiAobG9ja2VkKSBnb3RvIGxvY2tlZDsKKwkJfQorCQl0bXBfZ2kgPSBHSV81
OTU7CisJCWVyciA9IGxnczhneHhfYXV0b2xvY2tfZ2kocHJpdiwgR0lfNTk1LCAmbG9ja2VkKTsK
KwkJaWYgKGVycikgZ290byBvdXQ7CisJCWlmIChsb2NrZWQpIGdvdG8gbG9ja2VkOworCX0KKwor
bG9ja2VkOgorCWlmICgoZXJyID09IDApICYmIChsb2NrZWQgPT0gMSkpIHsKKwkJdTggdDsKKwor
CQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QTIsICZ0KTsKKwkJKmRldGVjdGVkX3BhcmFtID0g
dDsKKworCQlpZiAodG1wX2dpID09IEdJXzk0NSkKKwkJCWRwcmludGsoIkdJIDk0NSBsb2NrZWRc
biIpOworCQllbHNlIGlmICh0bXBfZ2kgPT0gR0lfNTk1KQorCQkJZHByaW50aygiR0kgNTk1IGxv
Y2tlZFxuIik7CisJCWVsc2UgaWYgKHRtcF9naSA9PSBHSV80MjApCisJCQlkcHJpbnRrKCJHSSA0
MjAgbG9ja2VkXG4iKTsKKwkJKmdpID0gdG1wX2dpOworCX0KKwlpZiAoIWxvY2tlZCkKKwkJZXJy
ID0gLTE7CisKK291dDoKKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMgdm9pZCBsZ3M4Z3h4X2F1
dG9fbG9jayhzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdikKK3sKKwlzOCBlcnI7CisJLy91OCBj
dHJsX2ZyYW1lID0gMCwgbW9kZSA9IDAsIHJhdGUgPSAwOworCXU4IC8qaW50ZXJfbGVhdmVyX2xl
biA9IDAsKi8gZ2kgPSAweDI7CisJdTggZGV0ZWN0ZWRfcGFyYW0gPSAwOworCisJZXJyID0gbGdz
OGd4eF9hdXRvX2RldGVjdChwcml2LCAmZGV0ZWN0ZWRfcGFyYW0sICZnaSk7CisKKwlpZiAoZXJy
ICE9IDApIHsKKyNpZiAwCisJCS8qIFNldCBhdXRvIGd1YXJkaW50ZXJ2YWwgZGV0ZWN0aW9uICov
CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDMsIDB4MDEpOworI2VuZGlmCisJCWRwcmlu
dGsoImxnczhneHhfYXV0b19kZXRlY3QgZmFpbGVkXG4iKTsKKwl9CisKKwkKKwkvKiBBcHBseSBk
ZXRlY3RlZCBwYXJhbWV0ZXJzICovCisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hY
X1BST0RfTEdTODkxMykgeworCQl1OCBpbnRlcl9sZWF2ZV9sZW4gPSBkZXRlY3RlZF9wYXJhbSAm
IFRJTV9NQVNLIDsKKwkJaW50ZXJfbGVhdmVfbGVuID0gKGludGVyX2xlYXZlX2xlbiA9PSBUSU1f
TE9ORykgPyAweDYwIDogMHg0MDsKKwkJZGV0ZWN0ZWRfcGFyYW0gJj0gQ0ZfTUFTSyB8IFNDX01B
U0sgIHwgTEdTX0ZFQ19NQVNLOworCQlkZXRlY3RlZF9wYXJhbSB8PSBpbnRlcl9sZWF2ZV9sZW47
CisJfQorCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4N0QsIGRldGVjdGVkX3BhcmFtKTsKKwlp
ZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKSB7CisJCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4QzAsIGRldGVjdGVkX3BhcmFtKTsKKwl9CisJLy9sZ3M4Z3h4
X3NvZnRfcmVzZXQocHJpdik7CisKKwkvKiBFbnRlciBtYW51YWwgbW9kZSAqLworCWxnczhneHhf
c2V0X21vZGVfbWFudWFsKHByaXYpOworCisJaWYgKGdpID09IDB4MikKKwlzd2l0Y2goZ2kpIHsK
KwljYXNlIEdJXzk0NToKKwkJcHJpdi0+Y3Vycl9naSA9IDk0NTsgYnJlYWs7CisJY2FzZSBHSV81
OTU6CisJCXByaXYtPmN1cnJfZ2kgPSA1OTU7IGJyZWFrOworCWNhc2UgR0lfNDIwOgorCQlwcml2
LT5jdXJyX2dpID0gNDIwOyBicmVhazsKKwlkZWZhdWx0OgorCQlwcml2LT5jdXJyX2dpID0gOTQ1
OyBicmVhazsKKwl9Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9zZXRfbXBlZ19tb2RlKHN0cnVj
dCBsZ3M4Z3h4X3N0YXRlICpwcml2LAorCQkJCSB1OCBzZXJpYWwsIHU4IGNsa19wb2wsIHU4IGNs
a19nYXRlZCkKK3sKKwlpbnQgcmV0ID0gMDsKKwl1OCB0OworCisJcmV0ID0gbGdzOGd4eF9yZWFk
X3JlZyhwcml2LCAweEMyLCAmdCk7CisJaWYgKHJldCAhPSAwKQorCQlyZXR1cm4gcmV0OworCisJ
dCAmPSAweEY4OworCXQgfD0gc2VyaWFsID8gVFNfU0VSSUFMIDogVFNfUEFSQUxMRUw7CisJdCB8
PSBjbGtfcG9sID8gVFNfQ0xLX0lOVkVSVEVEIDogVFNfQ0xLX05PUk1BTDsKKwl0IHw9IGNsa19n
YXRlZCA/IFRTX0NMS19HQVRFRCA6IFRTX0NMS19GUkVFUlVOOworCisJcmV0ID0gbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHhDMiwgdCk7CisJaWYgKHJldCAhPSAwKQorCQlyZXR1cm4gcmV0Owor
CisJcmV0dXJuIDA7Cit9CisKKworLyogTEdTODkxMyBkZW1vZCBmcm9udGVuZCBmdW5jdGlvbnMg
Ki8KKworc3RhdGljIGludCBsZ3M4OTEzX2luaXQoc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYp
Cit7CisJdTggdDsKKworCS8qIExHUzg5MTMgc3BlY2lmaWMgKi8KKwlsZ3M4Z3h4X3dyaXRlX3Jl
Zyhwcml2LCAweGMxLCAweDMpOworCisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDdjLCAmdCk7
CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHg3YywgKHQmMHg4YykgfCAweDMpOworCisJLyog
TEdTODkxMyBzcGVjaWZpYyAqLworCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhjMywgJnQpOwor
CWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4YzMsIHQmMHgxMCk7CisKKyNpZiAwCisJLyogc2V0
IEFHQyByZWYgKi8KKwkvKiBGSVhNRSBiZXR0ZXIgc2V0IGZyb20gY29uZmlndXJhdGlvbiBwZXIg
aGFyZHdhcmUgKi8KKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDJDLCAwKTsgCisJbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHgyRCwgMHgxOCk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwg
MHgyRSwgMHhBMik7CisjZW5kaWYKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGxnczhn
eHhfaW5pdChzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSkKK3sKKwlzdHJ1Y3QgbGdzOGd4eF9zdGF0
ZSAqcHJpdiA9IChzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqKWZlLT5kZW1vZHVsYXRvcl9wcml2Owor
CWNvbnN0IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnID0gcHJpdi0+Y29uZmlnOworCXU4
IGRhdGEgPSAwOworCXM4IGVycjsKKwlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJbGdz
OGd4eF9yZWFkX3JlZyhwcml2LCAwLCAmZGF0YSk7CisJZHByaW50aygicmVnIDAgPSAweCUwMlhc
biIsIGRhdGEpOworCisJLyogU2V0dXAgTVBFRyBvdXRwdXQgZm9ybWF0ICovCisJZXJyID0gbGdz
OGd4eF9zZXRfbXBlZ19tb2RlKHByaXYsIGNvbmZpZy0+c2VyaWFsX3RzLAorCQkJCSAgICBjb25m
aWctPnRzX2Nsa19wb2wsCisJCQkJICAgIGNvbmZpZy0+dHNfY2xrX2dhdGVkKTsKKwlpZiAoZXJy
ICE9IDApCisJCXJldHVybiAtRUlPOworCisJaWYgKGNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BS
T0RfTEdTODkxMykgeworCQlsZ3M4OTEzX2luaXQocHJpdik7CisJfQorCWxnczhneHhfc2V0X2lm
X2ZyZXEocHJpdiwgcHJpdi0+Y29uZmlnLT5pZl9mcmVxKTsKKwlpZiAoY29uZmlnLT5wcm9kICE9
IExHUzhHWFhfUFJPRF9MR1M4OTEzKQorCQlsZ3M4Z3h4X3NldF9hZF9tb2RlKHByaXYpOworCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGxnczhneHhfcmVsZWFzZShzdHJ1Y3QgZHZiX2Zy
b250ZW5kICpmZSkKK3sKKwlzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqc3RhdGUgPSBmZS0+ZGVtb2R1
bGF0b3JfcHJpdjsKKwlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOworCisJa2ZyZWUoc3RhdGUp
OworfQorCisjaWYgMAorc3RhdGljIGludCBsZ3M4Z3h4X3NsZWVwKHN0cnVjdCBkdmJfZnJvbnRl
bmQgKmZlKQoreworCWRwcmludGsoIiVzXG4iLCBfX2Z1bmNfXyk7CisKKwlyZXR1cm4gMDsKK30K
KyNlbmRpZgorCitzdGF0aWMgaW50IGxnczhneHhfd3JpdGUoc3RydWN0IGR2Yl9mcm9udGVuZCAq
ZmUsIHU4ICpidWYsIGludCBsZW4pCit7CisJc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYgPSBm
ZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKworCWlmIChsZW4gIT0gMikKKwkJcmV0dXJuIC1FSU5WQUw7
CisKKwlyZXR1cm4gbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgYnVmWzBdLCBidWZbMV0pOworfQor
CitzdGF0aWMgaW50IGxnczhneHhfc2V0X2ZlKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLAorCQkJ
ICBzdHJ1Y3QgZHZiX2Zyb250ZW5kX3BhcmFtZXRlcnMgKmZlX3BhcmFtcykKK3sKKwlzdHJ1Y3Qg
bGdzOGd4eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCisJZHByaW50aygi
JXNcbiIsIF9fZnVuY19fKTsKKworCS8qIHNldCBmcmVxdWVuY3kgKi8KKwlpZiAoZmUtPm9wcy50
dW5lcl9vcHMuc2V0X3BhcmFtcykgeworCQlmZS0+b3BzLnR1bmVyX29wcy5zZXRfcGFyYW1zKGZl
LCBmZV9wYXJhbXMpOworCQlpZiAoZmUtPm9wcy5pMmNfZ2F0ZV9jdHJsKQorCQkJZmUtPm9wcy5p
MmNfZ2F0ZV9jdHJsKGZlLCAwKTsKKwl9CisKKwkvKiBIYXJkY29kZWQgdG8gdXNlIGF1dG8gYXMg
bXVjaCBhcyBwb3NzaWJsZSAqLworCWZlX3BhcmFtcy0+dS5vZmRtLmNvZGVfcmF0ZV9IUCA9IEZF
Q19BVVRPOworCWZlX3BhcmFtcy0+dS5vZmRtLmd1YXJkX2ludGVydmFsID0gR1VBUkRfSU5URVJW
QUxfQVVUTzsKKwlmZV9wYXJhbXMtPnUub2ZkbS50cmFuc21pc3Npb25fbW9kZSA9IFRSQU5TTUlT
U0lPTl9NT0RFX0FVVE87CisKKwkvKiBTZXQgc3RhbmRhcmQgcGFyYW1zLi4gb3IgcHV0IHRoZW0g
dG8gYXV0byAqLworCWlmICgoZmVfcGFyYW1zLT51Lm9mZG0uY29kZV9yYXRlX0hQID09IEZFQ19B
VVRPKSB8fAorCSAgICAoZmVfcGFyYW1zLT51Lm9mZG0uY29kZV9yYXRlX0xQID09IEZFQ19BVVRP
KSB8fAorCSAgICAoZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9PSBRQU1fQVVUTykg
fHwKKwkgICAgKGZlX3BhcmFtcy0+dS5vZmRtLmhpZXJhcmNoeV9pbmZvcm1hdGlvbiA9PSBISUVS
QVJDSFlfQVVUTykpIHsKKwl9IGVsc2UgeworCQkvKiBzZXQgY29uc3RlbGxhdGlvbiAqLworCQlz
d2l0Y2ggKGZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24pIHsKKwkJY2FzZSBRUFNLOgor
CQljYXNlIFFBTV8xNjoKKwkJY2FzZSBRQU1fNjQ6CisJCQlicmVhazsKKworCQlkZWZhdWx0Ogor
CQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKworCQkvKiBzZXQgaGllcmFyY2h5ICovCisJCXN3aXRj
aCAoZmVfcGFyYW1zLT51Lm9mZG0uaGllcmFyY2h5X2luZm9ybWF0aW9uKSB7CisJCWNhc2UgSElF
UkFSQ0hZX05PTkU6CisJCWNhc2UgSElFUkFSQ0hZXzE6CisJCWNhc2UgSElFUkFSQ0hZXzI6CisJ
CWNhc2UgSElFUkFSQ0hZXzQ6CisJCQlicmVhazsKKworCQlkZWZhdWx0OgorCQkJcmV0dXJuIC1F
SU5WQUw7CisJCX0KKwl9CisKKwkvKiBzZXQgZ3VhcmQgaW50ZXJ2YWwgKi8KKwlzd2l0Y2ggKGZl
X3BhcmFtcy0+dS5vZmRtLmd1YXJkX2ludGVydmFsKSB7CisJY2FzZSBHVUFSRF9JTlRFUlZBTF8x
XzMyOgorCWNhc2UgR1VBUkRfSU5URVJWQUxfMV8xNjoKKwljYXNlIEdVQVJEX0lOVEVSVkFMXzFf
ODoKKwljYXNlIEdVQVJEX0lOVEVSVkFMXzFfNDoKKwljYXNlIEdVQVJEX0lOVEVSVkFMX0FVVE86
CisJCWJyZWFrOworCisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogc2V0
IHRyYW5zbWlzc2lvbiBtb2RlICovCisJc3dpdGNoIChmZV9wYXJhbXMtPnUub2ZkbS50cmFuc21p
c3Npb25fbW9kZSkgeworCWNhc2UgVFJBTlNNSVNTSU9OX01PREVfMks6CisJY2FzZSBUUkFOU01J
U1NJT05fTU9ERV84SzoKKwljYXNlIFRSQU5TTUlTU0lPTl9NT0RFX0FVVE86CisJCWJyZWFrOwor
CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogc3RhcnQgYXV0byBsb2Nr
ICovCisJbGdzOGd4eF9hdXRvX2xvY2socHJpdik7CisKKwltc2xlZXAoMTApOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9nZXRfZmUoc3RydWN0IGR2Yl9mcm9udGVuZCAq
ZmUsCisJCQkgIHN0cnVjdCBkdmJfZnJvbnRlbmRfcGFyYW1ldGVycyAqZmVfcGFyYW1zKQorewor
CXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7CisJdTgg
dDsKKwlpbnQgdHJhbnNsYXRlZF9mZWMgPSBGRUNfMV8yOworCisJZHByaW50aygiJXNcbiIsIF9f
ZnVuY19fKTsKKworCS8qIFRPRE86IGdldCByZWFsIHJlYWRpbmdzIGZyb20gZGV2aWNlICovCisJ
LyogaW52ZXJzaW9uIHN0YXR1cyAqLworCWZlX3BhcmFtcy0+aW52ZXJzaW9uID0gSU5WRVJTSU9O
X09GRjsKKworCS8qIGJhbmR3aWR0aCAqLworCWZlX3BhcmFtcy0+dS5vZmRtLmJhbmR3aWR0aCA9
IEJBTkRXSURUSF84X01IWjsKKworCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg3RCwgJnQpOwor
CS8qIEZFQy4gTm8gZXhhY3QgbWF0Y2ggZm9yIERNQi1USCwgcGljayBhcHByb3guIHZhbHVlICov
CisJc3dpdGNoKHQgJiBMR1NfRkVDX01BU0spIHsKKwljYXNlICBMR1NfRkVDXzBfNDogLyogRkVD
IDAuNCAqLworCQl0cmFuc2xhdGVkX2ZlYyA9IEZFQ18xXzI7CisJCWJyZWFrOworCWNhc2UgIExH
U19GRUNfMF82OiAvKiBGRUMgMC42ICovCisJCXRyYW5zbGF0ZWRfZmVjID0gRkVDXzJfMzsKKwkJ
YnJlYWs7CisJY2FzZSAgTEdTX0ZFQ18wXzg6IC8qIEZFQyAwLjggKi8KKwkJdHJhbnNsYXRlZF9m
ZWMgPSBGRUNfNV82OworCQlicmVhazsKKwlkZWZhdWx0OgorCQl0cmFuc2xhdGVkX2ZlYyA9IEZF
Q18xXzI7CisJfQorCWZlX3BhcmFtcy0+dS5vZmRtLmNvZGVfcmF0ZV9IUCA9CisJZmVfcGFyYW1z
LT51Lm9mZG0uY29kZV9yYXRlX0xQID0gdHJhbnNsYXRlZF9mZWM7CisKKwkvKiBjb25zdGVsbGF0
aW9uICovCisJc3dpdGNoKHQgJiBTQ19NQVNLKSB7CisJY2FzZSBTQ19RQU02NDoKKwkJZmVfcGFy
YW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9IFFBTV82NDsKKwkJYnJlYWs7CisJY2FzZSBTQ19R
QU0zMjoKKwkJZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9IFFBTV8zMjsKKwkJYnJl
YWs7CisJY2FzZSBTQ19RQU0xNjoKKwkJZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9
IFFBTV8xNjsKKwkJYnJlYWs7CisJY2FzZSBTQ19RQU00OgorCWNhc2UgU0NfUUFNNE5SOgorCQlm
ZV9wYXJhbXMtPnUub2ZkbS5jb25zdGVsbGF0aW9uID0gUVBTSzsKKwkJYnJlYWs7CisJZGVmYXVs
dDoKKwkJZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9IFFBTV82NDsKKwl9CisKKwkv
KiB0cmFuc21pc3Npb24gbW9kZSAqLworCWZlX3BhcmFtcy0+dS5vZmRtLnRyYW5zbWlzc2lvbl9t
b2RlID0gVFJBTlNNSVNTSU9OX01PREVfOEs7CisKKwkvKiBndWFyZCBpbnRlcnZhbCAqLworCWZl
X3BhcmFtcy0+dS5vZmRtLmd1YXJkX2ludGVydmFsID0gR1VBUkRfSU5URVJWQUxfMV8xNjsKKwor
CS8qIGhpZXJhcmNoeSAqLworCWZlX3BhcmFtcy0+dS5vZmRtLmhpZXJhcmNoeV9pbmZvcm1hdGlv
biA9IEhJRVJBUkNIWV9OT05FOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYworaW50IGxnczhn
eHhfZ2V0X3R1bmVfc2V0dGluZ3Moc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsCisJCQkgICAgICBz
dHJ1Y3QgZHZiX2Zyb250ZW5kX3R1bmVfc2V0dGluZ3MgKmZlc2V0dGluZ3MpCit7CisJLyogRklY
TUU6IGNvcHkgZnJvbSB0ZGExMDA0eC5jICovCisJZmVzZXR0aW5ncy0+bWluX2RlbGF5X21zID0g
ODAwOworCS8qIERyaWZ0IGNvbXBlbnNhdGlvbiBtYWtlcyBubyBzZW5zZSBmb3IgRFZCLVQgKi8K
KwlmZXNldHRpbmdzLT5zdGVwX3NpemUgPSAwOworCWZlc2V0dGluZ3MtPm1heF9kcmlmdCA9IDA7
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9yZWFkX3N0YXR1cyhzdHJ1Y3Qg
ZHZiX2Zyb250ZW5kICpmZSwgZmVfc3RhdHVzX3QgKmZlX3N0YXR1cykKK3sKKwlzdHJ1Y3QgbGdz
OGd4eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCXM4IHJldDsKKwl1OCB0
OworCisJZHByaW50aygiJXNcbiIsIF9fZnVuY19fKTsKKworCXJldCA9IGxnczhneHhfcmVhZF9y
ZWcocHJpdiwgMHg0QiwgJnQpOworCWlmIChyZXQgIT0gMCkKKwkJcmV0dXJuIC1FSU87CisKKwlk
cHJpbnRrKCJSZWcgMHg0QjogMHglMDJYXG4iLCB0KTsKKworCSpmZV9zdGF0dXMgPSAwOworCWlm
IChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpIHsKKwkJaWYgKCh0
ICYgMHg0MCkgPT0gMHg0MCkKKwkJCSpmZV9zdGF0dXMgfD0gRkVfSEFTX1NJR05BTCB8IEZFX0hB
U19DQVJSSUVSOworCQlpZiAoKHQgJiAweDgwKSA9PSAweDgwKQorCQkJKmZlX3N0YXR1cyB8PSBG
RV9IQVNfVklURVJCSSB8IEZFX0hBU19TWU5DIHwgRkVfSEFTX0xPQ0s7CisJfSBlbHNlIHsKKwkJ
aWYgKCh0ICYgMHg4MCkgPT0gMHg4MCkKKwkJCSpmZV9zdGF0dXMgfD0gRkVfSEFTX1NJR05BTCB8
IEZFX0hBU19DQVJSSUVSIHwKKwkJCQlGRV9IQVNfVklURVJCSSB8IEZFX0hBU19TWU5DIHwgRkVf
SEFTX0xPQ0s7CisJfQorCisJLyogc3VjY2VzcyAqLworCWRwcmludGsoIiVzOiBmZV9zdGF0dXM9
MHgleFxuIiwgX19mdW5jX18sICpmZV9zdGF0dXMpOworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IGxnczhneHhfcmVhZF9zaWduYWxfYWdjKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1
MTYgKnNpZ25hbCkKK3sKKwl1MTYgdjsKKwl1OCBhZ2NfbHZsWzJdLCBjYXQ7CisKKwlkcHJpbnRr
KCIlcygpXG4iLCBfX2Z1bmNfXyk7CQorCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHgzRiwgJmFn
Y19sdmxbMF0pOworCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHgzRSwgJmFnY19sdmxbMV0pOwor
CisJdiA9IGFnY19sdmxbMF07CisJdiA8PD0gODsKKwl2IHw9IGFnY19sdmxbMV07CisKKwlkcHJp
bnRrKCJhZ2NfbHZsOiAweCUwNFhcbiIsIHYpOworCisJaWYgKHYgPCAweDEwMCApCisJCWNhdCA9
IDA7CisJZWxzZSBpZiAodiA8IDB4MTkwKQorCQljYXQgPSA1OworCWVsc2UgaWYgKHYgPCAweDJB
OCkKKwkJY2F0ID0gNDsKKwllbHNlIGlmICh2IDwgMHgzODEpCisJCWNhdCA9IDM7CisJZWxzZSBp
ZiAodiA8IDB4NDAwKQorCQljYXQgPSAyOworCWVsc2UgaWYgKHYgPT0gMHg0MDApCisJCWNhdCA9
IDE7CisJZWxzZQorCQljYXQgPSAwOworCQkKKwkqc2lnbmFsID0gY2F0OworCisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyBpbnQgbGdzODkxM19yZWFkX3NpZ25hbF9zdHJlbmd0aChzdHJ1Y3QgbGdz
OGd4eF9zdGF0ZSAqcHJpdiwgdTE2ICpzaWduYWwpCit7CisJdTggdDsgczggcmV0OworI2lmbmRl
ZiBVU0VfRkFLRV9TSUdOQUxfU1RSRU5HVEgKKwlzMTYgbWF4X3N0cmVuZ3RoID0gMDsKKwl1OCBz
dHI7CisJdTE2IGksIGdpID0gcHJpdi0+Y3Vycl9naTsKKyNlbmRpZgorCisJZHByaW50aygiJXNc
biIsIF9fZnVuY19fKTsKKworCXJldCA9IGxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg0QiwgJnQp
OworCWlmIChyZXQgIT0gMCkKKwkJcmV0dXJuIC1FSU87CisKKyNpZmRlZiBVU0VfRkFLRV9TSUdO
QUxfU1RSRU5HVEgKKwlpZiAoKHQgJiAweEMwKSA9PSAweEMwKSB7CisJCWRwcmludGsoIkZha2Ug
c2lnbmFsIHN0cmVuZ3RoIGFzIDUwXG4iKTsKKwkJKnNpZ25hbCA9IDB4MzI7CisJfQorI2Vsc2UK
KwlkcHJpbnRrKCJnaSA9ICVkXG4iLCBnaSk7CisJZm9yIChpID0gMDsgaSA8IGdpOyBpKyspIHsK
KworCQlpZiAoKGkgJiAweEZGKSA9PSAwKQorCQkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHg4
NCwgMHgwMyAmIChpID4+IDgpKTsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHg4MywgaSAm
IDB4RkYpOworCisJCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg5NCwgJnN0cik7CisJCWlmICht
YXhfc3RyZW5ndGggPCBzdHIpCisJCQltYXhfc3RyZW5ndGggPSBzdHI7CisJfQorCisJKnNpZ25h
bCA9IG1heF9zdHJlbmd0aDsKKwlkcHJpbnRrKCIlczogc2lnbmFsPTB4JTAyWFxuIiwgX19mdW5j
X18sICpzaWduYWwpOworI2VuZGlmCisKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4OTUsICZ0
KTsKKwlkcHJpbnRrKCIlczogQVZHIE5vaXNlPTB4JTAyWFxuIiwgX19mdW5jX18sIHQpOworCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9yZWFkX3NpZ25hbF9zdHJlbmd0aChz
dHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTE2ICpzaWduYWwpCit7CisJc3RydWN0IGxnczhneHhf
c3RhdGUgKnByaXYgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKworCWlmIChwcml2LT5jb25maWct
PnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpCisJCXJldHVybiBsZ3M4OTEzX3JlYWRfc2ln
bmFsX3N0cmVuZ3RoKHByaXYsIHNpZ25hbCk7CisJZWxzZQorCQlyZXR1cm4gbGdzOGd4eF9yZWFk
X3NpZ25hbF9hZ2MocHJpdiwgc2lnbmFsKTsKK30KKworc3RhdGljIGludCBsZ3M4Z3h4X3JlYWRf
c25yKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCB1MTYgKnNucikKK3sKKwlzdHJ1Y3QgbGdzOGd4
eF9zdGF0ZSAqcHJpdiA9IGZlLT5kZW1vZHVsYXRvcl9wcml2OworCXU4IHQ7CisJKnNuciA9IDA7
CisKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4OTUsICZ0KTsKKwlkcHJpbnRrKCJBVkcgTm9p
c2U9MHglMDJYXG4iLCB0KTsKKwkqc25yID0gMjU2IC0gdDsKKwkqc25yIDw8PSA4OworCWRwcmlu
dGsoInNucj0weCV4XG4iLCAqc25yKTsKKwkKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBs
Z3M4Z3h4X3JlYWRfdWNibG9ja3Moc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsIHUzMiAqdWNibG9j
a3MpCit7CisJKnVjYmxvY2tzID0gMDsKKwlkcHJpbnRrKCIlczogdWNibG9ja3M9MHgleFxuIiwg
X19mdW5jX18sICp1Y2Jsb2Nrcyk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4
eF9yZWFkX2JlcihzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTMyICpiZXIpCit7CisJc3RydWN0
IGxnczhneHhfc3RhdGUgKnByaXYgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKKwl1OCByMCwgcjEs
IHIyLCByMzsKKwl1MzIgdG90YWxfY250LCBlcnJfY250OworCisJZHByaW50aygiJXNcbiIsIF9f
ZnVuY19fKTsKKworCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4YzYsIDB4MDEpOworCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4YzYsIDB4NDEpOworCWxnczhneHhfd3JpdGVfcmVnKHByaXYs
IDB4YzYsIDB4MDEpOworCisJbXNsZWVwKDIwMCk7CisKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2
LCAweGM2LCAweDgxKTsKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDAsICZyMCk7CisJbGdz
OGd4eF9yZWFkX3JlZyhwcml2LCAweGQxLCAmcjEpOworCWxnczhneHhfcmVhZF9yZWcocHJpdiwg
MHhkMiwgJnIyKTsKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDMsICZyMyk7CisJdG90YWxf
Y250ID0gKHIzIDw8IDI0KSB8IChyMiA8PCAxNikgfCAocjEgPDwgOCkgfCAocjApOworCWxnczhn
eHhfcmVhZF9yZWcocHJpdiwgMHhkNCwgJnIwKTsKKwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4
ZDUsICZyMSk7CisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweGQ2LCAmcjIpOworCWxnczhneHhf
cmVhZF9yZWcocHJpdiwgMHhkNywgJnIzKTsKKwllcnJfY250ID0gKHIzIDw8IDI0KSB8IChyMiA8
PCAxNikgfCAocjEgPDwgOCkgfCAocjApOworCWRwcmludGsoImVycm9yPSVkIHRvdGFsPSVkXG4i
LCBlcnJfY250LCB0b3RhbF9jbnQpOworCisJaWYgKHRvdGFsX2NudCA9PSAwKQorCQkqYmVyID0g
MDsKKwllbHNlCisJCSpiZXIgPSBlcnJfY250ICogMTAwIC8gdG90YWxfY250OworCisJZHByaW50
aygiJXM6IGJlcj0weCV4XG4iLCBfX2Z1bmNfXywgKmJlcik7CisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgbGdzOGd4eF9pMmNfZ2F0ZV9jdHJsKHN0cnVjdCBkdmJfZnJvbnRlbmQqIGZlLCBp
bnQgZW5hYmxlKQoreworCXN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxh
dG9yX3ByaXY7CisKKwlpZiAocHJpdi0+Y29uZmlnLT50dW5lcl9hZGRyZXNzID09IDApCisJCXJl
dHVybiAwOworCWlmIChlbmFibGUpIHsKKwkJcmV0dXJuIGxnczhneHhfd3JpdGVfcmVnKHByaXYs
IDB4MDEsIDB4ODAgfCBwcml2LT5jb25maWctPnR1bmVyX2FkZHJlc3MpOworCX0gZWxzZSB7CisJ
CXJldHVybiBsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDAxLCAwKTsKKwl9Cit9CisKK3N0YXRp
YyBzdHJ1Y3QgZHZiX2Zyb250ZW5kX29wcyBsZ3M4Z3h4X29wcyA9IHsKKwkuaW5mbyA9IHsKKwkJ
Lm5hbWUgPSAiTGVnZW5kIFNpbGljb24gTEdTODkxMy9MR1M4R1hYIERNQi1USCIsCisJCS50eXBl
ID0gRkVfT0ZETSwKKwkJLmZyZXF1ZW5jeV9taW4gPSA0NzQwMDAwMDAsCisJCS5mcmVxdWVuY3lf
bWF4ID0gODU4MDAwMDAwLAorCQkuZnJlcXVlbmN5X3N0ZXBzaXplID0gMTAwMDAsCisJCS5jYXBz
ID0KKwkJICAgIEZFX0NBTl9GRUNfMV8yIHwgRkVfQ0FOX0ZFQ18yXzMgfCBGRV9DQU5fRkVDXzNf
NCB8CisJCSAgICBGRV9DQU5fRkVDXzVfNiB8IEZFX0NBTl9GRUNfN184IHwgRkVfQ0FOX0ZFQ19B
VVRPIHwKKwkJICAgIEZFX0NBTl9RUFNLIHwKKwkJICAgIEZFX0NBTl9RQU1fMTYgfCBGRV9DQU5f
UUFNXzY0IHwgRkVfQ0FOX1FBTV9BVVRPIHwKKwkJICAgIEZFX0NBTl9UUkFOU01JU1NJT05fTU9E
RV9BVVRPIHwgRkVfQ0FOX0dVQVJEX0lOVEVSVkFMX0FVVE8KKwl9LAorCisJLnJlbGVhc2UgPSBs
Z3M4Z3h4X3JlbGVhc2UsCisKKwkuaW5pdCA9IGxnczhneHhfaW5pdCwKKwkvLy5zbGVlcCA9IGxn
czhneHhfc2xlZXAsCisJLndyaXRlID0gbGdzOGd4eF93cml0ZSwKKwkuaTJjX2dhdGVfY3RybCA9
IGxnczhneHhfaTJjX2dhdGVfY3RybCwKKworCS5zZXRfZnJvbnRlbmQgPSBsZ3M4Z3h4X3NldF9m
ZSwKKwkuZ2V0X2Zyb250ZW5kID0gbGdzOGd4eF9nZXRfZmUsCisJLmdldF90dW5lX3NldHRpbmdz
ID0gbGdzOGd4eF9nZXRfdHVuZV9zZXR0aW5ncywKKworCS5yZWFkX3N0YXR1cyA9IGxnczhneHhf
cmVhZF9zdGF0dXMsCisJLnJlYWRfYmVyID0gbGdzOGd4eF9yZWFkX2JlciwKKwkucmVhZF9zaWdu
YWxfc3RyZW5ndGggPSBsZ3M4Z3h4X3JlYWRfc2lnbmFsX3N0cmVuZ3RoLAorCS5yZWFkX3NuciA9
IGxnczhneHhfcmVhZF9zbnIsCisJLnJlYWRfdWNibG9ja3MgPSBsZ3M4Z3h4X3JlYWRfdWNibG9j
a3MsCit9OworCitzdHJ1Y3QgZHZiX2Zyb250ZW5kICpsZ3M4Z3h4X2F0dGFjaChjb25zdCBzdHJ1
Y3QgbGdzOGd4eF9jb25maWcgKmNvbmZpZywKKwkJCQkgICAgc3RydWN0IGkyY19hZGFwdGVyICpp
MmMpCit7CisJc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYgPSBOVUxMOworCXU4IGRhdGEgPSAw
OworCisJZHByaW50aygiJXMoKVxuIixfX2Z1bmNfXyk7CisKKwlpZiAoY29uZmlnID09IE5VTEwg
fHwgaTJjID09IE5VTEwpCisJCXJldHVybiBOVUxMOworCisJcHJpdiA9IGt6YWxsb2Moc2l6ZW9m
KHN0cnVjdCBsZ3M4Z3h4X3N0YXRlKSwgR0ZQX0tFUk5FTCk7CisJaWYgKHByaXYgPT0gTlVMTCkK
KwkJZ290byBlcnJvcl9vdXQ7CisKKwlwcml2LT5jb25maWcgPSBjb25maWc7CisJcHJpdi0+aTJj
ID0gaTJjOworCisJLyogY2hlY2sgaWYgdGhlIGRlbW9kIGlzIHRoZXJlICovCisJaWYgKGxnczhn
eHhfcmVhZF9yZWcocHJpdiwgMCwgJmRhdGEpICE9IDAgLyp8fAorCQlkYXRhICE9IDB4MEIqLykg
eworCQlkcHJpbnRrKCIlcyBsZ3M4Z3h4IG5vdCBmb3VuZCBhdCBpMmMgYWRkciAweCUwMlhcbiIs
CisJCQlfX2Z1bmNfXywgcHJpdi0+Y29uZmlnLT5kZW1vZF9hZGRyZXNzKTsKKwkJZ290byBlcnJv
cl9vdXQ7CisJfQorCisJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAxLCAmZGF0YSk7CisKKwltZW1j
cHkoJnByaXYtPmZyb250ZW5kLm9wcywgJmxnczhneHhfb3BzLAorCSAgICAgICBzaXplb2Yoc3Ry
dWN0IGR2Yl9mcm9udGVuZF9vcHMpKTsKKwlwcml2LT5mcm9udGVuZC5kZW1vZHVsYXRvcl9wcml2
ID0gcHJpdjsKKworCXJldHVybiAmcHJpdi0+ZnJvbnRlbmQ7CisKK2Vycm9yX291dDoKKwlkcHJp
bnRrKCIlcygpIGVycm9yX291dFxuIiwgX19mdW5jX18pOworCWtmcmVlKHByaXYpOworCXJldHVy
biBOVUxMOworCit9CitFWFBPUlRfU1lNQk9MKGxnczhneHhfYXR0YWNoKTsKKworTU9EVUxFX0RF
U0NSSVBUSU9OKCJMZWdlbmQgU2lsaWNvbiBMR1M4OTEzL0xHUzhHWFggRE1CLVRIIGRlbW9kdWxh
dG9yIGRyaXZlciIpOworTU9EVUxFX0FVVEhPUigiRGF2aWQgVC4gTC4gV29uZyA8ZGF2aWR0bHdv
bmdAZ21haWwuY29tPiIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwpkaWZmIC1yIDYyNmMxMzZl
YzIyMSBsaW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eC5oCi0tLSAvZGV2
L251bGwJVGh1IEphbiAwMSAwMDowMDowMCAxOTcwICswMDAwCisrKyBiL2xpbnV4L2RyaXZlcnMv
bWVkaWEvZHZiL2Zyb250ZW5kcy9sZ3M4Z3h4LmgJVHVlIE1hciAxNyAyMzowNzo1NyAyMDA5ICsw
ODAwCkBAIC0wLDAgKzEsOTAgQEAKKy8qCisgKiAgICBTdXBwb3J0IGZvciBMZWdlbmQgU2lsaWNv
biBETUItVEggZGVtb2R1bGF0b3IKKyAqICAgIExHUzg5MTMsIExHUzhHTDUKKyAqICAgIGV4cGVy
aW1lbnRhbCBzdXBwb3J0IExHUzhHNDIsIExHUzhHNTIKKyAqCisgKiAgICBDb3B5cmlnaHQgKEMp
IDIwMDcsMjAwOCBEYXZpZCBULkwuIFdvbmcgPGRhdmlkdGx3b25nQGdtYWlsLmNvbT4KKyAqICAg
IENvcHlyaWdodCAoQykgMjAwOCBTaXJpdXMgSW50ZXJuYXRpb25hbCAoSG9uZyBLb25nKSBMaW1p
dGVkCisgKiAgICBUaW1vdGh5IExlZSA8dGltb3RoeS5sZWVAc2lyaXVzaGsuY29tPiAoZm9yIGlu
aXRpYWwgd29yayBvbiBMR1M4R0w1KQorICoKKyAqICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNv
ZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgICBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieQorICogICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNp
b24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uCisgKgorICogICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFO
VFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogICAgTUVSQ0hBTlRB
QklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICog
ICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAg
ICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZQorICogICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUg
dG8gdGhlIEZyZWUgU29mdHdhcmUKKyAqICAgIEZvdW5kYXRpb24sIEluYy4sIDY3NSBNYXNzIEF2
ZSwgQ2FtYnJpZGdlLCBNQSAwMjEzOSwgVVNBLgorICoKKyAqLworCisjaWZuZGVmIF9fTEdTOEdY
WF9IX18KKyNkZWZpbmUgX19MR1M4R1hYX0hfXworCisjaW5jbHVkZSA8bGludXgvZHZiL2Zyb250
ZW5kLmg+CisjaW5jbHVkZSA8bGludXgvaTJjLmg+CisKKyNkZWZpbmUgTEdTOEdYWF9QUk9EX0xH
Uzg5MTMgMAorI2RlZmluZSBMR1M4R1hYX1BST0RfTEdTOEdMNSAxCisjZGVmaW5lIExHUzhHWFhf
UFJPRF9MR1M4RzQyIDMKKyNkZWZpbmUgTEdTOEdYWF9QUk9EX0xHUzhHNTIgNAorI2RlZmluZSBM
R1M4R1hYX1BST0RfTEdTOEc1NCA1CisKK3N0cnVjdCBsZ3M4Z3h4X2NvbmZpZyB7CisKKwkvKiBw
cm9kdWN0IHR5cGUgKi8KKwl1OCBwcm9kOworCisJLyogdGhlIGRlbW9kdWxhdG9yJ3MgaTJjIGFk
ZHJlc3MgKi8KKwl1OCBkZW1vZF9hZGRyZXNzOworCisJLyogcGFyYWxsZWwgb3Igc2VyaWFsIHRy
YW5zcG9ydCBzdHJlYW0gKi8KKwl1OCBzZXJpYWxfdHM7CisKKwkvKiB0cmFuc3BvcnQgc3RyZWFt
IHBvbGFyaXR5Ki8KKwl1OCB0c19jbGtfcG9sOworCisJLyogdHJhbnNwb3J0IHN0cmVhbSBjbG9j
ayBnYXRlZCBieSB0c192YWxpZCAqLworCXU4IHRzX2Nsa19nYXRlZDsKKworCS8qIEEvRCBDbG9j
ayBmcmVxdWVuY3kgKi8KKwl1MzIgaWZfY2xrX2ZyZXE7IC8qIGluIGtIeiAqLworCisJLyogSUYg
ZnJlcXVlbmN5ICovCisJdTMyIGlmX2ZyZXE7IC8qIGluIGtIeiAqLworCisJLypVc2UgRXh0ZXJu
YWwgQURDKi8KKwl1OCBleHRfYWRjOworCisJLypFeHRlcm5hbCBBREMgb3V0cHV0IHR3bydzIGNv
bXBsZW1lbnQqLworCXU4IGFkY19zaWduZWQ7CisKKwkvKlNhbXBsZSBJRiBkYXRhIGF0IGZhbGxp
bmcgZWRnZSBvZiBJRl9DTEsqLworCXU4IGlmX25lZ19lZGdlOworCisJLypJRiB1c2UgTmVnYXRp
dmUgY2VudGVyIGZyZXF1ZW5jeSovCisJdTggaWZfbmVnX2NlbnRlcjsKKworCS8qIHNsYXZlIGFk
ZHJlc3MgYW5kIGNvbmZpZ3VyYXRpb24gb2YgdGhlIHR1bmVyICovCisJdTggdHVuZXJfYWRkcmVz
czsKK307CisKKyNpZiBkZWZpbmVkKENPTkZJR19EVkJfTEdTOEdYWCkgfHwgXAorCShkZWZpbmVk
KENPTkZJR19EVkJfTEdTOEdYWF9NT0RVTEUpICYmIGRlZmluZWQoTU9EVUxFKSkKK2V4dGVybiBz
dHJ1Y3QgZHZiX2Zyb250ZW5kICpsZ3M4Z3h4X2F0dGFjaChjb25zdCBzdHJ1Y3QgbGdzOGd4eF9j
b25maWcgKmNvbmZpZywKKwkJCQkJICAgc3RydWN0IGkyY19hZGFwdGVyICppMmMpOworI2Vsc2UK
K3N0YXRpYyBpbmxpbmUKK3N0cnVjdCBkdmJfZnJvbnRlbmQgKmxnczhneHhfYXR0YWNoKGNvbnN0
IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnLAorCQkJCSAgICBzdHJ1Y3QgaTJjX2FkYXB0
ZXIgKmkyYykgeworCXByaW50ayhLRVJOX1dBUk5JTkcgIiVzOiBkcml2ZXIgZGlzYWJsZWQgYnkg
S2NvbmZpZ1xuIiwgX19mdW5jX18pOworCXJldHVybiBOVUxMOworfQorI2VuZGlmIC8qIENPTkZJ
R19EVkJfTEdTOEdYWCAqLworCisjZW5kaWYgLyogX19MR1M4R1hYX0hfXyAqLwpkaWZmIC1yIDYy
NmMxMzZlYzIyMSBsaW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eF9wcml2
LmgKLS0tIC9kZXYvbnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAwIDE5NzAgKzAwMDAKKysrIGIvbGlu
dXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xnczhneHhfcHJpdi5oCVR1ZSBNYXIgMTcg
MjM6MDc6NTcgMjAwOSArMDgwMApAQCAtMCwwICsxLDcwIEBACisvKgorICogICAgU3VwcG9ydCBm
b3IgTGVnZW5kIFNpbGljb24gRE1CLVRIIGRlbW9kdWxhdG9yCisgKiAgICBMR1M4OTEzLCBMR1M4
R0w1CisgKiAgICBleHBlcmltZW50YWwgc3VwcG9ydCBMR1M4RzQyLCBMR1M4RzUyCisgKgorICog
ICAgQ29weXJpZ2h0IChDKSAyMDA3LDIwMDggRGF2aWQgVC5MLiBXb25nIDxkYXZpZHRsd29uZ0Bn
bWFpbC5jb20+CisgKiAgICBDb3B5cmlnaHQgKEMpIDIwMDggU2lyaXVzIEludGVybmF0aW9uYWwg
KEhvbmcgS29uZykgTGltaXRlZAorICogICAgVGltb3RoeSBMZWUgPHRpbW90aHkubGVlQHNpcml1
c2hrLmNvbT4gKGZvciBpbml0aWFsIHdvcmsgb24gTEdTOEdMNSkKKyAqCisgKiAgICBUaGlzIHBy
b2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1v
ZGlmeQorICogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICAgIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRp
b247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAgICAoYXQgeW91ciBv
cHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqICAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogICAgYnV0IFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YK
KyAqICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUKKyAqICAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCisgKgorICogICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUg
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAgICBGb3VuZGF0aW9uLCBJ
bmMuLCA2NzUgTWFzcyBBdmUsIENhbWJyaWRnZSwgTUEgMDIxMzksIFVTQS4KKyAqCisgKi8KKwor
I2lmbmRlZiBMR1M4OTEzX1BSSVZfSAorI2RlZmluZSBMR1M4OTEzX1BSSVZfSAorCitzdHJ1Y3Qg
bGdzOGd4eF9zdGF0ZSB7CisJc3RydWN0IGkyY19hZGFwdGVyICppMmM7CisJLyogY29uZmlndXJh
dGlvbiBzZXR0aW5ncyAqLworCWNvbnN0IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnOwor
CXN0cnVjdCBkdmJfZnJvbnRlbmQgZnJvbnRlbmQ7CisJdTE2IGN1cnJfZ2k7IC8qIGN1cnJlbnQg
Z3VhcmQgaW50ZXJ2YWwgKi8KK307CisKKyNkZWZpbmUgU0NfTUFTSwkJMHgxQwkvKiBTdWItQ2Fy
cmllciBNb2R1bGF0aW9uIE1hc2sgKi8KKyNkZWZpbmUgU0NfUUFNNjQJMHgxMAkvKiA2NFFBTSBt
b2R1bGF0aW9uICovCisjZGVmaW5lIFNDX1FBTTMyCTB4MEMJLyogMzJRQU0gbW9kdWxhdGlvbiAq
LworI2RlZmluZSBTQ19RQU0xNgkweDA4CS8qIDE2UUFNIG1vZHVsYXRpb24gKi8KKyNkZWZpbmUg
U0NfUUFNNE5SCTB4MDQJLyogNFFBTSBtb2R1bGF0aW9uICovCisjZGVmaW5lIFNDX1FBTTQJCTB4
MDAJLyogNFFBTSBtb2R1bGF0aW9uICovCisKKyNkZWZpbmUgTEdTX0ZFQ19NQVNLCTB4MDMJLyog
RkVDIFJhdGUgTWFzayAqLworI2RlZmluZSBMR1NfRkVDXzBfNAkweDAwCS8qIEZFQyBSYXRlIDAu
NCAqLworI2RlZmluZSBMR1NfRkVDXzBfNgkweDAxCS8qIEZFQyBSYXRlIDAuNiAqLworI2RlZmlu
ZSBMR1NfRkVDXzBfOAkweDAyCS8qIEZFQyBSYXRlIDAuOCAqLworCisjZGVmaW5lIFRJTV9NQVNL
CSAgMHgyMAkvKiBUaW1lIEludGVybGVhdmUgTGVuZ3RoIE1hc2sgKi8KKyNkZWZpbmUgVElNX0xP
TkcJICAweDAwCS8qIFRpbWUgSW50ZXJsZWF2ZSBMZW5ndGggPSA3MjAgKi8KKyNkZWZpbmUgVElN
X01JRERMRSAgICAgMHgyMCAgIC8qIFRpbWUgSW50ZXJsZWF2ZSBMZW5ndGggPSAyNDAgKi8KKwor
I2RlZmluZSBDRl9NQVNLCTB4ODAJLyogQ29udHJvbCBGcmFtZSBNYXNrICovCisjZGVmaW5lIENG
X0VOCTB4ODAJLyogQ29udHJvbCBGcmFtZSBPbiAqLworCisjZGVmaW5lIEdJX01BU0sJMHgwMwkv
KiBHdWFyZCBJbnRlcnZhbCBNYXNrICovCisjZGVmaW5lIEdJXzQyMAkweDAwCS8qIDEvOSBHdWFy
ZCBJbnRlcnZhbCAqLworI2RlZmluZSBHSV81OTUJMHgwMQkKKyNkZWZpbmUgR0lfOTQ1CTB4MDIJ
LyogMS80IEd1YXJkIEludGVydmFsICovCisKKworI2RlZmluZSBUU19QQVJBTExFTAkweDAwCS8q
IFBhcmFsbGVsIFRTIE91dHB1dCBhLmsuYS4gU1BJICovCisjZGVmaW5lIFRTX1NFUklBTAkweDAx
CS8qIFNlcmlhbCBUUyBPdXRwdXQgYS5rLmEuIFNTSSAqLworI2RlZmluZSBUU19DTEtfTk9STUFM
CQkweDAwCS8qIE1QRUcgQ2xvY2sgTm9ybWFsICovCisjZGVmaW5lIFRTX0NMS19JTlZFUlRFRAkJ
MHgwMgkvKiBNUEVHIENsb2NrIEludmVydGVkICovCisjZGVmaW5lIFRTX0NMS19HQVRFRAkJMHgw
MAkvKiBNUEVHIGNsb2NrIGdhdGVkICovCisjZGVmaW5lIFRTX0NMS19GUkVFUlVOCQkweDA0CS8q
IE1QRUcgY2xvY2sgZnJlZSBydW5uaW5nKi8KKworCisjZW5kaWYK
--000e0cd17cc03d84b00465529717--
