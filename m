Return-path: <linux-media-owner@vger.kernel.org>
Received: from perceval.ideasonboard.com ([95.142.166.194]:35654 "EHLO
	perceval.ideasonboard.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1754731AbaBUNSO (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Fri, 21 Feb 2014 08:18:14 -0500
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
To: Sakari Ailus <sakari.ailus@iki.fi>
Cc: Hans Verkuil <hverkuil@xs4all.nl>, linux-media@vger.kernel.org,
	k.debski@samsung.com
Subject: Re: [PATCH v5.1 3/7] v4l: Add timestamp source flags, mask and document them
Date: Fri, 21 Feb 2014 14:19:26 +0100
Message-ID: <3197008.QzfCa0jNuY@avalon>
In-Reply-To: <20140221130448.GC15635@valkosipuli.retiisi.org.uk>
References: <20140217232931.GW15635@valkosipuli.retiisi.org.uk> <1627498.vqEXNhvDry@avalon> <20140221130448.GC15635@valkosipuli.retiisi.org.uk>
MIME-Version: 1.0
Content-Transfer-Encoding: 7Bit
Content-Type: text/plain; charset="us-ascii"
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

Hi Sakari,

On Friday 21 February 2014 15:04:48 Sakari Ailus wrote:
> Hi Laurent,
> 
> On Fri, Feb 21, 2014 at 12:58:58PM +0100, Laurent Pinchart wrote:
> ...
> 
> > > It's possible to calculate it (decrementing the readout time + exposure
> > > time from the end of frame timestamp) and that's what the devices
> > > supposedly do. The pre-frame exposure time isn't available to the host,
> > > so the end of frame timestamp cannot be calculated by the host from the
> > > camera generated timestamp.
> > > 
> > > However the link to the host is USB which has a lot more latency than
> > > almost anything else which makes even hardware generated timestamps a
> > > little imprecise.
> > 
> > Why so ? There will be a jitter in frame arrival, but the hardware
> > timestamp should be accurate (at least if properly generated by the
> > camera firmware).
>
> Yes, the hardware timestamp should be accurate on its own, but as there's
> delay and jitter converting that into something that's relevant on the host
> adds some uncertainty. AFAIR the accuracy of the camera generated timestamp
> was still much better than that of the driver generated one, right?

Yes it is, as the conversion mechanism is stats-based and takes jitter and 
delays into account.

-- 
Regards,

Laurent Pinchart

