Return-path: <mchehab@pedra>
Received: from na3sys009aog110.obsmtp.com ([74.125.149.203]:43070 "HELO
	na3sys009aog110.obsmtp.com" rhost-flags-OK-OK-OK-OK)
	by vger.kernel.org with SMTP id S1755216Ab1ATFjF (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Thu, 20 Jan 2011 00:39:05 -0500
From: Qing Xu <qingx@marvell.com>
To: "g.liakhovetski@gmx.de" <g.liakhovetski@gmx.de>,
	Laurent Pinchart <laurent.pinchart@ideasonboard.com>
CC: "linux-media@vger.kernel.org" <linux-media@vger.kernel.org>
Date: Wed, 19 Jan 2011 21:38:55 -0800
Subject: RE: [PATCH] [media] v4l: soc-camera: add enum-frame-size ioctl
Message-ID: <7BAC95F5A7E67643AAFB2C31BEE662D014040BF848@SC-VEXCH2.marvell.com>
References: <1295500500-6261-1-git-send-email-qingx@marvell.com>
In-Reply-To: <1295500500-6261-1-git-send-email-qingx@marvell.com>
Content-Language: en-US
Content-Type: multipart/mixed;
	boundary="_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_"
MIME-Version: 1.0
List-ID: <linux-media.vger.kernel.org>
Sender: <mchehab@pedra>

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64

SGksDQoNCihhIGdlbmVyYWwgcmVxdWVzdDogY291bGQgeW91IHBsZWFzZSBjb25maWd1cmUgeW91
ciBtYWlsZXIgdG8gd3JhcCBMaW5lcyBhdCBzb21ld2hlcmUgYXJvdW5kIDcwIGNoYXJhY3RlcnM/
KQ0KTm8gbWF0dGVyIGhvdyBJIHRyeSwgaXQgc2VlbXMgdGhhdCBpdCBzdGlsbCBmYWlsIGF0IHdy
YXAgdG8gNzAgd2l0aCBteQ0KT3V0bG9vay4gOi0oICEhIVNPUlJZIGZvciB1bi1jb252ZW5pZW5j
ZSEhIQ0KDQpJIHVwZGF0ZSB0aGUgcGF0Y2ggYW5kIHRlc3Qgb2sgd2l0aCBvdXIgZHJpdmVyLiBQ
bGVhc2UgcmVmZXIgdG8NCmF0dGFjaG1lbnQsIHBhdGNoZXMgYW5kIG91ciBkcml2ZXIgc291cmNl
IGNvZGUuIEkgaGF2ZSB0ZXN0DQpweGE5NTVfY2FtX2VudW1fZnNpemVzKCkgYW5kIGRlZmF1bHRf
ZW51bV9mc2l6ZXMoKSwgYm90aCB3b3JrcyBvayBpbg0KQW5kcm9pZCBHaW5nZXJicmVhZCBjYW1l
cmEgYXBwbGljYXRpb24uDQoNCg0KLVFpbmcNCg0KLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0N
CkZyb206IFFpbmcgWHUgW21haWx0bzpxaW5neEBtYXJ2ZWxsLmNvbV0NClNlbnQ6IDIwMTHE6jHU
wjIwyNUgMTM6MTUNClRvOiBnLmxpYWtob3ZldHNraUBnbXguZGUNCkNjOiBsaW51eC1tZWRpYUB2
Z2VyLmtlcm5lbC5vcmc7IFFpbmcgWHUNClN1YmplY3Q6IFtQQVRDSF0gW21lZGlhXSB2NGw6IHNv
Yy1jYW1lcmE6IGFkZCBlbnVtLWZyYW1lLXNpemUgaW9jdGwNCg0KYWRkIHZpZGlvY19lbnVtX2Zy
YW1lc2l6ZXMgaW1wbGVtZW50YXRpb24sIGZvbGxvdyBkZWZhdWx0X2dfcGFybSgpDQphbmQgZ19t
YnVzX2ZtdCgpIG1ldGhvZA0KDQpTaWduZWQtb2ZmLWJ5OiBRaW5nIFh1IDxxaW5neEBtYXJ2ZWxs
LmNvbT4NCi0tLQ0KIGRyaXZlcnMvbWVkaWEvdmlkZW8vc29jX2NhbWVyYS5jIHwgICAzNiArKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysNCiBpbmNsdWRlL21lZGlhL3NvY19jYW1l
cmEuaCAgICAgICB8ICAgIDEgKw0KIGluY2x1ZGUvbWVkaWEvdjRsMi1zdWJkZXYuaCAgICAgIHwg
ICAgMiArKw0KIDMgZmlsZXMgY2hhbmdlZCwgMzkgaW5zZXJ0aW9ucygrKSwgMCBkZWxldGlvbnMo
LSkNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vc29jX2NhbWVyYS5jIGIvZHJp
dmVycy9tZWRpYS92aWRlby9zb2NfY2FtZXJhLmMNCmluZGV4IDA1MmJkNmQuLmM4OTAxMGEgMTAw
NjQ0DQotLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL3NvY19jYW1lcmEuYw0KKysrIGIvZHJpdmVy
cy9tZWRpYS92aWRlby9zb2NfY2FtZXJhLmMNCkBAIC0xNDUsNiArMTQ1LDE1IEBAIHN0YXRpYyBp
bnQgc29jX2NhbWVyYV9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9z
dGRfaWQgKmEpDQogICAgICAgIHJldHVybiB2NGwyX3N1YmRldl9jYWxsKHNkLCBjb3JlLCBzX3N0
ZCwgKmEpOw0KIH0NCg0KK3N0YXRpYyBpbnQgc29jX2NhbWVyYV9lbnVtX2ZzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkNCit7DQorICAgICAgIHN0cnVj
dCBzb2NfY2FtZXJhX2RldmljZSAqaWNkID0gZmlsZS0+cHJpdmF0ZV9kYXRhOw0KKyAgICAgICBz
dHJ1Y3Qgc29jX2NhbWVyYV9ob3N0ICppY2kgPSB0b19zb2NfY2FtZXJhX2hvc3QoaWNkLT5kZXYu
cGFyZW50KTsNCisNCisgICAgICAgcmV0dXJuIGljaS0+b3BzLT5lbnVtX2ZzaXplcyhpY2QsIGZz
aXplKTsNCit9DQorDQogc3RhdGljIGludCBzb2NfY2FtZXJhX3JlcWJ1ZnMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
djRsMl9yZXF1ZXN0YnVmZmVycyAqcCkNCiB7DQpAQCAtMTE2MCw2ICsxMTY5LDMwIEBAIHN0YXRp
YyBpbnQgZGVmYXVsdF9zX3Bhcm0oc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QsDQogICAg
ICAgIHJldHVybiB2NGwyX3N1YmRldl9jYWxsKHNkLCB2aWRlbywgc19wYXJtLCBwYXJtKTsNCiB9
DQoNCitzdGF0aWMgaW50IGRlZmF1bHRfZW51bV9mc2l6ZXMoc3RydWN0IHNvY19jYW1lcmFfZGV2
aWNlICppY2QsDQorICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2NGwyX2ZybXNpemVl
bnVtICpmc2l6ZSkNCit7DQorICAgICAgIGludCByZXQ7DQorICAgICAgIHN0cnVjdCB2NGwyX3N1
YmRldiAqc2QgPSBzb2NfY2FtZXJhX3RvX3N1YmRldihpY2QpOw0KKyAgICAgICBjb25zdCBzdHJ1
Y3Qgc29jX2NhbWVyYV9mb3JtYXRfeGxhdGUgKnhsYXRlOw0KKyAgICAgICBfX3UzMiBwaXhmbXQg
PSBmc2l6ZS0+cGl4ZWxfZm9ybWF0Ow0KKyAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAq
ZnNpemVfbWJ1cyA9IGZzaXplOw0KKw0KKyAgICAgICB4bGF0ZSA9IHNvY19jYW1lcmFfeGxhdGVf
YnlfZm91cmNjKGljZCwgcGl4Zm10KTsNCisgICAgICAgaWYgKCF4bGF0ZSkNCisgICAgICAgICAg
ICAgICByZXR1cm4gLUVJTlZBTDsNCisgICAgICAgLyogbWFwIHhsYXRlLWNvZGUgdG8gcGl4ZWxf
Zm9ybWF0LCBzZW5zb3Igb25seSBoYW5kbGUgeGxhdGUtY29kZSovDQorICAgICAgIGZzaXplX21i
dXMtPnBpeGVsX2Zvcm1hdCA9IHhsYXRlLT5jb2RlOw0KKw0KKyAgICAgICByZXQgPSB2NGwyX3N1
YmRldl9jYWxsKHNkLCB2aWRlbywgZW51bV9tYnVzX2ZzaXplcywgZnNpemVfbWJ1cyk7DQorICAg
ICAgIGlmIChyZXQgPCAwKQ0KKyAgICAgICAgICAgICAgIHJldHVybiByZXQ7DQorDQorICAgICAg
IGZzaXplLT5waXhlbF9mb3JtYXQgPSBwaXhmbXQ7DQorDQorICAgICAgIHJldHVybiAwOw0KK30N
CisNCiBzdGF0aWMgdm9pZCBzb2NfY2FtZXJhX2RldmljZV9pbml0KHN0cnVjdCBkZXZpY2UgKmRl
diwgdm9pZCAqcGRhdGEpDQogew0KICAgICAgICBkZXYtPnBsYXRmb3JtX2RhdGEgICAgICA9IHBk
YXRhOw0KQEAgLTExOTUsNiArMTIyOCw4IEBAIGludCBzb2NfY2FtZXJhX2hvc3RfcmVnaXN0ZXIo
c3RydWN0IHNvY19jYW1lcmFfaG9zdCAqaWNpKQ0KICAgICAgICAgICAgICAgIGljaS0+b3BzLT5z
ZXRfcGFybSA9IGRlZmF1bHRfc19wYXJtOw0KICAgICAgICBpZiAoIWljaS0+b3BzLT5nZXRfcGFy
bSkNCiAgICAgICAgICAgICAgICBpY2ktPm9wcy0+Z2V0X3Bhcm0gPSBkZWZhdWx0X2dfcGFybTsN
CisgICAgICAgaWYgKCFpY2ktPm9wcy0+ZW51bV9mc2l6ZXMpDQorICAgICAgICAgICAgICAgaWNp
LT5vcHMtPmVudW1fZnNpemVzID0gZGVmYXVsdF9lbnVtX2ZzaXplczsNCg0KICAgICAgICBtdXRl
eF9sb2NrKCZsaXN0X2xvY2spOw0KICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KGl4LCAmaG9z
dHMsIGxpc3QpIHsNCkBAIC0xMzAyLDYgKzEzMzcsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0
bDJfaW9jdGxfb3BzIHNvY19jYW1lcmFfaW9jdGxfb3BzID0gew0KICAgICAgICAudmlkaW9jX2df
aW5wdXQgICAgICAgICAgPSBzb2NfY2FtZXJhX2dfaW5wdXQsDQogICAgICAgIC52aWRpb2Nfc19p
bnB1dCAgICAgICAgICA9IHNvY19jYW1lcmFfc19pbnB1dCwNCiAgICAgICAgLnZpZGlvY19zX3N0
ZCAgICAgICAgICAgID0gc29jX2NhbWVyYV9zX3N0ZCwNCisgICAgICAgLnZpZGlvY19lbnVtX2Zy
YW1lc2l6ZXMgID0gc29jX2NhbWVyYV9lbnVtX2ZzaXplcywNCiAgICAgICAgLnZpZGlvY19yZXFi
dWZzICAgICAgICAgID0gc29jX2NhbWVyYV9yZXFidWZzLA0KICAgICAgICAudmlkaW9jX3RyeV9m
bXRfdmlkX2NhcCAgPSBzb2NfY2FtZXJhX3RyeV9mbXRfdmlkX2NhcCwNCiAgICAgICAgLnZpZGlv
Y19xdWVyeWJ1ZiAgICAgICAgID0gc29jX2NhbWVyYV9xdWVyeWJ1ZiwNCmRpZmYgLS1naXQgYS9p
bmNsdWRlL21lZGlhL3NvY19jYW1lcmEuaCBiL2luY2x1ZGUvbWVkaWEvc29jX2NhbWVyYS5oDQpp
bmRleCA4NmUzNjMxLi42ZTQ4MDBjIDEwMDY0NA0KLS0tIGEvaW5jbHVkZS9tZWRpYS9zb2NfY2Ft
ZXJhLmgNCisrKyBiL2luY2x1ZGUvbWVkaWEvc29jX2NhbWVyYS5oDQpAQCAtODUsNiArODUsNyBA
QCBzdHJ1Y3Qgc29jX2NhbWVyYV9ob3N0X29wcyB7DQogICAgICAgIGludCAoKnNldF9jdHJsKShz
dHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKiwgc3RydWN0IHY0bDJfY29udHJvbCAqKTsNCiAgICAg
ICAgaW50ICgqZ2V0X3Bhcm0pKHN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqLCBzdHJ1Y3QgdjRs
Ml9zdHJlYW1wYXJtICopOw0KICAgICAgICBpbnQgKCpzZXRfcGFybSkoc3RydWN0IHNvY19jYW1l
cmFfZGV2aWNlICosIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKik7DQorICAgICAgIGludCAoKmVu
dW1fZnNpemVzKShzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKiwgc3RydWN0IHY0bDJfZnJtc2l6
ZWVudW0gKik7DQogICAgICAgIHVuc2lnbmVkIGludCAoKnBvbGwpKHN0cnVjdCBmaWxlICosIHBv
bGxfdGFibGUgKik7DQogICAgICAgIGNvbnN0IHN0cnVjdCB2NGwyX3F1ZXJ5Y3RybCAqY29udHJv
bHM7DQogICAgICAgIGludCBudW1fY29udHJvbHM7DQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9tZWRp
YS92NGwyLXN1YmRldi5oIGIvaW5jbHVkZS9tZWRpYS92NGwyLXN1YmRldi5oDQppbmRleCBiMDMx
NmE3Li4wZDQ4MmM5IDEwMDY0NA0KLS0tIGEvaW5jbHVkZS9tZWRpYS92NGwyLXN1YmRldi5oDQor
KysgYi9pbmNsdWRlL21lZGlhL3Y0bDItc3ViZGV2LmgNCkBAIC0yNzUsNiArMjc1LDggQEAgc3Ry
dWN0IHY0bDJfc3ViZGV2X3ZpZGVvX29wcyB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKTsNCiAgICAgICAgaW50ICgqZW51bV9tYnVzX2Zt
dCkoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwgdW5zaWduZWQgaW50IGluZGV4LA0KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBlbnVtIHY0bDJfbWJ1c19waXhlbGNvZGUgKmNvZGUpOw0KKyAg
ICAgICBpbnQgKCplbnVtX21idXNfZnNpemVzKShzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLA0KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUp
Ow0KICAgICAgICBpbnQgKCpnX21idXNfZm10KShzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLA0KICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdjRsMl9tYnVzX2ZyYW1lZm10ICpmbXQpOw0K
ICAgICAgICBpbnQgKCp0cnlfbWJ1c19mbXQpKHN0cnVjdCB2NGwyX3N1YmRldiAqc2QsDQotLQ0K
MS42LjMuMw0KDQo=

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_
Content-Type: application/octet-stream;
	name="0001-camera-soc-camera-add-enum-frame-sizes.patch"
Content-Description: 0001-camera-soc-camera-add-enum-frame-sizes.patch
Content-Disposition: attachment;
	filename="0001-camera-soc-camera-add-enum-frame-sizes.patch"; size=4150;
	creation-date="Wed, 19 Jan 2011 21:12:46 GMT";
	modification-date="Wed, 19 Jan 2011 21:12:46 GMT"
Content-Transfer-Encoding: base64

RnJvbSA3ZTNkNjY5YTU4YjhkZmY4NzE5N2Q1NWQ1ZWM3OTFjNzZjZjYwMmNjIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBRaW5nIFh1IDxxaW5neEBtYXJ2ZWxsLmNvbT4KRGF0ZTogVGh1
LCAyMCBKYW4gMjAxMSAxMzoxMDowNyArMDgwMApTdWJqZWN0OiBbUEFUQ0ggMS8yXSBjYW1lcmE6
IHNvYy1jYW1lcmEgYWRkIGVudW0tZnJhbWUtc2l6ZXMKCkNoYW5nZS1JZDogSThmODY2ZDUyN2I0
MGU2NzQxZWNkMDI4MWZhMzAyOGQ5MzM0MjY1ZmUKClNpZ25lZC1vZmYtYnk6IFFpbmcgWHUgPHFp
bmd4QG1hcnZlbGwuY29tPgotLS0KIGRyaXZlcnMvbWVkaWEvdmlkZW8vc29jX2NhbWVyYS5jIHwg
ICAzNyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBpbmNsdWRlL21lZGlh
L3NvY19jYW1lcmEuaCAgICAgICB8ICAgIDEgKwogaW5jbHVkZS9tZWRpYS92NGwyLXN1YmRldi5o
ICAgICAgfCAgICAyICsrCiAzIGZpbGVzIGNoYW5nZWQsIDQwIGluc2VydGlvbnMoKyksIDAgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9zb2NfY2FtZXJhLmMg
Yi9kcml2ZXJzL21lZGlhL3ZpZGVvL3NvY19jYW1lcmEuYwppbmRleCA0YjJmMTFlLi44YTdjMzNi
IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL3NvY19jYW1lcmEuYworKysgYi9kcml2
ZXJzL21lZGlhL3ZpZGVvL3NvY19jYW1lcmEuYwpAQCAtMTUyLDYgKzE1MiwxNiBAQCBzdGF0aWMg
aW50IHNvY19jYW1lcmFfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkICphKQogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHNkLCBjb3JlLCBzX3N0ZCwgKmEp
OwogfQogCitzdGF0aWMgaW50IHNvY19jYW1lcmFfZW51bV9mc2l6ZXMoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAorCQkJCQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQorewor
CXN0cnVjdCBzb2NfY2FtZXJhX2ZpbGUgKmljZiA9IGZpbGUtPnByaXZhdGVfZGF0YTsKKwlzdHJ1
Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZCA9IGljZi0+aWNkOworCXN0cnVjdCBzb2NfY2FtZXJh
X2hvc3QgKmljaSA9IHRvX3NvY19jYW1lcmFfaG9zdChpY2QtPmRldi5wYXJlbnQpOworCisJcmV0
dXJuIGljaS0+b3BzLT5lbnVtX2ZzaXplcyhpY2QsIGZzaXplKTsKK30KKwogc3RhdGljIGludCBz
b2NfY2FtZXJhX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQkgICAg
ICBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAqcCkKIHsKQEAgLTExNDcsNiArMTE1NywzMCBA
QCBzdGF0aWMgaW50IGRlZmF1bHRfc19jcm9wKHN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqaWNk
LCBzdHJ1Y3QgdjRsMl9jcm9wICphKQogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHNkLCB2aWRl
bywgc19jcm9wLCBhKTsKIH0KIAorc3RhdGljIGludCBkZWZhdWx0X2VudW1fZnNpemVzKHN0cnVj
dCBzb2NfY2FtZXJhX2RldmljZSAqaWNkLAorCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAq
ZnNpemUpCit7CisJaW50IHJldDsKKwlzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkID0gc29jX2NhbWVy
YV90b19zdWJkZXYoaWNkKTsKKwljb25zdCBzdHJ1Y3Qgc29jX2NhbWVyYV9mb3JtYXRfeGxhdGUg
KnhsYXRlOworCV9fdTMyIHBpeGZtdCA9IGZzaXplLT5waXhlbF9mb3JtYXQ7CisJc3RydWN0IHY0
bDJfZnJtc2l6ZWVudW0gKmZzaXplX21idXMgPSBmc2l6ZTsKKworCXhsYXRlID0gc29jX2NhbWVy
YV94bGF0ZV9ieV9mb3VyY2MoaWNkLCBwaXhmbXQpOworCWlmICgheGxhdGUpCisJCXJldHVybiAt
RUlOVkFMOworCS8qIG1hcCB4bGF0ZS1jb2RlIHRvIHBpeGVsX2Zvcm1hdCwgc2Vuc29yIG9ubHkg
aGFuZGxlIHhsYXRlLWNvZGUqLworCWZzaXplX21idXMtPnBpeGVsX2Zvcm1hdCA9IHhsYXRlLT5j
b2RlOworCisJcmV0ID0gdjRsMl9zdWJkZXZfY2FsbChzZCwgdmlkZW8sIGVudW1fbWJ1c19mc2l6
ZXMsIGZzaXplX21idXMpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJZnNpemUt
PnBpeGVsX2Zvcm1hdCA9IHBpeGZtdDsKKworCXJldHVybiAwOworfQorCiBzdGF0aWMgdm9pZCBz
b2NfY2FtZXJhX2RldmljZV9pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqcGRhdGEpCiB7
CiAJZGV2LT5wbGF0Zm9ybV9kYXRhCT0gcGRhdGE7CkBAIC0xMTc4LDYgKzEyMTIsOCBAQCBpbnQg
c29jX2NhbWVyYV9ob3N0X3JlZ2lzdGVyKHN0cnVjdCBzb2NfY2FtZXJhX2hvc3QgKmljaSkKIAkJ
aWNpLT5vcHMtPmdldF9jcm9wID0gZGVmYXVsdF9nX2Nyb3A7CiAJaWYgKCFpY2ktPm9wcy0+Y3Jv
cGNhcCkKIAkJaWNpLT5vcHMtPmNyb3BjYXAgPSBkZWZhdWx0X2Nyb3BjYXA7CisJaWYgKCFpY2kt
Pm9wcy0+ZW51bV9mc2l6ZXMpCisJCWljaS0+b3BzLT5lbnVtX2ZzaXplcyA9IGRlZmF1bHRfZW51
bV9mc2l6ZXM7CiAKIAltdXRleF9sb2NrKCZsaXN0X2xvY2spOwogCWxpc3RfZm9yX2VhY2hfZW50
cnkoaXgsICZob3N0cywgbGlzdCkgewpAQCAtMTI4NSw2ICsxMzIxLDcgQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCB2NGwyX2lvY3RsX29wcyBzb2NfY2FtZXJhX2lvY3RsX29wcyA9IHsKIAkudmlkaW9j
X2dfaW5wdXQJCSA9IHNvY19jYW1lcmFfZ19pbnB1dCwKIAkudmlkaW9jX3NfaW5wdXQJCSA9IHNv
Y19jYW1lcmFfc19pbnB1dCwKIAkudmlkaW9jX3Nfc3RkCQkgPSBzb2NfY2FtZXJhX3Nfc3RkLAor
CS52aWRpb2NfZW51bV9mcmFtZXNpemVzICA9IHNvY19jYW1lcmFfZW51bV9mc2l6ZXMsCiAJLnZp
ZGlvY19yZXFidWZzCQkgPSBzb2NfY2FtZXJhX3JlcWJ1ZnMsCiAJLnZpZGlvY190cnlfZm10X3Zp
ZF9jYXAgID0gc29jX2NhbWVyYV90cnlfZm10X3ZpZF9jYXAsCiAJLnZpZGlvY19xdWVyeWJ1Zgkg
PSBzb2NfY2FtZXJhX3F1ZXJ5YnVmLApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9tZWRpYS9zb2NfY2Ft
ZXJhLmggYi9pbmNsdWRlL21lZGlhL3NvY19jYW1lcmEuaAppbmRleCA2ZmIxODZhLi4zYTQ2N2Zm
IDEwMDY0NAotLS0gYS9pbmNsdWRlL21lZGlhL3NvY19jYW1lcmEuaAorKysgYi9pbmNsdWRlL21l
ZGlhL3NvY19jYW1lcmEuaApAQCAtODMsNiArODMsNyBAQCBzdHJ1Y3Qgc29jX2NhbWVyYV9ob3N0
X29wcyB7CiAJaW50ICgqc2V0X2N0cmwpKHN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqLCBzdHJ1
Y3QgdjRsMl9jb250cm9sICopOwogCWludCAoKmdldF9wYXJtKShzdHJ1Y3Qgc29jX2NhbWVyYV9k
ZXZpY2UgKiwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqKTsKIAlpbnQgKCpzZXRfcGFybSkoc3Ry
dWN0IHNvY19jYW1lcmFfZGV2aWNlICosIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKik7CisJaW50
ICgqZW51bV9mc2l6ZXMpKHN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqLCBzdHJ1Y3QgdjRsMl9m
cm1zaXplZW51bSAqKTsKIAl1bnNpZ25lZCBpbnQgKCpwb2xsKShzdHJ1Y3QgZmlsZSAqLCBwb2xs
X3RhYmxlICopOwogCWNvbnN0IHN0cnVjdCB2NGwyX3F1ZXJ5Y3RybCAqY29udHJvbHM7CiAJaW50
IG51bV9jb250cm9sczsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVkaWEvdjRsMi1zdWJkZXYuaCBi
L2luY2x1ZGUvbWVkaWEvdjRsMi1zdWJkZXYuaAppbmRleCAwMmM2ZjRkLi5mNjU5MzljIDEwMDY0
NAotLS0gYS9pbmNsdWRlL21lZGlhL3Y0bDItc3ViZGV2LmgKKysrIGIvaW5jbHVkZS9tZWRpYS92
NGwyLXN1YmRldi5oCkBAIC0yNDgsNiArMjQ4LDggQEAgc3RydWN0IHY0bDJfc3ViZGV2X3ZpZGVv
X29wcyB7CiAJCQlzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKTsKIAlpbnQgKCplbnVt
X21idXNfZm10KShzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCB1bnNpZ25lZCBpbnQgaW5kZXgsCiAJ
CQkgICAgIGVudW0gdjRsMl9tYnVzX3BpeGVsY29kZSAqY29kZSk7CisJaW50ICgqZW51bV9tYnVz
X2ZzaXplcykoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKKwkJCSAgICAgc3RydWN0IHY0bDJfZnJt
c2l6ZWVudW0gKmZzaXplKTsKIAlpbnQgKCpnX21idXNfZm10KShzdHJ1Y3QgdjRsMl9zdWJkZXYg
KnNkLAogCQkJICBzdHJ1Y3QgdjRsMl9tYnVzX2ZyYW1lZm10ICpmbXQpOwogCWludCAoKnRyeV9t
YnVzX2ZtdCkoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKLS0gCjEuNi4zLjMKCg==

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_
Content-Type: application/octet-stream;
	name="0002-ARM-pxa-soc-camera-add-enum-frame-sizes.patch"
Content-Description: 0002-ARM-pxa-soc-camera-add-enum-frame-sizes.patch
Content-Disposition: attachment;
	filename="0002-ARM-pxa-soc-camera-add-enum-frame-sizes.patch"; size=3472;
	creation-date="Wed, 19 Jan 2011 21:12:46 GMT";
	modification-date="Wed, 19 Jan 2011 21:12:46 GMT"
Content-Transfer-Encoding: base64

RnJvbSAzMzIwZDBkZWJhN2IyNzllYmM2MzkwZDc0ZThiMTk5Mzg3OTZlZjUxIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBRaW5nIFh1IDxxaW5neEBtYXJ2ZWxsLmNvbT4KRGF0ZTogVGh1
LCAyMCBKYW4gMjAxMSAxMzoxMTowOCArMDgwMApTdWJqZWN0OiBbUEFUQ0ggMi8yXSBBUk06IHB4
YTogc29jLWNhbWVyYSBhZGQgZW51bS1mcmFtZS1zaXplcwoKQ2hhbmdlLUlkOiBJYzkxYmIzODMz
MzNmZTIyMmYxNWQ5MDIxN2U0YjU5ZWM1MzBkNTk2OQoKU2lnbmVkLW9mZi1ieTogUWluZyBYdSA8
cWluZ3hAbWFydmVsbC5jb20+Ci0tLQogZHJpdmVycy9tZWRpYS92aWRlby9vdjU2NDIuYyAgICAg
fCAgIDE0ICsrKysrKystLS0tLS0tCiBkcml2ZXJzL21lZGlhL3ZpZGVvL3B4YTk1NV9jYW0uYyB8
ICAgMjUgKysrKysrKysrKysrKysrKysrKysrKysrKwogMiBmaWxlcyBjaGFuZ2VkLCAzMiBpbnNl
cnRpb25zKCspLCA3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdmlk
ZW8vb3Y1NjQyLmMgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL292NTY0Mi5jCmluZGV4IGJkOTNiNzMu
LjY4MjZlYzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8vb3Y1NjQyLmMKKysrIGIv
ZHJpdmVycy9tZWRpYS92aWRlby9vdjU2NDIuYwpAQCAtNzA4LDE3ICs3MDgsMTcgQEAgc3RhdGlj
IGludCBvdjU2NDJfZ19mbXQoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBvdjU2NDJfZW51bV9mcmFtZXNpemVzKHN0cnVjdCB2NGwyX3N1YmRldiAq
c2QsCitzdGF0aWMgaW50IG92NTY0Ml9lbnVtX2ZzaXplcyhzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNk
LAogCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQgPSBzZC0+cHJpdjsKIAogCWZzaXplLT50eXBlID0gVjRMMl9GUk1TSVpFX1RZ
UEVfRElTQ1JFVEU7CisKKwkvKiBhYnVzZSBwaXhlbF9mb3JtYXQsIGluIGZhY3QsIGl0IGlzIHhs
YXRlLT5jb2RlKi8KIAlzd2l0Y2ggKGZzaXplLT5waXhlbF9mb3JtYXQpIHsKLQkJY2FzZSBWNEwy
X1BJWF9GTVRfVVlWWToKLQkJY2FzZSBWNEwyX1BJWF9GTVRfWVVWNDIyUDoKLQkJY2FzZSBWNEwy
X1BJWF9GTVRfWVVWNDIwOgotCQljYXNlIFY0TDJfUElYX0ZNVF9SR0I1NjU6CisJCWNhc2UgVjRM
Ml9NQlVTX0ZNVF9ZVVlWOF8yWDhfQkU6CisJCWNhc2UgVjRMMl9NQlVTX0ZNVF9SR0I1NjVfMlg4
X0xFOgogCQkJaWYgKGZzaXplLT5pbmRleCA+PSBOX09WNTY0Ml9TSVpFUykgewogCQkJCWRldl93
YXJuKCZjbGllbnQtPmRldiwgIm92NTY0MiB1bnN1cHBvcnRlZCBzaXplIVxuIik7CiAJCQkJcmV0
dXJuIC1FSU5WQUw7CkBAIC03MjYsNyArNzI2LDcgQEAgc3RhdGljIGludCBvdjU2NDJfZW51bV9m
cmFtZXNpemVzKHN0cnVjdCB2NGwyX3N1YmRldiAqc2QsCiAJCQlmc2l6ZS0+ZGlzY3JldGUuaGVp
Z2h0ID0gb3Y1NjQyX3NpemVzW2ZzaXplLT5pbmRleF0uaGVpZ2h0OwogCQkJZnNpemUtPmRpc2Ny
ZXRlLndpZHRoID0gb3Y1NjQyX3NpemVzW2ZzaXplLT5pbmRleF0ud2lkdGg7CiAJCQlicmVhazsK
LQkJY2FzZSBWNEwyX1BJWF9GTVRfSlBFRzoKKwkJY2FzZSBWNEwyX01CVVNfRk1UX0pQRUdfMVg4
OgogCQkJaWYgKGZzaXplLT5pbmRleCA+PSBOX09WNTY0Ml9TSVpFU19KUEVHKSB7CiAJCQkJZGV2
X3dhcm4oJmNsaWVudC0+ZGV2LCAib3Y1NjQyIHVuc3VwcG9ydGVkIGpwZWcgc2l6ZSFcbiIpOwog
CQkJCXJldHVybiAtRUlOVkFMOwpAQCAtODUxLDcgKzg1MSw3IEBAIHN0YXRpYyBzdHJ1Y3QgdjRs
Ml9zdWJkZXZfdmlkZW9fb3BzIG92NTY0Ml9zdWJkZXZfdmlkZW9fb3BzID0gewogCS5nX21idXNf
Zm10CT0gb3Y1NjQyX2dfZm10LAogCS50cnlfbWJ1c19mbXQJPSBvdjU2NDJfdHJ5X2ZtdCwKIAku
ZW51bV9tYnVzX2ZtdAk9IG92NTY0Ml9lbnVtX2ZtdCwKLQkuZW51bV9mcmFtZXNpemVzID0gb3Y1
NjQyX2VudW1fZnJhbWVzaXplcywKKwkuZW51bV9tYnVzX2ZzaXplcyA9IG92NTY0Ml9lbnVtX2Zz
aXplcywKIH07CiAKIHN0YXRpYyBzdHJ1Y3QgdjRsMl9zdWJkZXZfb3BzIG92NTY0Ml9zdWJkZXZf
b3BzID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9weGE5NTVfY2FtLmMgYi9k
cml2ZXJzL21lZGlhL3ZpZGVvL3B4YTk1NV9jYW0uYwppbmRleCBjMWJkYTJiLi45ODcxOGNjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3ZpZGVvL3B4YTk1NV9jYW0uYworKysgYi9kcml2ZXJz
L21lZGlhL3ZpZGVvL3B4YTk1NV9jYW0uYwpAQCAtMTMzNyw2ICsxMzM3LDMwIEBAIHN0YXRpYyBp
bnQgcHhhOTU1X2NhbV9zZXRfcGFyYW0oc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QsCiAJ
cmV0dXJuIDA7CiB9CiAKK3N0YXRpYyBpbnQgcHhhOTU1X2NhbV9lbnVtX2ZzaXplcyhzdHJ1Y3Qg
c29jX2NhbWVyYV9kZXZpY2UgKmljZCwKKwkJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZz
aXplcykKK3sKKwlpbnQgcmV0OworCXN0cnVjdCB2NGwyX3N1YmRldiAqc2QgPSBzb2NfY2FtZXJh
X3RvX3N1YmRldihpY2QpOworCWNvbnN0IHN0cnVjdCBzb2NfY2FtZXJhX2Zvcm1hdF94bGF0ZSAq
eGxhdGU7CisJX191MzIgcGl4Zm10ID0gZnNpemVzLT5waXhlbF9mb3JtYXQ7CisJc3RydWN0IHY0
bDJfZnJtc2l6ZWVudW0gKmZzaXplX21idXMgPSBmc2l6ZXM7CisKKwl4bGF0ZSA9IHNvY19jYW1l
cmFfeGxhdGVfYnlfZm91cmNjKGljZCwgcGl4Zm10KTsKKwlpZiAoIXhsYXRlKQorCQlyZXR1cm4g
LUVJTlZBTDsKKworCS8qIG1hcCB4bGF0ZS1jb2RlIHRvIHBpeGVsX2Zvcm1hdCwgc2Vuc29yIG9u
bHkgaGFuZGxlIHhsYXRlLWNvZGUqLworCWZzaXplX21idXMtPnBpeGVsX2Zvcm1hdCA9IHhsYXRl
LT5jb2RlOworCisJcmV0ID0gdjRsMl9zdWJkZXZfY2FsbChzZCwgdmlkZW8sIGVudW1fbWJ1c19m
c2l6ZXMsIGZzaXplX21idXMpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCisJZnNp
emVzLT5waXhlbF9mb3JtYXQgPSBwaXhmbXQ7CisKKwlyZXR1cm4gMDsKK30KIAogc3RhdGljIHN0
cnVjdCBzb2NfY2FtZXJhX2hvc3Rfb3BzIHB4YTk1NV9zb2NfY2FtX2hvc3Rfb3BzID0gewogCS5v
d25lcgkJPSBUSElTX01PRFVMRSwKQEAgLTEzNTIsNiArMTM3Niw3IEBAIHN0YXRpYyBzdHJ1Y3Qg
c29jX2NhbWVyYV9ob3N0X29wcyBweGE5NTVfc29jX2NhbV9ob3N0X29wcyA9IHsKIAkucXVlcnlj
YXAJPSBweGE5NTVfY2FtX3F1ZXJ5Y2FwLAogCS5zZXRfYnVzX3BhcmFtCT0gcHhhOTU1X2NhbV9z
ZXRfYnVzX3BhcmFtLAogCS5zZXRfcGFybSA9IHB4YTk1NV9jYW1fc2V0X3BhcmFtLAorCS5lbnVt
X2ZzaXplcyA9IHB4YTk1NV9jYW1fZW51bV9mc2l6ZXMsCiB9OwogCiBzdGF0aWMgaXJxcmV0dXJu
X3QgcHhhOTU1X2NhbV9pcnEoaW50IGlycSwgdm9pZCAqZGF0YSkKLS0gCjEuNi4zLjMKCg==

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_
Content-Type: text/plain; name="ov5642.c"
Content-Description: ov5642.c
Content-Disposition: attachment; filename="ov5642.c"; size=24330;
	creation-date="Wed, 19 Jan 2011 19:53:54 GMT";
	modification-date="Wed, 19 Jan 2011 19:53:54 GMT"
Content-Transfer-Encoding: base64

LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CgoqIERyaXZlciBmb3IgT21uaVZpc2lvbiBDTU9TIEltYWdlIFNlbnNvcgoqCiogQ29weXJpZ2h0
IChDKSAyMDEwLCBNYXJ2ZWxsIEludGVybmF0aW9uYWwgTHRkLgoqCQkJCVFpbmcgWHUgPHFpbmd4
QG1hcnZlbGwuY29tPgoqCiogQmFzZWQgb24gbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9tdDlt
MDAxLmMKKgoqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSB2ZXJzaW9uIDIgYXMKKiBwdWJsaXNoZWQgYnkgdGhlIEZyZWUg
U29mdHdhcmUgRm91bmRhdGlvbi4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0qLwojaW5jbHVkZSA8bGludXgvaW5pdC5oPgojaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+CiNpbmNsdWRlIDxsaW51eC9zbGFiLmg+CiNpbmNsdWRlIDxsaW51eC9k
ZWxheS5oPgojaW5jbHVkZSA8bGludXgvdmlkZW9kZXYyLmg+CiNpbmNsdWRlIDxsaW51eC9pMmMu
aD4KCiNpbmNsdWRlICJvdjU2NDIuaCIKCiNpbmNsdWRlIDxtZWRpYS92NGwyLWNvbW1vbi5oPgoj
aW5jbHVkZSA8bWVkaWEvdjRsMi1jaGlwLWlkZW50Lmg+CiNpbmNsdWRlIDxtZWRpYS9zb2NfY2Ft
ZXJhLmg+CgovKgoqIGZsYXNoIG1vZGU6CiogMDAgQ29udGlub3VzIGZsYXNoLCBmbGFzaCBvbiB3
aGVuIG9uIHJlcSBmbGFzaCBvZmYgd2hlbiBvZmYgcmVxLgoqIDAxIE9uZSBmbGFzaCwgdGhlIGZs
YXNoIHN0cm9iZSBpcyBvcGVuZWQgZm9yIGEgcGVyaW9kIG9mIHRpbWUgc3BlY2lmaWVkCiogYnkg
aGlnaCAzIGJ5dGVzLgoqIDEwIHBlcmlvZGljIGZsYXNoLCB0aGUgZmxhc2ggaXMgb24gcGVyaW9k
aWNsbHkgdGhlIHBlcmlvZCBpcyBzcGVjaWZpZWQKKiBieSBoaWdoIDMgYnl0ZXMuCiogMTEgcHVs
c2UgZmxhc2gsIGZsYXNoIG9uZSB0aW1lIGZvciBhIHZlcnkgc2hvcnQgcHVsc2UsIHdpZHRoIG9m
IHRoZQoqIHB1bHNlIGlzIHNwZWNpZmllZCBieSBiaXQKKi8Kc3RydWN0IGZsYXNoX3N0cnVjdCB7
Cgl1bnNpZ25lZCBjaGFyCW1vZGU7Cgl1bnNpZ25lZCBjaGFyCWJyaWdodG5lc3M7Cgl1bnNpZ25l
ZCBpbnQgCWR1cmF0aW9uOwp9OwoKLyogb3Y1NjQyIGhhcyBvbmx5IG9uZSBmaXhlZCBjb2xvcnNw
YWNlIHBlciBwaXhlbGNvZGUgKi8Kc3RydWN0IG92NTY0Ml9kYXRhZm10IHsKCWVudW0gdjRsMl9t
YnVzX3BpeGVsY29kZQljb2RlOwoJZW51bSB2NGwyX2NvbG9yc3BhY2UJCWNvbG9yc3BhY2U7Cn07
CgpzdHJ1Y3Qgb3Y1NjQyIHsKCXN0cnVjdCB2NGwyX3N1YmRldiBzdWJkZXY7CglpbnQgbW9kZWw7
CS8qIFY0TDJfSURFTlRfT1Y1NjQyKiBjb2RlcyBmcm9tIHY0bDItY2hpcC1pZGVudC5oICovCglz
dHJ1Y3QgdjRsMl9yZWN0IHJlY3Q7Cgl1MzIgcGl4Zm10OwoJY29uc3Qgc3RydWN0IG92NTY0Ml9k
YXRhZm10ICpjdXJmbXQ7Cgljb25zdCBzdHJ1Y3Qgb3Y1NjQyX2RhdGFmbXQgKmZtdHM7CglpbnQg
bnVtX2ZtdHM7CgoJc3RydWN0IGZsYXNoX3N0cnVjdCBmbGFzaDsJLyogRmxhc2ggc3Ryb2JlIHJl
bGF0ZWQgaW5mbyAqLwoJc3RydWN0IHJlZ3ZhbF9saXN0ICpyZWdzX2ZtdDsKCXN0cnVjdCByZWd2
YWxfbGlzdCAqcmVnc19zaXplOwp9OwoKc3RhdGljIGNvbnN0IHN0cnVjdCBvdjU2NDJfZGF0YWZt
dCBvdjU2NDJfY29sb3VyX2ZtdHNbXSA9IHsKCXtWNEwyX01CVVNfRk1UX1lVWVY4XzJYOF9CRSwg
VjRMMl9DT0xPUlNQQUNFX0pQRUd9LAoJe1Y0TDJfTUJVU19GTVRfSlBFR18xWDgsIFY0TDJfQ09M
T1JTUEFDRV9KUEVHfSwKCXtWNEwyX01CVVNfRk1UX1JHQjU2NV8yWDhfTEUsIFY0TDJfQ09MT1JT
UEFDRV9TUkdCfQp9OwoKLyoKKiBTdG9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdmlkZW8gZGF0
YSBmb3JtYXQuICBUaGUgY29sb3IgbWF0cml4CiogaXMgZGVlcGx5IHRpZWQgaW50byB0aGUgZm9y
bWF0LCBzbyBrZWVwIHRoZSByZWxldmFudCB2YWx1ZXMgaGVyZS4KKiBUaGUgbWFnaWMgbWF0cml4
IG51Ym1lcnMgY29tZSBmcm9tIE9tbmlWaXNpb24uCiovCnN0YXRpYyBzdHJ1Y3Qgb3Y1NjQyX2Zv
cm1hdF9zdHJ1Y3QgewoJZW51bSB2NGwyX21idXNfcGl4ZWxjb2RlCWNvZGU7CglzdHJ1Y3QgcmVn
dmFsX2xpc3QJKnJlZ3M7Cn0gb3Y1NjQyX2ZtdHNbXSA9IHsKCXsKCQkuY29kZSA9IFY0TDJfTUJV
U19GTVRfWVVZVjhfMlg4X0xFLAoJCS5yZWdzID0gb3Y1NjQyX2ZtdF95dXY0MjIsCgl9LHsKCQku
Y29kZSA9IFY0TDJfTUJVU19GTVRfWVZZVThfMlg4X0xFLAoJCS5yZWdzID0gb3Y1NjQyX2ZtdF95
dXY0MjIsCgl9LHsKCQkuY29kZSA9IFY0TDJfTUJVU19GTVRfWVVZVjhfMlg4X0JFLAoJCS5yZWdz
ID0gb3Y1NjQyX2ZtdF95dXY0MjIsCgl9LHsKCQkuY29kZSA9IFY0TDJfTUJVU19GTVRfWVZZVThf
Mlg4X0JFLAoJCS5yZWdzID0gb3Y1NjQyX2ZtdF95dXY0MjIsCgl9LHsKCQkuY29kZSA9IFY0TDJf
TUJVU19GTVRfSlBFR18xWDgsCgkJLnJlZ3MgPSBvdjU2NDJfZm10X2pwZywKCX0sewoJCS5jb2Rl
ID0gVjRMMl9NQlVTX0ZNVF9SR0I1NjVfMlg4X0xFLAoJCS5yZWdzID0gb3Y1NjQyX2ZtdF9yZ2I1
NjUsCgl9LAp9OwoKc3RhdGljIHN0cnVjdCBvdjU2NDJfd2luX3NpemUgewoJaW50CXdpZHRoOwoJ
aW50CWhlaWdodDsKCXN0cnVjdCByZWd2YWxfbGlzdCAqcmVnczsKfSBvdjU2NDJfc2l6ZXNbXSA9
IHsKCXsKCQkud2lkdGggPSAzMjAsCgkJLmhlaWdodCA9IDI0MCwKCQkucmVncyA9IG92NTY0Ml9y
ZXNfcXZnYSwvKiBRVkdBICovCgl9LCB7CgkJLndpZHRoID0gNDgwLAoJCS5oZWlnaHQgPSAzMjAs
CgkJLnJlZ3MgPSBvdjU2NDJfcmVzX2hhbGZfdmdhLC8qIGhhbGYgVkdBICovCgl9LCB7CgkJLndp
ZHRoID0gNjQwLAoJCS5oZWlnaHQgPSA0ODAsCgkJLnJlZ3MgPSBvdjU2NDJfcmVzX3ZnYSwvKiBW
R0EgKi8KCX0sIHsKCQkud2lkdGggPSA4MDAsCgkJLmhlaWdodCA9IDQ4MCwKCQkucmVncyA9IG92
NTY0Ml9yZXNfd3ZnYSwvKiBXVkdBICovCgl9LCB7CgkJLndpZHRoID0gMjU5MiwKCQkuaGVpZ2h0
ID0gMTk0NCwKCQkucmVncyA9IG92NTY0Ml9yZXNfNU0sLyo1TSAyNTkyeDE5NDQqLwoJfSwgewoJ
CS53aWR0aCA9IDE5MjAsCgkJLmhlaWdodCA9IDEwODAsCgkJLnJlZ3MgPSBvdjU2NDJfcmVzXzEw
ODBQLC8qMTA4MHAgMTkyMHgxMDgwICovCgl9LCB7CgkJLndpZHRoID0gMTI4MCwKCQkuaGVpZ2h0
ID0gNzIwLAoJCS5yZWdzID0gb3Y1NjQyX3Jlc183MjBQLC8qIDEyODB4NzIwICovCgl9LAp9OwoK
c3RhdGljIHN0cnVjdCBvdjU2NDJfd2luX3NpemUgb3Y1NjQyX3NpemVzX2pwZWdbXSA9IHsKCXsK
CQkud2lkdGggPSAzMjAsCgkJLmhlaWdodCA9IDI0MCwKCQkucmVncyA9IG92NTY0Ml9yZXNfcXZn
YSwvKiBRVkdBICovCgl9LCB7CgkJLndpZHRoID0gNjQwLAoJCS5oZWlnaHQgPSA0ODAsCgkJLnJl
Z3MgPSBvdjU2NDJfcmVzX3ZnYSwJLyogVkdBICovCgl9LCB7CgkJLndpZHRoID0gMjU5MiwKCQku
aGVpZ2h0ID0gMTk0NCwKCQkucmVncyA9IG92NTY0Ml9yZXNfNU0sLyo1TSAyNTkyeDE5NDQqLwoJ
fSwKfTsKCiNkZWZpbmUgTl9PVjU2NDJfRk1UUyBBUlJBWV9TSVpFKG92NTY0Ml9mbXRzKQojZGVm
aW5lIE5fT1Y1NjQyX1NJWkVTIEFSUkFZX1NJWkUob3Y1NjQyX3NpemVzKQojZGVmaW5lIE5fT1Y1
NjQyX1NJWkVTX0pQRUcgQVJSQVlfU0laRShvdjU2NDJfc2l6ZXNfanBlZykKI2RlZmluZSBKUEVH
X0JVRl9TSVpFICgxMDI0KjEwMjQpCgplbnVtIGZsYXNoX2FyZ19mb3JtYXQgewoJRkxBU0hfQVJH
X1RJTUVfT0ZGCT0gMCwKCUZMQVNIX0FSR19NT0RFXzAJPSAwLAoJRkxBU0hfQVJHX01PREVfMSwK
CUZMQVNIX0FSR19NT0RFXzIsCglGTEFTSF9BUkdfTU9ERV8zLAoJRkxBU0hfQVJHX01PREVfRVZF
Ugk9IEZMQVNIX0FSR19NT0RFXzAsIC8qIEFsd2F5cyBvbiB0aWxsIHNlbmQgb2ZmICAqLwoJRkxB
U0hfQVJHX01PREVfVElNRUQJPSBGTEFTSF9BUkdfTU9ERV8xLCAvKiBPbiBmb3Igc29tZSB0aW1l
ICovCglGTEFTSF9BUkdfTU9ERV9SRVBFQVQJPSBGTEFTSF9BUkdfTU9ERV8yLCAvKiBSZXBlYXRl
ZGxseSBvbiAqLwoJRkxBU0hfQVJHX01PREVfQkxJTksJPSBGTEFTSF9BUkdfTU9ERV8zLCAvKiBP
biBmb3Igc29tZSBqZWZmaWVzIGRlZmluZWQgYnkgSC9XICovCglGTEFTSF9BUkdfTU9ERV9NQVgs
CS8qIEVxdWFsIG9yIGdyZWF0ZXIgbW9kZSBjb25zaWRlcmVkIGludmFsaWQgKi8KCUZMQVNIX0FS
R19MVU1JX09GRgk9IDAsIC8qIEZsYXNoIG9mZiAqLwoJRkxBU0hfQVJHX0xVTUlfRlVMTCwKCUZM
QVNIX0FSR19MVU1JX0RJTTEsCS8qIE9uZSBmaWZ0aCBsdW1pbmFuY2UqLwoJRkxBU0hfQVJHX0xV
TUlfRElNMiwJLyogT25lIHRoaXJkIGx1bWluYW5jZSwgbm90IHN1cHBvcnRlZCBpbiBIL1cgY29u
ZmlndXJhdGlvbiAqLwoJRkxBU0hfQVJHX0xVTUlfTUFYLAkvKiBFcXVhbCBvciBncmVhdGVyIGx1
bWluYW5jZSBjb25zaWRlcmVkIGludmFsaWQgKi8KfTsKCnN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRs
Ml9xdWVyeWN0cmwgb3Y1NjQyX2NvbnRyb2xzW10gPSB7Cgl7CgkJLmlkID0gVjRMMl9DSURfRk9D
VVNfQVVUTywKCQkudHlwZSA9IFY0TDJfQ1RSTF9UWVBFX0JPT0xFQU4sCgkJLm5hbWUgPSAiYXV0
byBmb2N1cyIsCgkJLm1pbmltdW0gPSAwLAoJCS5tYXhpbXVtID0gMSwKCQkuc3RlcCA9IDEsCgkJ
LmRlZmF1bHRfdmFsdWUgPSAwLAoJfSx7CgkJLmlkID0gVjRMMl9DSURfQVVUT19XSElURV9CQUxB
TkNFLAoJCS50eXBlID0gVjRMMl9DVFJMX1RZUEVfQk9PTEVBTiwKCQkubmFtZSA9ICJhdXRvIHdo
aXRlIGJhbGFuY2UiLAoJCS5taW5pbXVtID0gMCwKCQkubWF4aW11bSA9IDEsCgkJLnN0ZXAgPSAx
LAoJCS5kZWZhdWx0X3ZhbHVlID0gMCwKCX0sewoJCS5pZCA9IFY0TDJfQ0lEX0VYUE9TVVJFX0FV
VE8sCgkJLnR5cGUgPSBWNEwyX0NUUkxfVFlQRV9CT09MRUFOLAoJCS5uYW1lID0gImF1dG8gZXhw
b3N1cmUiLAoJCS5taW5pbXVtID0gMCwKCQkubWF4aW11bSA9IDEsCgkJLnN0ZXAgPSAxLAoJCS5k
ZWZhdWx0X3ZhbHVlID0gMCwKCX0sewoJCS5pZCA9IFY0TDJfQ0lEX0ZMQVNIX0RVUkFUSU9OLAoJ
CS50eXBlID0gVjRMMl9DVFJMX1RZUEVfSU5URUdFUiwKCQkubmFtZSA9ICJmbGFzaCBkdXJhdGlv
biIsCgkJLm1pbmltdW0gPSAwLAoJCS5tYXhpbXVtID0gNjAwMDAsCgkJLnN0ZXAgPSAxLAoJCS5k
ZWZhdWx0X3ZhbHVlID0gMTAwMCwKCX0sewoJCS5pZCA9IFY0TDJfQ0lEX0ZMQVNIX01PREUsCgkJ
LnR5cGUgPSBWNEwyX0NUUkxfVFlQRV9JTlRFR0VSLAoJCS5uYW1lID0gImZsYXNoIG1vZGUiLAoJ
CS5taW5pbXVtID0gRkxBU0hfQVJHX01PREVfMCwKCQkubWF4aW11bSA9IEZMQVNIX0FSR19NT0RF
X01BWCAtIDEsCgkJLnN0ZXAgPSAxLAoJCS5kZWZhdWx0X3ZhbHVlID0gMCwKCX0sewoJCS5pZCA9
IFY0TDJfQ0lEX0ZMQVNIX0xVTUlOQU5DRSwKCQkudHlwZSA9IFY0TDJfQ1RSTF9UWVBFX0lOVEVH
RVIsCgkJLm5hbWUgPSAiZmxhc2ggYnJpZ2h0bmVzcyIsCgkJLm1pbmltdW0gPSBGTEFTSF9BUkdf
TFVNSV9PRkYsCgkJLm1heGltdW0gPSBGTEFTSF9BUkdfTFVNSV9NQVggLSAxLAoJCS5zdGVwID0g
MSwKCQkuZGVmYXVsdF92YWx1ZSA9IDAsCgl9Cn07CgojZGVmaW5lIHNldGJpdChyZWcsIG1hc2sp
IFwKZG97IFwKCXVuc2lnbmVkIGNoYXIgdmFsOyBcCglvdjU2NDJfcmVhZChjbGllbnQsIHJlZywg
JnZhbCk7IFwKCXZhbCB8PSAobWFzayk7IFwKCW92NTY0Ml93cml0ZShjbGllbnQsIHJlZywgdmFs
KTsgXAp9d2hpbGUgKDApCgojZGVmaW5lIGNscmJpdChyZWcsIG1hc2spIFwKZG97IFwKCXVuc2ln
bmVkIGNoYXIgdmFsOyBcCglvdjU2NDJfcmVhZChjbGllbnQsIHJlZywgJnZhbCk7CVwKCXZhbCAm
PSAofihtYXNrKSk7CVwKCW92NTY0Ml93cml0ZShjbGllbnQsIHJlZywgdmFsKTsJXAp9d2hpbGUg
KDApCgpzdGF0aWMgc3RydWN0IG92NTY0MiAqdG9fb3Y1NjQyKGNvbnN0IHN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQpCnsKCXJldHVybiBjb250YWluZXJfb2YoaTJjX2dldF9jbGllbnRkYXRhKGNs
aWVudCksIHN0cnVjdCBvdjU2NDIsIHN1YmRldik7Cn0KCgovKmlzc3VlIHRoYXQgT1Ygc2Vuc29y
IG11c3Qgd3JpdGUgdGhlbiByZWFkLiA1NjQyIHJlZ2lzdGVyIGlzIDE2Yml0ISEhKi8Kc3RhdGlj
IGludCBvdjU2NDJfcmVhZChzdHJ1Y3QgaTJjX2NsaWVudCAqYywgdTE2IHJlZywKCQl1bnNpZ25l
ZCBjaGFyICp2YWx1ZSkKewoJdTggZGF0YTsKCXU4IGFkZHJlc3NbMl07CglpbnQgcmV0ID0gMDsK
CWFkZHJlc3NbMF0gPSByZWc+Pjg7CglhZGRyZXNzWzFdID0gcmVnOwoKCXJldCA9IChpbnQpaTJj
X3NtYnVzX3dyaXRlX2J5dGVfZGF0YShjLGFkZHJlc3NbMF0sYWRkcmVzc1sxXSk7CglpZiAocmV0
KQoJCWdvdG8gZXhpdDsKCWRhdGEgPSBpMmNfc21idXNfcmVhZF9ieXRlKGMpOwoJKnZhbHVlID0g
ZGF0YTsKZXhpdDoKCXJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbnQgb3Y1NjQyX3dyaXRlKHN0cnVj
dCBpMmNfY2xpZW50ICpjLCB1MTYgcmVnLAoJCXVuc2lnbmVkIGNoYXIgdmFsdWUpCnsKCXU4IGRh
dGFbM107CglkYXRhWzBdID0gcmVnPj44OwoJZGF0YVsxXSA9IHJlZzsKCWRhdGFbMl09ICB2YWx1
ZTsKCWkyY19tYXN0ZXJfc2VuZChjLCBkYXRhLCAzKTsKCWlmIChyZWcgPT0gUkVHX1NZUyAmJiAo
dmFsdWUgJiBTWVNfUkVTRVQpKQoJCW1zbGVlcCgyKTsgIC8qIFdhaXQgZm9yIHJlc2V0IHRvIHJ1
biAqLwoJcmV0dXJuIDA7Cn0KCi8qIFdyaXRlIGEgbGlzdCBvZiByZWdpc3RlciBzZXR0aW5nczsg
ZmYvZmYgc3RvcHMgdGhlIHByb2Nlc3MuKi8Kc3RhdGljIGludCBvdjU2NDJfd3JpdGVfYXJyYXko
c3RydWN0IGkyY19jbGllbnQgKmMsIHN0cnVjdCByZWd2YWxfbGlzdCAqdmFscykKewoJd2hpbGUg
KHZhbHMtPnJlZ19udW0gIT0gMHhmZmZmIHx8IHZhbHMtPnZhbHVlICE9IDB4ZmYpIHsKCQlpbnQg
cmV0ID0gb3Y1NjQyX3dyaXRlKGMsIHZhbHMtPnJlZ19udW0sIHZhbHMtPnZhbHVlKTsKCQlpZiAo
cmV0IDwgMCkKCQkJcmV0dXJuIHJldDsKCQl2YWxzKys7Cgl9CglyZXR1cm4gMDsKfQoKc3RhdGlj
IGludCBvdjU2NDJfZGV0ZWN0KHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQpCnsKCXVuc2lnbmVk
IGNoYXIgdiA9IDA7CglpbnQgcmV0ID0gMDsKCglyZXQgPSBvdjU2NDJfcmVhZChjbGllbnQsIFJF
R19QSURILCAmdik7CgoJcHJpbnRrKEtFUk5fTk9USUNFICJjYW06IG92NTY0Ml9kZXRlY3QgMHgl
eFxuIix2KTsKCWlmIChyZXQgPCAwKQoJCXJldHVybiByZXQ7CglpZiAodiAhPSAweDU2KQoJCXJl
dHVybiAtRU5PREVWOwoKCXJldCA9IG92NTY0Ml9yZWFkKGNsaWVudCwgUkVHX1BJREwsICZ2KTsK
CglwcmludGsoS0VSTl9OT1RJQ0UgImNhbTogb3Y1NjQyX2RldGVjdCAweCV4XG4iLHYpOwoJaWYg
KHJldCA8IDApCgkJcmV0dXJuIHJldDsKCWlmICh2ICE9IDB4NDIpCgkJcmV0dXJuIC1FTk9ERVY7
CgoJcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW50IG92NTY0Ml9nZXRfYXdiKHN0cnVjdCBpMmNfY2xp
ZW50ICpjbGllbnQsIGludCAqdmFsdWUpCnsKCWludCByZXQ7Cgl1bnNpZ25lZCBjaGFyIHYgPSAw
OwoKCXJldCA9IG92NTY0Ml9yZWFkKGNsaWVudCwgUkVHX0FXQl9FTiwgJnYpOwoJKnZhbHVlID0g
KCh2ICYgQVdCX0RJUykgIT0gQVdCX0RJUyk7CglyZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW50IG92
NTY0Ml9zZXRfYXdiKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIGludCB2YWx1ZSkKewoJdW5z
aWduZWQgY2hhciB2ID0gMDsKCWludCByZXQ7CgoJcmV0ID0gb3Y1NjQyX3JlYWQoY2xpZW50LCBS
RUdfQVdCX0VOLCAmdik7CglpZiAoIXZhbHVlKQoJCXYgPSBBV0JfRElTOwoJZWxzZQoJCXYgPSAw
eDAwOwoJcmV0ID0gb3Y1NjQyX3dyaXRlKGNsaWVudCwgUkVHX0FXQl9FTiwgdik7CglyZXR1cm4g
cmV0Owp9CgpzdGF0aWMgaW50IG92NTY0Ml9nZXRfYWUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVu
dCwgaW50ICp2YWx1ZSkKewoJaW50IHJldDsKCXVuc2lnbmVkIGNoYXIgdiA9IDA7CgoJcmV0ID0g
b3Y1NjQyX3JlYWQoY2xpZW50LCBSRUdfQUVfRU4sICZ2KTsKCSp2YWx1ZSA9ICgodiAmIEFFX0VO
KSA9PSBBRV9FTik7CglyZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW50IG92NTY0Ml9zZXRfYWUoc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCwgaW50IHZhbHVlKQp7Cgl1bnNpZ25lZCBjaGFyIHYgPSAw
OwoJaW50IHJldDsKCglyZXQgPSBvdjU2NDJfcmVhZChjbGllbnQsIFJFR19BRV9FTiwgJnYpOwoJ
aWYgKHZhbHVlKQoJCXYgfD0gQUVfRU47CgllbHNlCgkJdiAmPSB+QUVfRU47CglyZXQgKz0gb3Y1
NjQyX3dyaXRlKGNsaWVudCwgUkVHX0FFX0VOLCB2KTsKCXJldHVybiByZXQ7Cn0KCnN0YXRpYyBp
bnQgb3Y1NjQyX2dldF9hZihzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCBpbnQgKnZhbHVlKQp7
CglpbnQgcmV0OwoJdW5zaWduZWQgY2hhciB2ID0gMDsKCglyZXQgPSBvdjU2NDJfcmVhZChjbGll
bnQsIFJFR19BRl9FTiwgJnYpOwoJKnZhbHVlID0gKHYgJiBBRl9FTikgPT0gQUZfRU47CglyZXR1
cm4gcmV0Owp9CgpzdGF0aWMgaW50IG92NTY0Ml9zZXRfYWYoc3RydWN0IGkyY19jbGllbnQgKmNs
aWVudCwgaW50IHZhbHVlKQp7Cgl1bnNpZ25lZCBjaGFyIHYgPSAwOwoJaW50IHJldDsKCglyZXQg
PSBvdjU2NDJfcmVhZChjbGllbnQsIFJFR19BRl9FTiwgJnYpOwoJaWYgKHZhbHVlKQoJCXYgfD0g
QUZfRU47CgllbHNlCgkJdiAmPSB+QUZfRU47CglyZXQgKz0gb3Y1NjQyX3dyaXRlKGNsaWVudCwg
UkVHX0FGX0VOLCB2KTsKCXJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbnQgb3Y1NjQyX2dldF9mbGFz
aF9sdW0oc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwgaW50ICpsdW0pCnsKCXN0cnVjdCBvdjU2
NDIgKm92NTY0MiA9IHRvX292NTY0MihjbGllbnQpOwoJKmx1bSA9IG92NTY0Mi0+Zmxhc2guYnJp
Z2h0bmVzczsKCXJldHVybiAqbHVtOwp9CgpzdGF0aWMgaW50IG92NTY0Ml9zZXRfZmxhc2hfbHVt
KHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIGludCBsdW0pCnsKCXN0cnVjdCBvdjU2NDIgKm92
NTY0MiA9IHRvX292NTY0MihjbGllbnQpOwoJaW50IHJldCA9IDA7CgoJaWYgKChsdW0gPCAwKSB8
fCAobHVtID4gRkxBU0hfQVJHX0xVTUlfTUFYKSkKCQlyZXR1cm4gLUVJTlZBTDsKCglpZiAobHVt
ID09IDApIHsKCQlvdjU2NDItPmZsYXNoLmJyaWdodG5lc3MgPSBGTEFTSF9BUkdfTFVNSV9PRkY7
CgkJLyogUmVxdWVzdCB0dXJuIE9GRiB0aGUgZmxhc2gsIHNvIGlnbm9yZSBmbGFzaCBtb2RlICov
CgkJY2xyYml0KFJFR19TWVNfUkVTRVQsIDB4MDgpOwkvKiBjbGVhciByZXNldCovCgkJc2V0Yml0
KFJFR19DTEtfRU5BQkxFLCAweDA4KTsJLyogZW5hYmxlIGNsb2NrKi8KCQlzZXRiaXQoUkVHX1BB
RF9PVVRQVVQsIDB4MjApOwkvKiBwYWQgb3V0cHV0IGVuYWJsZSovCgkJc2V0Yml0KFJFR19GUkVY
X01PREUsIDB4MDIpOwkvKiBGUkVYIG1vZGUqLwoJCS8qIFN0cm9iZSBjb250cm9sICovCgkJcmV0
ID0gb3Y1NjQyX3dyaXRlKGNsaWVudCwgUkVHX1NUUkJfQ1RSTCwgMHgwMyk7CgkJLyoKCQkqIFdy
aXRlIGFnYWluIHRvIG1ha2Ugc3VyZSBzdHJvYmUgcmVxdWVzdCBlbmQgaXMgcmVjZWl2ZWQKCQkq
IGFmdGVyIG90aGVyIGJpdHMgYXJlIHNhdmVkIGluIHRoZSByZWcsIHVzZSBMRUQzIG1vZGUgb2Zm
CgkJKi8KCQlyZXQgfD0gb3Y1NjQyX3dyaXRlKGNsaWVudCwgUkVHX1NUUkJfQ1RSTCwgMHgwMyk7
CgkJcmV0dXJuIHJldDsKCX0KCglvdjU2NDItPmZsYXNoLmJyaWdodG5lc3MgPSBsdW07CgljbHJi
aXQoUkVHX1NZU19SRVNFVCwgMHgwOCk7CS8qIGNsZWFyIHJlc2V0Ki8KCXNldGJpdChSRUdfQ0xL
X0VOQUJMRSwgMHgwOCk7CS8qIGVuYWJsZSBjbG9jayovCglzZXRiaXQoUkVHX1BBRF9PVVRQVVQs
IDB4MDIpOwkvKiBwYWQgb3V0cHV0IGVuYWJsZSovCglzZXRiaXQoUkVHX0ZSRVhfTU9ERSwgMHgw
Mik7CS8qIEZSRVggbW9kZSovCgoJc3dpdGNoIChvdjU2NDItPmZsYXNoLm1vZGUpCgl7CgkJY2Fz
ZSBGTEFTSF9BUkdfTU9ERV9USU1FRDoKCQkJaWYgKG92NTY0Mi0+Zmxhc2guZHVyYXRpb24pIHsK
CQkJCS8qIFN0cm9iZSBjb250cm9sICovCgkJCQlyZXQgPSBvdjU2NDJfd3JpdGUoY2xpZW50LCBS
RUdfU1RSQl9DVFJMLCAweDAzKTsKCQkJCS8qIFNlbmQgc3Ryb2JlIHJlcXVlc3QgKi8KCQkJCXJl
dCB8PSBvdjU2NDJfd3JpdGUoY2xpZW50LCBSRUdfU1RSQl9DVFJMLCAweDgzKTsKCQkJCW1zbGVl
cChvdjU2NDItPmZsYXNoLmR1cmF0aW9uKTsKCQkJCXJldCB8PSBvdjU2NDJfd3JpdGUoY2xpZW50
LCBSRUdfU1RSQl9DVFJMLCAweDAzKTsKCQkJCW92NTY0Mi0+Zmxhc2guYnJpZ2h0bmVzcyA9IEZM
QVNIX0FSR19MVU1JX09GRjsKCQkJCXJldHVybiByZXQ7CgkJCX0KCQkJLyogTk8gYnJlYWsgaGVy
ZSwgaWYgZHVyYXRpb24gaXMgMCwgbGVhdmUgaXQgT04gKi8KCQljYXNlIEZMQVNIX0FSR19NT0RF
X0VWRVI6CgkJCS8qIFN0cm9iZSBjb250cm9sICovCgkJCXJldCA9IG92NTY0Ml93cml0ZShjbGll
bnQsIFJFR19TVFJCX0NUUkwsIDB4MDMpOwoJCQkvKiBTZW5kIHN0cm9iZSByZXF1ZXN0ICovCgkJ
CXJldCB8PSBvdjU2NDJfd3JpdGUoY2xpZW50LCBSRUdfU1RSQl9DVFJMLCAweDgzKTsKCQkJcmV0
dXJuIHJldDsKCQljYXNlIEZMQVNIX0FSR19NT0RFX1JFUEVBVDoKCQkJLyogU3Ryb2JlIGNvbnRy
b2wgKi8KCQkJcmV0ID0gb3Y1NjQyX3dyaXRlKGNsaWVudCwgUkVHX1NUUkJfQ1RSTCwgMHgwMik7
CgkJCS8qIFNlbmQgc3Ryb2JlIHJlcXVlc3QgKi8KCQkJcmV0IHw9IG92NTY0Ml93cml0ZShjbGll
bnQsIFJFR19TVFJCX0NUUkwsIDB4ODIpOwoJCQlyZXR1cm4gcmV0OwoJCWNhc2UgRkxBU0hfQVJH
X01PREVfQkxJTks6CgkJCS8qIFVzZSBvdjU2NDIgeGVub24gZmxhc2ggbW9kZSAqLwoJCQlyZXR1
cm4gcmV0OwoJfQoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgb3Y1NjQyX2dldF9mbGFzaF90aW1l
KHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIGludCAqdGltZSkKewoJc3RydWN0IG92NTY0MiAq
b3Y1NjQyID0gdG9fb3Y1NjQyKGNsaWVudCk7CgkqdGltZSA9IG92NTY0Mi0+Zmxhc2guZHVyYXRp
b247CglyZXR1cm4gKnRpbWU7Cn0KCgpzdGF0aWMgaW50IG92NTY0Ml9zZXRfZmxhc2hfdGltZShz
dHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCBpbnQgdGltZSkKewoJaW50IHJldCA9IDA7CglzdHJ1
Y3Qgb3Y1NjQyICpvdjU2NDIgPSB0b19vdjU2NDIoY2xpZW50KTsKCWlmICh0aW1lIDwgMCkgewoJ
CXByaW50ayhLRVJOX0VSUiAiY2FtOiBJbnZhbGlkIGZsYXNoIGR1cmF0aW9uOiAlZFxuIiwgdGlt
ZSk7CgkJcmV0dXJuIC1FSU5WQUw7Cgl9CglvdjU2NDItPmZsYXNoLmR1cmF0aW9uID0gdGltZTsK
CWlmICh0aW1lID09IDApCgkJb3Y1NjQyLT5mbGFzaC5tb2RlID0gRkxBU0hfQVJHX01PREVfRVZF
UjsKCWVsc2UKCQlvdjU2NDItPmZsYXNoLm1vZGUgPSBGTEFTSF9BUkdfTU9ERV9USU1FRDsKCS8q
CgkqIElmIHRoZSBmbGFzaCBpcyBvbiwgdGhlIGR1cmF0aW9uIGNoYW5nZSB3aWxsIGFmZmVjdCB0
aGUKCSogYmVoYXZvaXIgb2YgZmxhc2ggaW1tZWRpYXRlbGx5CgkqLwoJaWYgKG92NTY0Mi0+Zmxh
c2guYnJpZ2h0bmVzcyAhPSBGTEFTSF9BUkdfTFVNSV9PRkYpCgkJcmV0ID0gb3Y1NjQyX3NldF9m
bGFzaF9sdW0oY2xpZW50LCBvdjU2NDItPmZsYXNoLmJyaWdodG5lc3MpOwoJcmV0dXJuIHJldDsK
fQoKc3RhdGljIGludCBvdjU2NDJfZ2V0X2ZsYXNoX21vZGUoc3RydWN0IGkyY19jbGllbnQgKmNs
aWVudCwgaW50ICptb2RlKQp7CglzdHJ1Y3Qgb3Y1NjQyICpvdjU2NDIgPSB0b19vdjU2NDIoY2xp
ZW50KTsKCSptb2RlID0gb3Y1NjQyLT5mbGFzaC5tb2RlOwoJcmV0dXJuICptb2RlOwp9CgpzdGF0
aWMgaW50IG92NTY0Ml9zZXRfZmxhc2hfbW9kZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCBp
bnQgbW9kZSkKewoJc3RydWN0IG92NTY0MiAqb3Y1NjQyID0gdG9fb3Y1NjQyKGNsaWVudCk7CgoJ
aWYgKG1vZGUgPj0gRkxBU0hfQVJHX01PREVfTUFYKQoJCXJldHVybiAtRUlOVkFMOwoJb3Y1NjQy
LT5mbGFzaC5tb2RlID0gbW9kZTsKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IG92NTY0Ml9nX2No
aXBfaWRlbnQoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKCQkJCXN0cnVjdCB2NGwyX2RiZ19jaGlw
X2lkZW50ICppZCkKewoJc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHNkLT5wcml2OwoJc3Ry
dWN0IG92NTY0MiAqb3Y1NjQyID0gdG9fb3Y1NjQyKGNsaWVudCk7CglpZC0+aWRlbnQJPSBvdjU2
NDItPm1vZGVsOwoJaWQtPnJldmlzaW9uCT0gMDsKCglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBv
djU2NDJfZ19yZWdpc3RlcihzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLAoJCQkgICAgICBzdHJ1Y3Qg
djRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKewoJc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHNk
LT5wcml2OwoJcmV0dXJuIG92NTY0Ml9yZWFkKGNsaWVudCwgKHUxNilyZWctPnJlZywgKHVuc2ln
bmVkIGNoYXIgKikmKHJlZy0+dmFsKSk7Cn0KCnN0YXRpYyBpbnQgb3Y1NjQyX3NfcmVnaXN0ZXIo
c3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKCQkJICAgICAgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVy
ICpyZWcpCnsKCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQgPSBzZC0+cHJpdjsKCXJldHVybiBv
djU2NDJfd3JpdGUoY2xpZW50LCAodTE2KXJlZy0+cmVnLCAodW5zaWduZWQgY2hhcilyZWctPnZh
bCk7Cn0KCnN0YXRpYyBpbnQgb3Y1NjQyX3Nfc3RyZWFtKHN0cnVjdCB2NGwyX3N1YmRldiAqc2Qs
IGludCBlbmFibGUpCnsKCXVuc2lnbmVkIGNoYXIgdmFsOwoJc3RydWN0IGkyY19jbGllbnQgKmNs
aWVudCA9IHNkLT5wcml2OwoJaWYgKGVuYWJsZSkgewoJCW92NTY0Ml9yZWFkKGNsaWVudCwgMHgz
MDA4LCAmdmFsKTsKCQl2YWwgJj0gfjB4NDA7CgkJb3Y1NjQyX3dyaXRlKGNsaWVudCwgMHgzMDA4
LCB2YWwpOwoJfSBlbHNlIHsKCQkvKiBzdG9wIGFmdGVyIG9uZSBmcmFtZSAqLwoJCW92NTY0Ml9y
ZWFkKGNsaWVudCwgMHg0MjAxLCAmdmFsKTsKCQl2YWwgfD0gMHgwMTsKCQlvdjU2NDJfd3JpdGUo
Y2xpZW50LCAweDQyMDEsIHZhbCk7Cgl9CglyZXR1cm4gMDsKfQpzdGF0aWMgaW50IG92NTY0Ml9l
bnVtX2ZtdChzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCB1bnNpZ25lZCBpbnQgaW5kZXgsCgkJCSAg
ICBlbnVtIHY0bDJfbWJ1c19waXhlbGNvZGUgKmNvZGUpCnsKCXN0cnVjdCBpMmNfY2xpZW50ICpj
bGllbnQgPSBzZC0+cHJpdjsKCXN0cnVjdCBvdjU2NDIgKm92NTY0MiA9IHRvX292NTY0MihjbGll
bnQpOwoKCWlmIChpbmRleCA+PSBvdjU2NDItPm51bV9mbXRzKQoJCXJldHVybiAtRUlOVkFMOwoK
CSpjb2RlID0gb3Y1NjQyLT5mbXRzW2luZGV4XS5jb2RlOwoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bnQgb3Y1NjQyX3RyeV9mbXQoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwKCQkJICAgc3RydWN0IHY0
bDJfbWJ1c19mcmFtZWZtdCAqbWYpCnsKCWludCBpOwoJc3RydWN0IGkyY19jbGllbnQgKmNsaWVu
dCA9IHNkLT5wcml2OwoJc3RydWN0IG92NTY0MiAqb3Y1NjQyID0gdG9fb3Y1NjQyKGNsaWVudCk7
CgoJLyogZW51bSB0aGUgc3VwcG9ydGVkIGZvcm1hdHMqLwoJZm9yIChpID0gMDsgaSA8IE5fT1Y1
NjQyX0ZNVFM7IGkrKykgewoJCWlmIChvdjU2NDJfZm10c1tpXS5jb2RlID09IG1mLT5jb2RlKXsK
CQkJb3Y1NjQyLT5yZWdzX2ZtdCA9IG92NTY0Ml9mbXRzW2ldLnJlZ3M7CgkJCWJyZWFrOwoJCX0K
CX0KCWlmIChpID49IE5fT1Y1NjQyX0ZNVFMpewoJCXByaW50ayhLRVJOX0VSUiAiY2FtOiBvdjU2
NDIgdW5zdXBwb3J0ZWQgY29sb3IgZm9ybWF0IVxuIik7CgkJcmV0dXJuIC1FSU5WQUw7Cgl9CgoK
CWlmKG1mLT5jb2RlID09IFY0TDJfTUJVU19GTVRfSlBFR18xWDgpewoJCS8qIGVudW0gdGhlIHN1
cHBvcnRlZCBzaXplcyBmb3IgSlBFRyovCgkJZm9yIChpID0gMDsgaSA8IE5fT1Y1NjQyX1NJWkVT
X0pQRUc7IGkrKykgewoJCQlpZiAobWYtPndpZHRoID09IG92NTY0Ml9zaXplc19qcGVnW2ldLndp
ZHRoCgkJCQkmJiBtZi0+aGVpZ2h0ID09IG92NTY0Ml9zaXplc19qcGVnW2ldLmhlaWdodCkgewoJ
CQkJb3Y1NjQyLT5yZWdzX3NpemUgPSBvdjU2NDJfc2l6ZXNfanBlZ1tpXS5yZWdzOwoJCQkJYnJl
YWs7CgkJCX0KCQl9CgkJaWYgKGkgPj0gTl9PVjU2NDJfU0laRVNfSlBFRyl7CgkJCQlwcmludGso
S0VSTl9FUlIiY2FtOiBvdjU2NDIgdW5zdXBwb3J0ZWQganBlZyBzaXplIVxuIik7CgkJCQlyZXR1
cm4gLUVJTlZBTDsKCQl9Cgl9IGVsc2UgewoJCS8qIGVudW0gdGhlIHN1cHBvcnRlZCBzaXplcyov
CgkJZm9yIChpID0gMDsgaSA8IE5fT1Y1NjQyX1NJWkVTOyBpKyspIHsKCQkJaWYgKG1mLT53aWR0
aCA9PSBvdjU2NDJfc2l6ZXNbaV0ud2lkdGgKCQkJCSYmIG1mLT5oZWlnaHQgPT0gb3Y1NjQyX3Np
emVzW2ldLmhlaWdodCkgewoJCQkJb3Y1NjQyLT5yZWdzX3NpemUgPSBvdjU2NDJfc2l6ZXNbaV0u
cmVnczsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmIChpID49IE5fT1Y1NjQyX1NJWkVTKXsKCQkJ
cHJpbnRrKEtFUk5fRVJSICJjYW06IG92NTY0MiB1bnN1cHBvcnRlZCB3aW5kb3cgc2l6ZSwgdyVk
LCBoJWQhXG4iLAoJCQkJCW1mLT53aWR0aCwgbWYtPmhlaWdodCk7CgkJCXJldHVybiAtRUlOVkFM
OwoJCX0KCX0KCgltZi0+ZmllbGQgPSBWNEwyX0ZJRUxEX05PTkU7CgoJc3dpdGNoIChtZi0+Y29k
ZSkgewoJY2FzZSBWNEwyX01CVVNfRk1UX1JHQjU2NV8yWDhfTEU6CgljYXNlIFY0TDJfTUJVU19G
TVRfWVVZVjhfMlg4X0xFOgoJY2FzZSBWNEwyX01CVVNfRk1UX1lWWVU4XzJYOF9MRToKCWNhc2Ug
VjRMMl9NQlVTX0ZNVF9ZVVlWOF8yWDhfQkU6CgljYXNlIFY0TDJfTUJVU19GTVRfWVZZVThfMlg4
X0JFOgoJCS8qIGVudW0gdGhlIHN1cHBvcnRlZCBzaXplcyovCgkJZm9yIChpID0gMDsgaSA8IE5f
T1Y1NjQyX1NJWkVTOyBpKyspIHsKCQkJaWYgKG1mLT53aWR0aCA9PSBvdjU2NDJfc2l6ZXNbaV0u
d2lkdGgKCQkJCSYmIG1mLT5oZWlnaHQgPT0gb3Y1NjQyX3NpemVzW2ldLmhlaWdodCkgewoJCQkJ
b3Y1NjQyLT5yZWdzX3NpemUgPSBvdjU2NDJfc2l6ZXNbaV0ucmVnczsKCQkJCWJyZWFrOwoJCQl9
CgkJfQoJCWlmIChpID49IE5fT1Y1NjQyX1NJWkVTKXsKCQkJcHJpbnRrKEtFUk5fRVJSICJjYW06
IG92NTY0MiB1bnN1cHBvcnRlZCB3aW5kb3cgc2l6ZSwgdyVkLCBoJWQhXG4iLAoJCQkJCW1mLT53
aWR0aCwgbWYtPmhlaWdodCk7CgkJCXJldHVybiAtRUlOVkFMOwoJCX0KCgkJaWYgKG1mLT5jb2Rl
ID09IFY0TDJfTUJVU19GTVRfUkdCNTY1XzJYOF9MRSkKCQkJbWYtPmNvbG9yc3BhY2UgPSBWNEwy
X0NPTE9SU1BBQ0VfU1JHQjsKCQllbHNlCgkJCW1mLT5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQ
QUNFX0pQRUc7CgkJYnJlYWs7CgoJY2FzZSBWNEwyX01CVVNfRk1UX0pQRUdfMVg4OgoJCS8qIGVu
dW0gdGhlIHN1cHBvcnRlZCBzaXplcyBmb3IgSlBFRyovCgkJZm9yIChpID0gMDsgaSA8IE5fT1Y1
NjQyX1NJWkVTX0pQRUc7IGkrKykgewoJCQlpZiAobWYtPndpZHRoID09IG92NTY0Ml9zaXplc19q
cGVnW2ldLndpZHRoCgkJCQkmJiBtZi0+aGVpZ2h0ID09IG92NTY0Ml9zaXplc19qcGVnW2ldLmhl
aWdodCkgewoJCQkJb3Y1NjQyLT5yZWdzX3NpemUgPSBvdjU2NDJfc2l6ZXNfanBlZ1tpXS5yZWdz
OwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJaWYgKGkgPj0gTl9PVjU2NDJfU0laRVNfSlBFRyl7CgkJ
CQlwcmludGsoS0VSTl9FUlIiY2FtOiBvdjU2NDIgdW5zdXBwb3J0ZWQganBlZyBzaXplIVxuIik7
CgkJCQlyZXR1cm4gLUVJTlZBTDsKCQl9CgkJbWYtPmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9SU1BB
Q0VfSlBFRzsKCQlicmVhazsKCWRlZmF1bHQ6CgkJZGV2X2VycigmY2xpZW50LT5kZXYsICJvdjU2
NDIgZG9lc24ndCBzdXBwb3J0IGNvZGUgJWRcbiIsIG1mLT5jb2RlKTsKCQlicmVhazsKCX0KCgly
ZXR1cm4gMDsKfQoKc3RhdGljIGludCBvdjU2NDJfc19mbXQoc3RydWN0IHY0bDJfc3ViZGV2ICpz
ZCwKCQkJIHN0cnVjdCB2NGwyX21idXNfZnJhbWVmbXQgKm1mKQp7CglpbnQgcmV0ID0gMDsKCXN0
cnVjdCBpMmNfY2xpZW50ICpjbGllbnQgPSBzZC0+cHJpdjsKCXN0cnVjdCBvdjU2NDIgKm92NTY0
MiA9IHRvX292NTY0MihjbGllbnQpOwoKCXN3aXRjaCAobWYtPmNvZGUpIHsKCQljYXNlIFY0TDJf
TUJVU19GTVRfSlBFR18xWDg6CgkJCW92NTY0Ml93cml0ZV9hcnJheShjbGllbnQsIG92NTY0Ml9q
cGdfZGVmYXVsdCk7CgkJCW92NTY0Ml93cml0ZV9hcnJheShjbGllbnQsIG92NTY0Mi0+cmVnc19z
aXplKTsKCQkJYnJlYWs7CgoJCWNhc2UgVjRMMl9NQlVTX0ZNVF9ZVVlWOF8yWDhfTEU6CgkJY2Fz
ZSBWNEwyX01CVVNfRk1UX1lWWVU4XzJYOF9MRToKCQljYXNlIFY0TDJfTUJVU19GTVRfWVVZVjhf
Mlg4X0JFOgoJCWNhc2UgVjRMMl9NQlVTX0ZNVF9ZVllVOF8yWDhfQkU6CgkJY2FzZSBWNEwyX01C
VVNfRk1UX1JHQjU2NV8yWDhfTEU6CgkJZGVmYXVsdDoKCQkJaWYgKG1mLT53aWR0aCA9PSAxOTIw
ICYmIG1mLT5oZWlnaHQgPT0gMTA4MCkgewoJCQkJb3Y1NjQyX3dyaXRlX2FycmF5KGNsaWVudCwg
b3Y1NjQyX3l1dl8xMDgwcCk7CgkJCX0gZWxzZSBpZiAobWYtPndpZHRoID09IDEyODAgJiYgbWYt
PmhlaWdodCA9PSA3MjApIHsKCQkJCW92NTY0Ml93cml0ZV9hcnJheShjbGllbnQsIG92NTY0Ml95
dXZfNzIwcCk7CgkJCX0gZWxzZSB7CgkJCQlvdjU2NDJfd3JpdGVfYXJyYXkoY2xpZW50LCBvdjU2
NDJfeXV2X2RlZmF1bHQpOwoJCQkJb3Y1NjQyX3dyaXRlX2FycmF5KGNsaWVudCwgb3Y1NjQyLT5y
ZWdzX2ZtdCk7CgkJCQlvdjU2NDJfd3JpdGVfYXJyYXkoY2xpZW50LCBvdjU2NDItPnJlZ3Nfc2l6
ZSk7CgkJCQlvdjU2NDJfd3JpdGVfYXJyYXkoY2xpZW50LCBvdjU2NDJfbWlwaSk7CgkJCX0KCQkJ
YnJlYWs7Cgl9CgoJcmV0dXJuIHJldDsKfQoKc3RhdGljIGludCBvdjU2NDJfZ19mbXQoc3RydWN0
IHY0bDJfc3ViZGV2ICpzZCwKCQkJIHN0cnVjdCB2NGwyX21idXNfZnJhbWVmbXQgKm1mKQp7Cglz
dHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gc2QtPnByaXY7CglzdHJ1Y3Qgb3Y1NjQyICpvdjU2
NDIgPSB0b19vdjU2NDIoY2xpZW50KTsKCgltZi0+d2lkdGgJCT0gb3Y1NjQyLT5yZWN0LndpZHRo
OwoJbWYtPmhlaWdodAkJPSBvdjU2NDItPnJlY3QuaGVpZ2h0OwoJbWYtPmNvZGUJPSBWNEwyX01C
VVNfRk1UX1lVWVY4XzJYOF9CRTsKCW1mLT5maWVsZAkJPSBWNEwyX0ZJRUxEX05PTkU7CgltZi0+
Y29sb3JzcGFjZQkJPSBWNEwyX0NPTE9SU1BBQ0VfSlBFRzsKCXJldHVybiAwOwp9CgpzdGF0aWMg
aW50IG92NTY0Ml9lbnVtX2ZzaXplcyhzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLAoJCQlzdHJ1Y3Qg
djRsMl9mcm1zaXplZW51bSAqZnNpemUpCnsKCXN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQgPSBz
ZC0+cHJpdjsKCglmc2l6ZS0+dHlwZSA9IFY0TDJfRlJNU0laRV9UWVBFX0RJU0NSRVRFOwoKCS8q
IGFidXNlIHBpeGVsX2Zvcm1hdCwgaW4gZmFjdCwgaXQgaXMgeGxhdGUtPmNvZGUqLwoJc3dpdGNo
IChmc2l6ZS0+cGl4ZWxfZm9ybWF0KSB7CgkJY2FzZSBWNEwyX01CVVNfRk1UX1lVWVY4XzJYOF9C
RToKCQljYXNlIFY0TDJfTUJVU19GTVRfUkdCNTY1XzJYOF9MRToKCQkJaWYgKGZzaXplLT5pbmRl
eCA+PSBOX09WNTY0Ml9TSVpFUykgewoJCQkJZGV2X3dhcm4oJmNsaWVudC0+ZGV2LCAib3Y1NjQy
IHVuc3VwcG9ydGVkIHNpemUhXG4iKTsKCQkJCXJldHVybiAtRUlOVkFMOwoJCQl9CgkJCWZzaXpl
LT5kaXNjcmV0ZS5oZWlnaHQgPSBvdjU2NDJfc2l6ZXNbZnNpemUtPmluZGV4XS5oZWlnaHQ7CgkJ
CWZzaXplLT5kaXNjcmV0ZS53aWR0aCA9IG92NTY0Ml9zaXplc1tmc2l6ZS0+aW5kZXhdLndpZHRo
OwoJCQlicmVhazsKCQljYXNlIFY0TDJfTUJVU19GTVRfSlBFR18xWDg6CgkJCWlmIChmc2l6ZS0+
aW5kZXggPj0gTl9PVjU2NDJfU0laRVNfSlBFRykgewoJCQkJZGV2X3dhcm4oJmNsaWVudC0+ZGV2
LCAib3Y1NjQyIHVuc3VwcG9ydGVkIGpwZWcgc2l6ZSFcbiIpOwoJCQkJcmV0dXJuIC1FSU5WQUw7
CgkJCX0KCQkJZnNpemUtPmRpc2NyZXRlLmhlaWdodCA9IG92NTY0Ml9zaXplc19qcGVnW2ZzaXpl
LT5pbmRleF0uaGVpZ2h0OwoJCQlmc2l6ZS0+ZGlzY3JldGUud2lkdGggPSBvdjU2NDJfc2l6ZXNf
anBlZ1tmc2l6ZS0+aW5kZXhdLndpZHRoOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQlkZXZfZXJy
KCZjbGllbnQtPmRldiwgIm92NTY0MiB1bnN1cHBvcnRlZCBmb3JtYXQhXG4iKTsKCQkJcmV0dXJu
IC1FSU5WQUw7Cgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyB1bnNpZ25lZCBsb25nIG92NTY0Ml9x
dWVyeV9idXNfcGFyYW0oc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QpCnsKCXN0cnVjdCBz
b2NfY2FtZXJhX2xpbmsgKmljbCA9IHRvX3NvY19jYW1lcmFfbGluayhpY2QpOwoJdW5zaWduZWQg
bG9uZyBmbGFncyA9IFNPQ0FNX01JUEkgfCBTT0NBTV9NSVBJXzFMQU5FOwoKCXJldHVybiBzb2Nf
Y2FtZXJhX2FwcGx5X3NlbnNvcl9mbGFncyhpY2wsIGZsYWdzKTsKfQoKc3RhdGljIGludCBvdjU2
NDJfc2V0X2J1c19wYXJhbShzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZCwgdW5zaWduZWQg
bG9uZyBmKQp7CiNpZiAwLypUT0RPOiBhZGQgbWlwaSBhbmQgcGFyYWxsZWwgZGlmZmVyZW50IHNl
dHRpbmcqLwoJaWYgKGYgJiBTT0NBTV9NSVBJKSAvKiBtaXBpIHNldHRpbmcqLwoJCW92NTY0Ml93
cml0ZV9hcnJheShjbGllbnQsIG92NTY0Ml9taXBpKTsKCWVsc2UgLyogcGFyYWxsZWwgc2V0dGlu
ZyovCgkJb3Y1NjQyX3dyaXRlX2FycmF5KGNsaWVudCwgb3Y1NjQyX21pcGkpOwojZW5kaWYKCXJl
dHVybiAwOwp9CgpzdGF0aWMgc3RydWN0IHNvY19jYW1lcmFfb3BzIG92NTY0Ml9vcHMgPSB7Cgku
cXVlcnlfYnVzX3BhcmFtCT0gb3Y1NjQyX3F1ZXJ5X2J1c19wYXJhbSwKCS5zZXRfYnVzX3BhcmFt
CQk9IG92NTY0Ml9zZXRfYnVzX3BhcmFtLAoJLmNvbnRyb2xzCQkJPSBvdjU2NDJfY29udHJvbHMs
CgkubnVtX2NvbnRyb2xzCQk9IEFSUkFZX1NJWkUob3Y1NjQyX2NvbnRyb2xzKSwKfTsKCnN0YXRp
YyBpbnQgb3Y1NjQyX3NfY3RybChzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCBzdHJ1Y3QgdjRsMl9j
b250cm9sICpjdHJsKQp7CglzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50ID0gc2QtPnByaXY7Cglj
b25zdCBzdHJ1Y3QgdjRsMl9xdWVyeWN0cmwgKnFjdHJsOwoJaW50IHJldDsKCglxY3RybCA9IHNv
Y19jYW1lcmFfZmluZF9xY3RybCgmb3Y1NjQyX29wcywgY3RybC0+aWQpOwoJaWYgKCFxY3RybCkK
CQlyZXR1cm4gLUVJTlZBTDsKCglzd2l0Y2ggKGN0cmwtPmlkKSB7CgljYXNlIFY0TDJfQ0lEX0FV
VE9fV0hJVEVfQkFMQU5DRToKCQlyZXQgPSBvdjU2NDJfc2V0X2F3YihjbGllbnQsIGN0cmwtPnZh
bHVlKTsKCQlicmVhazsKCWNhc2UgVjRMMl9DSURfRk9DVVNfQVVUTzoKCQlyZXQgPSBvdjU2NDJf
c2V0X2FmKGNsaWVudCwgY3RybC0+dmFsdWUpOwoJCWJyZWFrOwoJY2FzZSBWNEwyX0NJRF9FWFBP
U1VSRV9BVVRPOgoJCXJldCA9IG92NTY0Ml9zZXRfYWUoY2xpZW50LCBjdHJsLT52YWx1ZSk7CgkJ
YnJlYWs7CgljYXNlIFY0TDJfQ0lEX0ZMQVNIX0RVUkFUSU9OOgoJCXJldCA9ICBvdjU2NDJfc2V0
X2ZsYXNoX3RpbWUoY2xpZW50LCBjdHJsLT52YWx1ZSk7CgkJYnJlYWs7CgljYXNlIFY0TDJfQ0lE
X0ZMQVNIX01PREU6CgkJcmV0ID0gIG92NTY0Ml9zZXRfZmxhc2hfbW9kZShjbGllbnQsIGN0cmwt
PnZhbHVlKTsKCQlicmVhazsKCWNhc2UgVjRMMl9DSURfRkxBU0hfTFVNSU5BTkNFOgoJCXJldCA9
ICBvdjU2NDJfc2V0X2ZsYXNoX2x1bShjbGllbnQsIGN0cmwtPnZhbHVlKTsKCQlicmVhazsKCWRl
ZmF1bHQ6CgkJcmV0ID0gLUVJTlZBTDsKCX0KCglyZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW50IG92
NTY0Ml9nX2N0cmwoc3RydWN0IHY0bDJfc3ViZGV2ICpzZCwgc3RydWN0IHY0bDJfY29udHJvbCAq
Y3RybCkKewoJc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCA9IHNkLT5wcml2OwoJaW50IHJldDsK
Cglzd2l0Y2ggKGN0cmwtPmlkKSB7CgljYXNlIFY0TDJfQ0lEX0FVVE9fV0hJVEVfQkFMQU5DRToK
CQlyZXQgPSBvdjU2NDJfZ2V0X2F3YihjbGllbnQsICZjdHJsLT52YWx1ZSk7CgkJYnJlYWs7Cglj
YXNlIFY0TDJfQ0lEX0ZPQ1VTX0FVVE86CgkJcmV0ID0gb3Y1NjQyX2dldF9hZihjbGllbnQsICZj
dHJsLT52YWx1ZSk7CgkJYnJlYWs7CgljYXNlIFY0TDJfQ0lEX0VYUE9TVVJFX0FVVE86CgkJcmV0
ID0gb3Y1NjQyX2dldF9hZShjbGllbnQsICZjdHJsLT52YWx1ZSk7CgkJYnJlYWs7CgljYXNlIFY0
TDJfQ0lEX0ZMQVNIX0RVUkFUSU9OOgoJCXJldCA9ICBvdjU2NDJfZ2V0X2ZsYXNoX3RpbWUoY2xp
ZW50LCAmY3RybC0+dmFsdWUpOwoJCWJyZWFrOwoJY2FzZSBWNEwyX0NJRF9GTEFTSF9NT0RFOgoJ
CXJldCA9ICBvdjU2NDJfZ2V0X2ZsYXNoX21vZGUoY2xpZW50LCAmY3RybC0+dmFsdWUpOwoJCWJy
ZWFrOwoJY2FzZSBWNEwyX0NJRF9GTEFTSF9MVU1JTkFOQ0U6CgkJcmV0ID0gIG92NTY0Ml9nZXRf
Zmxhc2hfbHVtKGNsaWVudCwgJmN0cmwtPnZhbHVlKTsKCQlicmVhazsKCWRlZmF1bHQ6CgkJcmV0
ID0gLUVJTlZBTDsKCX0KCglyZXR1cm4gMDsKfQoKc3RhdGljIHN0cnVjdCB2NGwyX3N1YmRldl9j
b3JlX29wcyBvdjU2NDJfc3ViZGV2X2NvcmVfb3BzID0gewoJLmdfY3RybAkJPSBvdjU2NDJfZ19j
dHJsLAoJLnNfY3RybAkJPSBvdjU2NDJfc19jdHJsLAoJLmdfY2hpcF9pZGVudAk9IG92NTY0Ml9n
X2NoaXBfaWRlbnQsCiNpZmRlZiBDT05GSUdfVklERU9fQURWX0RFQlVHCgkuZ19yZWdpc3Rlcgk9
IG92NTY0Ml9nX3JlZ2lzdGVyLAoJLnNfcmVnaXN0ZXIJPSBvdjU2NDJfc19yZWdpc3RlciwKI2Vu
ZGlmCn07CgpzdGF0aWMgc3RydWN0IHY0bDJfc3ViZGV2X3ZpZGVvX29wcyBvdjU2NDJfc3ViZGV2
X3ZpZGVvX29wcyA9IHsKCS5zX3N0cmVhbQk9IG92NTY0Ml9zX3N0cmVhbSwKCS5zX21idXNfZm10
CT0gb3Y1NjQyX3NfZm10LAoJLmdfbWJ1c19mbXQJPSBvdjU2NDJfZ19mbXQsCgkudHJ5X21idXNf
Zm10CT0gb3Y1NjQyX3RyeV9mbXQsCgkuZW51bV9tYnVzX2ZtdAk9IG92NTY0Ml9lbnVtX2ZtdCwK
CS5lbnVtX21idXNfZnNpemVzID0gb3Y1NjQyX2VudW1fZnNpemVzLAp9OwoKc3RhdGljIHN0cnVj
dCB2NGwyX3N1YmRldl9vcHMgb3Y1NjQyX3N1YmRldl9vcHMgPSB7CgkuY29yZQk9ICZvdjU2NDJf
c3ViZGV2X2NvcmVfb3BzLAoJLnZpZGVvCT0gJm92NTY0Ml9zdWJkZXZfdmlkZW9fb3BzLAp9OwoK
c3RhdGljIGludCBvdjU2NDJfcHJvYmUoc3RydWN0IGkyY19jbGllbnQgKmNsaWVudCwKCQkJIGNv
bnN0IHN0cnVjdCBpMmNfZGV2aWNlX2lkICpkaWQpCnsKCXN0cnVjdCBvdjU2NDIgKm92NTY0MjsK
CXN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqaWNkID0gY2xpZW50LT5kZXYucGxhdGZvcm1fZGF0
YTsKCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlciA9IHRvX2kyY19hZGFwdGVyKGNsaWVudC0+
ZGV2LnBhcmVudCk7CglzdHJ1Y3Qgc29jX2NhbWVyYV9saW5rICppY2w7CglpbnQgcmV0OwoJaW50
IGk7CgoJaWYgKCFpY2QpIHsKCQlkZXZfZXJyKCZjbGllbnQtPmRldiwgIm92NTY0MiBtaXNzaW5n
IHNvYy1jYW1lcmEgZGF0YSFcbiIpOwoJCXJldHVybiAtRUlOVkFMOwoJfQoJaWYgKCFpY2QtPmRl
di5wYXJlbnQgfHwKCSAgICB0b19zb2NfY2FtZXJhX2hvc3QoaWNkLT5kZXYucGFyZW50KS0+bnIg
IT0gaWNkLT5pZmFjZSkKCQlyZXR1cm4gLUVOT0RFVjsKCglpY2wgPSB0b19zb2NfY2FtZXJhX2xp
bmsoaWNkKTsKCWlmICghaWNsKSB7CgkJZGV2X2VycigmY2xpZW50LT5kZXYsICJvdjU2NDIgZHJp
dmVyIG5lZWRzIHBsYXRmb3JtIGRhdGFcbiIpOwoJCXJldHVybiAtRUlOVkFMOwoJfQoKCWlmICgh
aTJjX2NoZWNrX2Z1bmN0aW9uYWxpdHkoYWRhcHRlciwgSTJDX0ZVTkNfU01CVVNfV09SRF9EQVRB
KSkgewoJCWRldl93YXJuKCZhZGFwdGVyLT5kZXYsCgkJCSAiSTJDLUFkYXB0ZXIgZG9lc24ndCBz
dXBwb3J0IEkyQ19GVU5DX1NNQlVTX1dPUkRcbiIpOwoJCXJldHVybiAtRUlPOwoJfQoKCW92NTY0
MiA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBvdjU2NDIpLCBHRlBfS0VSTkVMKTsKCWlmICghb3Y1
NjQyKSB7CgkJZGV2X2VycigmY2xpZW50LT5kZXYsICJvdjU2NDIgZmFpbGVkIHRvIGFsbG9jIHN0
cnVjdCFcbiIpOwoJCXJldHVybiAtRU5PTUVNOwoJfQoKCW92NTY0Mi0+cmVjdC5sZWZ0ID0gMDsK
CW92NTY0Mi0+cmVjdC50b3AgPSAwOwoJb3Y1NjQyLT5yZWN0LndpZHRoID0gNjQwOwoJb3Y1NjQy
LT5yZWN0LmhlaWdodCA9IDQ4MDsKCW92NTY0Mi0+cGl4Zm10ID0gVjRMMl9QSVhfRk1UX1VZVlk7
CgoJaWNkLT5vcHMgPSAmb3Y1NjQyX29wczsKCglvdjU2NDItPm1vZGVsID0gVjRMMl9JREVOVF9P
VjU2NDI7CglvdjU2NDItPmZtdHMgPSBvdjU2NDJfY29sb3VyX2ZtdHM7CglvdjU2NDItPm51bV9m
bXRzID0gQVJSQVlfU0laRShvdjU2NDJfY29sb3VyX2ZtdHMpOwoKCW92NTY0Mi0+Zmxhc2guYnJp
Z2h0bmVzcyA9IEZMQVNIX0FSR19MVU1JX09GRjsKCW92NTY0Mi0+Zmxhc2guZHVyYXRpb24gPSBG
TEFTSF9BUkdfVElNRV9PRkY7CglvdjU2NDItPmZsYXNoLm1vZGUgPSBGTEFTSF9BUkdfTU9ERV9F
VkVSOwoJdjRsMl9pMmNfc3ViZGV2X2luaXQoJm92NTY0Mi0+c3ViZGV2LCBjbGllbnQsICZvdjU2
NDJfc3ViZGV2X29wcyk7CgoJZm9yIChpID0gTUFYX0RFVEVDVF9OVU07IGkgPiAwOyAtLWkpIHsK
CQlyZXQgPSBvdjU2NDJfZGV0ZWN0KGNsaWVudCk7CgkJaWYgKCFyZXQpIHsKCQkJcHJpbnRrKEtF
Uk5fTk9USUNFICJjYW06IE9tbmlWaXNpb24gb3Y1NjQyIHNlbnNvciBkZXRlY3RlZCFcbiIpOwoJ
CQlyZXR1cm4gMDsKCQl9Cgl9CglwcmludGsoS0VSTl9FUlIgImNhbTogYWJvcnQgcmV0cnksIGZh
aWxlZCB0byBkZXRlY3QgT21uaVZpc2lvbiBvdjU2NDIhXG4iKTsKCglpY2QtPm9wcyA9IE5VTEw7
CglpMmNfc2V0X2NsaWVudGRhdGEoY2xpZW50LCBOVUxMKTsKCWlmIChvdjU2NDIpCgkJa2ZyZWUo
b3Y1NjQyKTsKCglyZXQgPSAtRU5PREVWOwoJcmV0dXJuIHJldDsKfQoKc3RhdGljIGludCBvdjU2
NDJfcmVtb3ZlKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQpCnsKCXN0cnVjdCBvdjU2NDIgKm92
NTY0MiA9IHRvX292NTY0MihjbGllbnQpOwoJc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2Qg
PSBjbGllbnQtPmRldi5wbGF0Zm9ybV9kYXRhOwoJc3RydWN0IHNvY19jYW1lcmFfbGluayAqaWNs
ID0gdG9fc29jX2NhbWVyYV9saW5rKGljZCk7CgoJaWNkLT5vcHMgPSBOVUxMOwoJaWYgKGljbC0+
ZnJlZV9idXMpCgkJaWNsLT5mcmVlX2J1cyhpY2wpOwoJaWNsLT5wb3dlcihpY2QtPnBkZXYsIDAp
OwoKCWkyY19zZXRfY2xpZW50ZGF0YShjbGllbnQsIE5VTEwpOwoJY2xpZW50LT5kcml2ZXIgPSBO
VUxMOwoJa2ZyZWUob3Y1NjQyKTsKCXJldHVybiAwOwp9CgpzdGF0aWMgc3RydWN0IGkyY19kZXZp
Y2VfaWQgb3Y1NjQyX2lkdGFibGVbXSA9IHsKCXsgIm92NTY0MiIsIDAgfSwKCXsgfQp9OwoKTU9E
VUxFX0RFVklDRV9UQUJMRShpMmMsIG92NTY0Ml9pZHRhYmxlKTsKCnN0YXRpYyBzdHJ1Y3QgaTJj
X2RyaXZlciBvdjU2NDJfZHJpdmVyID0gewoJLmRyaXZlciA9IHsKCQkubmFtZQk9ICJvdjU2NDIi
LAoJfSwKCS5pZF90YWJsZQk9IG92NTY0Ml9pZHRhYmxlLAoJLnByb2JlCQk9IG92NTY0Ml9wcm9i
ZSwKCS5yZW1vdmUJCT0gb3Y1NjQyX3JlbW92ZSwKfTsKCnN0YXRpYyBpbnQgX19pbml0IG92NTY0
Ml9tb2RfaW5pdCh2b2lkKQp7CglpbnQgcmV0ID0gMDsKCXJldCA9IGkyY19hZGRfZHJpdmVyKCZv
djU2NDJfZHJpdmVyKTsKCXJldHVybiByZXQ7Cn0KCnN0YXRpYyB2b2lkIF9fZXhpdCBvdjU2NDJf
bW9kX2V4aXQodm9pZCkKewoJaTJjX2RlbF9kcml2ZXIoJm92NTY0Ml9kcml2ZXIpOwp9Cgptb2R1
bGVfaW5pdChvdjU2NDJfbW9kX2luaXQpOwptb2R1bGVfZXhpdChvdjU2NDJfbW9kX2V4aXQpOwoK
TU9EVUxFX0RFU0NSSVBUSU9OKCJPbW5pVmlzaW9uIE9WNTY0MiBDYW1lcmEgRHJpdmVyIik7Ck1P
RFVMRV9BVVRIT1IoIlFpbmcgWHUiKTsKTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwoK

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_
Content-Type: text/plain; name="pxa955_cam.c"
Content-Description: pxa955_cam.c
Content-Disposition: attachment; filename="pxa955_cam.c"; size=41807;
	creation-date="Wed, 19 Jan 2011 21:12:24 GMT";
	modification-date="Wed, 19 Jan 2011 21:12:24 GMT"
Content-Transfer-Encoding: base64

LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCgoqIFY0TDIgRHJpdmVyIGZvciBQWEE5NXggY2FtZXJhIGhvc3QKKgoqIEJhc2VkIG9uIGxp
bnV4L2RyaXZlcnMvbWVkaWEvdmlkZW8vcHhhX2NhbWVyYS5jCioKKiBDb3B5cmlnaHQgKEMpIDIw
MTAsIE1hcnZlbGwgSW50ZXJuYXRpb25hbCBMdGQuCiogICAgICAgICAgICAgIFFpbmcgWHUgPHFp
bmd4QG1hcnZlbGwuY29tPgoqCiogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKiBpdCB1bmRlciB0aGUgdGVybXMgb2Yg
dGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQoqIHRoZSBGcmVl
IFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9y
CiogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKI2luY2x1ZGUgPGxp
bnV4L2tlcm5lbC5oPgojaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiNpbmNsdWRlIDxsaW51eC9p
bml0Lmg+CiNpbmNsdWRlIDxsaW51eC9pbnRlcnJ1cHQuaD4KI2luY2x1ZGUgPGxpbnV4L3NwaW5s
b2NrLmg+CiNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KI2luY2x1ZGUgPGxpbnV4L3dhaXQuaD4K
I2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KI2luY2x1ZGUgPGxpbnV4L2RtYS1tYXBwaW5nLmg+CiNp
bmNsdWRlIDxsaW51eC9zbGFiLmg+CiNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4K
I2luY2x1ZGUgPGxpbnV4L3ZlcnNpb24uaD4KI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgoKI2luY2x1
ZGUgPG1hY2gvZG1hLmg+CgojaW5jbHVkZSA8bWVkaWEvdjRsMi1jb21tb24uaD4KI2luY2x1ZGUg
PG1lZGlhL3Y0bDItZGV2Lmg+CiNpbmNsdWRlIDxtZWRpYS92aWRlb2J1Zi1kbWEtY29udGlnLmg+
CiNpbmNsdWRlIDxtZWRpYS9zb2NfY2FtZXJhLmg+CiNpbmNsdWRlIDxtZWRpYS9zb2NfbWVkaWFi
dXMuaD4KI2luY2x1ZGUgPG1lZGlhL3Y0bDItY2hpcC1pZGVudC5oPgoKI2luY2x1ZGUgInB4YTk1
NV9jc2kuaCIKCk1PRFVMRV9BVVRIT1IoIlFpbmcgWHUgPHFpbmd4QG1hcnZlbGwuY29tPiIpOwpN
T0RVTEVfREVTQ1JJUFRJT04oIk1hcnZlbGwgUFhBOTU1IFNpbXBsZSBDYXB0dXJlIENvbnRyb2xs
ZXIgRHJpdmVyIik7Ck1PRFVMRV9MSUNFTlNFKCJHUEwiKTsKTU9EVUxFX1NVUFBPUlRFRF9ERVZJ
Q0UoIlZpZGVvIik7CgovKiBzY2kgcmVnaXN0ZXIsIHNjaTAgYmFzZTogMHg1MDAwMDAwMCovCiNk
ZWZpbmUgUkVHX1NDSUNSMAkweDAwMDAKI2RlZmluZSBSRUdfU0NJQ1IxCTB4MDAwNAojZGVmaW5l
IFJFR19TQ0lTUgkweDAwMDgKI2RlZmluZSBSRUdfU0NJTUFTSwkweDAwMEMKI2RlZmluZSBSRUdf
U0NJRklGTwkweDAwRjgKI2RlZmluZSBSRUdfU0NJRklGT1NSCTB4MDBGQwojZGVmaW5lIFJFR19T
Q0lEQUREUjAJMHgwMjAwCiNkZWZpbmUgUkVHX1NDSVNBRERSMAkweDAyMDQKI2RlZmluZSBSRUdf
U0NJVEFERFIwCTB4MDIwOAojZGVmaW5lIFJFR19TQ0lEQ01EMAkweDAyMEMKI2RlZmluZSBSRUdf
U0NJREFERFIxCTB4MDIxMAojZGVmaW5lIFJFR19TQ0lTQUREUjEJMHgwMjE0CiNkZWZpbmUgUkVH
X1NDSVRBRERSMQkweDAyMTgKI2RlZmluZSBSRUdfU0NJRENNRDEJMHgwMjFDCiNkZWZpbmUgUkVH
X1NDSURBRERSMgkweDAyMjAKI2RlZmluZSBSRUdfU0NJU0FERFIyCTB4MDIyNAojZGVmaW5lIFJF
R19TQ0lUQUREUjIJMHgwMjI4CiNkZWZpbmUgUkVHX1NDSURDTUQyCTB4MDIyQwojZGVmaW5lIFJF
R19TQ0lEQlIwCTB4MDMwMAojZGVmaW5lIFJFR19TQ0lEQ1NSMAkweDAzMDQKI2RlZmluZSBSRUdf
U0NJREJSMQkweDAzMTAKI2RlZmluZSBSRUdfU0NJRENTUjEJMHgwMzE0CiNkZWZpbmUgUkVHX1ND
SURCUjIJMHgwMzIwCiNkZWZpbmUgUkVHX1NDSURDU1IyCTB4MDMyNAoKI2RlZmluZQlJUlFfRU9G
WAkweDAwMDAwMDAxCiNkZWZpbmUJSVJRX0VPRgkJMHgwMDAwMDAwMgojZGVmaW5lCUlSUV9ESVMJ
CTB4MDAwMDAwMDQKI2RlZmluZQlJUlFfT0ZPCQkweDAwMDAwMDA4CiNkZWZpbmUJSVJRX0RCUwkJ
MHgwMDAwMDIwMAojZGVmaW5lCUlSUV9TT0ZYCTB4MDAwMDA0MDAKI2RlZmluZQlJUlFfU09GCQkw
eDAwMDAwODAwCgovKiBGTVRfWVVWNDIwICYgRk1UX1JHQjY2NiBvbmx5IGZvciBpbnB1dCBmb3Jt
YXQgd2l0aG91dCBvdXRwdXQgZm9ybWF0ICovCiNkZWZpbmUgICBGTVRfUkFXOAkgIDB4MDAwMAoj
ZGVmaW5lICAgRk1UX1JBVzEwCSAgMHgwMDAyCiNkZWZpbmUgICBGTVRfWVVWNDIyCSAgMHgwMDAz
CiNkZWZpbmUgICBGTVRfWVVWNDIwCSAgMHgwMDA0CiNkZWZpbmUgICBGTVRfUkdCNTY1CSAgMHgw
MDA1CiNkZWZpbmUgICBGTVRfUkdCNjY2CSAgMHgwMDA2CiNkZWZpbmUgICBGTVRfUkdCODg4CSAg
MHgwMDA3CiNkZWZpbmUgICBGTVRfSlBFRwkgIDB4MDAwOAojZGVmaW5lICAgRk1UX1lVVjQyMlBB
Q0tFVAkweDAwMDkKCiNkZWZpbmUgU0NJQ1IxX0ZNVF9PVVQobikgICAgICAgKChuKSA8PDEyKQkv
KiBPdXRwdXQgUGl4ZWwgRm9ybWF0ICg0IGJpdHMpICovCiNkZWZpbmUgU0NJQ1IxX0ZNVF9JTihu
KSAgICAgICAgKChuKSA8PDI4KQkvKiBJbnB1dCBQaXhlbCBGb3JtYXQgKDQgYml0cykgKi8KCi8q
IFJFR19TQ0lEQ1NSMCAqLwojZGVmaW5lIFNDSURDU1JfRE1BX1JVTiAgICAgICAgMHg4MDAwMDAw
MCAgCS8qIERNQSBDaGFubmVsIEVuYWJsZSAqLwoKLyogUkVHX1NDSUNSMCAqLwojZGVmaW5lIFND
SUNSMF9DQVBfRU4gICAgICAgICAgMHg0MDAwMDAwMCAJLyogQ2FwdHVyZSBFbmFibGUgKi8KI2Rl
ZmluZSBTQ0lDUjBfQ0lfRU4gICAgICAgICAgIDB4ODAwMDAwMDAgCS8qIENhbWVyYSBJbnRlcmZh
Y2UgRW5hYmxlICovCgovKiBSRUdfU0NJRklGTyAqLwojZGVmaW5lIFNDSUZJRk9fRnhfRU4gICAg
ICAgIDB4MDAxMAkvKiBGSUZPIDAgRW5hYmxlICovCgojZGVmaW5lIFNDSUZJRk9fRjBfRU4gICAg
ICAgIDB4MDAxMAkvKiBGSUZPIDAgRW5hYmxlICovCiNkZWZpbmUgU0NJRklGT19GMV9FTiAgICAg
ICAgMHgwMDIwCS8qIEZJRk8gMSBFbmFibGUgKi8KI2RlZmluZSBTQ0lGSUZPX0YyX0VOICAgICAg
ICAweDAwNDAJLyogRklGTyAyIEVuYWJsZSAqLwojZGVmaW5lIFNDSUZJRk9fRlhfRU4obikgICgo
bikgPDw0KQkJLyogSW5wdXQgUGl4ZWwgRm9ybWF0ICg0IGJpdHMpICovCgovKiBSRUdfU0NJREJS
eCovCiNkZWZpbmUgU0NJREJSX0VOIAkJKDB4MXU8PDEpIC8qRE1BIEJyYW5jaCBFbmFibGUqLwoK
I2RlZmluZSBWR0FfV0lEVEggICAgICAgNjQwCiNkZWZpbmUgVkdBX0hFSUdIVCAgICAgIDQ4MAoK
I2RlZmluZSBTRU5TT1JfTUFYIDIKCiNkZWZpbmUgUFhBOTU1X0NBTV9WRVJTSU9OX0NPREUgS0VS
TkVMX1ZFUlNJT04oMCwgMCwgNSkKI2RlZmluZSBQWEE5NTVfQ0FNX0RSVl9OQU1FICJweGE5NXgt
Y2FtZXJhIgoKI2RlZmluZSBKUEVHX0NPTVBSRVNTX1JBVElPX0hJR0ggMTAKI2RlZmluZSBDSEFO
TkVMX05VTSAzIAkJLypZVVYqLwojZGVmaW5lIE1BWF9ETUFfQlVGUyA0CiNkZWZpbmUgTUlOX0RN
QV9CVUZTIDIKI2RlZmluZSBNQVhfRE1BX1NJWkUgKDE5MjAqMTA4MCozLzIpCiNkZWZpbmUgSlBF
R19CVUZfU0laRSAoMTAyNCoxMDI0KQoKc3RhdGljIHVuc2lnbmVkIGludCB2aWRfbWVtX2xpbWl0
ID0gMTY7CS8qIFZpZGVvIG1lbW9yeSBsaW1pdCwgaW4gTWIgKi8KCi8qIGRlc2NyaXB0b3IgbmVl
ZGVkIGZvciB0aGUgY2FtZXJhIGNvbnRyb2xsZXIgRE1BIGVuZ2luZSAqLwpzdHJ1Y3QgcHhhX2Nh
bV9kbWEgewoJZG1hX2FkZHJfdAlzZ19kbWE7CglzdHJ1Y3QgcHhhX2RtYV9kZXNjCSpzZ19jcHU7
CglzaXplX3QJc2dfc2l6ZTsKCWludAlzZ2xlbjsKfTsKCnN0cnVjdCBweGFfYnVmX25vZGUgewoJ
LyogY29tbW9uIHY0bCBidWZmZXIgc3R1ZmYgLS0gbXVzdCBiZSBmaXJzdCAqLwoJc3RydWN0IHZp
ZGVvYnVmX2J1ZmZlciB2YjsKCWVudW0gdjRsMl9tYnVzX3BpeGVsY29kZQljb2RlOwoJc3RydWN0
IHBhZ2UgKnBhZ2U7CglzdHJ1Y3QgcHhhX2NhbV9kbWEgZG1hX2Rlc2NbQ0hBTk5FTF9OVU1dOwp9
OwoKc3RydWN0IHB4YTk1NV9jYW1fZGV2IHsKCXN0cnVjdCBzb2NfY2FtZXJhX2hvc3QJc29jX2hv
c3Q7CglzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZDsKCXN0cnVjdCBsaXN0X2hlYWQgZGV2
X2xpc3Q7CS8qIGxpbmsgdG8gb3RoZXIgZGV2aWNlcyAqLwoKCXN0cnVjdCBjbGsgKnNjaTFfY2xr
OwoJc3RydWN0IGNsayAqc2NpMl9jbGs7CgoJc3RydWN0IHB4YTk1NV9jc2lfZGV2CQkqY3NpZGV2
OwoJdW5zaWduZWQgaW50CQlpcnE7Cgl2b2lkIF9faW9tZW0JCSpyZWdzOwoJd2FpdF9xdWV1ZV9o
ZWFkX3QgaW93YWl0OwkvKiB3YWl0aW5nIG9uIGZyYW1lIGRhdGEgKi8KCWJvb2wgc3RyZWFtb247
Cglib29sIHN0cmVhbW9mZjsKCglzdHJ1Y3QgcmVzb3VyY2UJCSpyZXM7Cgl1bnNpZ25lZCBsb25n
CQlwbGF0Zm9ybV9mbGFnczsKCgkvKiBETUEgYnVmZmVycyAqLwoJc3RydWN0IGxpc3RfaGVhZCBk
bWFfYnVmX2xpc3Q7CS8qZG1hIGJ1ZmZlciBsaXN0LCB0aGUgbGlzdCBtZW1iZXIgaXMgYnVmX25v
ZGUqLwoJdW5zaWduZWQgaW50IGRtYV9idWZfc2l6ZTsJCS8qIGFsbG9jYXRlZCBzaXplICovCgl1
bnNpZ25lZCBpbnQgY2hhbm5lbHM7Cgl1bnNpZ25lZCBpbnQgY2hhbm5lbF9zaXplW0NIQU5ORUxf
TlVNXTsKCgkvKiBzdHJlYW1pbmcgYnVmZmVycyAqLwoJc3BpbmxvY2tfdCBzcGluX2xvY2s7ICAv
KiBBY2Nlc3MgdG8gZGV2aWNlICovCgoJc3RydWN0IHB4YTk1NV9jYW1lcmFfcGRhdGEgKnBkYXRh
Owp9OwoKLyogcmVmZXIgdG8gdmlkZW9idWYtZG1hLWNvbnRpZy5jKi8Kc3RydWN0IHZpZGVvYnVm
X2RtYV9jb250aWdfbWVtb3J5IHsKCXUzMiBtYWdpYzsKCXZvaWQgKnZhZGRyOwoJZG1hX2FkZHJf
dCBkbWFfaGFuZGxlOwoJdW5zaWduZWQgbG9uZyBzaXplOwoJaW50IGlzX3VzZXJwdHI7Cn07Cgoj
ZGVmaW5lIE1BR0lDX0RDX01FTSAweDA3MzNhYzYxCiNkZWZpbmUgTUFHSUNfQ0hFQ0soaXMsIHNo
b3VsZCkJCQkJCSAgICBcCglpZiAodW5saWtlbHkoKGlzKSAhPSAoc2hvdWxkKSkpCXsJCQkJICAg
IFwKCQlwcl9lcnIoIm1hZ2ljIG1pc21hdGNoOiAleCBleHBlY3RlZCAleFxuIiwgKGlzKSwgKHNo
b3VsZCkpOyBcCgkJQlVHKCk7CQkJCQkJCSAgICBcCgl9CgovKiBMZW4gc2hvdWxkIDggYnl0ZXMg
YWxpZ24sIGJpdFsyOjBdIHNob3VsZCBiZSAwICovCiNkZWZpbmUgU0lOR0xFX0RFU0NfVFJBTlNf
TUFYICAgKDEgPDwgMjQpCgpleHRlcm4gc3RydWN0IHB4YTk1NV9jc2lfZGV2ICpjc2lfZGV2aWNl
OwpzdGF0aWMgaW50IGNzaV9hdHRhY2goc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldikKewoJ
aWYgKGNzaV9kZXZpY2UgIT0gTlVMTCkgewoJCXBjZGV2LT5jc2lkZXYgPSBjc2lfZGV2aWNlOwoJ
CXJldHVybiAwOwoJfQoKCXByaW50ayhLRVJOX0VSUiAiY2FtOiBmYWlsZWQgdG8gZmluZCBDU0kg
ZGV2aWNlIVxuIik7CglyZXR1cm4gLUVOT0RFVjsKfQoKc3RhdGljIGlubGluZSB2b2lkIHNjaV9y
ZWdfd3JpdGUoc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldiwgdW5zaWduZWQgaW50IHJlZywK
CQl1bnNpZ25lZCBpbnQgdmFsKQp7CglfX3Jhd193cml0ZWwodmFsLCBwY2Rldi0+cmVncyArIHJl
Zyk7Cn0KCnN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IHNjaV9yZWdfcmVhZChzdHJ1Y3QgcHhh
OTU1X2NhbV9kZXYgKnBjZGV2LAoJCXVuc2lnbmVkIGludCByZWcpCnsKCXJldHVybiBfX3Jhd19y
ZWFkbChwY2Rldi0+cmVncyArIHJlZyk7Cn0KCgpzdGF0aWMgaW5saW5lIHZvaWQgc2NpX3JlZ193
cml0ZV9tYXNrKHN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYsIHVuc2lnbmVkIGludCByZWcs
CgkJdW5zaWduZWQgaW50IHZhbCwgdW5zaWduZWQgaW50IG1hc2spCnsKCXVuc2lnbmVkIGludCB2
ID0gc2NpX3JlZ19yZWFkKHBjZGV2LCByZWcpOwoKCXYgPSAodiAmIH5tYXNrKSB8ICh2YWwgJiBt
YXNrKTsKCXNjaV9yZWdfd3JpdGUocGNkZXYsIHJlZywgdik7Cn0KCnN0YXRpYyBpbmxpbmUgdm9p
ZCBzY2lfcmVnX2NsZWFyX2JpdChzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2LAoJCXVuc2ln
bmVkIGludCByZWcsIHVuc2lnbmVkIGludCB2YWwpCnsKCXNjaV9yZWdfd3JpdGVfbWFzayhwY2Rl
diwgcmVnLCAwLCB2YWwpOwp9CgpzdGF0aWMgaW5saW5lIHZvaWQgc2NpX3JlZ19zZXRfYml0KHN0
cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYsCgkJdW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQg
aW50IHZhbCkKewoJc2NpX3JlZ193cml0ZV9tYXNrKHBjZGV2LCByZWcsIHZhbCwgdmFsKTsKfQoK
I2lmZGVmIERFQlVHCnN0YXRpYyB2b2lkIHNjaV9kdW1wX3JlZ2lzdGVycyhzdHJ1Y3QgcHhhOTU1
X2NhbV9kZXYgKnBjZGV2KQp7CglwcmludGsoS0VSTl9FUlIgIlNDSUNSMCAweCV4XG4iLCBzY2lf
cmVnX3JlYWQocGNkZXYsIFJFR19TQ0lDUjApKTsKCXByaW50ayhLRVJOX0VSUiAiU0NJQ1IxIDB4
JXhcbiIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSUNSMSkpOwoJcHJpbnRrKEtFUk5fRVJS
ICJTQ0lTUiAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lTUikpOwoJcHJpbnRr
KEtFUk5fRVJSICJTQ0lNQVNLIDB4JXhcbiIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSU1B
U0spKTsKCXByaW50ayhLRVJOX0VSUiAiU0NJRklGTyAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNk
ZXYsIFJFR19TQ0lGSUZPKSk7CglwcmludGsoS0VSTl9FUlIgIlNDSUZJRk9TUiAweCV4XG4iLCBz
Y2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lGSUZPU1IpKTsKCglwcmludGsoS0VSTl9FUlIgIlND
SURBRERSMCAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lEQUREUjApKTsKCXBy
aW50ayhLRVJOX0VSUiAiU0NJU0FERFIwIDB4JXhcbiIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVH
X1NDSVNBRERSMCkpOwoJcHJpbnRrKEtFUk5fRVJSICJTQ0lUQUREUjAgMHgleFxuIiwgc2NpX3Jl
Z19yZWFkKHBjZGV2LCBSRUdfU0NJVEFERFIwKSk7CglwcmludGsoS0VSTl9FUlIgIlNDSURDTUQw
IDB4JXhcbiIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSURDTUQwKSk7CgoJcHJpbnRrKEtF
Uk5fRVJSICJTQ0lEQUREUjEgMHgleFxuIiwgc2NpX3JlZ19yZWFkKHBjZGV2LCBSRUdfU0NJREFE
RFIxKSk7CglwcmludGsoS0VSTl9FUlIgIlNDSVNBRERSMSAweCV4XG4iLCBzY2lfcmVnX3JlYWQo
cGNkZXYsIFJFR19TQ0lTQUREUjEpKTsKCXByaW50ayhLRVJOX0VSUiAiU0NJVEFERFIxIDB4JXhc
biIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSVRBRERSMSkpOwoJcHJpbnRrKEtFUk5fRVJS
ICJTQ0lEQ01EMSAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lEQ01EMSkpOwoK
CXByaW50ayhLRVJOX0VSUiAiU0NJREFERFIyIDB4JXhcbiIsIHNjaV9yZWdfcmVhZChwY2Rldiwg
UkVHX1NDSURBRERSMikpOwoJcHJpbnRrKEtFUk5fRVJSICJTQ0lTQUREUjIgMHgleFxuIiwgc2Np
X3JlZ19yZWFkKHBjZGV2LCBSRUdfU0NJU0FERFIyKSk7CglwcmludGsoS0VSTl9FUlIgIlNDSVRB
RERSMiAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lUQUREUjIpKTsKCXByaW50
ayhLRVJOX0VSUiAiU0NJRENNRDIgMHgleFxuIiwgc2NpX3JlZ19yZWFkKHBjZGV2LCBSRUdfU0NJ
RENNRDIpKTsKCglwcmludGsoS0VSTl9FUlIgIlNDSURCUjAgMHgleFxuIiwgc2NpX3JlZ19yZWFk
KHBjZGV2LCBSRUdfU0NJREJSMCkpOwoJcHJpbnRrKEtFUk5fRVJSICJTQ0lEQ1NSMCAweCV4XG4i
LCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lEQ1NSMCkpOwoKCXByaW50ayhLRVJOX0VSUiAi
U0NJREJSMSAweCV4XG4iLCBzY2lfcmVnX3JlYWQocGNkZXYsIFJFR19TQ0lEQlIxKSk7Cglwcmlu
dGsoS0VSTl9FUlIgIlNDSURDU1IxIDB4JXhcbiIsIHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1ND
SURDU1IxKSk7CgoJcHJpbnRrKEtFUk5fRVJSICJTQ0lEQlIyIDB4JXhcbiIsIHNjaV9yZWdfcmVh
ZChwY2RldiwgUkVHX1NDSURCUjIpKTsKCXByaW50ayhLRVJOX0VSUiAiU0NJRENTUjIgMHgleFxu
Iiwgc2NpX3JlZ19yZWFkKHBjZGV2LCBSRUdfU0NJRENTUjIpKTsKfQoKc3RhdGljIHZvaWQgZG1h
X2R1bXBfZGVzYyhzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2KQp7CglpbnQgaSwgazsKCXN0
cnVjdCBweGFfYnVmX25vZGUgKmJ1Zl9ub2RlOwoJcHJpbnRrKEtFUk5fRVJSICJjYW06IGR1bXBf
ZG1hX2Rlc2MgKioqKioqKioqKioqK1xuIik7CgoJcHJpbnRrKEtFUk5fRVJSICJkbWFfYnVmX2xp
c3QgaGVhZCAweCV4XG4iLCh1bnNpZ25lZCBpbnQpJnBjZGV2LT5kbWFfYnVmX2xpc3QpOwoJbGlz
dF9mb3JfZWFjaF9lbnRyeShidWZfbm9kZSwgJnBjZGV2LT5kbWFfYnVmX2xpc3QsIHZiLnF1ZXVl
KSAgewoJCQlwcmludGsoS0VSTl9FUlIgImJ1Zl9ub2RlIDB4JXhcbiIsKHVuc2lnbmVkIGludCli
dWZfbm9kZSk7CgoJCWZvciAoaSA9IDA7IGkgPCBwY2Rldi0+Y2hhbm5lbHM7IGkrKyl7CgkJCXBy
aW50ayhLRVJOX0VSUiAiY2hubmwgJWQsIGNobm5sX3NpemUgJWQsIHNnbGVuICVkLCBzZ2RtYSAw
eCV4LCBzZ3N6ZSAlZFxuIiwKCQkJCWkscGNkZXYtPmNoYW5uZWxfc2l6ZVtpXSxidWZfbm9kZS0+
ZG1hX2Rlc2NbaV0uc2dsZW4sYnVmX25vZGUtPmRtYV9kZXNjW2ldLnNnX2RtYSxidWZfbm9kZS0+
ZG1hX2Rlc2NbaV0uc2dfc2l6ZSk7CgkJCWZvciAoayA9IDA7IGsgPCBidWZfbm9kZS0+ZG1hX2Rl
c2NbaV0uc2dsZW47IGsrKykgewoJCQkJcHJpbnRrKEtFUk5fRVJSICJkY21kIFslZF0gIDB4JXhc
biIsayxidWZfbm9kZS0+ZG1hX2Rlc2NbaV0uc2dfY3B1W2tdLmRjbWQpOwoJCQkJcHJpbnRrKEtF
Uk5fRVJSICJkZGFkclslZF0gIDB4JXhcbiIsayxidWZfbm9kZS0+ZG1hX2Rlc2NbaV0uc2dfY3B1
W2tdLmRkYWRyKTsKCQkJCXByaW50ayhLRVJOX0VSUiAiZHNhZHJbJWRdICAweCV4XG4iLGssYnVm
X25vZGUtPmRtYV9kZXNjW2ldLnNnX2NwdVtrXS5kc2Fkcik7CgkJCQlwcmludGsoS0VSTl9FUlIg
ImR0YWRyWyVkXSAgMHgleFxuXG4iLGssYnVmX25vZGUtPmRtYV9kZXNjW2ldLnNnX2NwdVtrXS5k
dGFkcik7CgkJCX0KCQl9Cgl9CgoJcHJpbnRrKEtFUk5fRVJSICJjYW06IGR1bXBfZG1hX2Rlc2Mg
KioqKioqKioqKioqLVxuXG4iKTsKfQoKc3RhdGljIHZvaWQgZG1hX2R1bXBfYnVmX2xpc3Qoc3Ry
dWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldikKewoJc3RydWN0IHB4YV9idWZfbm9kZSAqYnVmX25v
ZGU7CglkbWFfYWRkcl90IGRtYV9oYW5kbGVzOwoKCXByaW50ayhLRVJOX0VSUiAiY2FtOiBkdW1w
X2RtYV9idWZfbGlzdCAqKioqKioqKioqKiorXG4iKTsKCWxpc3RfZm9yX2VhY2hfZW50cnkoYnVm
X25vZGUsICZwY2Rldi0+ZG1hX2J1Zl9saXN0LCB2Yi5xdWV1ZSkgewoJCWRtYV9oYW5kbGVzID0g
dmlkZW9idWZfdG9fZG1hX2NvbnRpZygmYnVmX25vZGUtPnZiKTsKCQlwcmludGsoS0VSTl9FUlIg
ImNhbTogYnVmX25vZGUgMHgleCwgcGEgMHgleFxuIiwKCQkJKHVuc2lnbmVkIGludClidWZfbm9k
ZSwgZG1hX2hhbmRsZXMpOwoJfQoJcHJpbnRrKEtFUk5fRVJSICJjYW06IGR1bXBfZG1hX2J1Zl9s
aXN0ICoqKioqKioqKioqKi1cblxuIik7Cn0KI2VuZGlmCgovKiBvbmx5IGhhbmRsZSBpbiBpcnEg
Y29udGV4dCovCnN0YXRpYyB2b2lkIGRtYV9mZXRjaF9mcmFtZShzdHJ1Y3QgcHhhOTU1X2NhbV9k
ZXYgKnBjZGV2KQp7CglzdHJ1Y3QgcHhhX2J1Zl9ub2RlICpidWZfbm9kZSA9IE5VTEw7CglpbnQg
bm9kZV9udW0gPSAwOwoJZG1hX2FkZHJfdCBkbWFfaGFuZGxlczsKCXN0cnVjdCBkZXZpY2UgKmRl
diA9IHBjZGV2LT5zb2NfaG9zdC52NGwyX2Rldi5kZXY7CgoJbGlzdF9mb3JfZWFjaF9lbnRyeShi
dWZfbm9kZSwgJnBjZGV2LT5kbWFfYnVmX2xpc3QsIHZiLnF1ZXVlKSB7CgkJaWYgKGJ1Zl9ub2Rl
LT52Yi5zdGF0ZSA9PSBWSURFT0JVRl9RVUVVRUQpCgkJCW5vZGVfbnVtKys7Cgl9CglpZiAobm9k
ZV9udW0gPiAxKSB7CgkJLyoKCQkqIGdldCB0aGUgZmlyc3Qgbm9kZSBvZiBkbWFfbGlzdCwgaXQg
bXVzdCBoYXZlIGJlZW4gZmlsbGVkIGJ5IGRtYSwgYW5kCgkJKiByZW1vdmUgaXQgZnJvbSBkbWEt
YnVmLWxpc3QuCgkJKi8KCQlidWZfbm9kZSA9IGxpc3RfZW50cnkocGNkZXYtPmRtYV9idWZfbGlz
dC5uZXh0LAoJCQlzdHJ1Y3QgcHhhX2J1Zl9ub2RlLCB2Yi5xdWV1ZSk7CgkJZG1hX2hhbmRsZXMg
PSB2aWRlb2J1Zl90b19kbWFfY29udGlnKCZidWZfbm9kZS0+dmIpOwoKCQkvKiBpbnZhbGlkIGNh
Y2hlLCB0byBtYWtlIHN1cmUgdXNlciBjb3VsZCBnZXQgdGhlIHJlYWwgZGF0YSBmcm9tIEREUiov
CgkJZG1hX21hcF9wYWdlKGRldiwKCQkJCWJ1Zl9ub2RlLT5wYWdlLAoJCQkJMCwKCQkJCWJ1Zl9u
b2RlLT52Yi5ic2l6ZSwKCQkJCURNQV9GUk9NX0RFVklDRSk7CgoJCS8qIFRPRE86IGZvciBKUEVH
CgoJCWlmIChwY2Rldi0+cGl4X2Zvcm1hdC5waXhlbGZvcm1hdCA9PSBWNEwyX1BJWF9GTVRfSlBF
RykgewoJCQlkbWFfc3luY19zaW5nbGVfZm9yX2RldmljZSgmcGNkZXYtPnBkZXYtPmRldiwKCQkJ
CQkJCXNidWYtPmRtYV9oYW5kbGVzLAoJCQkJCQkJc2J1Zi0+djRsYnVmLmxlbmd0aCwKCQkJCQkJ
CURNQV9GUk9NX0RFVklDRSk7CgkJCWlmICgoKChjaGFyICopYnVmX25vZGUtPmRtYV9idWZzKVsw
XSAhPSAweGZmKQoJCQl8fCAoKChjaGFyICopYnVmX25vZGUtPmRtYV9idWZzKVsxXSAhPSAweGQ4
KSkKCQkJCXByaW50ayhLRVJOX0VSUiAiY2FtOiBKUEVHIEVSUk9SICEhISBkcm9wcGVkIHRoaXMg
ZnJhbWUuXG4iKTsKCQl9CgkJKi8KCQlidWZfbm9kZS0+dmIuc3RhdGUgPSBWSURFT0JVRl9ET05F
OwoJCXdha2VfdXAoJmJ1Zl9ub2RlLT52Yi5kb25lKTsKCQlsaXN0X2RlbF9pbml0KCZidWZfbm9k
ZS0+dmIucXVldWUpOwoJfSBlbHNlIHsKCQkvKmlmIHRoZXJlIGlzIG9ubHkgb25lIGxlZnQgaW4g
ZG1hX2xpc3QsIGRyb3AgaXQhKi8KCQlwcmludGsoS0VSTl9ERUJVRyAiY2FtOiBkcm9wIGEgZnJh
bWUhXG4iKTsKCX0KCn0KCnN0YXRpYyB2b2lkIGRtYV9hcHBlbmRfZGVzYyhzdHJ1Y3QgcHhhOTU1
X2NhbV9kZXYqIHBjZGV2LAoJCQkJCQkJCXN0cnVjdCBweGFfYnVmX25vZGUqIHByZSwKCQkJCQkJ
CQlzdHJ1Y3QgcHhhX2J1Zl9ub2RlKiBuZXh0KQp7CglpbnQgaSA9IDA7CglzdHJ1Y3QgcHhhX2Nh
bV9kbWEgKnByZV9kbWEgPSBOVUxMLCAqbmV4dF9kbWEgPSBOVUxMOwoKCWZvciAoaSA9IDA7IGkg
PCBwY2Rldi0+Y2hhbm5lbHM7IGkrKykgewoJCXByZV9kbWEgPSAmcHJlLT5kbWFfZGVzY1tpXTsK
CQluZXh0X2RtYSA9ICZuZXh0LT5kbWFfZGVzY1tpXTsKCQlwcmVfZG1hLT5zZ19jcHVbcHJlX2Rt
YS0+c2dsZW4tMV0uZGRhZHIgPSAodTMyKW5leHRfZG1hLT5zZ19kbWE7Cgl9CglwcmludGsoS0VS
Tl9ERUJVRyAiY2FtOiBhcHBlbmQgbmV3IGRtYSAweCV4IHRvIDB4JXhcbiIsCgkJbmV4dF9kbWEt
PnNnX2RtYSwgcHJlX2RtYS0+c2dfZG1hKTsKfQoKc3RhdGljIHZvaWQgZG1hX2F0dGFjaF9idWZz
KHN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYpCnsKCXN0cnVjdCBweGFfYnVmX25vZGUgKmJ1
Zl9ub2RlID0gTlVMTDsKCXN0cnVjdCBweGFfYnVmX25vZGUgKnRhaWxfbm9kZSA9IE5VTEw7Cgl1
bnNpZ25lZCBpbnQgcmVndmFsOwoJYm9vbCBkbWFfYnJhbmNoZWQgPSBmYWxzZTsKCglsaXN0X2Zv
cl9lYWNoX2VudHJ5KGJ1Zl9ub2RlLCAmcGNkZXYtPmRtYV9idWZfbGlzdCwgdmIucXVldWUpIHsK
CgkJaWYgKGJ1Zl9ub2RlLT52Yi5zdGF0ZSA9PSBWSURFT0JVRl9RVUVVRUQpCgkJCWNvbnRpbnVl
OwoKCQkvKgoJCSogd2UgZ290IGEgbmV3IGVuLXF1ZXVlIGJ1ZiB3aGljaCBpcyBub3QgaW4gSFcg
ZG1hIGNoYWluLCBhcHBlbmQgaXQgdG8KCQkqIHRoZSB0YWlsIG9mIEhXIGRtYSBjaGFpbiwgYW5k
IGxvb3AgdGhlIHRhaWwgdG8gaXRzZWxmLgoJCSovCgkJaWYgKGJ1Zl9ub2RlLT52Yi5zdGF0ZSA9
PSBWSURFT0JVRl9BQ1RJVkUpIHsKCgkJCXRhaWxfbm9kZSA9IGxpc3RfZW50cnkoYnVmX25vZGUt
PnZiLnF1ZXVlLnByZXYsCgkJCQkJCXN0cnVjdCBweGFfYnVmX25vZGUsIHZiLnF1ZXVlKTsKCgkJ
CS8qCgkJCSogTk9URSEhISBvbmx5IG9uZSBkZXNjIGZvciBvbmUgZnJhbWUgYnVmZmVyLCBpZiBu
b3QgaW4gdGhpcyB3YXksCgkJCSogbmVlZCBjaGFuZ2UgaGVyZSwgYXMgcGh5IGFkZHIgbWlnaHQg
bm90IGxvY2F0ZWQgYmV0d2VlbiB0aGUKCQkJKiBiZWdpbiBhbmQgZW5kLCBwaHkgYWRkciBtaWdo
dCBub3QgY29udGludW91cyBiZXR3ZWVuIGRpZmZlcmVudAoJCQkqIGRlc2Mgb2Ygb25lIGZyYW1l
IGJ1ZmZlci4KCQkJKi8KCQkJcmVndmFsID0gc2NpX3JlZ19yZWFkKHBjZGV2LCBSRUdfU0NJVEFE
RFIwKTsKCQkJaWYgKCgocmVndmFsID49IHZpZGVvYnVmX3RvX2RtYV9jb250aWcoJnRhaWxfbm9k
ZS0+dmIpKQoJCQkJJiYgKHJlZ3ZhbCA8ICh2aWRlb2J1Zl90b19kbWFfY29udGlnKCZ0YWlsX25v
ZGUtPnZiKQoJCQkJKyBwY2Rldi0+Y2hhbm5lbF9zaXplWzBdKSkpCgkJCQkmJiAoZG1hX2JyYW5j
aGVkID09IGZhbHNlKSkgewoJCQkJLyoKCQkJCSogaWYgd2UgZmluZCBETUEgaXMgbG9vcGluZyBp
biB0aGUgbGFzdCBidWYsIGFuZCB0aGVyZSBpcyBuZXcKCQkJCSogY29taW5nIGJ1ZiwgKERNQSB0
YXJnZXQgYWRkcmVzcyBzaG93cyB0aGF0IERNQSBpcyB3b3JraW5nIGluCgkJCQkqIHRoZSB0YWls
IGJ1ZmZlcikgd2UgU0hPVUxEIHNldCBETUEgYnJhbmNoIHJlZywgZm9yY2UgRE1BIG1vdmUKCQkJ
CSogdG8gdGhlIG5ldyBidWYgZGVzY3JpcHRvciBpbiB0aGUgbmV4dCBmcmFtZSwgc28gd2UgY2Fu
IHBpY2sgdXAKCQkJCSogdGhpcyBidWYgd2hlbiBuZXh0IGlycSBjb21lcy4KCQkJCSovCgkJCQlk
bWFfYnJhbmNoZWQgPSB0cnVlOwoJCQkJc2NpX3JlZ193cml0ZShwY2RldiwgUkVHX1NDSURCUjAs
IChidWZfbm9kZS0+ZG1hX2Rlc2NbMF0uc2dfZG1hIHwgU0NJREJSX0VOKSk7CgkJCQlpZihwY2Rl
di0+Y2hhbm5lbHMgPT0gMykgewoJCQkJCXNjaV9yZWdfd3JpdGUocGNkZXYsIFJFR19TQ0lEQlIx
LCAoYnVmX25vZGUtPmRtYV9kZXNjWzFdLnNnX2RtYSB8IFNDSURCUl9FTikpOwoJCQkJCXNjaV9y
ZWdfd3JpdGUocGNkZXYsIFJFR19TQ0lEQlIyLCAoYnVmX25vZGUtPmRtYV9kZXNjWzJdLnNnX2Rt
YSB8IFNDSURCUl9FTikpOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJLyoKCQkJCSogaWYgaXQgaXMg
bm90IHRoZSBsYXN0IGJ1ZiB3aGljaCBETUEgbG9vcGluZyBpbiwganVzdCBhcHBlbmQKCQkJCSog
ZGVzYyB0byB0aGUgdGFpbCBvZiB0aGUgRE1BIGNoYWluLgoJCQkJKi8KCQkJCWRtYV9hcHBlbmRf
ZGVzYyhwY2RldiwgdGFpbF9ub2RlLCBidWZfbm9kZSk7CgkJCX0KCQkJZG1hX2FwcGVuZF9kZXNj
KHBjZGV2LCBidWZfbm9kZSwgYnVmX25vZGUpOwoJCQlidWZfbm9kZS0+dmIuc3RhdGUgPSBWSURF
T0JVRl9RVUVVRUQ7CgkJfQoJfQoKfQoKc3RhdGljIGludCBkbWFfYWxsb2NfZGVzYyhzdHJ1Y3Qg
cHhhX2J1Zl9ub2RlICpidWZfbm9kZSwKCQkJCQlzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2
KQp7CglpbnQgaTsKCXVuc2lnbmVkIGludCAJbGVuID0gMCwgbGVuX3RtcCA9IDA7CglweGFfZG1h
X2Rlc2MgCSpkbWFfZGVzY190bXA7Cgl1bnNpZ25lZCBsb25nIAlkbWFfZGVzY19waHlfdG1wOwoJ
dW5zaWduZWQgbG9uZyAJc3JjcGh5YWRkciwgZHN0cGh5YWRkcjsKCXN0cnVjdCBweGFfY2FtX2Rt
YSAqZGVzYzsKCXN0cnVjdCB2aWRlb2J1Zl9idWZmZXIgKnZiID0gJmJ1Zl9ub2RlLT52YjsKCXN0
cnVjdCBkZXZpY2UgKmRldiA9IHBjZGV2LT5zb2NfaG9zdC52NGwyX2Rldi5kZXY7CglzcmNwaHlh
ZGRyID0gMDsJLyogVEJEICovCgoJZHN0cGh5YWRkciA9IHZpZGVvYnVmX3RvX2RtYV9jb250aWco
dmIpOwoKCWZvciAoaSA9IDA7IGkgPCBwY2Rldi0+Y2hhbm5lbHM7IGkrKykgewoJCXByaW50ayhL
RVJOX0RFQlVHICJjYW06IGluZGV4ICVkLCBjaGFubmVscyAlZFxuIix2Yi0+aSwgaSk7CgkJZGVz
YyA9ICZidWZfbm9kZS0+ZG1hX2Rlc2NbaV07CgkJbGVuID0gcGNkZXYtPmNoYW5uZWxfc2l6ZVtp
XTsKCgkJZGVzYy0+c2dsZW4gPSAobGVuICsgU0lOR0xFX0RFU0NfVFJBTlNfTUFYIC0gMSkgLyBT
SU5HTEVfREVTQ19UUkFOU19NQVg7CgkJZGVzYy0+c2dfc2l6ZSA9IChkZXNjLT5zZ2xlbikgKiBz
aXplb2Yoc3RydWN0IHB4YV9kbWFfZGVzYyk7CgoJCWlmIChkZXNjLT5zZ19jcHUgPT0gTlVMTCl7
CgkJCWRlc2MtPnNnX2NwdSA9IGRtYV9hbGxvY19jb2hlcmVudChkZXYsIGRlc2MtPnNnX3NpemUs
CgkJCQkJICAgICAmZGVzYy0+c2dfZG1hLCBHRlBfS0VSTkVMKTsKCQl9CgkJcHJpbnRrKEtFUk5f
REVCVUcgImNhbTogc2dsZW4gJWQsIHNpemUgJWQsIHNnX2NwdSAweCV4XG4iLAoJCQlkZXNjLT5z
Z2xlbiwgZGVzYy0+c2dfc2l6ZSwgKHVuc2lnbmVkIGludClkZXNjLT5zZ19jcHUpOwoJCWlmICgh
ZGVzYy0+c2dfY3B1KXsKCQkJcHJpbnRrKEtFUk5fRVJSICJjYW06IGRtYV9hbGxvY19jb2hlcmVu
dCBmYWlsZWQgYXQgY2hubmwgJWQhXG4iLCBpKTsKCQkJZ290byBlcnI7CgkJfQoKCQlkbWFfZGVz
Y190bXAgPSBkZXNjLT5zZ19jcHU7CgkJZG1hX2Rlc2NfcGh5X3RtcCA9IGRlc2MtPnNnX2RtYTsK
CgkJd2hpbGUgKGxlbikgewoJCQlsZW5fdG1wID0gbGVuID4gU0lOR0xFX0RFU0NfVFJBTlNfTUFY
ID8KCQkJCVNJTkdMRV9ERVNDX1RSQU5TX01BWCA6IGxlbjsKCgkJCWlmICgoZHN0cGh5YWRkciAm
IDB4ZikgIT0gMCkgewoJCQkJcHJpbnRrKEtFUk5fRVJSICJjYW06IGVycm9yOiBhdCBsZWFzdCB3
ZSBuZWVkIDE2Ynl0ZXMgYWxpZ24gZm9yIERNQSFcbiIpOwoJCQkJZ290byBlcnI7CgkJCX0KCQkJ
ZG1hX2Rlc2NfdG1wLT5kZGFkciA9IGRtYV9kZXNjX3BoeV90bXAgKyBzaXplb2YocHhhX2RtYV9k
ZXNjKTsKCQkJZG1hX2Rlc2NfdG1wLT5kc2FkciA9IHNyY3BoeWFkZHI7IC8qIFRCRCAqLwoJCQlk
bWFfZGVzY190bXAtPmR0YWRyID0gZHN0cGh5YWRkcjsKCQkJZG1hX2Rlc2NfdG1wLT5kY21kID0g
bGVuX3RtcDsKCgkJCWxlbiAtPSBsZW5fdG1wOwoJCQlkbWFfZGVzY190bXArKzsKCQkJZG1hX2Rl
c2NfcGh5X3RtcCArPSBzaXplb2YocHhhX2RtYV9kZXNjKTsKCQkJZHN0cGh5YWRkciArPSBsZW5f
dG1wOwoKCQl9Cgl9CglyZXR1cm4gMDsKCmVycjoKCWZvciAoaSA9IDA7IGkgPCBwY2Rldi0+Y2hh
bm5lbHM7IGkrKykgewoJCWRlc2MgPSAmYnVmX25vZGUtPmRtYV9kZXNjW2ldOwoJCWlmIChkZXNj
LT5zZ19jcHUpIHsKCQkJZG1hX2ZyZWVfY29oZXJlbnQoZGV2LCBkZXNjLT5zZ19zaXplLAoJCQkJ
ICAgIGRlc2MtPnNnX2NwdSwgZGVzYy0+c2dfZG1hKTsKCQkJZGVzYy0+c2dfY3B1ID0gMDsKCQl9
Cgl9CglyZXR1cm4gLUVOT01FTTsKfQoKc3RhdGljIHZvaWQgZG1hX2ZyZWVfZGVzYyhzdHJ1Y3Qg
cHhhX2J1Zl9ub2RlICpidWZfbm9kZSwKCQkJCQkJCXN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNk
ZXYpCnsKCWludCBpOwoJc3RydWN0IHB4YV9jYW1fZG1hICpkZXNjOwoJc3RydWN0IGRldmljZSAq
ZGV2ID0gcGNkZXYtPnNvY19ob3N0LnY0bDJfZGV2LmRldjsKCglmb3IgKGkgPSAwOyBpIDwgcGNk
ZXYtPmNoYW5uZWxzOyBpKyspIHsKCQlkZXNjID0gJmJ1Zl9ub2RlLT5kbWFfZGVzY1tpXTsKCQlp
ZiAoZGVzYy0+c2dfY3B1KXsKCQkJZG1hX2ZyZWVfY29oZXJlbnQoZGV2LCBkZXNjLT5zZ19zaXpl
LAoJCQkJICAgIGRlc2MtPnNnX2NwdSwgZGVzYy0+c2dfZG1hKTsKCQkJZGVzYy0+c2dfY3B1ID0g
MDsKCQl9Cgl9Cn0KCnN0YXRpYyB2b2lkIGRtYV9mcmVlX2J1ZnMoc3RydWN0IHZpZGVvYnVmX3F1
ZXVlICp2cSwKCQkJCXN0cnVjdCBweGFfYnVmX25vZGUgKmJ1ZiwKCQkJCXN0cnVjdCBweGE5NTVf
Y2FtX2RldiAqcGNkZXYpCnsKCXN0cnVjdCB2aWRlb2J1Zl9idWZmZXIgKnZiID0gJmJ1Zi0+dmI7
CglzdHJ1Y3QgdmlkZW9idWZfZG1hX2NvbnRpZ19tZW1vcnkgKm1lbSA9IHZiLT5wcml2OwoJLyoK
CSogVE9ETzoKCSogVGhpcyB3YWl0cyB1bnRpbCB0aGlzIGJ1ZmZlciBpcyBvdXQgb2YgZGFuZ2Vy
LCBpLmUuLCB1bnRpbCBpdCBpcyBubwoJKiBsb25nZXIgaW4gU1RBVEVfUVVFVUVEIG9yIFNUQVRF
X0FDVElWRQoJKi8KCS8qdmlkZW9idWZfd2FpdG9uKHZiLCAwLCAwKTsqLwoKCWRtYV9mcmVlX2Rl
c2MoYnVmLCBwY2Rldik7CgoJLyoKCSogVE9ETzogYXMgdXNlciB3aWxsIGNhbGwgc3RyZWFtLW9m
ZiB3aGVuIGhlIGhhc24ndCBlbi1xdWV1ZSBhbGwKCSogcmVxdWVzdC1idWZmZXJzLCBpZiBkaXJl
Y3RsdHkgY2FsbCB2aWRlb2J1Zl9kbWFfY29udGlnX2ZyZWUgaGVyZSwKCSogaXQgd2lsbCByZWxl
YXNlIG5vbi1pbml0aXpsaXplZCBidWZmZXJzLCBpdCBjYXVzZXMga2VybmVsIHBhbmljLiBTbywK
CSogd2UgaW1wbGVtZW50IG91ciBvd24gZnJlZSBvcGVyYXRpb24gYXMgZm9sbG93IHRvIGF2b2lk
IGtlcm5lbCBwYW5pYy4KCSogKHJlZmVyIHRvIHZpZGVvYnVmLWRtYS1jb250aWcuYykKCSovCgkv
KnZpZGVvYnVmX2RtYV9jb250aWdfZnJlZSh2cSwgJmJ1Zi0+dmIpOyovCgoJLyoKCSogbW1hcHBl
ZCBtZW1vcnkgY2FuJ3QgYmUgZnJlZWQgaGVyZSwgb3RoZXJ3aXNlIG1tYXBwZWQgcmVnaW9uCgkq
IHdvdWxkIGJlIHJlbGVhc2VkLCB3aGlsZSBzdGlsbCBuZWVkZWQuIEluIHRoaXMgY2FzZSwgdGhl
IG1lbW9yeQoJKiByZWxlYXNlIHNob3VsZCBoYXBwZW4gaW5zaWRlIHZpZGVvYnVmX3ZtX2Nsb3Nl
KCkuCgkqIFNvLCBpdCBzaG91bGQgZnJlZSBtZW1vcnkgb25seSBpZiB0aGUgbWVtb3J5IHdlcmUg
YWxsb2NhdGVkIGZvcgoJKiByZWFkKCkgb3BlcmF0aW9uLgoJKi8KCWlmICh2Yi0+bWVtb3J5ICE9
IFY0TDJfTUVNT1JZX1VTRVJQVFIpCgkJcmV0dXJuOwoKCWlmICghbWVtKQoJCXJldHVybjsKCglN
QUdJQ19DSEVDSyhtZW0tPm1hZ2ljLCBNQUdJQ19EQ19NRU0pOwoKCS8qIGhhbmRsZSB1c2VyIHNw
YWNlIHBvaW50ZXIgY2FzZSAqLwoJaWYgKHZiLT5iYWRkcikgewoJCS8qdmlkZW9idWZfZG1hX2Nv
bnRpZ191c2VyX3B1dChtZW0pOyovCgkJbWVtLT5pc191c2VycHRyID0gMDsKCQltZW0tPmRtYV9o
YW5kbGUgPSAwOwoJCW1lbS0+c2l6ZSA9IDA7Cgl9CgoJYnVmLT52Yi5zdGF0ZSA9IFZJREVPQlVG
X05FRURTX0lOSVQ7Cn0KCnN0YXRpYyB2b2lkIGRtYV9jaGFpbl9pbml0KHN0cnVjdCBweGE5NTVf
Y2FtX2RldiAqcGNkZXYpCnsKCWludCBpID0gMDsKCXN0cnVjdCBweGFfY2FtX2RtYSAqZG1hX2N1
ciA9IE5VTEwsICpkbWFfcHJlID0gTlVMTDsKCXN0cnVjdCBweGFfYnVmX25vZGUgKmJ1Zl9jdXIg
PSBOVUxMLCAqYnVmX3ByZSA9IE5VTEw7CglzdHJ1Y3QgcHhhX2J1Zl9ub2RlICpidWZfbm9kZTsK
CgkvKmNoYWluIHRoZSBidWZmZXJzIGluIHRoZSBkbWFfYnVmX2xpc3QgbGlzdCovCglsaXN0X2Zv
cl9lYWNoX2VudHJ5KGJ1Zl9ub2RlLCAmcGNkZXYtPmRtYV9idWZfbGlzdCwgdmIucXVldWUpIHsK
CQlpZiAoYnVmX25vZGUtPnZiLnN0YXRlID09IFZJREVPQlVGX0FDVElWRSkgewoJCQlidWZfY3Vy
ID0gYnVmX25vZGU7CgoJCQkvKmhlYWQgb2YgdGhlIGRtYV9idWZfbGlzdCwgdGhpcyBpcyB0aGUg
Zmlyc3QgZG1hIGRlc2MqLwoJCQlpZiAoYnVmX25vZGUtPnZiLnF1ZXVlLnByZXYgPT0gJnBjZGV2
LT5kbWFfYnVmX2xpc3QpIHsKCQkJCWZvciAoaSA9IDA7IGkgPCBwY2Rldi0+Y2hhbm5lbHM7IGkr
KykgewoJCQkJCWRtYV9jdXIgPSAmYnVmX2N1ci0+ZG1hX2Rlc2NbaV07CgkJCQkJaWYgKGJ1Zl9w
cmUpCgkJCQkJCWRtYV9wcmUgPSAmYnVmX3ByZS0+ZG1hX2Rlc2NbaV07CgkJCQkJc2NpX3JlZ193
cml0ZShwY2RldiwgUkVHX1NDSURBRERSMCArIGkqMHgxMCwgZG1hX2N1ci0+c2dfZG1hKTsKCQkJ
CX0KCQkJfSBlbHNlIHsKCQkJCS8qIGxpbmsgdG8gcHJldiBkZXNjcmlwdG9yICovCgkJCQlkbWFf
YXBwZW5kX2Rlc2MocGNkZXYsIGJ1Zl9wcmUsIGJ1Zl9jdXIpOwoJCQl9CgoJCQkvKiBmaW5kIHRo
ZSB0YWlsLCBsb29wIGJhY2sgdG8gdGhlIHRhaWwgaXRzZWxmICovCgkJCWlmICgmcGNkZXYtPmRt
YV9idWZfbGlzdCA9PSBidWZfbm9kZS0+dmIucXVldWUubmV4dCkgewoJCQkJZG1hX2FwcGVuZF9k
ZXNjKHBjZGV2LCBidWZfY3VyLCBidWZfY3VyKTsKCQkJfQoJCQlidWZfcHJlID0gYnVmX2N1cjsK
CQkJYnVmX25vZGUtPnZiLnN0YXRlID0gVklERU9CVUZfUVVFVUVEOwoJCX0KCX0KCn0KCnN0YXRp
YyBpbnQgc2NpX2NrZW4oc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldiwgaW50IGZsYWcpCnsK
CWlmIChmbGFnKSB7CgkJLyogVGhlIG9yZGVyIG9mIGVuYWJsaW5nIG1hdHRlcnMhIEFYSSBtdXN0
IGJlIHRoZSAxc3Qgb25lICovCgkJY2xrX2VuYWJsZShwY2Rldi0+c2NpMV9jbGspOwoJCWNsa19l
bmFibGUocGNkZXYtPnNjaTJfY2xrKTsKCX0gZWxzZSB7CgkJY2xrX2Rpc2FibGUocGNkZXYtPnNj
aTJfY2xrKTsKCQljbGtfZGlzYWJsZShwY2Rldi0+c2NpMV9jbGspOwoJfTsKCglyZXR1cm4gMDsK
fQoKI2RlZmluZSBwaXhmbXRzdHIoeCkgKHgpICYgMHhmZiwgKCh4KSA+PiA4KSAmIDB4ZmYsICgo
eCkgPj4gMTYpICYgMHhmZiwgXAoJKCh4KSA+PiAyNCkgJiAweGZmCnN0YXRpYyB2b2lkIHNjaV9z
X2ZtdChzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2LAoJCQkJc3RydWN0IHY0bDJfcGl4X2Zv
cm1hdCAqZm10KQp7Cgl1bnNpZ25lZCBpbnQgc2l6ZSA9IGZtdC0+d2lkdGgqZm10LT5oZWlnaHQ7
CglwcmludGsoS0VSTl9OT1RJQ0UgImNhbTogc2V0IGZtdCBhcyAlYyVjJWMlYywgJXV4JXVcbiIs
CgkJcGl4Zm10c3RyKGZtdC0+cGl4ZWxmb3JtYXQpLCBmbXQtPndpZHRoLCBmbXQtPmhlaWdodCk7
CgoJc3dpdGNoIChmbXQtPnBpeGVsZm9ybWF0KSB7CgoJY2FzZSBWNEwyX1BJWF9GTVRfUkdCNTY1
OgoJCXBjZGV2LT5jaGFubmVscyA9IDE7CgkJcGNkZXYtPmNoYW5uZWxfc2l6ZVswXSA9IHNpemUq
MjsKCQlzY2lfcmVnX3dyaXRlKHBjZGV2LCBSRUdfU0NJQ1IxLCBTQ0lDUjFfRk1UX0lOKEZNVF9S
R0I1NjUpIHwgU0NJQ1IxX0ZNVF9PVVQoRk1UX1JHQjU2NSkpOwoJICAgIGJyZWFrOwoKCWNhc2Ug
VjRMMl9QSVhfRk1UX0pQRUc6CgkJcGNkZXYtPmNoYW5uZWxzID0gMTsKCQkvKiB1c2Ugc2l6ZSBn
ZXQgZnJvbSBzZW5zb3IgKi8KCQkvKiBwY2Rldi0+Y2hhbm5lbF9zaXplWzBdID0gZm10LT5zaXpl
aW1hZ2U7Ki8KCgkJcGNkZXYtPmNoYW5uZWxfc2l6ZVswXSA9IEpQRUdfQlVGX1NJWkU7CgkJc2Np
X3JlZ193cml0ZShwY2RldiwgUkVHX1NDSUNSMSwgU0NJQ1IxX0ZNVF9JTihGTVRfSlBFRykgfCBT
Q0lDUjFfRk1UX09VVChGTVRfSlBFRykpOwoJICAgIGJyZWFrOwoKCWNhc2UgVjRMMl9QSVhfRk1U
X1lVVjQyMlA6CgkJcGNkZXYtPmNoYW5uZWxzID0gMzsKCQlwY2Rldi0+Y2hhbm5lbF9zaXplWzBd
ID0gc2l6ZTsKCQlwY2Rldi0+Y2hhbm5lbF9zaXplWzFdID0gcGNkZXYtPmNoYW5uZWxfc2l6ZVsy
XSA9IHNpemUvMjsKCQlzY2lfcmVnX3dyaXRlKHBjZGV2LCBSRUdfU0NJQ1IxLCBTQ0lDUjFfRk1U
X0lOKEZNVF9ZVVY0MjIpIHwgU0NJQ1IxX0ZNVF9PVVQoRk1UX1lVVjQyMikpOwoJCWJyZWFrOwoK
CWNhc2UgVjRMMl9QSVhfRk1UX1lWWVU6CgljYXNlIFY0TDJfUElYX0ZNVF9ZVVlWOgoJY2FzZSBW
NEwyX1BJWF9GTVRfVVlWWToKCWNhc2UgVjRMMl9QSVhfRk1UX1ZZVVk6CgkJcGNkZXYtPmNoYW5u
ZWxzID0gMTsKCQlwY2Rldi0+Y2hhbm5lbF9zaXplWzBdID0gc2l6ZSoyOwoJCXNjaV9yZWdfd3Jp
dGUocGNkZXYsIFJFR19TQ0lDUjEsIFNDSUNSMV9GTVRfSU4oRk1UX1lVVjQyMikgfCBTQ0lDUjFf
Rk1UX09VVChGTVRfWVVWNDIyUEFDS0VUKSk7CgkJYnJlYWs7CgoJY2FzZSBWNEwyX1BJWF9GTVRf
WVVWNDIwOgoJCS8qIG9ubHkgYWNjZXB0IFlVVjQyMiBhcyBpbnB1dCAqLwoJCXBjZGV2LT5jaGFu
bmVscyA9IDM7CgkJcGNkZXYtPmNoYW5uZWxfc2l6ZVswXSA9IHNpemU7CgkJcGNkZXYtPmNoYW5u
ZWxfc2l6ZVsxXSA9IHBjZGV2LT5jaGFubmVsX3NpemVbMl0gPSBzaXplLzQ7CgkJc2NpX3JlZ193
cml0ZShwY2RldiwgUkVHX1NDSUNSMSwgU0NJQ1IxX0ZNVF9JTihGTVRfWVVWNDIyKSB8IFNDSUNS
MV9GTVRfT1VUKEZNVF9ZVVY0MjApKTsKCQlicmVhazsKCglkZWZhdWx0OgoJCXByaW50ayhLRVJO
X0VSUiAiY2FtOiBlcnJvciBjYW4gbm90IHN1cHBvcnQgZm10IVxuIik7CgkJYnJlYWs7Cgl9Cgp9
CgpzdGF0aWMgdm9pZCBzY2lfaXJxX2VuYWJsZShzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2
LCB1bnNpZ25lZCBpbnQgdmFsKQp7CglzY2lfcmVnX3dyaXRlKHBjZGV2LCBSRUdfU0NJU1IsIHNj
aV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSVNSKSk7CglzY2lfcmVnX2NsZWFyX2JpdChwY2Rldiwg
UkVHX1NDSU1BU0ssIHZhbCk7Cn0KCnN0YXRpYyB2b2lkIHNjaV9pcnFfZGlzYWJsZShzdHJ1Y3Qg
cHhhOTU1X2NhbV9kZXYgKnBjZGV2LCB1bnNpZ25lZCBpbnQgdmFsKQp7CglzY2lfcmVnX3NldF9i
aXQocGNkZXYsIFJFR19TQ0lNQVNLLCB2YWwpOwp9CgovKgogKiBNYWtlIHRoZSBjb250cm9sbGVy
IHN0YXJ0IGdyYWJiaW5nIGltYWdlcy4gIEV2ZXJ5dGhpbmcgbXVzdAogKiBiZSBzZXQgdXAgYmVm
b3JlIGRvaW5nIHRoaXMuCiAqLwpzdGF0aWMgdm9pZCBzY2lfZW5hYmxlKHN0cnVjdCBweGE5NTVf
Y2FtX2RldiAqcGNkZXYpCnsKCWludCBpID0gMDsKCXVuc2lnbmVkIGludCB2YWwgPSAwOwoKCS8q
IHN0YXJ0X2ZpZm8gKi8KCWZvciAoaSA9IDA7IGkgPCBwY2Rldi0+Y2hhbm5lbHM7IGkrKykgewoJ
CXZhbCA9IFNDSUZJRk9fRjBfRU4gPDwgaTsKCQlzY2lfcmVnX3NldF9iaXQocGNkZXYsIFJFR19T
Q0lGSUZPLCB2YWwpOwoJfQoKCS8qIHN0YXJ0X2RtYSAqLwoJZm9yIChpID0gMDsgaSA8IHBjZGV2
LT5jaGFubmVsczsgaSsrKQoJCXNjaV9yZWdfc2V0X2JpdChwY2RldiwgUkVHX1NDSURDU1IwICsg
aSoweDEwLCBTQ0lEQ1NSX0RNQV9SVU4pOwoKCS8qIHN0YXJ0IHNjaSAqLwoJc2NpX3JlZ19zZXRf
Yml0KHBjZGV2LCBSRUdfU0NJQ1IwLCBTQ0lDUjBfQ0FQX0VOIHwgU0NJQ1IwX0NJX0VOKTsKfQoK
c3RhdGljIHZvaWQgc2NpX2Rpc2FibGUoc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldikKewoJ
aW50IGkgPSAwOwoJdW5zaWduZWQgaW50IHZhbCA9IDA7CgoJLyogc3RvcF9maWZvICovCglmb3Ig
KGkgPSAwOyBpIDwgcGNkZXYtPmNoYW5uZWxzOyBpKyspIHsKCQl2YWwgPSBTQ0lGSUZPX0YwX0VO
IDw8IGk7CgkJc2NpX3JlZ19jbGVhcl9iaXQocGNkZXYsIFJFR19TQ0lGSUZPLCB2YWwpOwoJfQoK
CS8qIHN0b3BfZG1hICovCglmb3IgKGkgPSAwOyBpIDwgcGNkZXYtPmNoYW5uZWxzOyBpKyspIHsK
CQlzY2lfcmVnX2NsZWFyX2JpdChwY2RldiwgUkVHX1NDSURDU1IwICsgaSoweDEwLCBTQ0lEQ1NS
X0RNQV9SVU4pOwoJCXNjaV9yZWdfY2xlYXJfYml0KHBjZGV2LCBSRUdfU0NJREJSMCArIGkqMHgx
MCwgU0NJREJSX0VOKTsKCX0KCS8qIHN0b3Agc2NpICovCglzY2lfcmVnX2NsZWFyX2JpdChwY2Rl
diwgUkVHX1NDSUNSMCwgU0NJQ1IwX0NBUF9FTiB8IFNDSUNSMF9DSV9FTik7Cn0KCnZvaWQgc2Np
X2luaXQoc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldikKewoJLyoKCSogVHVybiBvZmYgdGhl
IGVuYWJsZSBiaXQuICBJdCBzdXJlIHNob3VsZCBiZSBvZmYgYW55d2F5LAoJKiBidXQgaXQncyBn
b29kIHRvIGJlIHN1cmUuCgkqLwoJc2NpX3JlZ19jbGVhcl9iaXQocGNkZXYsIFJFR19TQ0lDUjAs
IFNDSUNSMF9DSV9FTik7CgoJLyogTWFzayBhbGwgaW50ZXJydXB0cy4qLwoJc2NpX3JlZ193cml0
ZShwY2RldiwgUkVHX1NDSU1BU0ssIH4wKTsKfQoKc3RhdGljIHVuc2lnbmVkIGxvbmcgdXZhX3Rv
X3BhKHVuc2lnbmVkIGxvbmcgYWRkciwgc3RydWN0IHBhZ2UgKipwYWdlKQp7Cgl1bnNpZ25lZCBs
b25nIHJldCA9IDBVTDsKCXBnZF90ICpwZ2Q7CglwdWRfdCAqcHVkOwoJcG1kX3QgKnBtZDsKCXB0
ZV90ICpwdGU7CgoJcGdkID0gcGdkX29mZnNldChjdXJyZW50LT5tbSwgYWRkcik7CglpZiAoIXBn
ZF9ub25lKCpwZ2QpKSB7CgkJcHVkID0gcHVkX29mZnNldChwZ2QsIGFkZHIpOwoJCWlmICghcHVk
X25vbmUoKnB1ZCkpIHsKCQkJcG1kID0gcG1kX29mZnNldChwdWQsIGFkZHIpOwoJCQlpZiAoIXBt
ZF9ub25lKCpwbWQpKSB7CgkJCQlwdGUgPSBwdGVfb2Zmc2V0X21hcChwbWQsIGFkZHIpOwoJCQkJ
aWYgKCFwdGVfbm9uZSgqcHRlKSAmJiBwdGVfcHJlc2VudCgqcHRlKSkgewoJCQkJCSgqcGFnZSkg
PSBwdGVfcGFnZSgqcHRlKTsKCQkJCQlyZXQgPSBwYWdlX3RvX3BoeXMoKnBhZ2UpOwoJCQkJCXJl
dCB8PSAoYWRkciAmIChQQUdFX1NJWkUtMSkpOwoJCQkJfQoJCQl9CgkJfQoJfQoJcmV0dXJuIHJl
dDsKfQoKc3RydWN0IHBhZ2UqIHZhX3RvX3BhZ2UodW5zaWduZWQgbG9uZyB1c2VyX2FkZHIpCnsK
CXN0cnVjdCBwYWdlICpwYWdlID0gTlVMTDsKCXVuc2lnbmVkIGludCB2YWRkciA9IFBBR0VfQUxJ
R04odXNlcl9hZGRyKTsKCglpZiAodXZhX3RvX3BhKHZhZGRyLCAmcGFnZSkgIT0gMCkKCQlyZXR1
cm4gcGFnZTsKCglyZXR1cm4gMDsKfQp1bnNpZ25lZCBsb25nIHZhX3RvX3BhKHVuc2lnbmVkIGxv
bmcgdXNlcl9hZGRyLCB1bnNpZ25lZCBpbnQgc2l6ZSkKewoJdW5zaWduZWQgbG9uZyAgcGFkZHIs
IHBhZGRyX3RtcDsKCXVuc2lnbmVkIGxvbmcgIHNpemVfdG1wID0gMDsKCXN0cnVjdCBwYWdlICpw
YWdlID0gTlVMTDsKCWludCBwYWdlX251bSA9IFBBR0VfQUxJR04oc2l6ZSkgLyBQQUdFX1NJWkU7
Cgl1bnNpZ25lZCBpbnQgdmFkZHIgPSBQQUdFX0FMSUdOKHVzZXJfYWRkcik7CglpbnQgaSA9IDA7
CgoJaWYodmFkZHIgPT0gMCkKCQlyZXR1cm4gMDsKCglwYWRkciA9IHV2YV90b19wYSh2YWRkciwg
JnBhZ2UpOwoKCWZvciAoaSA9IDA7IGkgPCBwYWdlX251bTsgaSsrKSB7CgkJcGFkZHJfdG1wID0g
dXZhX3RvX3BhKHZhZGRyLCAmcGFnZSk7CgkJaWYgKChwYWRkcl90bXAgLSBwYWRkcikgIT0gc2l6
ZV90bXApCgkJCXJldHVybiAwOwoJCXZhZGRyICs9IFBBR0VfU0laRTsKCQlzaXplX3RtcCArPSBQ
QUdFX1NJWkU7Cgl9CglyZXR1cm4gcGFkZHI7Cn0KCnN0YXRpYyBpbnQgcHhhOTU1X3ZpZGVvYnVm
X3NldHVwKHN0cnVjdCB2aWRlb2J1Zl9xdWV1ZSAqdnEsIHVuc2lnbmVkIGludCAqY291bnQsCgkJ
CSAgICAgIHVuc2lnbmVkIGludCAqc2l6ZSkKewoJc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICpp
Y2QgPSB2cS0+cHJpdl9kYXRhOwoJaW50IGJ5dGVzX3Blcl9saW5lID0gc29jX21idXNfYnl0ZXNf
cGVyX2xpbmUoaWNkLT51c2VyX3dpZHRoLAoJCQkJCQlpY2QtPmN1cnJlbnRfZm10LT5ob3N0X2Zt
dCk7CgoJaWYgKGJ5dGVzX3Blcl9saW5lIDwgMCkKCQlyZXR1cm4gYnl0ZXNfcGVyX2xpbmU7CgoJ
aWYgKGljZC0+Y3VycmVudF9mbXQtPmhvc3RfZm10LT5mb3VyY2MgIT0gVjRMMl9QSVhfRk1UX0pQ
RUcpIHsKCQlkZXZfZGJnKGljZC0+ZGV2LnBhcmVudCwgImNvdW50PSVkLCBzaXplPSVkXG4iLCAq
Y291bnQsICpzaXplKTsKCgkJKnNpemUgPSBieXRlc19wZXJfbGluZSAqIGljZC0+dXNlcl9oZWln
aHQ7CgkJaWYgKDAgPT0gKmNvdW50KQoJCQkqY291bnQgPSAzMjsKCQlpZiAoKnNpemUgKiAqY291
bnQgPiB2aWRfbWVtX2xpbWl0ICogMTAyNCAqIDEwMjQpCgkJCSpjb3VudCA9ICh2aWRfbWVtX2xp
bWl0ICogMTAyNCAqIDEwMjQpIC8gKnNpemU7Cgl9IGVsc2UgewoJCSpzaXplID0gSlBFR19CVUZf
U0laRTsKCQlpZiAoMCA9PSAqY291bnQpCgkJCSpjb3VudCA9IDMyOwoJCWlmICgqc2l6ZSAqICpj
b3VudCA+IHZpZF9tZW1fbGltaXQgKiAxMDI0ICogMTAyNCkKCQkJKmNvdW50ID0gKHZpZF9tZW1f
bGltaXQgKiAxMDI0ICogMTAyNCkgLyAqc2l6ZTsKCX0KCXJldHVybiAwOwp9CgpzdGF0aWMgaW50
IHB4YTk1NV92aWRlb2J1Zl9wcmVwYXJlKHN0cnVjdCB2aWRlb2J1Zl9xdWV1ZSAqdnEsCgkJc3Ry
dWN0IHZpZGVvYnVmX2J1ZmZlciAqdmIsIGVudW0gdjRsMl9maWVsZCBmaWVsZCkKewoJc3RydWN0
IHNvY19jYW1lcmFfZGV2aWNlICppY2QgPSB2cS0+cHJpdl9kYXRhOwoJc3RydWN0IHNvY19jYW1l
cmFfaG9zdCAqaWNpID0gdG9fc29jX2NhbWVyYV9ob3N0KGljZC0+ZGV2LnBhcmVudCk7CglzdHJ1
Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2ID0gaWNpLT5wcml2OwoJc3RydWN0IHB4YV9idWZfbm9k
ZSAqYnVmID0KCQljb250YWluZXJfb2YodmIsIHN0cnVjdCBweGFfYnVmX25vZGUsIHZiKTsKCXN0
cnVjdCBweGFfY2FtX2RtYSAqZGVzYzsKCXVuc2lnbmVkIGludCB2YWRkcjsKCWludCByZXQ7Cglz
aXplX3QgbmV3X3NpemU7CglpbnQgYnl0ZXNfcGVyX2xpbmUgPSBzb2NfbWJ1c19ieXRlc19wZXJf
bGluZShpY2QtPnVzZXJfd2lkdGgsCgkJCQkJCWljZC0+Y3VycmVudF9mbXQtPmhvc3RfZm10KTsK
CWlmICh2Yi0+bWVtb3J5ID09IFY0TDJfTUVNT1JZX1VTRVJQVFIpIHsKCgkJdmFkZHIgPSBQQUdF
X0FMSUdOKHZiLT5iYWRkcik7CgkJaWYgKHZhZGRyICE9IHZiLT5iYWRkcikgewoJCQlwcmludGso
S0VSTl9FUlIgImNhbTogdGhlIG1lbW9yeSBpcyBub3QgcGFnZSBhbGlnbiFcbiIpOwoJCQlyZXR1
cm4gLUVQRVJNOwoJCX0KCgkJYnVmLT5wYWdlID0gdmFfdG9fcGFnZSh2YWRkcik7CgkJaWYgKCFi
dWYtPnBhZ2UpIHsKCQkJcHJpbnRrKEtFUk5fRVJSICJjYW06IGZhaWwgdG8gZ2V0IHBhZ2UgaW5m
byFcbiIpOwoJCQlyZXR1cm4gLUVGQVVMVDsKCQl9Cgl9CgoJaWYgKGJ5dGVzX3Blcl9saW5lIDwg
MCkKCQlyZXR1cm4gYnl0ZXNfcGVyX2xpbmU7CgluZXdfc2l6ZSA9IGJ5dGVzX3Blcl9saW5lICog
aWNkLT51c2VyX2hlaWdodDsKCWlmIChpY2QtPmN1cnJlbnRfZm10LT5ob3N0X2ZtdC0+Zm91cmNj
ID09IFY0TDJfUElYX0ZNVF9KUEVHKSB7CgkJbmV3X3NpemUgPSBKUEVHX0JVRl9TSVpFOwoJfQoK
CWlmIChidWYtPmNvZGUJIT0gaWNkLT5jdXJyZW50X2ZtdC0+Y29kZSB8fAoJICAgIHZiLT53aWR0
aAkhPSBpY2QtPnVzZXJfd2lkdGggfHwKCSAgICB2Yi0+aGVpZ2h0CSE9IGljZC0+dXNlcl9oZWln
aHQgfHwKCSAgICB2Yi0+ZmllbGQJIT0gZmllbGQpIHsKCQlidWYtPmNvZGUJPSBpY2QtPmN1cnJl
bnRfZm10LT5jb2RlOwoJCXZiLT53aWR0aAk9IGljZC0+dXNlcl93aWR0aDsKCQl2Yi0+aGVpZ2h0
CT0gaWNkLT51c2VyX2hlaWdodDsKCQl2Yi0+ZmllbGQJPSBmaWVsZDsKCQlpZiAodmItPnN0YXRl
ICE9IFZJREVPQlVGX05FRURTX0lOSVQpIHsKCQkJZG1hX2ZyZWVfYnVmcyh2cSwgYnVmLCBwY2Rl
dik7CgkJfQoJfQoKCWlmICh2Yi0+YmFkZHIgJiYgKHZiLT5ic2l6ZSA8IG5ld19zaXplKSkgewoJ
CS8qIFVzZXIgcHJvdmlkZWQgYnVmZmVyLCBidXQgaXQgaXMgdG9vIHNtYWxsICovCgkJcHJpbnRr
KEtFUk5fRVJSCgkJCSJjYW06IGJ1ZiBpbiB1c2UgJWQgaXMgc21hbGxlciB0aGFuIHJlcXVpcmVk
IHNpemUgJWQhXG4iLAoJCQl2Yi0+YnNpemUsIG5ld19zaXplKTsKCQlyZXR1cm4gLUVOT01FTTsK
CX0KCglpZiAodmItPnN0YXRlID09IFZJREVPQlVGX05FRURTX0lOSVQpIHsKCQkvKgoJCSogVGhl
IHRvdGFsIHNpemUgb2YgdmlkZW8tYnVmZmVycyB0aGF0IHdpbGwgYmUgYWxsb2NhdGVkIC8gbWFw
cGVkLgoJCSogc2l6ZSB0aGF0IHdlIGNhbGN1bGF0ZWQgaW4gdmlkZW9idWZfc2V0dXAgZ2V0cyBh
c3NpZ25lZCB0bwoJCSogdmItPmJzaXplLCBhbmQgbm93IHdlIHVzZSB0aGUgc2FtZSBjYWxjdWxh
dGlvbiB0byBnZXQgdmItPnNpemUuCgkJKi8KCQl2Yi0+c2l6ZSA9IG5ld19zaXplOwoKCQkvKiBU
aGlzIGFjdHVhbGx5IChhbGxvY2F0ZXMgYW5kKSBtYXBzIGJ1ZmZlcnMgKi8KCQlyZXQgPSB2aWRl
b2J1Zl9pb2xvY2sodnEsIHZiLCBOVUxMKTsKCgkJZGVzYyA9ICZidWYtPmRtYV9kZXNjWzBdOwoJ
CWlmIChkZXNjLT5zZ19jcHUgPT0gTlVMTCkgewoJCQlkbWFfYWxsb2NfZGVzYyhidWYsIHBjZGV2
KTsKCQl9CgoJCXZiLT5zdGF0ZSA9IFZJREVPQlVGX1BSRVBBUkVEOwoJfQoKCXJldHVybiAwOwp9
CgpzdGF0aWMgdm9pZCBweGE5NTVfdmlkZW9idWZfcXVldWUoc3RydWN0IHZpZGVvYnVmX3F1ZXVl
ICp2cSwKCQkJICAgICAgIHN0cnVjdCB2aWRlb2J1Zl9idWZmZXIgKnZiKQp7CglzdHJ1Y3Qgc29j
X2NhbWVyYV9kZXZpY2UgKmljZCA9IHZxLT5wcml2X2RhdGE7CglzdHJ1Y3Qgc29jX2NhbWVyYV9o
b3N0ICppY2kgPSB0b19zb2NfY2FtZXJhX2hvc3QoaWNkLT5kZXYucGFyZW50KTsKCXN0cnVjdCBw
eGE5NTVfY2FtX2RldiAqcGNkZXYgPSBpY2ktPnByaXY7CglzdHJ1Y3QgY3NpX3BoeV9jb25maWcg
dGltaW5nOwoKCWRldl9kYmcoaWNkLT5kZXYucGFyZW50LCAiJXMgKHZiPTB4JXApIDB4JTA4bHgg
JWRcbiIsCgkJX19mdW5jX18sIHZiLCB2Yi0+YmFkZHIsIHZiLT5ic2l6ZSk7CgoJbGlzdF9hZGRf
dGFpbCgmdmItPnF1ZXVlLCAmcGNkZXYtPmRtYV9idWZfbGlzdCk7Cgl2Yi0+c3RhdGUgPSBWSURF
T0JVRl9BQ1RJVkU7CgoJaWYgKHZxLT5zdHJlYW1pbmcgPT0gMSkgewoKCQkvKiBhdCBmaXJzdCB0
aW1lLCBzdHJlYW1vbiBzZXQgdG8gdHJ1ZSwgbWVhbnMgc3RyZWFtLW9uKi8KCQlpZiAoIXBjZGV2
LT5zdHJlYW1vbikgewoKCQkJaWYgKGxpc3RfZW1wdHkoJnBjZGV2LT5kbWFfYnVmX2xpc3QpKSB7
CgkJCQlwcmludGsoS0VSTl9FUlIgImNhbTogaW50ZXJuYWwgYnVmZmVycyBhcmUgbm90IHJlYWR5
IVxuIik7CgkJCQlyZXR1cm47CgkJCX0KCQkJcGNkZXYtPnN0cmVhbW9uID0gdHJ1ZTsKCQkJcGNk
ZXYtPnN0cmVhbW9mZiA9IGZhbHNlOwoKCQkJZG1hX2NoYWluX2luaXQocGNkZXYpOwoKCQkJc2Np
X2lycV9lbmFibGUocGNkZXYsIElSUV9FT0ZYfElSUV9PRk8pOwoJCQlweGE5NTVfY3NpX2RwaHko
cGNkZXYtPmNzaWRldiwgdGltaW5nKTsKCQkJLyogY29uZmlndXJlIGVuYWJsZSB3aGljaCBjYW1l
cmEgaW50ZXJmYWNlIGNvbnRyb2xsZXIqLwoJCQlweGE5NTVfY3NpX2VuYWJsZShwY2Rldi0+Y3Np
ZGV2LCAwKTsKCQkJc2NpX2VuYWJsZShwY2Rldik7CgkJfQoJfQp9CgpzdGF0aWMgdm9pZCBweGE5
NTVfdmlkZW9idWZfcmVsZWFzZShzdHJ1Y3QgdmlkZW9idWZfcXVldWUgKnZxLAoJCQkJIHN0cnVj
dCB2aWRlb2J1Zl9idWZmZXIgKnZiKQp7CglzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZCA9
IHZxLT5wcml2X2RhdGE7CglzdHJ1Y3Qgc29jX2NhbWVyYV9ob3N0ICppY2kgPSB0b19zb2NfY2Ft
ZXJhX2hvc3QoaWNkLT5kZXYucGFyZW50KTsKCXN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYg
PSBpY2ktPnByaXY7CglzdHJ1Y3QgcHhhX2J1Zl9ub2RlICpidWYgPSBjb250YWluZXJfb2YodmIs
IHN0cnVjdCBweGFfYnVmX25vZGUsIHZiKTsKCiNpZmRlZiBERUJVRwoJc3RydWN0IGRldmljZSAq
ZGV2ID0gaWNkLT5kZXYucGFyZW50OwoKCWRldl9lcnIoZGV2LCAiJXMgKHZiPTB4JXApIDB4JTA4
bHggJWRcbiIsIF9fZnVuY19fLAoJCXZiLCB2Yi0+YmFkZHIsIHZiLT5ic2l6ZSk7CgoJc3dpdGNo
ICh2Yi0+c3RhdGUpIHsKCWNhc2UgVklERU9CVUZfQUNUSVZFOgoJCWRldl9kYmcoZGV2LCAiJXMg
KGFjdGl2ZSlcbiIsIF9fZnVuY19fKTsKCQlicmVhazsKCWNhc2UgVklERU9CVUZfUVVFVUVEOgoJ
CWRldl9kYmcoZGV2LCAiJXMgKHF1ZXVlZClcbiIsIF9fZnVuY19fKTsKCQlicmVhazsKCWNhc2Ug
VklERU9CVUZfUFJFUEFSRUQ6CgkJZGV2X2RiZyhkZXYsICIlcyAocHJlcGFyZWQpXG4iLCBfX2Z1
bmNfXyk7CgkJYnJlYWs7CglkZWZhdWx0OgoJCWRldl9kYmcoZGV2LCAiJXMgKHVua25vd24pXG4i
LCBfX2Z1bmNfXyk7CgkJYnJlYWs7Cgl9CiNlbmRpZgoKCWlmICgodmItPnN0YXRlID09IFZJREVP
QlVGX0FDVElWRSB8fCB2Yi0+c3RhdGUgPT0gVklERU9CVUZfUVVFVUVEKSAmJgoJICAgICFsaXN0
X2VtcHR5KCZ2Yi0+cXVldWUpKSB7CgkJdmItPnN0YXRlID0gVklERU9CVUZfRVJST1I7CgoJCWxp
c3RfZGVsX2luaXQoJnZiLT5xdWV1ZSk7Cgl9CgoJaWYgKHZxLT5zdHJlYW1pbmcgPT0gMCkgewoJ
CWlmICghcGNkZXYtPnN0cmVhbW9mZikgewoJCQlJTklUX0xJU1RfSEVBRCgmcGNkZXYtPmRtYV9i
dWZfbGlzdCk7CgkJCXBjZGV2LT5zdHJlYW1vbiA9IGZhbHNlOwoJCQlwY2Rldi0+c3RyZWFtb2Zm
ID0gdHJ1ZTsKCgkJCXB4YTk1NV9jc2lfZGlzYWJsZShwY2Rldi0+Y3NpZGV2KTsKCQkJc2NpX2ly
cV9kaXNhYmxlKHBjZGV2LCBJUlFfRU9GWHxJUlFfT0ZPKTsKCQkJc2NpX2Rpc2FibGUocGNkZXYp
OwoJCX0KCX0KCWRtYV9mcmVlX2J1ZnModnEsIGJ1ZiwgcGNkZXYpOwoKfQoKc3RhdGljIHN0cnVj
dCB2aWRlb2J1Zl9xdWV1ZV9vcHMgcHhhOTU1X3ZpZGVvYnVmX29wcyA9IHsKCS5idWZfc2V0dXAg
ICAgICA9IHB4YTk1NV92aWRlb2J1Zl9zZXR1cCwKCS5idWZfcHJlcGFyZSAgICA9IHB4YTk1NV92
aWRlb2J1Zl9wcmVwYXJlLAoJLmJ1Zl9xdWV1ZSAgICAgID0gcHhhOTU1X3ZpZGVvYnVmX3F1ZXVl
LAoJLmJ1Zl9yZWxlYXNlICAgID0gcHhhOTU1X3ZpZGVvYnVmX3JlbGVhc2UsCn07CgpzdGF0aWMg
aW50IHB4YTk1NV9jYW1fYWRkX2RldmljZShzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZCkK
ewoJc3RydWN0IHNvY19jYW1lcmFfaG9zdCAqaWNpID0gdG9fc29jX2NhbWVyYV9ob3N0KGljZC0+
ZGV2LnBhcmVudCk7CglzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2ID0gaWNpLT5wcml2OwoK
CWlmIChwY2Rldi0+aWNkKQoJCXJldHVybiAtRUJVU1k7CgoJcGNkZXYtPmljZCA9IGljZDsKCglw
eGE5NTVfY3NpX2NrZW4ocGNkZXYtPmNzaWRldiwgMSk7CglzY2lfY2tlbihwY2RldiwgMSk7Cglz
Y2lfaW5pdChwY2Rldik7CglweGE5NTVfY3NpX2Nsa2RpdihwY2Rldi0+Y3NpZGV2KTsKCglkZXZf
aW5mbyhpY2QtPmRldi5wYXJlbnQsICJweGE5NTUgY2FtZXJhIGRyaXZlciBhdHRhY2hlZCB0byBj
YW1lcmEgJWRcbiIsCgkJIGljZC0+ZGV2bnVtKTsKCglyZXR1cm4gMDsKfQoKc3RhdGljIHZvaWQg
cHhhOTU1X2NhbV9yZW1vdmVfZGV2aWNlKHN0cnVjdCBzb2NfY2FtZXJhX2RldmljZSAqaWNkKQp7
CglzdHJ1Y3Qgc29jX2NhbWVyYV9ob3N0ICppY2kgPSB0b19zb2NfY2FtZXJhX2hvc3QoaWNkLT5k
ZXYucGFyZW50KTsKCXN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYgPSBpY2ktPnByaXY7CgoJ
QlVHX09OKGljZCAhPSBwY2Rldi0+aWNkKTsKCXNjaV9ja2VuKHBjZGV2LCAwKTsKCXB4YTk1NV9j
c2lfY2tlbihwY2Rldi0+Y3NpZGV2LCAwKTsKCglwY2Rldi0+aWNkID0gTlVMTDsKCglkZXZfaW5m
byhpY2QtPmRldi5wYXJlbnQsICJweGE5NTUgQ2FtZXJhIGRyaXZlciBkZXRhY2hlZCBmcm9tIGNh
bWVyYSAlZFxuIiwKCQkgaWNkLT5kZXZudW0pOwp9CgpzdGF0aWMgY29uc3Qgc3RydWN0IHNvY19t
YnVzX3BpeGVsZm10IHB4YTk1NV9jYW1lcmFfZm9ybWF0c1tdID0gewoJewoJCQkuZm91cmNjIAk9
IFY0TDJfUElYX0ZNVF9ZVVY0MjJQLAoJCQkubmFtZQkJPSAiWVVWNDIyUCIsCgkJCS5iaXRzX3Bl
cl9zYW1wbGUJPSA4LAoJCQkucGFja2luZwkJPSBTT0NfTUJVU19QQUNLSU5HXzJYOF9QQURMTywK
CQkJLm9yZGVyCQkJPSBTT0NfTUJVU19PUkRFUl9MRSwKCX0sewoJCS5mb3VyY2MJCQk9IFY0TDJf
UElYX0ZNVF9ZVVY0MjAsCgkJLm5hbWUJCQk9ICJZVVY0MjBQIiwKCQkuYml0c19wZXJfc2FtcGxl
CT0gOCwKCQkucGFja2luZwkJPSBTT0NfTUJVU19QQUNLSU5HXzJYOF9QQURMTywKCQkub3JkZXIJ
CQk9IFNPQ19NQlVTX09SREVSX0xFLAoJfSwKfTsKCi8qIHB4YTk1NV9jYW1fZ2V0X2Zvcm1hdHMg
cHJvdmlkZSBhbGwgZm10cyB0aGF0IGNhbWVyYSBjb250cm9sbGVyIHN1cHBvcnQqLwpzdGF0aWMg
aW50IHB4YTk1NV9jYW1fZ2V0X2Zvcm1hdHMoc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2Qs
IHVuc2lnbmVkIGludCBpZHgsCgkJCQkgIHN0cnVjdCBzb2NfY2FtZXJhX2Zvcm1hdF94bGF0ZSAq
eGxhdGUpCnsKCXN0cnVjdCB2NGwyX3N1YmRldiAqc2QgPSBzb2NfY2FtZXJhX3RvX3N1YmRldihp
Y2QpOwoJc3RydWN0IGRldmljZSAqZGV2ID0gaWNkLT5kZXYucGFyZW50OwoJaW50IGZvcm1hdHMg
PSAwLCByZXQsIGk7CgllbnVtIHY0bDJfbWJ1c19waXhlbGNvZGUgY29kZTsKCWNvbnN0IHN0cnVj
dCBzb2NfbWJ1c19waXhlbGZtdCAqZm10OwoKCXJldCA9IHY0bDJfc3ViZGV2X2NhbGwoc2QsIHZp
ZGVvLCBlbnVtX21idXNfZm10LCBpZHgsICZjb2RlKTsKCWlmIChyZXQgPCAwKQoJCS8qIE5vIG1v
cmUgZm9ybWF0cyAqLwoJCXJldHVybiAwOwoKCWZtdCA9IHNvY19tYnVzX2dldF9mbXRkZXNjKGNv
ZGUpOwoJaWYgKCFmbXQpIHsKCQlkZXZfZXJyKGRldiwgIkludmFsaWQgZm9ybWF0IGNvZGUgIyV1
OiAlZFxuIiwgaWR4LCBjb2RlKTsKCQlyZXR1cm4gMDsKCX0KCglzd2l0Y2ggKGNvZGUpIHsKCS8q
IHJlZmVyIHRvIG1idXNfZm10IHN0cnVjdCovCgljYXNlIFY0TDJfTUJVU19GTVRfWVVZVjhfMlg4
X0JFOgoJCWZvcm1hdHMgPSBBUlJBWV9TSVpFKHB4YTk1NV9jYW1lcmFfZm9ybWF0cyk7CgoJCWlm
ICh4bGF0ZSkgewoJCQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShweGE5NTVfY2FtZXJhX2Zv
cm1hdHMpOyBpKyspIHsKCQkJCXhsYXRlLT5ob3N0X2ZtdCA9ICZweGE5NTVfY2FtZXJhX2Zvcm1h
dHNbaV07CgkJCQl4bGF0ZS0+Y29kZQk9IGNvZGU7CgkJCQl4bGF0ZSsrOwoJCQkJZGV2X2Vycihk
ZXYsICJQcm92aWRpbmcgZm9ybWF0ICVzXG4iLAoJCQkJCXB4YTk1NV9jYW1lcmFfZm9ybWF0c1tp
XS5uYW1lKTsKCQkJfQoJCQlkZXZfZXJyKGRldiwgIlByb3ZpZGluZyBmb3JtYXQgJXNcbiIsIGZt
dC0+bmFtZSk7CgkJfQoJCWJyZWFrOwoKCWNhc2UgVjRMMl9NQlVTX0ZNVF9ZVllVOF8yWDhfQkU6
CgljYXNlIFY0TDJfTUJVU19GTVRfWVZZVThfMlg4X0xFOgoJY2FzZSBWNEwyX01CVVNfRk1UX1lV
WVY4XzJYOF9MRToKCWNhc2UgVjRMMl9NQlVTX0ZNVF9SR0I1NjVfMlg4X0xFOgoJY2FzZSBWNEwy
X01CVVNfRk1UX1JHQjU2NV8yWDhfQkU6CgljYXNlIFY0TDJfTUJVU19GTVRfSlBFR18xWDg6CgkJ
aWYgKHhsYXRlKQoJCQlkZXZfZXJyKGRldiwgIlByb3ZpZGluZyBmb3JtYXQgJXNcbiIsIGZtdC0+
bmFtZSk7CgkJYnJlYWs7CglkZWZhdWx0OgoJCS8qIGNhbWVyYSBjb250cm9sbGVyIGNhbiBub3Qg
c3VwcG9ydCB0aGlzIGZvcm1hdCwgd2hpY2ggbWlnaHQgc3VwcG9ydGVkIGJ5IHRoZSBzZW5zb3Iq
LwoJCWRldl9lcnIoZGV2LCAiTm90IHN1cHBvcnQgZm10ICVzXG4iLCBmbXQtPm5hbWUpOwoJCXJl
dHVybiAwOwoJfQoKCS8qIEdlbmVyaWMgcGFzcy10aHJvdWdoICovCglmb3JtYXRzKys7CglpZiAo
eGxhdGUpIHsKCQl4bGF0ZS0+aG9zdF9mbXQJPSBmbXQ7CgkJeGxhdGUtPmNvZGUJPSBjb2RlOwoJ
CXhsYXRlKys7Cgl9CgoJcmV0dXJuIGZvcm1hdHM7Cn0KCnN0YXRpYyB2b2lkIHB4YTk1NV9jYW1f
cHV0X2Zvcm1hdHMoc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QpCnsKCWtmcmVlKGljZC0+
aG9zdF9wcml2KTsKCWljZC0+aG9zdF9wcml2ID0gTlVMTDsKfQoKc3RhdGljIGludCBweGE5NTVf
Y2FtX3RyeV9mbXQoc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QsCgkJCSAgICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKewoJc3RydWN0IHY0bDJfc3ViZGV2ICpzZCA9IHNvY19jYW1lcmFf
dG9fc3ViZGV2KGljZCk7Cgljb25zdCBzdHJ1Y3Qgc29jX2NhbWVyYV9mb3JtYXRfeGxhdGUgKnhs
YXRlOwoJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4ID0gJmYtPmZtdC5waXg7CglzdHJ1Y3Qg
djRsMl9tYnVzX2ZyYW1lZm10IG1mOwoJX191MzIgcGl4Zm10ID0gcGl4LT5waXhlbGZvcm1hdDsK
CWludCByZXQ7CgoJeGxhdGUgPSBzb2NfY2FtZXJhX3hsYXRlX2J5X2ZvdXJjYyhpY2QsIHBpeGZt
dCk7CglpZiAoIXhsYXRlKSB7CgkJZGV2X3dhcm4oaWNkLT5kZXYucGFyZW50LCAiRm9ybWF0ICV4
IG5vdCBmb3VuZFxuIiwgcGl4Zm10KTsKCQlyZXR1cm4gLUVJTlZBTDsKCX0KCglwaXgtPmJ5dGVz
cGVybGluZSA9IHNvY19tYnVzX2J5dGVzX3Blcl9saW5lKHBpeC0+d2lkdGgsCgkJCQkJCQl4bGF0
ZS0+aG9zdF9mbXQpOwoJaWYgKHBpeC0+Ynl0ZXNwZXJsaW5lIDwgMCkKCQlyZXR1cm4gcGl4LT5i
eXRlc3BlcmxpbmU7CglwaXgtPnNpemVpbWFnZSA9IHBpeC0+aGVpZ2h0ICogcGl4LT5ieXRlc3Bl
cmxpbmU7CgoJLyogbGltaXQgdG8gc2Vuc29yIGNhcGFiaWxpdGllcyAqLwoJbWYud2lkdGgJPSBw
aXgtPndpZHRoOwoJbWYuaGVpZ2h0CT0gcGl4LT5oZWlnaHQ7CgltZi5maWVsZAk9IHBpeC0+Zmll
bGQ7CgltZi5jb2xvcnNwYWNlCT0gcGl4LT5jb2xvcnNwYWNlOwoJbWYuY29kZSAJPSB4bGF0ZS0+
Y29kZTsKCglyZXQgPSB2NGwyX3N1YmRldl9jYWxsKHNkLCB2aWRlbywgdHJ5X21idXNfZm10LCAm
bWYpOwoJaWYgKHJldCA8IDApCgkJcmV0dXJuIHJldDsKCglwaXgtPndpZHRoCT0gbWYud2lkdGg7
CglwaXgtPmhlaWdodCA9IG1mLmhlaWdodDsKCXBpeC0+Y29sb3JzcGFjZSA9IG1mLmNvbG9yc3Bh
Y2U7CgoJc3dpdGNoIChtZi5maWVsZCkgewoJY2FzZSBWNEwyX0ZJRUxEX0FOWToKCWNhc2UgVjRM
Ml9GSUVMRF9OT05FOgoJCXBpeC0+ZmllbGQJPSBWNEwyX0ZJRUxEX05PTkU7CgkJYnJlYWs7Cglk
ZWZhdWx0OgoJCWRldl9lcnIoaWNkLT5kZXYucGFyZW50LCAiRmllbGQgdHlwZSAlZCB1bnN1cHBv
cnRlZC5cbiIsCgkJCW1mLmZpZWxkKTsKCQlyZXR1cm4gLUVJTlZBTDsKCX0KCglyZXR1cm4gcmV0
Owp9CgpzdGF0aWMgaW50IHB4YTk1NV9jYW1fc2V0X2ZtdChzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZp
Y2UgKmljZCwKCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQp7CglzdHJ1Y3Qgc29jX2Nh
bWVyYV9ob3N0ICppY2kgPSB0b19zb2NfY2FtZXJhX2hvc3QoaWNkLT5kZXYucGFyZW50KTsKCXN0
cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXYgPSBpY2ktPnByaXY7CglzdHJ1Y3QgZGV2aWNlICpk
ZXYgPSBpY2QtPmRldi5wYXJlbnQ7CglzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkID0gc29jX2NhbWVy
YV90b19zdWJkZXYoaWNkKTsKCWNvbnN0IHN0cnVjdCBzb2NfY2FtZXJhX2Zvcm1hdF94bGF0ZSAq
eGxhdGUgPSBOVUxMOwoJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4ID0gJmYtPmZtdC5waXg7
CglfX3UzMiBwaXhmbXQgPSBwaXgtPnBpeGVsZm9ybWF0OwoJc3RydWN0IHY0bDJfbWJ1c19mcmFt
ZWZtdCBtZjsKCWludCByZXQ7CgoJeGxhdGUgPSBzb2NfY2FtZXJhX3hsYXRlX2J5X2ZvdXJjYyhp
Y2QsIHBpeGZtdCk7CglpZiAoIXhsYXRlKSB7CgkJZGV2X3dhcm4oZGV2LCAiRm9ybWF0ICV4IG5v
dCBmb3VuZFxuIiwgcGl4Zm10KTsKCQlyZXR1cm4gLUVJTlZBTDsKCX0KCgltZi53aWR0aAk9IHBp
eC0+d2lkdGg7CgltZi5oZWlnaHQJPSBwaXgtPmhlaWdodDsKCW1mLmZpZWxkCT0gcGl4LT5maWVs
ZDsKCW1mLmNvbG9yc3BhY2UJPSBwaXgtPmNvbG9yc3BhY2U7CgltZi5jb2RlCQk9IHhsYXRlLT5j
b2RlOwoKCXJldCA9IHY0bDJfc3ViZGV2X2NhbGwoc2QsIHZpZGVvLCBzX21idXNfZm10LCAmbWYp
OwoKCWlmIChtZi5jb2RlICE9IHhsYXRlLT5jb2RlKQoJCXJldHVybiAtRUlOVkFMOwoKCWljZC0+
c2Vuc2UgPSBOVUxMOwoJcGl4LT53aWR0aAkJPSBtZi53aWR0aDsKCXBpeC0+aGVpZ2h0CQk9IG1m
LmhlaWdodDsKCXBpeC0+ZmllbGQJCT0gbWYuZmllbGQ7CglwaXgtPmNvbG9yc3BhY2UJCT0gbWYu
Y29sb3JzcGFjZTsKCWljZC0+Y3VycmVudF9mbXQJPSB4bGF0ZTsKCglzY2lfZGlzYWJsZShwY2Rl
dik7CglzY2lfc19mbXQocGNkZXYsIHBpeCk7CgoJcmV0dXJuIHJldDsKfQoKc3RhdGljIHZvaWQg
cHhhOTU1X2NhbV9pbml0X3ZpZGVvYnVmKHN0cnVjdCB2aWRlb2J1Zl9xdWV1ZSAqcSwKCQkJICAg
ICAgc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QpCnsKCXN0cnVjdCBzb2NfY2FtZXJhX2hv
c3QgKmljaSA9IHRvX3NvY19jYW1lcmFfaG9zdChpY2QtPmRldi5wYXJlbnQpOwoJc3RydWN0IHB4
YTk1NV9jYW1fZGV2ICpwY2RldiA9IGljaS0+cHJpdjsKCgkvKgoJKiBXZSBtdXN0IHBhc3MgTlVM
TCBhcyBkZXYgcG9pbnRlciwgdGhlbiBhbGwgcGNpXyogZG1hIG9wZXJhdGlvbnMKCSogdHJhbnNm
b3JtIHRvIG5vcm1hbCBkbWFfKiBvbmVzLgoJKi8KCXZpZGVvYnVmX3F1ZXVlX2RtYV9jb250aWdf
aW5pdChxLCAmcHhhOTU1X3ZpZGVvYnVmX29wcywgTlVMTCwgJnBjZGV2LT5zcGluX2xvY2ssCgkJ
CQlWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUsIFY0TDJfRklFTERfTk9ORSwKCQkJCXNpemVv
ZihzdHJ1Y3QgcHhhX2J1Zl9ub2RlKSwgaWNkKTsKfQoKc3RhdGljIGludCBweGE5NTVfY2FtX3Jl
cWJ1ZnMoc3RydWN0IHNvY19jYW1lcmFfZmlsZSAqaWNmLAoJCQkgICAgICBzdHJ1Y3QgdjRsMl9y
ZXF1ZXN0YnVmZmVycyAqcCkKewoJaW50IGk7CglpZiAocC0+Y291bnQgPCBNSU5fRE1BX0JVRlMp
IHsKCQlwcmludGsoS0VSTl9FUlIgImNhbTogbmVlZCAlZCBidWZmZXJzIGF0IGxlYXN0IVxuIiwg
TUlOX0RNQV9CVUZTKTsKCQlyZXR1cm4gLUVJTlZBTDsKCX0KCgkvKgoJKlRoaXMgaXMgZm9yIGxv
Y2tpbmcgZGVidWdnaW5nIG9ubHkuIEkgcmVtb3ZlZCBzcGlubG9ja3MgYW5kIG5vdyBJCgkqIGNo
ZWNrIHdoZXRoZXIgLnByZXBhcmUgaXMgZXZlciBjYWxsZWQgb24gYSBsaW5rZWQgYnVmZmVyLCBv
ciB3aGV0aGVyCgkqIGEgZG1hIElSUSBjYW4gb2NjdXIgZm9yIGFuIGluLXdvcmsgb3IgdW5saW5r
ZWQgYnVmZmVyLiBVbnRpbCBub3cKCSogaXQgaGFkbid0IHRyaWdnZXJlZAoJKi8KCWZvciAoaSA9
IDA7IGkgPCBwLT5jb3VudDsgaSsrKSB7CgkJc3RydWN0IHB4YV9idWZfbm9kZSAqYnVmID0gY29u
dGFpbmVyX29mKGljZi0+dmJfdmlkcS5idWZzW2ldLAoJCQkJCQkgICAgICBzdHJ1Y3QgcHhhX2J1
Zl9ub2RlLCB2Yik7CgkJSU5JVF9MSVNUX0hFQUQoJmJ1Zi0+dmIucXVldWUpOwoJfQoJcmV0dXJu
IDA7Cn0KCnN0YXRpYyB1bnNpZ25lZCBpbnQgcHhhOTU1X2NhbV9wb2xsKHN0cnVjdCBmaWxlICpm
aWxlLCBwb2xsX3RhYmxlICpwdCkKewoJc3RydWN0IHNvY19jYW1lcmFfZmlsZSAqaWNmID0gZmls
ZS0+cHJpdmF0ZV9kYXRhOwoJcmV0dXJuIHZpZGVvYnVmX3BvbGxfc3RyZWFtKGZpbGUsICZpY2Yt
PnZiX3ZpZHEsIHB0KTsKfQoKc3RhdGljIGludCBweGE5NTVfY2FtX3F1ZXJ5Y2FwKHN0cnVjdCBz
b2NfY2FtZXJhX2hvc3QgKmljaSwKCQkJICAgICAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNh
cCkKewoJc3RydWN0IHY0bDJfZGJnX2NoaXBfaWRlbnQgaWQ7CglzdHJ1Y3QgcHhhOTU1X2NhbV9k
ZXYgKnBjZGV2ID0gaWNpLT5wcml2OwoJc3RydWN0IHNvY19jYW1lcmFfZGV2aWNlICppY2QgPSBw
Y2Rldi0+aWNkOwoJc3RydWN0IHY0bDJfc3ViZGV2ICpzZCA9IHNvY19jYW1lcmFfdG9fc3ViZGV2
KGljZCk7CglpbnQgcmV0ID0gMDsKCgljYXAtPnZlcnNpb24gPSBQWEE5NTVfQ0FNX1ZFUlNJT05f
Q09ERTsKCWNhcC0+Y2FwYWJpbGl0aWVzID0gVjRMMl9DQVBfVklERU9fQ0FQVFVSRSB8IFY0TDJf
Q0FQX1NUUkVBTUlORzsKCXN0cmNweShjYXAtPmNhcmQsICJNRzEiKTsKCXN0cmNweShjYXAtPmRy
aXZlciwgIk4vQSIpOwoKCXJldCA9IHY0bDJfc3ViZGV2X2NhbGwoc2QsIGNvcmUsIGdfY2hpcF9p
ZGVudCwgJmlkKTsKCWlmIChyZXQgPCAwKSB7CgkJcHJpbnRrKEtFUk5fRVJSICJjYW06IGZhaWxl
ZCB0byBnZXQgc2Vuc29yJ3MgbmFtZSFcbiIpOwoJCXJldHVybiByZXQ7Cgl9Cglzd2l0Y2ggKGlk
LmlkZW50KSB7CgkJY2FzZSBWNEwyX0lERU5UX09WNTY0MjoKCQkJc3RyY3B5KGNhcC0+ZHJpdmVy
LCAib3Y1NjQyIik7CgkJCWJyZWFrOwoJCWNhc2UgVjRMMl9JREVOVF9PVjc2OTA6CgkJCXN0cmNw
eShjYXAtPmRyaXZlciwgIm92NzY5MCIpOwoJCQlicmVhazsKCX0KCXJldHVybiAwOwp9CgpzdGF0
aWMgaW50IHB4YTk1NV9jYW1fc2V0X2J1c19wYXJhbShzdHJ1Y3Qgc29jX2NhbWVyYV9kZXZpY2Ug
KmljZCwgX191MzIgcGl4Zm10KQp7CglzdHJ1Y3Qgc29jX2NhbWVyYV9ob3N0ICppY2kgPSB0b19z
b2NfY2FtZXJhX2hvc3QoaWNkLT5kZXYucGFyZW50KTsKCXN0cnVjdCBweGE5NTVfY2FtX2RldiAq
cGNkZXYgPSBpY2ktPnByaXY7Cgl1bnNpZ25lZCBsb25nIGN0cmxsZXJfZmxhZ3MsIHNlbnNvcl9m
bGFncywgY29tbW9uX2ZsYWdzOwoJaW50IHJldDsKCWludCBsYW5lID0gMTsKCgljdHJsbGVyX2Zs
YWdzID0gU09DQU1fTUlQSSB8IFNPQ0FNX01JUElfMUxBTkUgfCBTT0NBTV9NSVBJXzJMQU5FOwoJ
c2Vuc29yX2ZsYWdzID0gaWNkLT5vcHMtPnF1ZXJ5X2J1c19wYXJhbShpY2QpOwoKCWNvbW1vbl9m
bGFncyA9IHNvY19jYW1lcmFfYnVzX3BhcmFtX2NvbXBhdGlibGUoc2Vuc29yX2ZsYWdzLCBjdHJs
bGVyX2ZsYWdzKTsKCWlmICghY29tbW9uX2ZsYWdzKSB7CgkJcmV0dXJuIC1FSU5WQUw7Cgl9CgoJ
cmV0ID0gaWNkLT5vcHMtPnNldF9idXNfcGFyYW0oaWNkLCBjb21tb25fZmxhZ3MpOwoJaWYgKHJl
dCA8IDApCgkJcmV0dXJuIHJldDsKCglpZiAoY29tbW9uX2ZsYWdzICYgU09DQU1fTUlQSV8xTEFO
RSkgewoJCWxhbmUgPSAxOwoJfSBlbHNlIGlmIChjb21tb25fZmxhZ3MgJiBTT0NBTV9NSVBJXzJM
QU5FKSB7CgkJbGFuZSA9IDI7Cgl9CglweGE5NTVfY3NpX2xhbmUocGNkZXYtPmNzaWRldiwgbGFu
ZSk7CglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBweGE5NTVfY2FtX3NldF9wYXJhbShzdHJ1Y3Qg
c29jX2NhbWVyYV9kZXZpY2UgKmljZCwKCQkJCSAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFy
bSkKewoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgcHhhOTU1X2NhbV9lbnVtX2ZzaXplcyhzdHJ1
Y3Qgc29jX2NhbWVyYV9kZXZpY2UgKmljZCwKCQkJCQlzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAq
ZnNpemVzKQp7CglpbnQgcmV0OwoJc3RydWN0IHY0bDJfc3ViZGV2ICpzZCA9IHNvY19jYW1lcmFf
dG9fc3ViZGV2KGljZCk7Cgljb25zdCBzdHJ1Y3Qgc29jX2NhbWVyYV9mb3JtYXRfeGxhdGUgKnhs
YXRlOwoJX191MzIgcGl4Zm10ID0gZnNpemVzLT5waXhlbF9mb3JtYXQ7CglzdHJ1Y3QgdjRsMl9m
cm1zaXplZW51bSAqZnNpemVfbWJ1cyA9IGZzaXplczsKCgl4bGF0ZSA9IHNvY19jYW1lcmFfeGxh
dGVfYnlfZm91cmNjKGljZCwgcGl4Zm10KTsKCWlmICgheGxhdGUpCgkJcmV0dXJuIC1FSU5WQUw7
CgoJLyogbWFwIHhsYXRlLWNvZGUgdG8gcGl4ZWxfZm9ybWF0LCBzZW5zb3Igb25seSBoYW5kbGUg
eGxhdGUtY29kZSovCglmc2l6ZV9tYnVzLT5waXhlbF9mb3JtYXQgPSB4bGF0ZS0+Y29kZTsKCgly
ZXQgPSB2NGwyX3N1YmRldl9jYWxsKHNkLCB2aWRlbywgZW51bV9tYnVzX2ZzaXplcywgZnNpemVf
bWJ1cyk7CglpZiAocmV0IDwgMCkKCQlyZXR1cm4gcmV0OwoKCWZzaXplcy0+cGl4ZWxfZm9ybWF0
ID0gcGl4Zm10OwoKCXJldHVybiAwOwp9CgpzdGF0aWMgc3RydWN0IHNvY19jYW1lcmFfaG9zdF9v
cHMgcHhhOTU1X3NvY19jYW1faG9zdF9vcHMgPSB7Cgkub3duZXIJCT0gVEhJU19NT0RVTEUsCgku
YWRkCQk9IHB4YTk1NV9jYW1fYWRkX2RldmljZSwKCS5yZW1vdmUJCT0gcHhhOTU1X2NhbV9yZW1v
dmVfZGV2aWNlLAoJLmdldF9mb3JtYXRzCT0gcHhhOTU1X2NhbV9nZXRfZm9ybWF0cywKCS5wdXRf
Zm9ybWF0cwk9IHB4YTk1NV9jYW1fcHV0X2Zvcm1hdHMsCgkuc2V0X2ZtdAk9IHB4YTk1NV9jYW1f
c2V0X2ZtdCwKCS50cnlfZm10CT0gcHhhOTU1X2NhbV90cnlfZm10LAoJLmluaXRfdmlkZW9idWYJ
PSBweGE5NTVfY2FtX2luaXRfdmlkZW9idWYsCgkucmVxYnVmcwk9IHB4YTk1NV9jYW1fcmVxYnVm
cywKCS5wb2xsCQk9IHB4YTk1NV9jYW1fcG9sbCwKCS5xdWVyeWNhcAk9IHB4YTk1NV9jYW1fcXVl
cnljYXAsCgkuc2V0X2J1c19wYXJhbQk9IHB4YTk1NV9jYW1fc2V0X2J1c19wYXJhbSwKCS5zZXRf
cGFybSA9IHB4YTk1NV9jYW1fc2V0X3BhcmFtLAoJLmVudW1fZnNpemVzID0gcHhhOTU1X2NhbV9l
bnVtX2ZzaXplcywKfTsKCnN0YXRpYyBpcnFyZXR1cm5fdCBweGE5NTVfY2FtX2lycShpbnQgaXJx
LCB2b2lkICpkYXRhKQp7CglzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYgKnBjZGV2ID0gZGF0YTsKCXVu
c2lnbmVkIGludCBpcnFzID0gMDsKCglzcGluX2xvY2soJnBjZGV2LT5zcGluX2xvY2spOwoJaXJx
cyA9IHNjaV9yZWdfcmVhZChwY2RldiwgUkVHX1NDSVNSKTsKCXNjaV9yZWdfd3JpdGUocGNkZXYs
IFJFR19TQ0lTUiwgaXJxcyk7CQkvKmNsZWFyIGlycXMgaGVyZSovCglpZiAoaXJxcyAmIElSUV9P
Rk8pIHsKCgkJcHJpbnRrKEtFUk5fRVJSICJjYW06IGNjaWMgb3ZlciBmbG93IGVycm9yIVxuIik7
CgkJcHhhOTU1X2NzaV9kaXNhYmxlKHBjZGV2LT5jc2lkZXYpOwoJCXNjaV9kaXNhYmxlKHBjZGV2
KTsKCQlweGE5NTVfY3NpX2VuYWJsZShwY2Rldi0+Y3NpZGV2LCAwKTsKCQlzY2lfZW5hYmxlKHBj
ZGV2KTsKCQlzcGluX3VubG9jaygmcGNkZXYtPnNwaW5fbG9jayk7CgkJcmV0dXJuIElSUV9IQU5E
TEVEOwoJfQoKCWlmIChpcnFzICYgSVJRX0VPRlgpIHsKCQlkbWFfZmV0Y2hfZnJhbWUocGNkZXYp
OwoJCWRtYV9hdHRhY2hfYnVmcyhwY2Rldik7Cgl9CgoJc3Bpbl91bmxvY2soJnBjZGV2LT5zcGlu
X2xvY2spOwoJcmV0dXJuIElSUV9IQU5ETEVEOwp9CgpzdGF0aWMgaW50IHB4YTk1NV9jYW1lcmFf
cHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKewoJc3RydWN0IHJlc291cmNlICpy
ZXM7CglpbnQgZXJyID0gLUVOT01FTTsKCXN0cnVjdCBweGE5NTVfY2FtX2RldiAqcGNkZXY7CgoJ
cGNkZXYgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYpLCBHRlBfS0VSTkVM
KTsKCWlmIChwY2RldiA9PSBOVUxMKQoJCWdvdG8gZXhpdDsKCW1lbXNldChwY2RldiwgMCwgc2l6
ZW9mKHN0cnVjdCBweGE5NTVfY2FtX2RldikpOwoKCXNwaW5fbG9ja19pbml0KCZwY2Rldi0+c3Bp
bl9sb2NrKTsKCWluaXRfd2FpdHF1ZXVlX2hlYWQoJnBjZGV2LT5pb3dhaXQpOwoJSU5JVF9MSVNU
X0hFQUQoJnBjZGV2LT5kZXZfbGlzdCk7CglJTklUX0xJU1RfSEVBRCgmcGNkZXYtPmRtYV9idWZf
bGlzdCk7CgoJcGNkZXYtPnBkYXRhID0gcGRldi0+ZGV2LnBsYXRmb3JtX2RhdGE7CglpZiAocGNk
ZXYtPnBkYXRhID09IE5VTEwpIHsKCQlwcmludGsoS0VSTl9FUlIgImNhbTogY2FtZXJhIG5vIHBs
YXRmb3JtIGRhdGEgZGVmaW5lZFxuIik7CgkJcmV0dXJuIC1FTk9ERVY7Cgl9CgoJcGNkZXYtPmly
cSA9IHBsYXRmb3JtX2dldF9pcnEocGRldiwgMCk7CglpZiAocGNkZXYtPmlycSA8IDApIHsKCQlw
cmludGsoS0VSTl9FUlIgImNhbTogY2FtZXJhIG5vIGlycVxuIik7CgkJcmV0dXJuIC1FTlhJTzsK
CX0KCXJlcyA9IHBsYXRmb3JtX2dldF9yZXNvdXJjZShwZGV2LCBJT1JFU09VUkNFX01FTSwgMCk7
CglpZiAocmVzID09IE5VTEwpIHsKCQlwcmludGsoS0VSTl9FUlIgImNhbTogbm8gSU8gbWVtb3J5
IHJlc291cmNlIGRlZmluZWRcbiIpOwoJCXJldHVybiAtRU5PREVWOwoJfQoKCWVyciA9IC1FSU87
CglwY2Rldi0+cmVncyA9IGlvcmVtYXAocmVzLT5zdGFydCwgU1pfNEspOwoJaWYgKCFwY2Rldi0+
cmVncykgewoJCXByaW50ayhLRVJOX0VSUiAiY2FtOiB1bmFibGUgdG8gaW9yZW1hcCBweGE5NXgt
Y2FtZXJhIHJlZ3NcbiIpOwoJCWdvdG8gZXhpdF9mcmVlOwoJfQoJZXJyID0gcmVxdWVzdF9pcnEo
cGNkZXYtPmlycSwgcHhhOTU1X2NhbV9pcnEsCgkJMCwgUFhBOTU1X0NBTV9EUlZfTkFNRSwgcGNk
ZXYpOwoJaWYgKGVycikgewoJCXByaW50ayhLRVJOX0VSUiAiY2FtOiB1bmFibGUgdG8gY3JlYXRl
IGlzdFxuIik7CgkJZ290byBleGl0X2lvdW5tYXA7Cgl9CgoJcGNkZXYtPnNjaTFfY2xrID0gY2xr
X2dldChOVUxMLCAiU0NJMUNMSyIpOwoJaWYgKCFwY2Rldi0+c2NpMV9jbGspIHsKCQlwcmludGso
S0VSTl9FUlIgImNhbTogdW5hYmxlIHRvIGdldCBzY2kgY2xrXG4iKTsKCQlnb3RvIGV4aXRfZnJl
ZV9pcnE7Cgl9CglwY2Rldi0+c2NpMl9jbGsgPSBjbGtfZ2V0KE5VTEwsICJTQ0kyQ0xLIik7Cglp
ZiAoIXBjZGV2LT5zY2kyX2NsaykgewoJCXByaW50ayhLRVJOX0VSUiAiY2FtOiB1bmFibGUgdG8g
Z2V0IHNjaSBjbGtcbiIpOwoJCWdvdG8gZXhpdF9mcmVlX2lycTsKCX0KCgljc2lfYXR0YWNoKHBj
ZGV2KTsKCglwY2Rldi0+c29jX2hvc3QuZHJ2X25hbWUJPSBQWEE5NTVfQ0FNX0RSVl9OQU1FOwoJ
cGNkZXYtPnNvY19ob3N0Lm9wcwkJPSAmcHhhOTU1X3NvY19jYW1faG9zdF9vcHM7CglwY2Rldi0+
c29jX2hvc3QucHJpdgkJPSBwY2RldjsKCXBjZGV2LT5zb2NfaG9zdC52NGwyX2Rldi5kZXYJPSAm
cGRldi0+ZGV2OwoJcGNkZXYtPnNvY19ob3N0Lm5yCQk9IHBkZXYtPmlkOwoKCWVyciA9IHNvY19j
YW1lcmFfaG9zdF9yZWdpc3RlcigmcGNkZXYtPnNvY19ob3N0KTsKCWlmIChlcnIpCgkJZ290byBl
eGl0X2ZyZWVfaXJxOwoKCXJldHVybiAwOwoKZXhpdF9mcmVlX2lycToKCWZyZWVfaXJxKHBjZGV2
LT5pcnEsIHBjZGV2KTsKZXhpdF9pb3VubWFwOgoJaW91bm1hcChwY2Rldi0+cmVncyk7CgljbGtf
cHV0KHBjZGV2LT5zY2kxX2Nsayk7CgljbGtfcHV0KHBjZGV2LT5zY2kyX2Nsayk7CmV4aXRfZnJl
ZToKCWtmcmVlKHBjZGV2KTsKZXhpdDoKCXJldHVybiBlcnI7Cn0KCgpzdGF0aWMgaW50IHB4YTk1
NV9jYW1lcmFfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCnsKCXN0cnVjdCBz
b2NfY2FtZXJhX2hvc3QgKnNvY19ob3N0ID0gdG9fc29jX2NhbWVyYV9ob3N0KCZwZGV2LT5kZXYp
OwoJc3RydWN0IHB4YTk1NV9jYW1fZGV2ICpwY2RldiA9IGNvbnRhaW5lcl9vZihzb2NfaG9zdCwK
CQkJCQlzdHJ1Y3QgcHhhOTU1X2NhbV9kZXYsIHNvY19ob3N0KTsKCglpZiAocGNkZXYgPT0gTlVM
TCkgewoJCXByaW50ayhLRVJOX1dBUk5JTkcgImNhbTogcmVtb3ZlIG9uIHVua25vd24gcGRldiAl
cFxuIiwgcGRldik7CgkJcmV0dXJuIC1FSU87Cgl9CgoJcHhhOTU1X2NzaV9kaXNhYmxlKHBjZGV2
LT5jc2lkZXYpOwoKCXNjaV9kaXNhYmxlKHBjZGV2KTsKCXNjaV9pcnFfZGlzYWJsZShwY2Rldiwg
SVJRX0VPRlh8SVJRX09GTyk7CglmcmVlX2lycShwY2Rldi0+aXJxLCBwY2Rldik7CglyZXR1cm4g
MDsKfQoKc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgcHhhOTU1X2NhbWVyYV9kcml2ZXIg
PSB7CgkuZHJpdmVyID0gewoJCS5uYW1lID0gUFhBOTU1X0NBTV9EUlZfTkFNRQoJfSwKCS5wcm9i
ZSAJCT0gcHhhOTU1X2NhbWVyYV9wcm9iZSwKCS5yZW1vdmUgCT0gcHhhOTU1X2NhbWVyYV9yZW1v
dmUsCgp9OwoKc3RhdGljIGludCBfX2RldmluaXQgcHhhOTU1X2NhbWVyYV9pbml0KHZvaWQpCnsK
CWludCByZXQgPSAwOwoKCXJldCA9IHBsYXRmb3JtX2RyaXZlcl9yZWdpc3RlcigmcHhhOTU1X2Nh
bWVyYV9kcml2ZXIpOwoJcmV0dXJuIHJldDsKfQoKc3RhdGljIHZvaWQgX19leGl0IHB4YTk1NV9j
YW1lcmFfZXhpdCh2b2lkKQp7CglwbGF0Zm9ybV9kcml2ZXJfdW5yZWdpc3RlcigmcHhhOTU1X2Nh
bWVyYV9kcml2ZXIpOwp9Cgptb2R1bGVfaW5pdChweGE5NTVfY2FtZXJhX2luaXQpOwptb2R1bGVf
ZXhpdChweGE5NTVfY2FtZXJhX2V4aXQpOwo=

--_005_7BAC95F5A7E67643AAFB2C31BEE662D014040BF848SCVEXCH2marve_--
