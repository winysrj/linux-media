Return-path: <linux-media-owner@vger.kernel.org>
Received: from cantor.suse.de ([195.135.220.2]:35526 "EHLO mx1.suse.de"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1751528AbZHJPuH (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Mon, 10 Aug 2009 11:50:07 -0400
Date: Mon, 10 Aug 2009 17:50:07 +0200
Message-ID: <s5hocqnllcg.wl%tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Ozan =?UTF-8?B?w4dhxJ9sYXlhbg==?= <ozan@pardus.org.tr>
Cc: alsa-devel@alsa-project.org, linux-media@vger.kernel.org
Subject: Re: [alsa-devel] NULL pointer dereference in ALSA triggered	through saa7134-alsa
In-Reply-To: <4A803FDC.8070005@pardus.org.tr>
References: <4A8025BF.7030404@pardus.org.tr>
	<s5hab27n501.wl%tiwai@suse.de>
	<4A803FDC.8070005@pardus.org.tr>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

At Mon, 10 Aug 2009 18:42:20 +0300,
Ozan Çağlayan wrote:
> 
> Takashi Iwai wrote:
> > At Mon, 10 Aug 2009 16:50:55 +0300,
> > Ozan Çağlayan wrote:
> >   
> >> Hi,
> >>
> >> I've finally succesfully compiled and linked saa7134-alsa driver using
> >> an external alsa-driver and its Module.symvers file. Everything seems
> >> okay, no undefined symbol or something else:
> >>
> >> - An installed 2.6.30.4 kernel which only builds and brings soundcore
> >> and sound_firmware,
> >> - Latest alsa-driver built externally and installed,
> >> - Latest saa7134-alsa, cx88-alsa, etc. code from linus-2.6 (seen that
> >> they don't affected by some API/ABI changes) patched on top of the
> >> alsa-driver tarball,
> >>     
> >
> > The external drivers using ALSA API have to be built with the
> > newer ALSA header files from alsa-driver tree.  It's not enough to
> > change snd_card_new() with snd_card_create().  The core structure
> > was changed, so the whole build has to be adjusted, too.
> >   
> Actually that was the 0th step that I forgot to mention. I'm installing
> the headers from the alsa-driver snapshot into /usr/include/sound and
> then I build alsa-driver. Then I use the symvers from the alsa-driver
> build alltogether with the headers that I've already installed into
> /usr/include/sound to build the V4L ones.

But /usr/include/sound isn't used for building kernel modules normally.
Unless any hack is added, these files have to be installed to the
kernel header directory.


Takashi
