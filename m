Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-ew0-f220.google.com ([209.85.219.220]:42298 "EHLO
	mail-ew0-f220.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S966490Ab0BZXB0 (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Fri, 26 Feb 2010 18:01:26 -0500
Received: by ewy20 with SMTP id 20so377183ewy.21
        for <linux-media@vger.kernel.org>; Fri, 26 Feb 2010 15:01:24 -0800 (PST)
MIME-Version: 1.0
In-Reply-To: <41ef408f1002241342v423d728cwf9bc4957f35dabed@mail.gmail.com>
References: <41ef408f1002241342v423d728cwf9bc4957f35dabed@mail.gmail.com>
From: Bert Massop <bert.massop@gmail.com>
Date: Sat, 27 Feb 2010 00:01:04 +0100
Message-ID: <41ef408f1002261501u68c5a204ha016786808e2a949@mail.gmail.com>
Subject: Re: af9015: tuner id:179 not supported, please report!
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=001636c5a67eea57b9048088e024
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--001636c5a67eea57b9048088e024
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Using the previous patch, the compiler will complain about a missing
file (tda18218.h). Please use this updated version of the patch, also
made by Nikola.

Have fun with it, it's working fine here!

Regards, Bert

On Wed, Feb 24, 2010 at 22:42, Bert Massop <bert.massop@gmail.com> wrote:
>
> This is a forward of the original email from Nikola Pajkovsky. Just
> for the records, so it is on the list.
>
> This solves the problem of the tuner id:179 not supported error, when
> loading the AF9015 driver.
>
> Thank you, Nikola!
>
> Regards,
> Bert Massop
>
> ---------- Forwarded message ----------
> From: Nikola Pajkovsky <npajkovs@redhat.com>
> Date: Wed, Feb 24, 2010 at 11:54
> Subject: Re: af901x: NXP TDA18218
> To: Antti Palosaari <crope@iki.fi>
> Cc: jan.sundman@aland.net, bert.massop@gmail.com,
> mkrufky@kernellabs.com, dheitmueller@kernellabs.com
>
>
> Hello,
>
> =A0 =A0here is my solution, I can watch Vancouver right now :). I don't
> look at the patch if there is some mistake(no time watch Vancouver),
> but I will when I will have some free time.
> Attached patch apply against this souce (hg clone
> http://linuxtv.org/hg/~anttip/af9015/).
>
> Firmware:
> wget http://jusst.de/manu/fw/AFA/dvb-usb-af9015.fw_a-link
> sudo mv dvb-usb-af9015.fw_a-link /lib/firmware/dvb-usb-af9015.fw
>
> Have a nice day ;)
>
> On 23.2.2010 14:02, Antti Palosaari wrote:
> >
> > Hello,
> > I just got info from one user about this driver, looks like Terratec ha=
ve driver.
> > http://forum.ubuntuusers.de/topic/probleme-beim-installieren-terratec-c=
inergy-t/3/?highlight=3Dterratec+cinergy+t+stick
> >
> > Antti
> >
> > Nikola Pajkovsky wrote:
> >>
> >> Hello,
> >>
> >> =A0 =A0is any chance that will be support for TDA182118?
> >>
> >> Regards,
> >>
> >
>
>
> --
> Nikola

--001636c5a67eea57b9048088e024
Content-Type: text/x-patch; charset=US-ASCII; name="af9013_tuner_tda18218.patch"
Content-Disposition: attachment; filename="af9013_tuner_tda18218.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_g65l722z1

ZGlmZiAtciAwZjQxZmQ3ZGY4NWQgbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL0tj
b25maWcKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL0tjb25maWcJVGh1
IEZlYiAxMSAwMjozMzoxMiAyMDEwICswMjAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvY29t
bW9uL3R1bmVycy9LY29uZmlnCVRodSBGZWIgMjUgMTc6MjE6MTEgMjAxMCArMDEwMApAQCAtMTc5
LDQgKzE3OSwxMSBAQAogCWhlbHAKIAkgIEEgZHJpdmVyIGZvciB0aGUgc2lsaWNvbiB0dW5lciBN
QVgyMTY1IGZyb20gTWF4aW0uCiAKK2NvbmZpZyBNRURJQV9UVU5FUl9UREExODIxOAorCXRyaXN0
YXRlICJOWFAgVERBMTgyMTggc2lsaWNvbiB0dW5lciIKKwlkZXBlbmRzIG9uIFZJREVPX01FRElB
ICYmIEkyQworCWRlZmF1bHQgbSBpZiBNRURJQV9UVU5FUl9DVVNUT01JU0UKKwloZWxwCisJICBB
IGRyaXZlciBmb3IgdGhlIHNpbGljb24gdHVuZXIgVERBMTgyMTggZnJvbSBOWFAuCisKIGVuZGlm
ICMgTUVESUFfVFVORVJfQ1VTVE9NSVNFCmRpZmYgLXIgMGY0MWZkN2RmODVkIGxpbnV4L2RyaXZl
cnMvbWVkaWEvY29tbW9uL3R1bmVycy9NYWtlZmlsZQotLS0gYS9saW51eC9kcml2ZXJzL21lZGlh
L2NvbW1vbi90dW5lcnMvTWFrZWZpbGUJVGh1IEZlYiAxMSAwMjozMzoxMiAyMDEwICswMjAwCisr
KyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvY29tbW9uL3R1bmVycy9NYWtlZmlsZQlUaHUgRmViIDI1
IDE3OjIxOjExIDIwMTAgKzAxMDAKQEAgLTI0LDYgKzI0LDcgQEAKIG9iai0kKENPTkZJR19NRURJ
QV9UVU5FUl9NWEw1MDA3VCkgKz0gbXhsNTAwN3Qubwogb2JqLSQoQ09ORklHX01FRElBX1RVTkVS
X01DNDRTODAzKSArPSBtYzQ0czgwMy5vCiBvYmotJChDT05GSUdfTUVESUFfVFVORVJfTUFYMjE2
NSkgKz0gbWF4MjE2NS5vCitvYmotJChDT05GSUdfTUVESUFfVFVORVJfVERBMTgyMTgpICs9IHRk
YTE4MjE4Lm8KIAogRVhUUkFfQ0ZMQUdTICs9IC1JZHJpdmVycy9tZWRpYS9kdmIvZHZiLWNvcmUK
IEVYVFJBX0NGTEFHUyArPSAtSWRyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcwpkaWZmIC1yIDBm
NDFmZDdkZjg1ZCBsaW51eC9kcml2ZXJzL21lZGlhL2NvbW1vbi90dW5lcnMvdGRhMTgyMTguYwot
LS0gL2Rldi9udWxsCVRodSBKYW4gMDEgMDA6MDA6MDAgMTk3MCArMDAwMAorKysgYi9saW51eC9k
cml2ZXJzL21lZGlhL2NvbW1vbi90dW5lcnMvdGRhMTgyMTguYwlUaHUgRmViIDI1IDE3OjIxOjEx
IDIwMTAgKzAxMDAKQEAgLTAsMCArMSw0NzEgQEAKKy8qCisgKiAgRHJpdmVyIGZvciBOWFAgVERB
MTgyMTggc2lsaWNvbiB0dW5lcgorICoKKyAqICBDb3B5cmlnaHQgKEMpIDIwMTAgTGF1cmlzIERp
bmcgPGxkaW5nQGdteC5kZT4KKyAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogIGl0IHVuZGVyIHRoZSB0ZXJt
cyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiAg
dGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGlj
ZW5zZSwgb3IKKyAqICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAq
ICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJl
IHVzZWZ1bCwKKyAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUg
aW1wbGllZCB3YXJyYW50eSBvZgorICogIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqICBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQg
YSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogIGFsb25nIHdpdGgg
dGhpcyBwcm9ncmFtOyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiAgRm91
bmRhdGlvbiwgSW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAyMTM5LCBVU0EuCisg
Ki8KKyNpbmNsdWRlICJ0ZGExODIxOC5oIgorI2luY2x1ZGUgImNvbXBhdC5oIgorI2luY2x1ZGUg
InRkYTE4MjE4X3ByaXYuaCIKKworc3RhdGljIGludCB0ZGExODIxOF93cml0ZV9yZWcoc3RydWN0
IGR2Yl9mcm9udGVuZCAqZmUsIHU4IHJlZywgdTggdmFsKQoreworCXN0cnVjdCB0ZGExODIxOF9w
cml2ICpwcml2ID0gZmUtPnR1bmVyX3ByaXY7CisJdTggYnVmWzJdID0geyByZWcsIHZhbCB9Owor
CXN0cnVjdCBpMmNfbXNnIG1zZyA9IHsgLmFkZHIgPSBwcml2LT5jZmctPmkyY19hZGRyZXNzLCAu
ZmxhZ3MgPSAwLAorCQkJICAgICAgIC5idWYgPSBidWYsIC5sZW4gPSAyIH07CisJaW50IHJldDsK
KworCWlmIChmZS0+b3BzLmkyY19nYXRlX2N0cmwpCisJCWZlLT5vcHMuaTJjX2dhdGVfY3RybChm
ZSwgMSk7CisJLyogd3JpdGUgcmVnaXN0ZXIgKi8KKwlyZXQgPSBpMmNfdHJhbnNmZXIocHJpdi0+
aTJjLCAmbXNnLCAxKTsKKwlpZiAoZmUtPm9wcy5pMmNfZ2F0ZV9jdHJsKQorCQlmZS0+b3BzLmky
Y19nYXRlX2N0cmwoZmUsIDApOworCisJaWYgKHJldCAhPSAxKQorCQlwcmludGsoS0VSTl9XQVJO
SU5HICJJMkMgd3JpdGUgZmFpbGVkIHJldDogJWQgcmVnOiAlMDJ4XG4iLCByZXQsIHJlZyk7CisK
KwlyZXR1cm4gKHJldCA9PSAxID8gMCA6IHJldCk7Cit9CisKK3N0YXRpYyBpbnQgdGRhMTgyMThf
d3JpdGVfcmVncyhzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTggcmVnLAorCXU4ICp2YWwsIHU4
IGxlbikKK3sKKwlzdHJ1Y3QgdGRhMTgyMThfcHJpdiAqcHJpdiA9IGZlLT50dW5lcl9wcml2Owor
CXU4IGJ1ZlsxK2xlbl07CisJc3RydWN0IGkyY19tc2cgbXNnID0geworCQkuYWRkciA9IHByaXYt
PmNmZy0+aTJjX2FkZHJlc3MsCisJCS5mbGFncyA9IDAsCisJCS5sZW4gPSBzaXplb2YoYnVmKSwK
KwkJLmJ1ZiA9IGJ1ZiB9OworCQkKKwlpbnQgcmV0OworCisJYnVmWzBdID0gcmVnOworCW1lbWNw
eSgmYnVmWzFdLCB2YWwsIGxlbik7CisJCisJaWYgKGZlLT5vcHMuaTJjX2dhdGVfY3RybCkKKwkJ
ZmUtPm9wcy5pMmNfZ2F0ZV9jdHJsKGZlLCAxKTsKKwlyZXQgPSBpMmNfdHJhbnNmZXIocHJpdi0+
aTJjLCAmbXNnLCAxKTsKKwlpZiAoZmUtPm9wcy5pMmNfZ2F0ZV9jdHJsKQorCQlmZS0+b3BzLmky
Y19nYXRlX2N0cmwoZmUsIDEpOworCisJaWYgKHJldCAhPSAxKQorCQlwcmludGsoS0VSTl9XQVJO
SU5HICJJMkMgd3JpdGUgZmFpbGVkIHJldDogJWQgcmVnOiAlMDJ4IGxlbjogJWRcbiIsIHJldCwg
cmVnLCBsZW4pOworCQorCXJldHVybiAocmV0ID09IDEgPyAwIDogcmV0KTsKK30KKworLypzdGF0
aWMgaW50IHRkYTE4MjE4X3JlYWRfcmVnKHN0cnVjdCB0ZGExODIxOF9wcml2ICpwcml2LCB1MTYg
cmVnLCB1OCAqdmFsKQoreworCXU4IG9idWZbM10gPSB7IHJlZyA+PiA4LCByZWcgJiAweGZmLCAw
IH07CisJdTggaWJ1ZlsxXTsKKwlzdHJ1Y3QgaTJjX21zZyBtc2dbMl0gPSB7CisJCXsKKwkJCS5h
ZGRyID0gMHgzYSwKKwkJCS5mbGFncyA9IDAsCisJCQkubGVuID0gc2l6ZW9mKG9idWYpLAorCQkJ
LmJ1ZiA9IG9idWYKKwkJfSwgeworCQkJLmFkZHIgPSAweDNhLAorCQkJLmZsYWdzID0gSTJDX01f
UkQsCisJCQkubGVuID0gc2l6ZW9mKGlidWYpLAorCQkJLmJ1ZiA9IGlidWYKKwkJfQorCX07CisK
KwlpZiAoaTJjX3RyYW5zZmVyKHByaXYtPmkyYywgbXNnLCAyKSAhPSAyKSB7CisJCXByaW50ayhL
RVJOX1dBUk5JTkcgIkkyQyByZWFkIGZhaWxlZCByZWc6JTA0eFxuIiwgcmVnKTsKKwkJcmV0dXJu
IC1FUkVNT1RFSU87CisJfQorCSp2YWwgPSBpYnVmWzBdOworCXJldHVybiAwOworfSovCisKK3N0
YXRpYyBpbnQgdGRhMTgyMThfcmVhZF9yZWdzKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlKQorewor
CXN0cnVjdCB0ZGExODIxOF9wcml2ICpwcml2ID0gZmUtPnR1bmVyX3ByaXY7CisJdTggKnJlZ3Mg
PSBwcml2LT50ZGExODIxOF9yZWdzOworCXU4IGJ1ZiA9IDB4MDA7CisJaW50IHJldDsKKwkvL2lu
dCBpOworCXN0cnVjdCBpMmNfbXNnIG1zZ1tdID0geworCQl7IC5hZGRyID0gMHhjMCwgLmZsYWdz
ID0gMCwKKwkJICAuYnVmID0gJmJ1ZiwgLmxlbiA9IDEgfSwKKwkJeyAuYWRkciA9IDB4YzAsIC5m
bGFncyA9IEkyQ19NX1JELAorCQkgIC5idWYgPSByZWdzLCAubGVuID0gNTkgfQorCX07CisKKwlp
ZiAoZmUtPm9wcy5pMmNfZ2F0ZV9jdHJsKQorCQlmZS0+b3BzLmkyY19nYXRlX2N0cmwoZmUsIDEp
OworCisJLyogcmVhZCBhbGwgcmVnaXN0ZXJzICovCisJcmV0ID0gaTJjX3RyYW5zZmVyKHByaXYt
PmkyYywgbXNnLCAyKTsKKworCWlmIChmZS0+b3BzLmkyY19nYXRlX2N0cmwpCisJCWZlLT5vcHMu
aTJjX2dhdGVfY3RybChmZSwgMCk7CisKKwlpZiAocmV0ICE9IDIpCisJCXByaW50ayhLRVJOX1dB
Uk5JTkcgIkkyQyByZWFkIGZhaWxlZCByZXQ6ICVkXG4iLCByZXQpOworCQorCS8qZm9yKGkgPSAw
OyBpIDw9IDU4OyBpKyspCisJCXByaW50aygiUmVnaXN0ZXIgJWQ6ICUwMnhcbiIsIGksIDB4ZmYg
JiByZWdzW2ldKTsqLworCisJcmV0dXJuIChyZXQgPT0gMiA/IDAgOiByZXQpOworfQorCitzdGF0
aWMgaW50IHRkYTE4MjE4X3NldF9wYXJhbXMoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsIHN0cnVj
dCBkdmJfZnJvbnRlbmRfcGFyYW1ldGVycyAqcGFyYW1zKQoreworCXN0cnVjdCB0ZGExODIxOF9w
cml2ICpwcml2ID0gZmUtPnR1bmVyX3ByaXY7CisJdTggKnJlZ3MgPSBwcml2LT50ZGExODIxOF9y
ZWdzOworCXU4IEZjLCBCUDsKKwlpbnQgaSwgcmV0OworCXUxNiBpZjEsIGJ3OworCXUzMiBmcmVx
OworCQorCXU4IHBhcmFtc2J1Zls0XVs2XSA9IHsKKwkJeyAweDAzLCAweDFhIH0sCisJCXsgMHgw
NCwgMHgwYSB9LAorCQl7IDB4MDEsIDB4MGYgfSwKKwkJeyAweDAxLCAweDBmIH0sCisJfTsKKwkK
Kwl1OCBhZ2NidWZbXVsyXSA9IHsKKwkJeyAweDFhLCAweDBlIH0sCisJCXsgMHgyMCwgMHg2MCB9
LAorCQl7IDB4MjMsIDB4MDIgfSwKKwkJeyAweDIwLCAweGEwIH0sCisJCXsgMHgyMywgMHgwOSB9
LAorCQl7IDB4MjAsIDB4ZTAgfSwKKwkJeyAweDIzLCAweDBjIH0sCisJCXsgMHgyMCwgMHg0MCB9
LAorCQl7IDB4MjMsIDB4MDEgfSwKKwkJeyAweDIwLCAweDgwIH0sCisJCXsgMHgyMywgMHgwOCB9
LAorCQl7IDB4MjAsIDB4YzAgfSwKKwkJeyAweDIzLCAweDBiIH0sCisJCXsgMHgyNCwgMHgxYyB9
LAorCQl7IDB4MjQsIDB4MGMgfSwKKwl9OworCQorCXN3aXRjaCAocGFyYW1zLT51Lm9mZG0uYmFu
ZHdpZHRoKSB7CisJY2FzZSBCQU5EV0lEVEhfNl9NSFo6CisJCWJ3ID0gNjAwMDsKKwkJRmMgPSAw
OworCQlicmVhazsKKwljYXNlIEJBTkRXSURUSF83X01IWjoKKwkJYncgPSA3MDAwOworCQlGYyA9
IDE7CisJCWJyZWFrOworCWNhc2UgQkFORFdJRFRIXzhfTUhaOgorCQlidyA9IDgwMDA7CisJCUZj
ID0gMjsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcHJpbnRrKEtFUk5fV0FSTklORyAiSW52YWxp
ZCBiYW5kd2lkdGgiKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCQorCWlmMSA9IGJ3IC8gMjsK
KwkKKwlpZigocGFyYW1zLT5mcmVxdWVuY3kgPj0gMTc0MDAwMDAwKSAmJiAocGFyYW1zLT5mcmVx
dWVuY3kgPCAxODgwMDAwMDApKSB7CisJCUJQID0gMzsKKwl9CisJZWxzZSBpZigocGFyYW1zLT5m
cmVxdWVuY3kgPj0gMTg4MDAwMDAwKSAmJiAocGFyYW1zLT5mcmVxdWVuY3kgPCAyNTMwMDAwMDAp
KSB7CisJCUJQID0gNDsKKwl9CisJZWxzZSBpZigocGFyYW1zLT5mcmVxdWVuY3kgPj0gMjUzMDAw
MDAwKSAmJiAocGFyYW1zLT5mcmVxdWVuY3kgPCAzNDMwMDAwMDApKSB7CisJCUJQID0gNTsKKwl9
CisJZWxzZSBpZigocGFyYW1zLT5mcmVxdWVuY3kgPj0gMzQzMDAwMDAwKSAmJiAocGFyYW1zLT5m
cmVxdWVuY3kgPD0gODcwMDAwMDAwKSkgeworCQlCUCA9IDY7CisJfQorCWVsc2UgeworCQlwcmlu
dGsoS0VSTl9XQVJOSU5HICJGcmVxdWVuY3kgb3V0IG9mIHJhbmdlIik7CisJCXJldHVybiAtRUlO
VkFMOworCX0KKwkKKwlmcmVxID0gcGFyYW1zLT5mcmVxdWVuY3k7CisJZnJlcSAvPSAxMDAwOwor
CWZyZXEgKz1pZjE7CisJZnJlcSAqPSAxNjsKKwkKKwl0ZGExODIxOF9yZWFkX3JlZ3MoZmUpOwor
CQorCXBhcmFtc2J1ZlswXVsyXSA9IHJlZ3NbMHgxYV0gfCBCUDsKKwlwYXJhbXNidWZbMF1bM10g
PSByZWdzWzB4MWJdICYgfjM7CisJcGFyYW1zYnVmWzBdWzNdID0gcmVnc1sweDFiXSB8IEZjOwor
CXBhcmFtc2J1ZlswXVs0XSA9IHJlZ3NbMHgxY10gfCAweDBhOworCQorCXBhcmFtc2J1ZlsxXVsy
XSA9IGZyZXEgPj4gMTY7CisJcGFyYW1zYnVmWzFdWzNdID0gZnJlcSA+PiA4OworCXBhcmFtc2J1
ZlsxXVs0XSA9IChmcmVxICYgMHhmMCkgfCAocmVnc1sweDBjXSAmIDB4MGYpOworCXBhcmFtc2J1
ZlsxXVs1XSA9IDB4ZmY7CisJcGFyYW1zYnVmWzJdWzJdID0gcmVnc1sweDBmXSB8IDB4NDA7CisJ
cGFyYW1zYnVmWzNdWzJdID0gMHgwOTsKKwkKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MDQs
IDB4MDMpOworCisJZm9yKGkgPSAwOyBpIDwgQVJSQVlfU0laRShwYXJhbXNidWYpOyBpKyspIHsK
KworCQkvKiB3cml0ZSByZWdpc3RlcnMgKi8KKwkJcmV0ID0gdGRhMTgyMThfd3JpdGVfcmVncyhm
ZSwgcGFyYW1zYnVmW2ldWzFdLCAmcGFyYW1zYnVmW2ldWzJdLCBwYXJhbXNidWZbaV1bMF0pOwor
CisJCWlmIChyZXQpCisJCQlnb3RvIGVycm9yOworCX0KKwlmb3IoaSA9IDA7IGkgPCBBUlJBWV9T
SVpFKGFnY2J1Zik7IGkrKykgeworCQl0ZGExODIxOF93cml0ZV9yZWcoZmUsIGFnY2J1ZltpXVsw
XSwgYWdjYnVmW2ldWzFdKTsKKwl9CisJCisJLy90ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MDMs
IDB4MDApOworCS8vdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA0LCAweDAwKTsKKwkvL3RkYTE4
MjE4X3dyaXRlX3JlZyhmZSwgMHgyMCwgMHhjNyk7CisJCisJbXNsZWVwKDYwKTsKKwlpID0gMDsK
Kwl3aGlsZShpIDwgMTApIHsKKwkJdGRhMTgyMThfcmVhZF9yZWdzKGZlKTsKKwkJaWYoKHJlZ3Nb
MHgwMV0gJiAweDYwKSA9PSAweDYwKQorCQkJcHJpbnRrKEtFUk5fSU5GTyAiV2UndmUgZ290IGEg
bG9jayEiKTsgYnJlYWs7CisJCW1zbGVlcCgyMCk7CisJCWkrKzsKKwl9CisJCisJcHJpdi0+YmFu
ZHdpZHRoID0gcGFyYW1zLT51Lm9mZG0uYmFuZHdpZHRoOworCXByaXYtPmZyZXF1ZW5jeSA9IHBh
cmFtcy0+ZnJlcXVlbmN5OworCXJldHVybiAwOworZXJyb3I6CisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGludCB0ZGExODIxOF9nZXRfZnJlcXVlbmN5KHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZl
LCB1MzIgKmZyZXF1ZW5jeSkKK3sKKwlzdHJ1Y3QgdGRhMTgyMThfcHJpdiAqcHJpdiA9IGZlLT50
dW5lcl9wcml2OworCSpmcmVxdWVuY3kgPSBwcml2LT5mcmVxdWVuY3k7CisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgdGRhMTgyMThfZ2V0X2JhbmR3aWR0aChzdHJ1Y3QgZHZiX2Zyb250ZW5k
ICpmZSwgdTMyICpiYW5kd2lkdGgpCit7CisJc3RydWN0IHRkYTE4MjE4X3ByaXYgKnByaXYgPSBm
ZS0+dHVuZXJfcHJpdjsKKwkqYmFuZHdpZHRoID0gcHJpdi0+YmFuZHdpZHRoOworCXJldHVybiAw
OworfQorCitzdGF0aWMgaW50IHRkYTE4MjE4X2luaXQoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUp
Cit7CisJLy9zdHJ1Y3QgdGRhMTgyMThfcHJpdiAqcHJpdiA9IGZlLT50dW5lcl9wcml2OworCS8v
dTggKnJlZ3MgPSBwcml2LT50ZGExODIxOF9yZWdzOworCWludCBpOworCWludCByZXQ7CisJCisJ
dTggaW5pdGJ1ZltdWzE4XSA9IHsKKwkJeyAweDEwLCAweDA1LCAweDAwLCAweDAwLCAweGQwLCAw
eDAwLCAweDQwLCAweDAwLCAweDAwLCAweDA3LCAweGZmLCAweDg0LCAweDA5LCAweDAwLCAweDEz
LCAweDAwLCAweDAwLCAweDAxIH0sCisJCXsgMHgwYiwgMHgxNSwgMHg4NCwgMHgwOSwgMHhmMCwg
MHgxOSwgMHgwYSwgMHgwZSwgMHgyOSwgMHg5OCwgMHgwMCwgMHgwMCwgMHg1OCB9LAorCQl7IDB4
MTAsIDB4MjQsIDB4MGMsIDB4NDgsIDB4ODUsIDB4YzksIDB4YTcsIDB4MDAsIDB4MDAsIDB4MDAs
IDB4MzAsIDB4ODEsIDB4ODAsIDB4MDAsIDB4MzksIDB4MDAsIDB4OGEsIDB4MDAgfSwKKwkJeyAw
eDA3LCAweDM0LCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweGY2LCAweGY2IH0sCisJ
fTsKKwkKKwl1OCBpbml0YnVmMls0XTsKKworCWZvcihpID0gMDsgaSA8IEFSUkFZX1NJWkUoaW5p
dGJ1Zik7IGkrKykgeworCQkKKwkJLyogd3JpdGUgcmVnaXN0ZXJzICovCisJCXJldCA9IHRkYTE4
MjE4X3dyaXRlX3JlZ3MoZmUsIGluaXRidWZbaV1bMV0sICZpbml0YnVmW2ldWzJdLCBpbml0YnVm
W2ldWzBdKTsKKworCQlpZiAocmV0ICE9IDApIHsKKwkJCXByaW50ayhLRVJOX0VSUiAiaW5pdDog
RVJST1I6IGkyY190cmFuc2ZlciByZXR1cm5lZDogJWRcbiIsIHJldCk7CisJCQlyZXR1cm4gLUVS
RU1PVEVJTzsKKwkJfQorCQlpZihpID09IDEpIHsKKwkJCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgyMiwgMHg4Yyk7CisJCX0KKwl9CisJCisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAw
eDgwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MDUsIDB4MDApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgwNSwgMHgyMCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAw
eDAwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjcsIDB4ZGUpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxNywgMHhmOCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDE4LCAw
eDBmKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MWMsIDB4OGIpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyOSwgMHgwMik7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDE5LCAw
eDFhKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MTEsIDB4MTMpOworCisJaW5pdGJ1ZjJb
MF0gPSAweDBhOworCWluaXRidWYyWzFdID0gMHg1YzsKKwlpbml0YnVmMlsyXSA9IDB4YzY7CisJ
aW5pdGJ1ZjJbM10gPSAweDA3OworCXRkYTE4MjE4X3dyaXRlX3JlZ3MoZmUsIGluaXRidWYyWzBd
LCAmaW5pdGJ1ZjJbMV0sIDMpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwgMHgwZiwgMHg0OSk7
CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAweDQwKTsKKwl0ZGExODIxOF93cml0ZV9y
ZWcoZmUsIDB4MDUsIDB4MDApOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwgMHgwNSwgMHgyMCk7
CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDExLCAweGVkKTsKKwl0ZGExODIxOF93cml0ZV9y
ZWcoZmUsIDB4MGYsIDB4NDkpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwgMHgxOSwgMHgyYSk7
CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAweDU4KTsKKwl0ZGExODIxOF93cml0ZV9y
ZWcoZmUsIDB4MDUsIDB4MTgpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwgMHgwNSwgMHgzOCk7
CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDI5LCAweDAzKTsKKwl0ZGExODIxOF93cml0ZV9y
ZWcoZmUsIDB4MTksIDB4MWEpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwgMHgxMSwgMHgxMyk7
CisJaW5pdGJ1ZjJbMF0gPSAweDBhOworCWluaXRidWYyWzFdID0gMHhiZTsKKwlpbml0YnVmMlsy
XSA9IDB4NmU7CisJaW5pdGJ1ZjJbM10gPSAweDA3OworCXRkYTE4MjE4X3dyaXRlX3JlZ3MoZmUs
IGluaXRidWYyWzBdLCAmaW5pdGJ1ZjJbMV0sIDMpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgwZiwgMHg0OSk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAweDU4KTsKKwl0ZGEx
ODIxOF93cml0ZV9yZWcoZmUsIDB4MDUsIDB4MTgpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgwNSwgMHgzOCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDExLCAweGVkKTsKKwl0ZGEx
ODIxOF93cml0ZV9yZWcoZmUsIDB4MGYsIDB4NDkpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgxOSwgMHgyYSk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDA1LCAweDU4KTsKKwl0ZGEx
ODIxOF93cml0ZV9yZWcoZmUsIDB4MDUsIDB4MTgpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgwNSwgMHgzOCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDE5LCAweDBhKTsKKwl0ZGEx
ODIxOF93cml0ZV9yZWcoZmUsIDB4MjcsIDB4YzkpOworCXRkYTE4MjE4X3dyaXRlX3JlZyhmZSwg
MHgxMSwgMHgxMyk7CisJaW5pdGJ1ZjJbMF0gPSAweDE3OworCWluaXRidWYyWzFdID0gMHhmMDsK
Kwlpbml0YnVmMlsyXSA9IDB4MTk7CisJaW5pdGJ1ZjJbM10gPSAweDAwOworCXRkYTE4MjE4X3dy
aXRlX3JlZ3MoZmUsIGluaXRidWYyWzBdLCAmaW5pdGJ1ZjJbMV0sIDIpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxYywgMHg5OCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDI5LCAw
eDAzKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MmEsIDB4MDApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyYSwgMHgwMSk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDJhLCAw
eDAyKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MmEsIDB4MDMpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxYywgMHg5OCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDE4LCAw
eDE5KTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjIsIDB4OWMpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxZiwgMHg1OCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDI0LCAw
eDBjKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MWMsIDB4ODgpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMCwgMHgxMCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIxLCAw
eDRjKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjAsIDB4MDApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMSwgMHg0OCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDFmLCAw
eDViKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjAsIDB4MDApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxZiwgMHg1OSk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIwLCAw
eDAwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MWYsIDB4NWEpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMCwgMHgwMCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDFmLCAw
eDVmKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjAsIDB4MDApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgxZiwgMHg1ZCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIwLCAw
eDAwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MWYsIDB4NWUpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMCwgMHgwMCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIwLCAw
eDYwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjMsIDB4MDIpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMCwgMHhhMCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIzLCAw
eDA5KTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjAsIDB4ZTApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMywgMHgwYyk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIwLCAw
eDQwKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjMsIDB4MDEpOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMCwgMHg4MCk7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDIzLCAw
eDA4KTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjAsIDB4YzApOworCXRkYTE4MjE4X3dy
aXRlX3JlZyhmZSwgMHgyMywgMHgwYik7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDFjLCAw
eDk4KTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjIsIDB4OGMpOworCWluaXRidWYyWzBd
ID0gMHgxNzsKKwlpbml0YnVmMlsxXSA9IDB4YjA7CisJaW5pdGJ1ZjJbMl0gPSAweDU5OworCWlu
aXRidWYyWzNdID0gMHgwMDsKKwkvL3RkYTE4MjE4X3dyaXRlX3JlZ3MoZmUsIGluaXRidWYyWzBd
LCAmaW5pdGJ1ZjJbMV0sIDIpOworCWluaXRidWYyWzBdID0gMHgxYTsKKwlpbml0YnVmMlsxXSA9
IDB4MGU7CisJaW5pdGJ1ZjJbMl0gPSAweDJhOworCWluaXRidWYyWzNdID0gMHg5ODsKKwl0ZGEx
ODIxOF93cml0ZV9yZWdzKGZlLCBpbml0YnVmMlswXSwgJmluaXRidWYyWzFdLCAzKTsKKwlpbml0
YnVmMlswXSA9IDB4MTc7CisJaW5pdGJ1ZjJbMV0gPSAweGIwOworCWluaXRidWYyWzJdID0gMHg1
OTsKKwlpbml0YnVmMlszXSA9IDB4MDA7CisJdGRhMTgyMThfd3JpdGVfcmVncyhmZSwgaW5pdGJ1
ZjJbMF0sICZpbml0YnVmMlsxXSwgMik7CisJdGRhMTgyMThfd3JpdGVfcmVnKGZlLCAweDJkLCAw
eDgxKTsKKwl0ZGExODIxOF93cml0ZV9yZWcoZmUsIDB4MjksIDB4MDIpOworCQorCXJldHVybiAw
OworfQorCQorc3RhdGljIGludCB0ZGExODIxOF9yZWxlYXNlKHN0cnVjdCBkdmJfZnJvbnRlbmQg
KmZlKQoreworCWtmcmVlKGZlLT50dW5lcl9wcml2KTsKKwlmZS0+dHVuZXJfcHJpdiA9IE5VTEw7
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHZiX3R1bmVyX29wcyB0ZGEx
ODIxOF90dW5lcl9vcHMgPSB7CisJLmluZm8gPSB7CisJCS5uYW1lICAgICAgICAgICA9ICJOWFAg
VERBMTgyMTgiLAorCQkuZnJlcXVlbmN5X21pbiAgPSBUREExODIxOF9NSU5fRlJFUSwKKwkJLmZy
ZXF1ZW5jeV9tYXggID0gVERBMTgyMThfTUFYX0ZSRVEsCisJCS5mcmVxdWVuY3lfc3RlcCA9IFRE
QTE4MjE4X1NURVAsCisJfSwKKworCS5yZWxlYXNlICAgICAgID0gdGRhMTgyMThfcmVsZWFzZSwK
KwkuaW5pdCAgICAgICAgICA9IHRkYTE4MjE4X2luaXQsCisJCisJLnNldF9wYXJhbXMgPSB0ZGEx
ODIxOF9zZXRfcGFyYW1zLAorCS5nZXRfZnJlcXVlbmN5ID0gdGRhMTgyMThfZ2V0X2ZyZXF1ZW5j
eSwKKwkuZ2V0X2JhbmR3aWR0aCA9IHRkYTE4MjE4X2dldF9iYW5kd2lkdGgsCit9OworCitzdHJ1
Y3QgZHZiX2Zyb250ZW5kICogdGRhMTgyMThfYXR0YWNoKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZl
LAorCQkJCSAgICBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmkyYywKKwkJCQkgICAgc3RydWN0IHRkYTE4
MjE4X2NvbmZpZyAqY2ZnKQoreworCXN0cnVjdCB0ZGExODIxOF9wcml2ICpwcml2ID0gTlVMTDsK
KworCXByaXYgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgdGRhMTgyMThfcHJpdiksIEdGUF9LRVJO
RUwpOworCWlmIChwcml2ID09IE5VTEwpCisJCXJldHVybiBOVUxMOworCisJcHJpdi0+Y2ZnID0g
Y2ZnOworCXByaXYtPmkyYyA9IGkyYzsKKworCWZlLT50dW5lcl9wcml2ID0gcHJpdjsKKwkKKwl0
ZGExODIxOF9yZWFkX3JlZ3MoZmUpOworCWlmIChwcml2LT50ZGExODIxOF9yZWdzWzB4MDBdICE9
IDB4YzApIHsKKwkJcHJpbnRrKEtFUk5fV0FSTklORyAiRGV2aWNlIGlzIG5vdCBhIFREQTE4MjE4
IVxuIik7CisJCWtmcmVlKHByaXYpOworCQlyZXR1cm4gTlVMTDsKKwl9CisJCisJcHJpbnRrKEtF
Uk5fSU5GTyAiTlhQIFREQTE4MjE4IHN1Y2Nlc3NmdWxseSBpZGVudGlmaWVkLlxuIik7CisJbWVt
Y3B5KCZmZS0+b3BzLnR1bmVyX29wcywgJnRkYTE4MjE4X3R1bmVyX29wcywKKwkgICAgICAgc2l6
ZW9mKHN0cnVjdCBkdmJfdHVuZXJfb3BzKSk7CisJCisJcmV0dXJuIGZlOworfQorRVhQT1JUX1NZ
TUJPTCh0ZGExODIxOF9hdHRhY2gpOworCitNT0RVTEVfREVTQ1JJUFRJT04oIk5YUCBUREExODIx
OCBzaWxpY29uIHR1bmVyIGRyaXZlciIpOworTU9EVUxFX0FVVEhPUigiTGF1cmlzIERpbmcgPGxk
aW5nQGdteC5kZT4iKTsKK01PRFVMRV9WRVJTSU9OKCIwLjEiKTsKK01PRFVMRV9MSUNFTlNFKCJH
UEwiKTsKZGlmZiAtciAwZjQxZmQ3ZGY4NWQgbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVu
ZXJzL3RkYTE4MjE4LmgKLS0tIC9kZXYvbnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAwIDE5NzAgKzAw
MDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9jb21tb24vdHVuZXJzL3RkYTE4MjE4LmgJVGh1
IEZlYiAyNSAxNzoyMToxMSAyMDEwICswMTAwCkBAIC0wLDAgKzEsNDQgQEAKKy8qCisgKiAgRHJp
dmVyIGZvciAgTlhQIFREQTE4MjE4IHNpbGljb24gdHVuZXIKKyAqCisgKiAgQ29weXJpZ2h0IChD
KSAyMDEwIExhdXJpcyBEaW5nIDxsZGluZ0BnbXguZGU+CisgKgorICogIFRoaXMgcHJvZ3JhbSBp
cyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Cisg
KiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBh
cyBwdWJsaXNoZWQgYnkKKyAqICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIg
dmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxh
dGVyIHZlcnNpb24uCisgKgorICogIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogIFlvdSBz
aG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlCisgKiAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZy
ZWUgU29mdHdhcmUKKyAqICBGb3VuZGF0aW9uLCBJbmMuLCA2NzUgTWFzcyBBdmUsIENhbWJyaWRn
ZSwgTUEgMDIxMzksIFVTQS4KKyAqLworCisjaWZuZGVmIFREQTE4MjE4X0gKKyNkZWZpbmUgVERB
MTgyMThfSAorCisjaW5jbHVkZSAiZHZiX2Zyb250ZW5kLmgiCisKK3N0cnVjdCB0ZGExODIxOF9j
b25maWcgeworCXU4IGkyY19hZGRyZXNzOworfTsKKworI2lmIGRlZmluZWQoQ09ORklHX01FRElB
X1RVTkVSX1REQTE4MjE4KSB8fCAoZGVmaW5lZChDT05GSUdfTUVESUFfVFVORVJfVERBMTgyMThf
TU9EVUxFKSAmJiBkZWZpbmVkKE1PRFVMRSkpCitleHRlcm4gc3RydWN0IGR2Yl9mcm9udGVuZCAq
dGRhMTgyMThfYXR0YWNoKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLAorCQkJCQkgIHN0cnVjdCBp
MmNfYWRhcHRlciAqaTJjLAorCQkJCQkgIHN0cnVjdCB0ZGExODIxOF9jb25maWcgKmNmZyk7Cisj
ZWxzZQorc3RhdGljIGlubGluZSBzdHJ1Y3QgZHZiX2Zyb250ZW5kICp0ZGExODIxOF9hdHRhY2go
c3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsCisJCQkJCQkgc3RydWN0IGkyY19hZGFwdGVyICppMmMs
CisJCQkJCQkgc3RydWN0IHRkYTE4MjE4X2NvbmZpZyAqY2ZnKQoreworCXByaW50ayhLRVJOX1dB
Uk5JTkcgIiVzOiBkcml2ZXIgZGlzYWJsZWQgYnkgS2NvbmZpZ1xuIiwgX19mdW5jX18pOworCXJl
dHVybiBOVUxMOworfQorI2VuZGlmIC8vIENPTkZJR19NRURJQV9UVU5FUl9UREExODIxOAorCisj
ZW5kaWYKXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlCmRpZmYgLXIgMGY0MWZkN2RmODVkIGxp
bnV4L2RyaXZlcnMvbWVkaWEvY29tbW9uL3R1bmVycy90ZGExODIxOF9wcml2LmgKLS0tIC9kZXYv
bnVsbAlUaHUgSmFuIDAxIDAwOjAwOjAwIDE5NzAgKzAwMDAKKysrIGIvbGludXgvZHJpdmVycy9t
ZWRpYS9jb21tb24vdHVuZXJzL3RkYTE4MjE4X3ByaXYuaAlUaHUgRmViIDI1IDE3OjIxOjExIDIw
MTAgKzAxMDAKQEAgLTAsMCArMSwzNiBAQAorLyoKKyAqICBEcml2ZXIgZm9yIE5YUCBUREExODIx
OCBzaWxpY29uIHR1bmVyCisgKgorICogIENvcHlyaWdodCAoQykgMjAxMCBMYXVyaXMgRGluZyA8
bGRpbmdAZ214LmRlPgorICogIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqICB0aGUg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNl
LCBvcgorICogIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogIFRo
aXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNl
ZnVsLAorICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBs
aWVkIHdhcnJhbnR5IG9mCisgKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFS
VElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisgKgorICogIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNv
cHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiAgYWxvbmcgd2l0aCB0aGlz
IHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKKyAqICBGb3VuZGF0
aW9uLCBJbmMuLCA2NzUgTWFzcyBBdmUsIENhbWJyaWRnZSwgTUEgMDIxMzksIFVTQS4KKyAqLwor
CisjaWZuZGVmIFREQTE4MjE4X1BSSVZfSAorI2RlZmluZSBUREExODIxOF9QUklWX0gKKworI2Rl
ZmluZSBUREExODIxOF9TVEVQICAgICAgICAgMTAwMCAvKiAxIGtIeiAqLworI2RlZmluZSBUREEx
ODIxOF9NSU5fRlJFUSAgIDE3NDAwMDAwMCAvKiAgIDE3NCBNSHogKi8KKyNkZWZpbmUgVERBMTgy
MThfTUFYX0ZSRVEgIDg2NDAwMDAwMCAvKiAgODY0IE1IeiAqLworCitzdHJ1Y3QgdGRhMTgyMThf
cHJpdiB7CisJdTggdGRhMTgyMThfcmVnc1sweDNiXTsKKwlzdHJ1Y3QgdGRhMTgyMThfY29uZmln
ICpjZmc7CisJc3RydWN0IGkyY19hZGFwdGVyICppMmM7CisKKwl1MzIgZnJlcXVlbmN5OworCXUz
MiBiYW5kd2lkdGg7Cit9OworCisjZW5kaWYKZGlmZiAtciAwZjQxZmQ3ZGY4NWQgbGludXgvZHJp
dmVycy9tZWRpYS9kdmIvZHZiLXVzYi9hZjkwMTUuYwotLS0gYS9saW51eC9kcml2ZXJzL21lZGlh
L2R2Yi9kdmItdXNiL2FmOTAxNS5jCVRodSBGZWIgMTEgMDI6MzM6MTIgMjAxMCArMDIwMAorKysg
Yi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9kdmItdXNiL2FmOTAxNS5jCVRodSBGZWIgMjUgMTc6
MjE6MTEgMjAxMCArMDEwMApAQCAtMjAsMTEgKzIwLDcgQEAKICAqICAgIEZvdW5kYXRpb24sIElu
Yy4sIDY3NSBNYXNzIEF2ZSwgQ2FtYnJpZGdlLCBNQSAwMjEzOSwgVVNBLgogICoKICAqLwotI2lm
IExJTlVYX1ZFUlNJT05fQ09ERSA+PSBLRVJORUxfVkVSU0lPTigyLCA2LCAyNSkKIAotI2luY2x1
ZGUgPGxpbnV4L2hhc2guaD4KLQotI2VuZGlmCiAjaW5jbHVkZSAiYWY5MDE1LmgiCiAjaW5jbHVk
ZSAiYWY5MDEzLmgiCiAjaW5jbHVkZSAibXQyMDYwLmgiCkBAIC0zMiw2ICsyOCw3IEBACiAjaW5j
bHVkZSAidGRhMTgyNzEuaCIKICNpbmNsdWRlICJteGw1MDA1cy5oIgogI2luY2x1ZGUgIm1jNDRz
ODAzLmgiCisjaW5jbHVkZSAidGRhMTgyMTguaCIKIAogc3RhdGljIGludCBkdmJfdXNiX2FmOTAx
NV9kZWJ1ZzsKIG1vZHVsZV9wYXJhbV9uYW1lZChkZWJ1ZywgZHZiX3VzYl9hZjkwMTVfZGVidWcs
IGludCwgMDY0NCk7CkBAIC0yNzMsNyArMjcwLDggQEAKIAogCXdoaWxlIChpIDwgbnVtKSB7CiAJ
CWlmIChtc2dbaV0uYWRkciA9PSBhZjkwMTVfYWY5MDEzX2NvbmZpZ1swXS5kZW1vZF9hZGRyZXNz
IHx8Ci0JCSAgICBtc2dbaV0uYWRkciA9PSBhZjkwMTVfYWY5MDEzX2NvbmZpZ1sxXS5kZW1vZF9h
ZGRyZXNzKSB7CisJCSAgICBtc2dbaV0uYWRkciA9PSBhZjkwMTVfYWY5MDEzX2NvbmZpZ1sxXS5k
ZW1vZF9hZGRyZXNzICB8fAorCQkgICAgbXNnW2ldLmFkZHIgPT0gMHgzYSkgewogCQkJYWRkciA9
IG1zZ1tpXS5idWZbMF0gPDwgODsKIAkJCWFkZHIgKz0gbXNnW2ldLmJ1ZlsxXTsKIAkJCW1ib3gg
PSBtc2dbaV0uYnVmWzJdOwpAQCAtMjg2LDcgKzI4NCw4IEBACiAKIAkJaWYgKG51bSA+IGkgKyAx
ICYmIChtc2dbaSsxXS5mbGFncyAmIEkyQ19NX1JEKSkgewogCQkJaWYgKG1zZ1tpXS5hZGRyID09
Ci0JCQkJYWY5MDE1X2FmOTAxM19jb25maWdbMF0uZGVtb2RfYWRkcmVzcykKKwkJCQlhZjkwMTVf
YWY5MDEzX2NvbmZpZ1swXS5kZW1vZF9hZGRyZXNzIHx8CisJCQkgICAgbXNnW2ldLmFkZHIgPT0g
MHgzYSkKIAkJCQlyZXEuY21kID0gUkVBRF9NRU1PUlk7CiAJCQllbHNlCiAJCQkJcmVxLmNtZCA9
IFJFQURfSTJDOwpAQCAtMzAxLDcgKzMwMCw4IEBACiAJCX0gZWxzZSBpZiAobXNnW2ldLmZsYWdz
ICYgSTJDX01fUkQpIHsKIAkJCXJldCA9IC1FSU5WQUw7CiAJCQlpZiAobXNnW2ldLmFkZHIgPT0K
LQkJCQlhZjkwMTVfYWY5MDEzX2NvbmZpZ1swXS5kZW1vZF9hZGRyZXNzKQorCQkJCWFmOTAxNV9h
ZjkwMTNfY29uZmlnWzBdLmRlbW9kX2FkZHJlc3MgfHwKKwkJCSAgICBtc2dbaV0uYWRkciA9PSAw
eDNhKQogCQkJCWdvdG8gZXJyb3I7CiAJCQllbHNlCiAJCQkJcmVxLmNtZCA9IFJFQURfSTJDOwpA
QCAtMzE1LDcgKzMxNSw4IEBACiAJCQlpICs9IDE7CiAJCX0gZWxzZSB7CiAJCQlpZiAobXNnW2ld
LmFkZHIgPT0KLQkJCQlhZjkwMTVfYWY5MDEzX2NvbmZpZ1swXS5kZW1vZF9hZGRyZXNzKQorCQkJ
CWFmOTAxNV9hZjkwMTNfY29uZmlnWzBdLmRlbW9kX2FkZHJlc3MgfHwKKwkJCSAgICBtc2dbaV0u
YWRkciA9PSAweDNhKQogCQkJCXJlcS5jbWQgPSBXUklURV9NRU1PUlk7CiAJCQllbHNlCiAJCQkJ
cmVxLmNtZCA9IFdSSVRFX0kyQzsKQEAgLTU2MCwyNCArNTYxLDExIEBACiAJcmV0dXJuIHJldDsK
IH0KIAotI2lmIExJTlVYX1ZFUlNJT05fQ09ERSA8IEtFUk5FTF9WRVJTSU9OKDIsIDYsIDI1KQor
LyogZHVtcCBlZXByb20gKi8KIHN0YXRpYyBpbnQgYWY5MDE1X2VlcHJvbV9kdW1wKHN0cnVjdCBk
dmJfdXNiX2RldmljZSAqZCkKLSNlbHNlCi0vKiBoYXNoIChhbmQgZHVtcCkgZWVwcm9tICovCi1z
dGF0aWMgaW50IGFmOTAxNV9lZXByb21faGFzaChzdHJ1Y3QgdXNiX2RldmljZSAqdWRldikKLSNl
bmRpZgogewotI2lmIExJTlVYX1ZFUlNJT05fQ09ERSA8IEtFUk5FTF9WRVJTSU9OKDIsIDYsIDI1
KQogCXU4IHJlZywgdmFsOwotI2Vsc2UKLQlzdGF0aWMgY29uc3QgdW5zaWduZWQgaW50IGVlcHJv
bV9zaXplID0gMjU2OwotCXVuc2lnbmVkIGludCByZWc7Ci0JaW50IHJldDsKLQl1OCB2YWwsICpl
ZXByb207Ci0Jc3RydWN0IHJlcV90IHJlcSA9IHtSRUFEX0kyQywgQUY5MDE1X0kyQ19FRVBST00s
IDAsIDAsIDEsIDEsICZ2YWx9OwotI2VuZGlmCiAKLSNpZiBMSU5VWF9WRVJTSU9OX0NPREUgPCBL
RVJORUxfVkVSU0lPTigyLCA2LCAyNSkKIAlmb3IgKHJlZyA9IDA7IDsgcmVnKyspIHsKIAkJaWYg
KHJlZyAlIDE2ID09IDApIHsKIAkJCWlmIChyZWcpCkBAIC01OTAsNDMgKzU3OCw5IEBACiAJCQlk
ZWJfaW5mbyhLRVJOX0NPTlQgIiAtLSIpOwogCQlpZiAocmVnID09IDB4ZmYpCiAJCQlicmVhazsK
LSNlbHNlCi0JZWVwcm9tID0ga21hbGxvYyhlZXByb21fc2l6ZSwgR0ZQX0tFUk5FTCk7Ci0JaWYg
KGVlcHJvbSA9PSBOVUxMKQotCQlyZXR1cm4gLUVOT01FTTsKLQotCWZvciAocmVnID0gMDsgcmVn
IDwgZWVwcm9tX3NpemU7IHJlZysrKSB7Ci0JCXJlcS5hZGRyID0gcmVnOwotCQlyZXQgPSBhZjkw
MTVfcndfdWRldih1ZGV2LCAmcmVxKTsKLQkJaWYgKHJldCkKLQkJCWdvdG8gZnJlZTsKLQkJZWVw
cm9tW3JlZ10gPSB2YWw7Ci0jZW5kaWYKIAl9Ci0KLSNpZiBMSU5VWF9WRVJTSU9OX0NPREUgPCBL
RVJORUxfVkVSU0lPTigyLCA2LCAyNSkKIAlkZWJfaW5mbyhLRVJOX0NPTlQgIlxuIik7CiAJcmV0
dXJuIDA7Ci0jZWxzZQotCWlmIChkdmJfdXNiX2FmOTAxNV9kZWJ1ZyAmIDB4MDEpCi0JCXByaW50
X2hleF9kdW1wX2J5dGVzKCIiLCBEVU1QX1BSRUZJWF9PRkZTRVQsIGVlcHJvbSwKLQkJCQllZXBy
b21fc2l6ZSk7Ci0KLQlCVUdfT04oZWVwcm9tX3NpemUgJSA0KTsKLQotCWFmOTAxNV9jb25maWcu
ZWVwcm9tX3N1bSA9IDA7Ci0JZm9yIChyZWcgPSAwOyByZWcgPCBlZXByb21fc2l6ZSAvIHNpemVv
Zih1MzIpOyByZWcrKykgewotCQlhZjkwMTVfY29uZmlnLmVlcHJvbV9zdW0gKj0gR09MREVOX1JB
VElPX1BSSU1FXzMyOwotCQlhZjkwMTVfY29uZmlnLmVlcHJvbV9zdW0gKz0gbGUzMl90b19jcHUo
KCh1MzIgKillZXByb20pW3JlZ10pOwotCX0KLQotCWRlYl9pbmZvKCIlczogZWVwcm9tIHN1bT0l
Ljh4XG4iLCBfX2Z1bmNfXywgYWY5MDE1X2NvbmZpZy5lZXByb21fc3VtKTsKLQotCXJldCA9IDA7
Ci1mcmVlOgotCWtmcmVlKGVlcHJvbSk7Ci0JcmV0dXJuIHJldDsKLSNlbmRpZgogfQogCiBzdGF0
aWMgaW50IGFmOTAxNV9kb3dubG9hZF9pcl90YWJsZShzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmQp
CkBAIC03NjUsMTMyICs3MTksMTIgQEAKIAlyZXR1cm4gcmV0OwogfQogCi1zdHJ1Y3QgYWY5MDE1
X3NldHVwIHsKLQl1bnNpZ25lZCBpbnQgaWQ7Ci0Jc3RydWN0IGR2Yl91c2JfcmNfa2V5ICpyY19r
ZXlfbWFwOwotCXVuc2lnbmVkIGludCByY19rZXlfbWFwX3NpemU7Ci0JdTggKmlyX3RhYmxlOwot
CXVuc2lnbmVkIGludCBpcl90YWJsZV9zaXplOwotfTsKLQotc3RhdGljIGNvbnN0IHN0cnVjdCBh
ZjkwMTVfc2V0dXAgKmFmOTAxNV9zZXR1cF9tYXRjaCh1bnNpZ25lZCBpbnQgaWQsCi0JCWNvbnN0
IHN0cnVjdCBhZjkwMTVfc2V0dXAgKnRhYmxlKQotewotCWZvciAoOyB0YWJsZS0+cmNfa2V5X21h
cDsgdGFibGUrKykKLQkJaWYgKHRhYmxlLT5pZCA9PSBpZCkKLQkJCXJldHVybiB0YWJsZTsKLQly
ZXR1cm4gTlVMTDsKLX0KLQotc3RhdGljIGNvbnN0IHN0cnVjdCBhZjkwMTVfc2V0dXAgYWY5MDE1
X3NldHVwX21vZHBhcmFtW10gPSB7Ci0JeyBBRjkwMTVfUkVNT1RFX0FfTElOS19EVFVfTSwKLQkJ
YWY5MDE1X3JjX2tleXNfYV9saW5rLCBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX2FfbGluayks
Ci0JCWFmOTAxNV9pcl90YWJsZV9hX2xpbmssIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX2Ff
bGluaykgfSwKLQl7IEFGOTAxNV9SRU1PVEVfTVNJX0RJR0lWT1hfTUlOSV9JSV9WMywKLQkJYWY5
MDE1X3JjX2tleXNfbXNpLCBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX21zaSksCi0JCWFmOTAx
NV9pcl90YWJsZV9tc2ksIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX21zaSkgfSwKLQl7IEFG
OTAxNV9SRU1PVEVfTVlHSUNUVl9VNzE4LAotCQlhZjkwMTVfcmNfa2V5c19teWdpY3R2LCBBUlJB
WV9TSVpFKGFmOTAxNV9yY19rZXlzX215Z2ljdHYpLAotCQlhZjkwMTVfaXJfdGFibGVfbXlnaWN0
diwgQVJSQVlfU0laRShhZjkwMTVfaXJfdGFibGVfbXlnaWN0dikgfSwKLQl7IEFGOTAxNV9SRU1P
VEVfRElHSVRUUkFERV9EVkJfVCwKLQkJYWY5MDE1X3JjX2tleXNfZGlnaXR0cmFkZSwgQVJSQVlf
U0laRShhZjkwMTVfcmNfa2V5c19kaWdpdHRyYWRlKSwKLQkJYWY5MDE1X2lyX3RhYmxlX2RpZ2l0
dHJhZGUsIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX2RpZ2l0dHJhZGUpIH0sCi0JeyBBRjkw
MTVfUkVNT1RFX0FWRVJNRURJQV9LUywKLQkJYWY5MDE1X3JjX2tleXNfYXZlcm1lZGlhLCBBUlJB
WV9TSVpFKGFmOTAxNV9yY19rZXlzX2F2ZXJtZWRpYSksCi0JCWFmOTAxNV9pcl90YWJsZV9hdmVy
bWVkaWFfa3MsIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX2F2ZXJtZWRpYV9rcykgfSwKLQl7
IH0KLX07Ci0KLS8qIGRvbid0IGFkZCBuZXcgZW50cmllcyBoZXJlIGFueW1vcmUsIHVzZSBoYXNo
ZXMgaW5zdGVhZCAqLwotc3RhdGljIGNvbnN0IHN0cnVjdCBhZjkwMTVfc2V0dXAgYWY5MDE1X3Nl
dHVwX3VzYmlkc1tdID0gewotCXsgVVNCX1ZJRF9MRUFEVEVLLAotCQlhZjkwMTVfcmNfa2V5c19s
ZWFkdGVrLCBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX2xlYWR0ZWspLAotCQlhZjkwMTVfaXJf
dGFibGVfbGVhZHRlaywgQVJSQVlfU0laRShhZjkwMTVfaXJfdGFibGVfbGVhZHRlaykgfSwKLQl7
IFVTQl9WSURfVklTSU9OUExVUywKLQkJYWY5MDE1X3JjX2tleXNfdHdpbmhhbiwgQVJSQVlfU0la
RShhZjkwMTVfcmNfa2V5c190d2luaGFuKSwKLQkJYWY5MDE1X2lyX3RhYmxlX3R3aW5oYW4sIEFS
UkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX3R3aW5oYW4pIH0sCi0JeyBVU0JfVklEX0tXT1JMRF8y
LCAvKiBUT0RPOiB1c2UgY29ycmVjdCByYyBrZXlzICovCi0JCWFmOTAxNV9yY19rZXlzX3R3aW5o
YW4sIEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfdHdpbmhhbiksCi0JCWFmOTAxNV9pcl90YWJs
ZV9rd29ybGQsIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX2t3b3JsZCkgfSwKLQl7IFVTQl9W
SURfQVZFUk1FRElBLAotCQlhZjkwMTVfcmNfa2V5c19hdmVybWVkaWEsIEFSUkFZX1NJWkUoYWY5
MDE1X3JjX2tleXNfYXZlcm1lZGlhKSwKLQkJYWY5MDE1X2lyX3RhYmxlX2F2ZXJtZWRpYSwgQVJS
QVlfU0laRShhZjkwMTVfaXJfdGFibGVfYXZlcm1lZGlhKSB9LAotCXsgVVNCX1ZJRF9NU0lfMiwK
LQkJYWY5MDE1X3JjX2tleXNfbXNpX2RpZ2l2b3hfaWlpLCBBUlJBWV9TSVpFKGFmOTAxNV9yY19r
ZXlzX21zaV9kaWdpdm94X2lpaSksCi0JCWFmOTAxNV9pcl90YWJsZV9tc2lfZGlnaXZveF9paWks
IEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX21zaV9kaWdpdm94X2lpaSkgfSwKLQl7IH0KLX07
Ci0KLXN0YXRpYyBjb25zdCBzdHJ1Y3QgYWY5MDE1X3NldHVwIGFmOTAxNV9zZXR1cF9oYXNoZXNb
XSA9IHsKLQl7IDB4YjhmZWI3MDgsCi0JCWFmOTAxNV9yY19rZXlzX21zaSwgQVJSQVlfU0laRShh
ZjkwMTVfcmNfa2V5c19tc2kpLAotCQlhZjkwMTVfaXJfdGFibGVfbXNpLCBBUlJBWV9TSVpFKGFm
OTAxNV9pcl90YWJsZV9tc2kpIH0sCi0JeyAweGEzNzAzZDAwLAotCQlhZjkwMTVfcmNfa2V5c19h
X2xpbmssIEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfYV9saW5rKSwKLQkJYWY5MDE1X2lyX3Rh
YmxlX2FfbGluaywgQVJSQVlfU0laRShhZjkwMTVfaXJfdGFibGVfYV9saW5rKSB9LAotCXsgMHg5
YjdkYzY0ZSwKLQkJYWY5MDE1X3JjX2tleXNfbXlnaWN0diwgQVJSQVlfU0laRShhZjkwMTVfcmNf
a2V5c19teWdpY3R2KSwKLQkJYWY5MDE1X2lyX3RhYmxlX215Z2ljdHYsIEFSUkFZX1NJWkUoYWY5
MDE1X2lyX3RhYmxlX215Z2ljdHYpIH0sCi0JeyB9Ci19OwotCi1zdGF0aWMgdm9pZCBhZjkwMTVf
c2V0X3JlbW90ZV9jb25maWcoc3RydWN0IHVzYl9kZXZpY2UgKnVkZXYsCi0JCXN0cnVjdCBkdmJf
dXNiX2RldmljZV9wcm9wZXJ0aWVzICpwcm9wcykKLXsKLQljb25zdCBzdHJ1Y3QgYWY5MDE1X3Nl
dHVwICp0YWJsZSA9IE5VTEw7Ci0KLQlpZiAoZHZiX3VzYl9hZjkwMTVfcmVtb3RlKSB7Ci0JCS8q
IGxvYWQgcmVtb3RlIGRlZmluZWQgYXMgbW9kdWxlIHBhcmFtICovCi0JCXRhYmxlID0gYWY5MDE1
X3NldHVwX21hdGNoKGR2Yl91c2JfYWY5MDE1X3JlbW90ZSwKLQkJCQlhZjkwMTVfc2V0dXBfbW9k
cGFyYW0pOwotCX0gZWxzZSB7Ci0JCXUxNiB2ZW5kb3IgPSBsZTE2X3RvX2NwdSh1ZGV2LT5kZXNj
cmlwdG9yLmlkVmVuZG9yKTsKLQotCQl0YWJsZSA9IGFmOTAxNV9zZXR1cF9tYXRjaChhZjkwMTVf
Y29uZmlnLmVlcHJvbV9zdW0sCi0JCQkJYWY5MDE1X3NldHVwX2hhc2hlcyk7Ci0KLQkJaWYgKCF0
YWJsZSAmJiB2ZW5kb3IgPT0gVVNCX1ZJRF9BRkFURUNIKSB7Ci0JCQkvKiBDaGVjayBVU0IgbWFu
dWZhY3R1cmVyIGFuZCBwcm9kdWN0IHN0cmluZ3MgYW5kIHRyeQotCQkJICAgdG8gZGV0ZXJtaW5l
IGNvcnJlY3QgcmVtb3RlIGluIGNhc2Ugb2YgY2hpcCB2ZW5kb3IKLQkJCSAgIHJlZmVyZW5jZSBJ
RHMgYXJlIHVzZWQuCi0JCQkgICBETyBOT1QgQUREIEFOWVRISU5HIE5FVyBIRVJFLiBVc2UgaGFz
aGVzIGluc3RlYWQuCi0JCQkgKi8KLQkJCWNoYXIgbWFudWZhY3R1cmVyWzEwXTsKLQkJCW1lbXNl
dChtYW51ZmFjdHVyZXIsIDAsIHNpemVvZihtYW51ZmFjdHVyZXIpKTsKLQkJCXVzYl9zdHJpbmco
dWRldiwgdWRldi0+ZGVzY3JpcHRvci5pTWFudWZhY3R1cmVyLAotCQkJCW1hbnVmYWN0dXJlciwg
c2l6ZW9mKG1hbnVmYWN0dXJlcikpOwotCQkJaWYgKCFzdHJjbXAoIk1TSSIsIG1hbnVmYWN0dXJl
cikpIHsKLQkJCQkvKiBpTWFudWZhY3R1cmVyIDEgTVNJCi0JCQkJICAgaVByb2R1Y3QgICAgICAy
IE1TSSBLLVZPWCAqLwotCQkJCXRhYmxlID0gYWY5MDE1X3NldHVwX21hdGNoKAotCQkJCQlBRjkw
MTVfUkVNT1RFX01TSV9ESUdJVk9YX01JTklfSUlfVjMsCi0JCQkJCWFmOTAxNV9zZXR1cF9tb2Rw
YXJhbSk7Ci0JCQl9IGVsc2UgaWYgKHVkZXYtPmRlc2NyaXB0b3IuaWRQcm9kdWN0ID09Ci0JCQkJ
Y3B1X3RvX2xlMTYoVVNCX1BJRF9UUkVLU1RPUl9EVkJUKSkgewotCQkJCXRhYmxlID0gJihjb25z
dCBzdHJ1Y3QgYWY5MDE1X3NldHVwKXsgMCwKLQkJCQkJYWY5MDE1X3JjX2tleXNfdHJla3N0b3Is
Ci0JCQkJCUFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfdHJla3N0b3IpLAotCQkJCQlhZjkwMTVf
aXJfdGFibGVfdHJla3N0b3IsCi0JCQkJCUFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX3RyZWtz
dG9yKQotCQkJCX07Ci0JCQl9Ci0JCX0gZWxzZSBpZiAoIXRhYmxlKQotCQkJdGFibGUgPSBhZjkw
MTVfc2V0dXBfbWF0Y2godmVuZG9yLCBhZjkwMTVfc2V0dXBfdXNiaWRzKTsKLQl9Ci0KLQlpZiAo
dGFibGUpIHsKLQkJcHJvcHMtPnJjX2tleV9tYXAgPSB0YWJsZS0+cmNfa2V5X21hcDsKLQkJcHJv
cHMtPnJjX2tleV9tYXBfc2l6ZSA9IHRhYmxlLT5yY19rZXlfbWFwX3NpemU7Ci0JCWFmOTAxNV9j
b25maWcuaXJfdGFibGUgPSB0YWJsZS0+aXJfdGFibGU7Ci0JCWFmOTAxNV9jb25maWcuaXJfdGFi
bGVfc2l6ZSA9IHRhYmxlLT5pcl90YWJsZV9zaXplOwotCX0KLX0KLQogc3RhdGljIGludCBhZjkw
MTVfcmVhZF9jb25maWcoc3RydWN0IHVzYl9kZXZpY2UgKnVkZXYpCiB7CiAJaW50IHJldDsKIAl1
OCB2YWwsIGksIG9mZnNldCA9IDA7CiAJc3RydWN0IHJlcV90IHJlcSA9IHtSRUFEX0kyQywgQUY5
MDE1X0kyQ19FRVBST00sIDAsIDAsIDEsIDEsICZ2YWx9OworCWNoYXIgbWFudWZhY3R1cmVyWzEw
XTsKIAogCS8qIElSIHJlbW90ZSBjb250cm9sbGVyICovCiAJcmVxLmFkZHIgPSBBRjkwMTVfRUVQ
Uk9NX0lSX01PREU7CkBAIC05MDIsMjAgKzczNiwxNTggQEAKIAl9CiAJaWYgKHJldCkKIAkJZ290
byBlcnJvcjsKLQotI2lmIExJTlVYX1ZFUlNJT05fQ09ERSA+PSBLRVJORUxfVkVSU0lPTigyLCA2
LCAyNSkKLQlyZXQgPSBhZjkwMTVfZWVwcm9tX2hhc2godWRldik7Ci0JaWYgKHJldCkKLQkJZ290
byBlcnJvcjsKLQotI2VuZGlmCiAJZGViX2luZm8oIiVzOiBJUiBtb2RlOiVkXG4iLCBfX2Z1bmNf
XywgdmFsKTsKIAlmb3IgKGkgPSAwOyBpIDwgYWY5MDE1X3Byb3BlcnRpZXNfY291bnQ7IGkrKykg
ewogCQlpZiAodmFsID09IEFGOTAxNV9JUl9NT0RFX0RJU0FCTEVEKSB7CiAJCQlhZjkwMTVfcHJv
cGVydGllc1tpXS5yY19rZXlfbWFwID0gTlVMTDsKIAkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJj
X2tleV9tYXBfc2l6ZSAgPSAwOwotCQl9IGVsc2UKLQkJCWFmOTAxNV9zZXRfcmVtb3RlX2NvbmZp
Zyh1ZGV2LCAmYWY5MDE1X3Byb3BlcnRpZXNbaV0pOworCQl9IGVsc2UgaWYgKGR2Yl91c2JfYWY5
MDE1X3JlbW90ZSkgeworCQkJLyogbG9hZCByZW1vdGUgZGVmaW5lZCBhcyBtb2R1bGUgcGFyYW0g
Ki8KKwkJCXN3aXRjaCAoZHZiX3VzYl9hZjkwMTVfcmVtb3RlKSB7CisJCQljYXNlIEFGOTAxNV9S
RU1PVEVfQV9MSU5LX0RUVV9NOgorCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXAg
PQorCQkJCSAgYWY5MDE1X3JjX2tleXNfYV9saW5rOworCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ld
LnJjX2tleV9tYXBfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX2FfbGlu
ayk7CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZSA9IGFmOTAxNV9pcl90YWJsZV9hX2xpbms7
CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZV9zaXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5
MDE1X2lyX3RhYmxlX2FfbGluayk7CisJCQkJYnJlYWs7CisJCQljYXNlIEFGOTAxNV9SRU1PVEVf
TVNJX0RJR0lWT1hfTUlOSV9JSV9WMzoKKwkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5yY19rZXlf
bWFwID0KKwkJCQkgIGFmOTAxNV9yY19rZXlzX21zaTsKKwkJCQlhZjkwMTVfcHJvcGVydGllc1tp
XS5yY19rZXlfbWFwX3NpemUgPQorCQkJCSAgQVJSQVlfU0laRShhZjkwMTVfcmNfa2V5c19tc2kp
OworCQkJCWFmOTAxNV9jb25maWcuaXJfdGFibGUgPSBhZjkwMTVfaXJfdGFibGVfbXNpOworCQkJ
CWFmOTAxNV9jb25maWcuaXJfdGFibGVfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpFKGFmOTAxNV9p
cl90YWJsZV9tc2kpOworCQkJCWJyZWFrOworCQkJY2FzZSBBRjkwMTVfUkVNT1RFX01ZR0lDVFZf
VTcxODoKKwkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5yY19rZXlfbWFwID0KKwkJCQkgIGFmOTAx
NV9yY19rZXlzX215Z2ljdHY7CisJCQkJYWY5MDE1X3Byb3BlcnRpZXNbaV0ucmNfa2V5X21hcF9z
aXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfbXlnaWN0dik7CisJCQkJYWY5
MDE1X2NvbmZpZy5pcl90YWJsZSA9CisJCQkJICBhZjkwMTVfaXJfdGFibGVfbXlnaWN0djsKKwkJ
CQlhZjkwMTVfY29uZmlnLmlyX3RhYmxlX3NpemUgPQorCQkJCSAgQVJSQVlfU0laRShhZjkwMTVf
aXJfdGFibGVfbXlnaWN0dik7CisJCQkJYnJlYWs7CisJCQljYXNlIEFGOTAxNV9SRU1PVEVfRElH
SVRUUkFERV9EVkJfVDoKKwkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5yY19rZXlfbWFwID0KKwkJ
CQkgIGFmOTAxNV9yY19rZXlzX2RpZ2l0dHJhZGU7CisJCQkJYWY5MDE1X3Byb3BlcnRpZXNbaV0u
cmNfa2V5X21hcF9zaXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfZGlnaXR0
cmFkZSk7CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZSA9CisJCQkJICBhZjkwMTVfaXJfdGFi
bGVfZGlnaXR0cmFkZTsKKwkJCQlhZjkwMTVfY29uZmlnLmlyX3RhYmxlX3NpemUgPQorCQkJCSAg
QVJSQVlfU0laRShhZjkwMTVfaXJfdGFibGVfZGlnaXR0cmFkZSk7CisJCQkJYnJlYWs7CisJCQlj
YXNlIEFGOTAxNV9SRU1PVEVfQVZFUk1FRElBX0tTOgorCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ld
LnJjX2tleV9tYXAgPQorCQkJCSAgYWY5MDE1X3JjX2tleXNfYXZlcm1lZGlhOworCQkJCWFmOTAx
NV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXBfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpFKGFmOTAx
NV9yY19rZXlzX2F2ZXJtZWRpYSk7CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZSA9CisJCQkJ
ICBhZjkwMTVfaXJfdGFibGVfYXZlcm1lZGlhX2tzOworCQkJCWFmOTAxNV9jb25maWcuaXJfdGFi
bGVfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpFKGFmOTAxNV9pcl90YWJsZV9hdmVybWVkaWFfa3Mp
OworCQkJCWJyZWFrOworCQkJfQorCQl9IGVsc2UgeworCQkJc3dpdGNoIChsZTE2X3RvX2NwdSh1
ZGV2LT5kZXNjcmlwdG9yLmlkVmVuZG9yKSkgeworCQkJY2FzZSBVU0JfVklEX0xFQURURUs6CisJ
CQkJYWY5MDE1X3Byb3BlcnRpZXNbaV0ucmNfa2V5X21hcCA9CisJCQkJICBhZjkwMTVfcmNfa2V5
c19sZWFkdGVrOworCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXBfc2l6ZSA9CisJ
CQkJICBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX2xlYWR0ZWspOworCQkJCWFmOTAxNV9jb25m
aWcuaXJfdGFibGUgPQorCQkJCSAgYWY5MDE1X2lyX3RhYmxlX2xlYWR0ZWs7CisJCQkJYWY5MDE1
X2NvbmZpZy5pcl90YWJsZV9zaXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxl
X2xlYWR0ZWspOworCQkJCWJyZWFrOworCQkJY2FzZSBVU0JfVklEX1ZJU0lPTlBMVVM6CisJCQkJ
YWY5MDE1X3Byb3BlcnRpZXNbaV0ucmNfa2V5X21hcCA9CisJCQkJICBhZjkwMTVfcmNfa2V5c190
d2luaGFuOworCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXBfc2l6ZSA9CisJCQkJ
ICBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX3R3aW5oYW4pOworCQkJCWFmOTAxNV9jb25maWcu
aXJfdGFibGUgPQorCQkJCSAgYWY5MDE1X2lyX3RhYmxlX3R3aW5oYW47CisJCQkJYWY5MDE1X2Nv
bmZpZy5pcl90YWJsZV9zaXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX3R3
aW5oYW4pOworCQkJCWJyZWFrOworCQkJY2FzZSBVU0JfVklEX0tXT1JMRF8yOgorCQkJCS8qIFRP
RE86IHVzZSBjb3JyZWN0IHJjIGtleXMgKi8KKwkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5yY19r
ZXlfbWFwID0KKwkJCQkgIGFmOTAxNV9yY19rZXlzX3R3aW5oYW47CisJCQkJYWY5MDE1X3Byb3Bl
cnRpZXNbaV0ucmNfa2V5X21hcF9zaXplID0KKwkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tl
eXNfdHdpbmhhbik7CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZSA9IGFmOTAxNV9pcl90YWJs
ZV9rd29ybGQ7CisJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZV9zaXplID0KKwkJCQkgIEFSUkFZ
X1NJWkUoYWY5MDE1X2lyX3RhYmxlX2t3b3JsZCk7CisJCQkJYnJlYWs7CisJCQkvKiBDaGVjayBV
U0IgbWFudWZhY3R1cmVyIGFuZCBwcm9kdWN0IHN0cmluZ3MgYW5kIHRyeQorCQkJICAgdG8gZGV0
ZXJtaW5lIGNvcnJlY3QgcmVtb3RlIGluIGNhc2Ugb2YgY2hpcCB2ZW5kb3IKKwkJCSAgIHJlZmVy
ZW5jZSBJRHMgYXJlIHVzZWQuICovCisJCQljYXNlIFVTQl9WSURfQUZBVEVDSDoKKwkJCQltZW1z
ZXQobWFudWZhY3R1cmVyLCAwLCBzaXplb2YobWFudWZhY3R1cmVyKSk7CisJCQkJdXNiX3N0cmlu
Zyh1ZGV2LCB1ZGV2LT5kZXNjcmlwdG9yLmlNYW51ZmFjdHVyZXIsCisJCQkJCW1hbnVmYWN0dXJl
ciwgc2l6ZW9mKG1hbnVmYWN0dXJlcikpOworCQkJCWlmICghc3RyY21wKCJHZW5pYXRlY2giLCBt
YW51ZmFjdHVyZXIpKSB7CisJCQkJCS8qIGlNYW51ZmFjdHVyZXIgMSBHZW5pYXRlY2gKKwkJCQkJ
ICAgaVByb2R1Y3QgICAgICAyIEFGOTAxNSAqLworCQkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5y
Y19rZXlfbWFwID0KKwkJCQkJICBhZjkwMTVfcmNfa2V5c19teWdpY3R2OworCQkJCQlhZjkwMTVf
cHJvcGVydGllc1tpXS5yY19rZXlfbWFwX3NpemUgPQorCQkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1
X3JjX2tleXNfbXlnaWN0dik7CisJCQkJCWFmOTAxNV9jb25maWcuaXJfdGFibGUgPQorCQkJCQkg
IGFmOTAxNV9pcl90YWJsZV9teWdpY3R2OworCQkJCQlhZjkwMTVfY29uZmlnLmlyX3RhYmxlX3Np
emUgPQorCQkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX215Z2ljdHYpOworCQkJCX0g
ZWxzZSBpZiAoIXN0cmNtcCgiTVNJIiwgbWFudWZhY3R1cmVyKSkgeworCQkJCQkvKiBpTWFudWZh
Y3R1cmVyIDEgTVNJCisJCQkJCSAgIGlQcm9kdWN0ICAgICAgMiBNU0kgSy1WT1ggKi8KKwkJCQkJ
YWY5MDE1X3Byb3BlcnRpZXNbaV0ucmNfa2V5X21hcCA9CisJCQkJCSAgYWY5MDE1X3JjX2tleXNf
bXNpOworCQkJCQlhZjkwMTVfcHJvcGVydGllc1tpXS5yY19rZXlfbWFwX3NpemUgPQorCQkJCQkg
IEFSUkFZX1NJWkUoYWY5MDE1X3JjX2tleXNfbXNpKTsKKwkJCQkJYWY5MDE1X2NvbmZpZy5pcl90
YWJsZSA9CisJCQkJCSAgYWY5MDE1X2lyX3RhYmxlX21zaTsKKwkJCQkJYWY5MDE1X2NvbmZpZy5p
cl90YWJsZV9zaXplID0KKwkJCQkJICBBUlJBWV9TSVpFKGFmOTAxNV9pcl90YWJsZV9tc2kpOwor
CQkJCX0gZWxzZSBpZiAodWRldi0+ZGVzY3JpcHRvci5pZFByb2R1Y3QgPT0KKwkJCQkJY3B1X3Rv
X2xlMTYoVVNCX1BJRF9UUkVLU1RPUl9EVkJUKSkgeworCQkJCQlhZjkwMTVfcHJvcGVydGllc1tp
XS5yY19rZXlfbWFwID0KKwkJCQkJICBhZjkwMTVfcmNfa2V5c190cmVrc3RvcjsKKwkJCQkJYWY5
MDE1X3Byb3BlcnRpZXNbaV0ucmNfa2V5X21hcF9zaXplID0KKwkJCQkJICBBUlJBWV9TSVpFKGFm
OTAxNV9yY19rZXlzX3RyZWtzdG9yKTsKKwkJCQkJYWY5MDE1X2NvbmZpZy5pcl90YWJsZSA9CisJ
CQkJCSAgYWY5MDE1X2lyX3RhYmxlX3RyZWtzdG9yOworCQkJCQlhZjkwMTVfY29uZmlnLmlyX3Rh
YmxlX3NpemUgPQorCQkJCQkgIEFSUkFZX1NJWkUoYWY5MDE1X2lyX3RhYmxlX3RyZWtzdG9yKTsK
KwkJCQl9CisJCQkJYnJlYWs7CisJCQljYXNlIFVTQl9WSURfQVZFUk1FRElBOgorCQkJCWFmOTAx
NV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXAgPQorCQkJCSAgYWY5MDE1X3JjX2tleXNfYXZlcm1l
ZGlhOworCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXBfc2l6ZSA9CisJCQkJICBB
UlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX2F2ZXJtZWRpYSk7CisJCQkJYWY5MDE1X2NvbmZpZy5p
cl90YWJsZSA9CisJCQkJICBhZjkwMTVfaXJfdGFibGVfYXZlcm1lZGlhOworCQkJCWFmOTAxNV9j
b25maWcuaXJfdGFibGVfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpFKGFmOTAxNV9pcl90YWJsZV9h
dmVybWVkaWEpOworCQkJCWJyZWFrOworCQkJY2FzZSBVU0JfVklEX01TSV8yOgorCQkJCWFmOTAx
NV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXAgPQorCQkJCSAgYWY5MDE1X3JjX2tleXNfbXNpX2Rp
Z2l2b3hfaWlpOworCQkJCWFmOTAxNV9wcm9wZXJ0aWVzW2ldLnJjX2tleV9tYXBfc2l6ZSA9CisJ
CQkJICBBUlJBWV9TSVpFKGFmOTAxNV9yY19rZXlzX21zaV9kaWdpdm94X2lpaSk7CisJCQkJYWY5
MDE1X2NvbmZpZy5pcl90YWJsZSA9CisJCQkJICBhZjkwMTVfaXJfdGFibGVfbXNpX2RpZ2l2b3hf
aWlpOworCQkJCWFmOTAxNV9jb25maWcuaXJfdGFibGVfc2l6ZSA9CisJCQkJICBBUlJBWV9TSVpF
KGFmOTAxNV9pcl90YWJsZV9tc2lfZGlnaXZveF9paWkpOworCQkJCWJyZWFrOworCQkJfQorCQl9
CiAJfQogCiAJLyogVFMgbW9kZSAtIG9uZSBvciB0d28gcmVjZWl2ZXJzICovCkBAIC0xMDI2LDYg
Kzk5OCw3IEBACiAJCWNhc2UgQUY5MDEzX1RVTkVSX01UMjA2MF8yOgogCQljYXNlIEFGOTAxM19U
VU5FUl9UREExODI3MToKIAkJY2FzZSBBRjkwMTNfVFVORVJfUVQxMDEwQToKKwkJY2FzZSBBRjkw
MTNfVFVORVJfVERBMTgyMTg6CiAJCQlhZjkwMTVfYWY5MDEzX2NvbmZpZ1tpXS5yZl9zcGVjX2lu
diA9IDE7CiAJCQlicmVhazsKIAkJY2FzZSBBRjkwMTNfVFVORVJfTVhMNTAwM0Q6CkBAIC0xMDM3
LDkgKzEwMTAsNiBAQAogCQkJYWY5MDE1X2FmOTAxM19jb25maWdbaV0uZ3Bpb1sxXSA9IEFGOTAx
M19HUElPX0xPOwogCQkJYWY5MDE1X2FmOTAxM19jb25maWdbaV0ucmZfc3BlY19pbnYgPSAxOwog
CQkJYnJlYWs7Ci0JCWNhc2UgQUY5MDEzX1RVTkVSX1REQTE4MjE4OgotCQkJd2FybigidHVuZXIg
TlhQIFREQTE4MjE4IG5vdCBzdXBwb3J0ZWQgeWV0Iik7Ci0JCQlyZXR1cm4gLUVOT0RFVjsKIAkJ
ZGVmYXVsdDoKIAkJCXdhcm4oInR1bmVyIGlkOiVkIG5vdCBzdXBwb3J0ZWQsIHBsZWFzZSByZXBv
cnQhIiwgdmFsKTsKIAkJCXJldHVybiAtRU5PREVWOwpAQCAtMTE2NCwxMSArMTEzNCwxMSBAQAog
CiAJCWRlYl9pbmZvKCIlczogaW5pdCBJMkNcbiIsIF9fZnVuY19fKTsKIAkJcmV0ID0gYWY5MDE1
X2kyY19pbml0KGFkYXAtPmRldik7Ci0jaWYgTElOVVhfVkVSU0lPTl9DT0RFIDwgS0VSTkVMX1ZF
UlNJT04oMiwgNiwgMjUpCisKKwkJLyogZHVtcCBlZXByb20gKGRlYnVnKSAqLwogCQlyZXQgPSBh
ZjkwMTVfZWVwcm9tX2R1bXAoYWRhcC0+ZGV2KTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7
Ci0jZW5kaWYKIAl9IGVsc2UgewogCQkvKiBzZWxlY3QgSTJDIGFkYXB0ZXIgKi8KIAkJaTJjX2Fk
YXAgPSAmc3RhdGUtPmkyY19hZGFwOwpAQCAtMTI0Nyw2ICsxMjE3LDEwIEBACiAJLmRpZ19vdXQg
PSAxLAogfTsKIAorc3RhdGljIHN0cnVjdCB0ZGExODIxOF9jb25maWcgYWY5MDE1X3RkYTE4MjE4
X2NvbmZpZyA9IHsKKwkuaTJjX2FkZHJlc3MgPSAweGMwLAorfTsKKwogc3RhdGljIGludCBhZjkw
MTVfdHVuZXJfYXR0YWNoKHN0cnVjdCBkdmJfdXNiX2FkYXB0ZXIgKmFkYXApCiB7CiAJc3RydWN0
IGFmOTAxNV9zdGF0ZSAqc3RhdGUgPSBhZGFwLT5kZXYtPnByaXY7CkBAIC0xMjk0LDYgKzEyNjgs
MTAgQEAKIAkJcmV0ID0gZHZiX2F0dGFjaChtYzQ0czgwM19hdHRhY2gsIGFkYXAtPmZlLCBpMmNf
YWRhcCwKIAkJCSZhZjkwMTVfbWM0NHM4MDNfY29uZmlnKSA9PSBOVUxMID8gLUVOT0RFViA6IDA7
CiAJCWJyZWFrOworCWNhc2UgQUY5MDEzX1RVTkVSX1REQTE4MjE4OgorCQlyZXQgPSBkdmJfYXR0
YWNoKHRkYTE4MjE4X2F0dGFjaCwgYWRhcC0+ZmUsIGkyY19hZGFwLAorCQkJJmFmOTAxNV90ZGEx
ODIxOF9jb25maWcpID09IE5VTEwgPyAtRU5PREVWIDogMDsKKwkJYnJlYWs7CiAJY2FzZSBBRjkw
MTNfVFVORVJfVU5LTk9XTjoKIAlkZWZhdWx0OgogCQlyZXQgPSAtRU5PREVWOwpAQCAtMTMzNCw4
ICsxMzEyLDcgQEAKIC8qIDI1ICove1VTQl9ERVZJQ0UoVVNCX1ZJRF9LV09STERfMiwgIFVTQl9Q
SURfS1dPUkxEXzM5OVVfMil9LAogCXtVU0JfREVWSUNFKFVTQl9WSURfS1dPUkxEXzIsICBVU0Jf
UElEX0tXT1JMRF9QQzE2MF9UKX0sCiAJe1VTQl9ERVZJQ0UoVVNCX1ZJRF9LV09STERfMiwgIFVT
Ql9QSURfU1ZFT05fU1RWMjApfSwKLQl7VVNCX0RFVklDRShVU0JfVklEX0tXT1JMRF8yLCAgVVNC
X1BJRF9USU5ZVFdJTl8yKX0sCi0Je1VTQl9ERVZJQ0UoVVNCX1ZJRF9MRUFEVEVLLCAgIFVTQl9Q
SURfV0lORkFTVF9EVFYyMDAwRFMpfSwKKwl7VVNCX0RFVklDRShVU0JfVklEX1RFUlJBVEVDLCBV
U0JfUElEX1RFUlJBVEVDX0NJTkVSR1lfVF9TVElDS19SQyl9LAogCXswfSwKIH07CiBNT0RVTEVf
REVWSUNFX1RBQkxFKHVzYiwgYWY5MDE1X3VzYl90YWJsZSk7CkBAIC0xNDIyLDggKzEzOTksNyBA
QAogCQkJfSwKIAkJCXsKIAkJCQkubmFtZSA9ICJEaWdpdGFsTm93IFRpbnlUd2luIERWQi1UIFJl
Y2VpdmVyIiwKLQkJCQkuY29sZF9pZHMgPSB7JmFmOTAxNV91c2JfdGFibGVbNV0sCi0JCQkJCSAg
ICAgJmFmOTAxNV91c2JfdGFibGVbMjhdLCBOVUxMfSwKKwkJCQkuY29sZF9pZHMgPSB7JmFmOTAx
NV91c2JfdGFibGVbNV0sIE5VTEx9LAogCQkJCS53YXJtX2lkcyA9IHtOVUxMfSwKIAkJCX0sCiAJ
CQl7CkBAIC0xNjQzLDggKzE2MTksOCBAQAogCQkJCS53YXJtX2lkcyA9IHtOVUxMfSwKIAkJCX0s
CiAJCQl7Ci0JCQkJLm5hbWUgPSAiTGVhZHRlayBXaW5GYXN0IERUVjIwMDBEUyIsCi0JCQkJLmNv
bGRfaWRzID0geyZhZjkwMTVfdXNiX3RhYmxlWzI5XSwgTlVMTH0sCisJCQkJLm5hbWUgPSAiVGVy
cmFUZWMgQ2luZXJneSBUIFN0aWNrIFJDIiwKKwkJCQkuY29sZF9pZHMgPSB7JmFmOTAxNV91c2Jf
dGFibGVbMjhdLCBOVUxMfSwKIAkJCQkud2FybV9pZHMgPSB7TlVMTH0sCiAJCQl9LAogCQl9CmRp
ZmYgLXIgMGY0MWZkN2RmODVkIGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2R2Yi11c2IvZHZiLXVz
Yi1pZHMuaAotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9kdmItdXNiL2R2Yi11c2ItaWRz
LmgJVGh1IEZlYiAxMSAwMjozMzoxMiAyMDEwICswMjAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVk
aWEvZHZiL2R2Yi11c2IvZHZiLXVzYi1pZHMuaAlUaHUgRmViIDI1IDE3OjIxOjExIDIwMTAgKzAx
MDAKQEAgLTEyOSw2ICsxMjksNyBAQAogI2RlZmluZSBVU0JfUElEX0tXT1JMRF9WU1RSRUFNX1dB
Uk0JCQkweDE3ZGYKICNkZWZpbmUgVVNCX1BJRF9URVJSQVRFQ19DSU5FUkdZX1RfVVNCX1hFCQkw
eDAwNTUKICNkZWZpbmUgVVNCX1BJRF9URVJSQVRFQ19DSU5FUkdZX1RfVVNCX1hFX1JFVjIJCTB4
MDA2OQorI2RlZmluZSBVU0JfUElEX1RFUlJBVEVDX0NJTkVSR1lfVF9TVElDS19SQyAgICAgICAg
MHgwMDk3CiAjZGVmaW5lIFVTQl9QSURfVFdJTkhBTl9WUDcwNDFfQ09MRAkJCTB4MzIwMQogI2Rl
ZmluZSBVU0JfUElEX1RXSU5IQU5fVlA3MDQxX1dBUk0JCQkweDMyMDIKICNkZWZpbmUgVVNCX1BJ
RF9UV0lOSEFOX1ZQNzAyMF9DT0xECQkJMHgzMjAzCmRpZmYgLXIgMGY0MWZkN2RmODVkIGxpbnV4
L2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9hZjkwMTMuYwotLS0gYS9saW51eC9kcml2ZXJz
L21lZGlhL2R2Yi9mcm9udGVuZHMvYWY5MDEzLmMJVGh1IEZlYiAxMSAwMjozMzoxMiAyMDEwICsw
MjAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9hZjkwMTMuYwlUaHUg
RmViIDI1IDE3OjIxOjExIDIwMTAgKzAxMDAKQEAgLTQ4OCw2ICs0ODgsMjAgQEAKIAkJCQlicmVh
azsKIAkJCX0KIAkJfQorCQllbHNlIGlmKHN0YXRlLT5jb25maWcudHVuZXIgPT0gQUY5MDEzX1RV
TkVSX1REQTE4MjE4KSB7CisJCQlzd2l0Y2ggKGJ3KSB7CisJCQljYXNlIEJBTkRXSURUSF82X01I
WjoKKwkJCQlpZl9zYW1wbGVfZnJlcSA9IDMwMDAwMDA7IC8qIDMgTUh6ICovCisJCQkJYnJlYWs7
CisJCQljYXNlIEJBTkRXSURUSF83X01IWjoKKwkJCQlpZl9zYW1wbGVfZnJlcSA9IDM1MDAwMDA7
IC8qIDMuNSBNSHogKi8KKwkJCQlicmVhazsKKwkJCWNhc2UgQkFORFdJRFRIXzhfTUhaOgorCQkJ
ZGVmYXVsdDoKKwkJCQlpZl9zYW1wbGVfZnJlcSA9IDQwMDAwMDA7IC8qIDQgTUh6ICovCisJCQkJ
YnJlYWs7CisJCQl9CisJCX0KIAogCQl3aGlsZSAoaWZfc2FtcGxlX2ZyZXEgPiAoYWRjX2ZyZXEg
LyAyKSkKIAkJCWlmX3NhbXBsZV9mcmVxID0gaWZfc2FtcGxlX2ZyZXEgLSBhZGNfZnJlcTsKQEAg
LTEzOTAsNiArMTQwNCw3IEBACiAJCWluaXQgPSB0dW5lcl9pbml0X210MjA2MF8yOwogCQlicmVh
azsKIAljYXNlIEFGOTAxM19UVU5FUl9UREExODI3MToKKwljYXNlIEFGOTAxM19UVU5FUl9UREEx
ODIxODoKIAkJbGVuID0gQVJSQVlfU0laRSh0dW5lcl9pbml0X3RkYTE4MjcxKTsKIAkJaW5pdCA9
IHR1bmVyX2luaXRfdGRhMTgyNzE7CiAJCWJyZWFrOwpkaWZmIC1yIDBmNDFmZDdkZjg1ZCBsaW51
eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvYWY5MDEzLmgKLS0tIGEvbGludXgvZHJpdmVy
cy9tZWRpYS9kdmIvZnJvbnRlbmRzL2FmOTAxMy5oCVRodSBGZWIgMTEgMDI6MzM6MTIgMjAxMCAr
MDIwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvYWY5MDEzLmgJVGh1
IEZlYiAyNSAxNzoyMToxMSAyMDEwICswMTAwCkBAIC00NCw3ICs0NCw3IEBACiAJQUY5MDEzX1RV
TkVSX01UMjA2MF8yICAgPSAxNDcsIC8qIE1pY3JvdHVuZSAqLwogCUFGOTAxM19UVU5FUl9UREEx
ODI3MSAgID0gMTU2LCAvKiBOWFAgKi8KIAlBRjkwMTNfVFVORVJfUVQxMDEwQSAgICA9IDE2Miwg
LyogUXVhbnRlayAqLwotCUFGOTAxM19UVU5FUl9UREExODIxOCAgID0gMTc5LCAvKiBOWFAgKi8K
KwlBRjkwMTNfVFVORVJfVERBMTgyMTggICAgPSAxNzksIC8qIE5YUCAqLwogfTsKIAogLyogQUY5
MDEzLzUgR1BJT3MgKG1vc3RseSBndWVzc2VkKQpkaWZmIC1yIDBmNDFmZDdkZjg1ZCBsaW51eC9k
cml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvYWY5MDEzX3ByaXYuaAotLS0gYS9saW51eC9kcml2
ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvYWY5MDEzX3ByaXYuaAlUaHUgRmViIDExIDAyOjMzOjEy
IDIwMTAgKzAyMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2FmOTAx
M19wcml2LmgJVGh1IEZlYiAyNSAxNzoyMToxMSAyMDEwICswMTAwCkBAIC03ODksOCArNzg5LDkg
QEAKIAl7IDB4OWJkOSwgMCwgOCwgMHgwOCB9LAogfTsKIAotLyogTlhQIFREQTE4MjcxIHR1bmVy
IGluaXQKLSAgIEFGOTAxM19UVU5FUl9UREExODI3MSAgID0gMTU2ICovCisvKiBOWFAgVERBMTgy
NzEgJiBUREExODIxOCB0dW5lciBpbml0CisgICBBRjkwMTNfVFVORVJfVERBMTgyNzEgICA9IDE1
NgorICAgQUY5MDEzX1RVTkVSX1REQTE4MjE4ICAgPSAxNzkgKi8KIHN0YXRpYyBzdHJ1Y3QgcmVn
ZGVzYyB0dW5lcl9pbml0X3RkYTE4MjcxW10gPSB7CiAJeyAweDliZDUsIDAsIDgsIDB4MDEgfSwK
IAl7IDB4OWJkNiwgMCwgOCwgMHgwNCB9LAo=
--001636c5a67eea57b9048088e024--
