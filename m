Return-path: <video4linux-list-bounces@redhat.com>
Received: from mx3.redhat.com (mx3.redhat.com [172.16.48.32])
	by int-mx2.corp.redhat.com (8.13.1/8.13.1) with ESMTP id m8AHketR018314
	for <video4linux-list@redhat.com>; Wed, 10 Sep 2008 13:46:41 -0400
Received: from rn-out-0910.google.com (rn-out-0910.google.com [64.233.170.189])
	by mx3.redhat.com (8.13.8/8.13.8) with ESMTP id m8AHk3ps027333
	for <video4linux-list@redhat.com>; Wed, 10 Sep 2008 13:46:08 -0400
Received: by rn-out-0910.google.com with SMTP id k32so1128074rnd.7
	for <video4linux-list@redhat.com>; Wed, 10 Sep 2008 10:46:02 -0700 (PDT)
Message-ID: <3192d3cd0809101046t62b3cb48w2c1d2af4b471b6b0@mail.gmail.com>
Date: Wed, 10 Sep 2008 17:46:02 +0000
From: "Christian Gmeiner" <christian.gmeiner@gmail.com>
To: "Linux and Kernel Video" <video4linux-list@redhat.com>
In-Reply-To: <3192d3cd0809100508v7da001d1oacd8fe076be5db5@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_Part_113134_22056253.1221068762385"
References: <3192d3cd0809100508v7da001d1oacd8fe076be5db5@mail.gmail.com>
Subject: Re: Extending current adv717x drivers
List-Unsubscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=unsubscribe>
List-Archive: <https://www.redhat.com/mailman/private/video4linux-list>
List-Post: <mailto:video4linux-list@redhat.com>
List-Help: <mailto:video4linux-list-request@redhat.com?subject=help>
List-Subscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=subscribe>
Sender: video4linux-list-bounces@redhat.com
Errors-To: video4linux-list-bounces@redhat.com
List-ID: <video4linux-list@redhat.com>

------=_Part_113134_22056253.1221068762385
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

So...

I have stared to convert the adv7175 driver to v4l2 but I am not sure
if its okay. Also there exist
a driver which must be changed to the new api.

So please give me feedback....


2008/9/10 Christian Gmeiner <christian.gmeiner@gmail.com>:
> Hi all,
>
> I am one of the supporters of the dxr3 drivers for Linux [0]. The big
> goal is it to get the driver ready
> for the mainline kernel. As this needs lot of work to be done, I will
> start with one of the top items
> of my todo list. Extending current adv717x drivers with new functionality.
>
> As you can see here [1] and [2] the adv717x driver offers some more
> functions, which are needed
> for the dxr3 driver - e.g. switching pixel port between 8-bit
> multiplexed YCrCb and 16 bit YCrCb.
>
> The current drivers used v4l1 include and so I had a look at the v4l2
> api but I am not sure how such
> a driver can be switched to v4l2. If this is not the case, whats the
> best way to "merge" dxr3s driver
> with the in-kernel driver?
>
> [0] http://dxr3.sf.net
> [1] http://dxr3.sourceforge.net/hg/em8300-nboullis/file/37328a436d49/modules/adv717x.c
> [2] http://dxr3.sourceforge.net/hg/em8300-nboullis/file/37328a436d49/modules/adv717x.h
>
>
> Thanks for your help,
> --
> BSc, Christian Gmeiner
>



-- 
Christian Gmeiner, B.Sc.

------=_Part_113134_22056253.1221068762385
Content-Type: application/octet-stream; name=adv717x_v4l2.patch
Content-Transfer-Encoding: base64
X-Attachment-Id: f_fkycyq070
Content-Disposition: attachment; filename=adv717x_v4l2.patch

ZGlmZiAtciBmZjA1MjAxMGM0Y2IgbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9LY29uZmlnCi0t
LSBhL2xpbnV4L2RyaXZlcnMvbWVkaWEvdmlkZW8vS2NvbmZpZwlTdW4gU2VwIDA3IDE0OjQ2OjQ0
IDIwMDggKzAyMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9LY29uZmlnCVdlZCBT
ZXAgMTAgMTk6Mzg6MTcgMjAwOCArMDAwMApAQCAtNDE5LDcgKzQxOSw3IEBACiAKIGNvbmZpZyBW
SURFT19BRFY3MTc1CiAJdHJpc3RhdGUgIkFuYWxvZyBEZXZpY2VzIEFEVjcxNzUgdmlkZW8gZW5j
b2RlciIKLQlkZXBlbmRzIG9uIFZJREVPX1Y0TDEgJiYgSTJDCisJZGVwZW5kcyBvbiBWSURFT19W
NEwyICYmIEkyQwogCS0tLWhlbHAtLS0KIAkgIFN1cHBvcnQgZm9yIHRoZSBBbmFsb2cgRGV2aWNl
cyBBRFY3MTc1IHZpZGVvIGVuY29kZXIgZHJpdmVyCiAKZGlmZiAtciBmZjA1MjAxMGM0Y2IgbGlu
dXgvZHJpdmVycy9tZWRpYS92aWRlby9hZHY3MTc1LmMKLS0tIGEvbGludXgvZHJpdmVycy9tZWRp
YS92aWRlby9hZHY3MTc1LmMJU3VuIFNlcCAwNyAxNDo0Njo0NCAyMDA4ICswMjAwCisrKyBiL2xp
bnV4L2RyaXZlcnMvbWVkaWEvdmlkZW8vYWR2NzE3NS5jCVdlZCBTZXAgMTAgMTk6Mzg6MTcgMjAw
OCArMDAwMApAQCAtMjQsMjYgKzI0LDggQEAKICAqIEZvdW5kYXRpb24sIEluYy4sIDY3NSBNYXNz
IEF2ZSwgQ2FtYnJpZGdlLCBNQSAwMjEzOSwgVVNBLgogICovCiAKLSNpbmNsdWRlIDxsaW51eC9t
b2R1bGUuaD4KLSNpbmNsdWRlIDxsaW51eC9pbml0Lmg+Ci0jaW5jbHVkZSA8bGludXgvZGVsYXku
aD4KLSNpbmNsdWRlIDxsaW51eC9lcnJuby5oPgotI2luY2x1ZGUgPGxpbnV4L2ZzLmg+Ci0jaW5j
bHVkZSA8bGludXgva2VybmVsLmg+Ci0jaW5jbHVkZSA8bGludXgvbWFqb3IuaD4KLSNpbmNsdWRl
IDxsaW51eC9zbGFiLmg+Ci0jaW5jbHVkZSA8bGludXgvbW0uaD4KLSNpbmNsdWRlIDxsaW51eC9z
aWduYWwuaD4KLSNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgogI2luY2x1ZGUgPGxpbnV4L2kyYy5o
PgotI2luY2x1ZGUgPGFzbS9pby5oPgotI2luY2x1ZGUgPGFzbS9wZ3RhYmxlLmg+Ci0jaW5jbHVk
ZSA8YXNtL3BhZ2UuaD4KLSNpbmNsdWRlIDxhc20vdWFjY2Vzcy5oPgotCi0jaW5jbHVkZSA8bGlu
dXgvdmlkZW9kZXYuaD4KLSNpbmNsdWRlIDxsaW51eC92aWRlb19lbmNvZGVyLmg+Ci0jaW5jbHVk
ZSAiY29tcGF0LmgiCisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jb21tb24uaD4KIAogTU9EVUxFX0RF
U0NSSVBUSU9OKCJBbmFsb2cgRGV2aWNlcyBBRFY3MTc1IHZpZGVvIGVuY29kZXIgZHJpdmVyIik7
CiBNT0RVTEVfQVVUSE9SKCJEYXZlIFBlcmtzIik7CkBAIC01NywyMiArMzksMTIgQEAKIG1vZHVs
ZV9wYXJhbShkZWJ1ZywgaW50LCAwKTsKIE1PRFVMRV9QQVJNX0RFU0MoZGVidWcsICJEZWJ1ZyBs
ZXZlbCAoMC0xKSIpOwogCi0jZGVmaW5lIGRwcmludGsobnVtLCBmb3JtYXQsIGFyZ3MuLi4pIFwK
LQlkbyB7IFwKLQkJaWYgKGRlYnVnID49IG51bSkgXAotCQkJcHJpbnRrKGZvcm1hdCwgIyNhcmdz
KTsgXAotCX0gd2hpbGUgKDApCi0KIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiAKIHN0cnVjdCBhZHY3
MTc1IHsKLQlpbnQgbm9ybTsKKwl2NGwyX3N0ZF9pZCBub3JtOwogCWludCBpbnB1dDsKIAlpbnQg
ZW5hYmxlOwotCWludCBicmlnaHQ7Ci0JaW50IGNvbnRyYXN0OwotCWludCBodWU7Ci0JaW50IHNh
dDsKIH07CiAKICNkZWZpbmUgICBJMkNfQURWNzE3NSAgICAgICAgMHhkNApAQCAtODEsMzAgKzUz
LDIwIEBACiBzdGF0aWMgY2hhciBhZHY3MTc1X25hbWVbXSA9ICJhZHY3MTc1IjsKIHN0YXRpYyBj
aGFyIGFkdjcxNzZfbmFtZVtdID0gImFkdjcxNzYiOwogCi1zdGF0aWMgY2hhciAqaW5wdXRzW10g
PSB7ICJwYXNzX3Rocm91Z2giLCAicGxheV9iYWNrIiwgImNvbG9yX2JhciIgfTsKLXN0YXRpYyBj
aGFyICpub3Jtc1tdID0geyAiUEFMIiwgIk5UU0MiLCAiU0VDQU0tPlBBTCAobWF5IG5vdCB3b3Jr
ISkiIH07Ci0KIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiAKLXN0YXRpYyBpbmxpbmUgaW50Ci1hZHY3
MTc1X3dyaXRlIChzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LAotCSAgICAgICB1OCAgICAgICAg
ICAgICAgICAgcmVnLAotCSAgICAgICB1OCAgICAgICAgICAgICAgICAgdmFsdWUpCitzdGF0aWMg
aW5saW5lIGludCBhZHY3MTc1X3dyaXRlKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQsIHU4IHJl
ZywgdTggdmFsdWUpCiB7CiAJcmV0dXJuIGkyY19zbWJ1c193cml0ZV9ieXRlX2RhdGEoY2xpZW50
LCByZWcsIHZhbHVlKTsKIH0KIAotc3RhdGljIGlubGluZSBpbnQKLWFkdjcxNzVfcmVhZCAoc3Ry
dWN0IGkyY19jbGllbnQgKmNsaWVudCwKLQkgICAgICB1OCAgICAgICAgICAgICAgICAgcmVnKQor
c3RhdGljIGlubGluZSBpbnQgYWR2NzE3NV9yZWFkKHN0cnVjdCBpMmNfY2xpZW50ICpjbGllbnQs
IHU4IHJlZykKIHsKIAlyZXR1cm4gaTJjX3NtYnVzX3JlYWRfYnl0ZV9kYXRhKGNsaWVudCwgcmVn
KTsKIH0KIAotc3RhdGljIGludAotYWR2NzE3NV93cml0ZV9ibG9jayAoc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCwKLQkJICAgICBjb25zdCB1OCAgICAgICAgICAqZGF0YSwKLQkJICAgICB1bnNp
Z25lZCBpbnQgICAgICAgbGVuKQorc3RhdGljIGludCBhZHY3MTc1X3dyaXRlX2Jsb2NrKHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsIGNvbnN0IHU4ICpkYXRhLAorCQkJCQkJdW5zaWduZWQgaW50
IGxlbikKIHsKIAlpbnQgcmV0ID0gLTE7CiAJdTggcmVnOwpAQCAtMTQ0LDkgKzEwNiw3IEBACiAJ
cmV0dXJuIHJldDsKIH0KIAotc3RhdGljIHZvaWQKLXNldF9zdWJjYXJyaWVyX2ZyZXEgKHN0cnVj
dCBpMmNfY2xpZW50ICpjbGllbnQsCi0JCSAgICAgaW50ICAgICAgICAgICAgICAgIHBhc3NfdGhy
b3VnaCkKK3N0YXRpYyB2b2lkIHNldF9zdWJjYXJyaWVyX2ZyZXEgKHN0cnVjdCBpMmNfY2xpZW50
ICpjbGllbnQsIGludCBwYXNzX3Rocm91Z2gpCiB7CiAJLyogZm9yIHNvbWUgcmVhc29uIHBhc3Nf
dGhyb3VnaCBOVFNDIG5lZWRzCiAJICogYSBkaWZmZXJlbnQgc3ViLWNhcnJpZXIgZnJlcSB0byBy
ZW1haW4gc3RhYmxlLiAqLwpAQCAtMjE3LDE1ICsxNzcsMTExIEBACiAJMHgwNiwgMHgxYSwJCS8q
IHN1YmMuIHBoYXNlICovCiB9OwogCitzdGF0aWMgaW50IGFkdjcxNzVfc2V0X3N0ZChzdHJ1Y3Qg
aTJjX2NsaWVudCAqY2xpZW50LCB2NGwyX3N0ZF9pZCBzdGQpCit7CisJc3RydWN0IGFkdjcxNzUg
KmVuY29kZXIgPSBpMmNfZ2V0X2NsaWVudGRhdGEoY2xpZW50KTsKKworCWlmIChzdGQgJiBWNEwy
X1NURF9QQUwpIHsKKworCQkgIGFkdjcxNzVfd3JpdGVfYmxvY2soY2xpZW50LCBpbml0X3BhbCwg
c2l6ZW9mKGluaXRfcGFsKSk7CisJCSAgaWYgKGVuY29kZXItPmlucHV0ID09IDApCisJCQkgIGFk
djcxNzVfd3JpdGUoY2xpZW50LCAweDBkLCAweDRmKTsJLy8gRW5hYmxlIGdlbmxvY2sKKwkJICBh
ZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSB8IFRSMFJTVCk7CisJCSAgYWR2NzE3
NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUpOworCisJfSBlbHNlIGlmIChzdGQgJiBWNEwy
X1NURF9OVFNDKSB7CisKKwkJICBhZHY3MTc1X3dyaXRlX2Jsb2NrKGNsaWVudCwgaW5pdF9udHNj
LCBzaXplb2YoaW5pdF9udHNjKSk7CisJCSAgaWYgKGVuY29kZXItPmlucHV0ID09IDApCisJCQkg
IGFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDBkLCAweDRmKTsJLy8gRW5hYmxlIGdlbmxvY2sKKwkJ
ICBhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSB8IFRSMFJTVCk7CisJCSAgYWR2
NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUpOworCisJfSBlbHNlIGlmIChzdGQgJiBW
NEwyX1NURF9TRUNBTSkgeworCisJCSAgLyogV0FSTklORyEgQURWNzE3NiBkb2VzIG5vdCBzdXBw
b3J0IFNFQ0FNLiAqLworCQkgIC8qIFRoaXMgaXMgYW4gYXR0ZW1wdCB0byBjb252ZXJ0CisJCQkq
IFNFQ0FNLT5QQUwgKHR5cGljYWxseSBpdCBkb2VzIG5vdCB3b3JrCisJCQkqIGR1ZSB0byBnZW5s
b2NrOiB3aGVuIGRlY29kZXIgaXMgaW4gU0VDQU0KKwkJCSogYW5kIGVuY29kZXIgaW4gaW4gUEFM
IHRoZSBzdWJjYXJyaWVyIGNhbgorCQkJKiBub3QgYmUgc3luY3Jvbml6ZWQgd2l0aCBob3Jpem9u
dGFsCisJCQkqIHF1ZW5jeSkgKi8KKwkJICBhZHY3MTc1X3dyaXRlX2Jsb2NrKGNsaWVudCwgaW5p
dF9wYWwsIHNpemVvZihpbml0X3BhbCkpOworCQkgIGlmIChlbmNvZGVyLT5pbnB1dCA9PSAwKQor
CQkJICBhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwZCwgMHg0OSk7CS8vIERpc2FibGUgZ2VubG9j
aworCQkgIGFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDA3LCBUUjBNT0RFIHwgVFIwUlNUKTsKKwkJ
ICBhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSk7CisJfSBlbHNlIHsKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJZW5jb2Rlci0+bm9ybSA9IHN0ZDsKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBhZHY3MTc1X3NldF9pbnB1dChzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50
LCBpbnQgdmFsKQoreworCXN0cnVjdCBhZHY3MTc1ICplbmNvZGVyID0gaTJjX2dldF9jbGllbnRk
YXRhKGNsaWVudCk7CisKKwkgIHN3aXRjaCAodmFsKSB7CisKKwkgIGNhc2UgMDoKKwkJICBhZHY3
MTc1X3dyaXRlKGNsaWVudCwgMHgwMSwgMHgwMCk7CisKKwkJICBpZiAoZW5jb2Rlci0+bm9ybSA9
PSBWNEwyX1NURF9OVFNDKQorCQkJICBzZXRfc3ViY2Fycmllcl9mcmVxKGNsaWVudCwgMSk7CisK
KwkJICBhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwYywgVFIxQ0FQVCk7CS8qIFRSMSAqLworCQkg
IGlmIChlbmNvZGVyLT5ub3JtID09IFY0TDJfU1REX1NFQ0FNKQorCQkJICBhZHY3MTc1X3dyaXRl
KGNsaWVudCwgMHgwZCwgMHg0OSk7CS8vIERpc2FibGUgZ2VubG9jaworCQkgIGVsc2UKKwkJCSAg
YWR2NzE3NV93cml0ZShjbGllbnQsIDB4MGQsIDB4NGYpOwkvLyBFbmFibGUgZ2VubG9jaworCQkg
IGFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDA3LCBUUjBNT0RFIHwgVFIwUlNUKTsKKwkJICBhZHY3
MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSk7CisJCSAgLy91ZGVsYXkoMTApOworCQkg
IGJyZWFrOworCisJICBjYXNlIDE6CisJCSAgYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDEsIDB4
MDApOworCisJCSAgaWYgKGVuY29kZXItPm5vcm0gPT0gVjRMMl9TVERfTlRTQykKKwkJCSAgc2V0
X3N1YmNhcnJpZXJfZnJlcShjbGllbnQsIDApOworCisJCSAgYWR2NzE3NV93cml0ZShjbGllbnQs
IDB4MGMsIFRSMVBMQVkpOwkvKiBUUjEgKi8KKwkJICBhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgw
ZCwgMHg0OSk7CisJCSAgYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUgfCBUUjBS
U1QpOworCQkgIGFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDA3LCBUUjBNT0RFKTsKKwkJICAvL3Vk
ZWxheSgxMCk7CisJCSAgYnJlYWs7CisKKwkgIGNhc2UgMjoKKwkJICBhZHY3MTc1X3dyaXRlKGNs
aWVudCwgMHgwMSwgMHg4MCk7CisKKwkJICBpZiAoZW5jb2Rlci0+bm9ybSA9PSBWNEwyX1NURF9O
VFNDKQorCQkJICBzZXRfc3ViY2Fycmllcl9mcmVxKGNsaWVudCwgMCk7CisKKwkJICBhZHY3MTc1
X3dyaXRlKGNsaWVudCwgMHgwZCwgMHg0OSk7CisJCSAgYWR2NzE3NV93cml0ZShjbGllbnQsIDB4
MDcsIFRSME1PREUgfCBUUjBSU1QpOworCQkgIGFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDA3LCBU
UjBNT0RFKTsKKwkJICAvL3VkZWxheSgxMCk7CisJCSAgYnJlYWs7CisKKwlkZWZhdWx0OgorCQly
ZXR1cm4gLUVJTlZBTDsKKwkJYnJlYWs7CisJfQorCisJZW5jb2Rlci0+aW5wdXQgPSB2YWw7CisJ
cmV0dXJuIDA7Cit9CisKIHN0YXRpYyBpbnQKLWFkdjcxNzVfY29tbWFuZCAoc3RydWN0IGkyY19j
bGllbnQgKmNsaWVudCwKLQkJIHVuc2lnbmVkIGludCAgICAgICBjbWQsCi0JCSB2b2lkICAgICAg
ICAgICAgICAqYXJnKQorYWR2NzE3NV9jb21tYW5kIChzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50
LCB1bnNpZ25lZCBpbnQgY21kLCB2b2lkICphcmcpCiB7CiAJc3RydWN0IGFkdjcxNzUgKmVuY29k
ZXIgPSBpMmNfZ2V0X2NsaWVudGRhdGEoY2xpZW50KTsKIAogCXN3aXRjaCAoY21kKSB7Ci0KKyNp
ZiAwCiAJY2FzZSAwOgogCQkvKiBUaGlzIGlzIGp1c3QgZm9yIHRlc3RpbmchISEgKi8KIAkJYWR2
NzE3NV93cml0ZV9ibG9jayhjbGllbnQsIGluaXRfY29tbW9uLApAQCAtMjMzLDE0MyArMjg5LDI2
IEBACiAJCWFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDA3LCBUUjBNT0RFIHwgVFIwUlNUKTsKIAkJ
YWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUpOwogCQlicmVhazsKLQotCWNhc2Ug
RU5DT0RFUl9HRVRfQ0FQQUJJTElUSUVTOgotCXsKLQkJc3RydWN0IHZpZGVvX2VuY29kZXJfY2Fw
YWJpbGl0eSAqY2FwID0gYXJnOwotCi0JCWNhcC0+ZmxhZ3MgPSBWSURFT19FTkNPREVSX1BBTCB8
Ci0JCQkgICAgIFZJREVPX0VOQ09ERVJfTlRTQyB8Ci0JCQkgICAgIFZJREVPX0VOQ09ERVJfU0VD
QU07IC8qIHdlbGwsIGhhY2t5ICovCi0JCWNhcC0+aW5wdXRzID0gMjsKLQkJY2FwLT5vdXRwdXRz
ID0gMTsKLQl9CisjZW5kaWYKKwljYXNlIFZJRElPQ19TX1NURDoKKwkJaWYgKGVuY29kZXItPm5v
cm0gIT0gKih2NGwyX3N0ZF9pZCAqKWFyZykKKwkJCXJldHVybiBhZHY3MTc1X3NldF9zdGQoY2xp
ZW50LCAqKHY0bDJfc3RkX2lkICopYXJnKTsKIAkJYnJlYWs7CiAKLQljYXNlIEVOQ09ERVJfU0VU
X05PUk06Ci0JewotCQlpbnQgaWFyZyA9ICooaW50ICopIGFyZzsKLQotCQlzd2l0Y2ggKGlhcmcp
IHsKLQotCQljYXNlIFZJREVPX01PREVfTlRTQzoKLQkJCWFkdjcxNzVfd3JpdGVfYmxvY2soY2xp
ZW50LCBpbml0X250c2MsCi0JCQkJCSAgICBzaXplb2YoaW5pdF9udHNjKSk7Ci0JCQlpZiAoZW5j
b2Rlci0+aW5wdXQgPT0gMCkKLQkJCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwZCwgMHg0Zik7
CS8vIEVuYWJsZSBnZW5sb2NrCi0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9E
RSB8IFRSMFJTVCk7Ci0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSk7Ci0J
CQlicmVhazsKLQotCQljYXNlIFZJREVPX01PREVfUEFMOgotCQkJYWR2NzE3NV93cml0ZV9ibG9j
ayhjbGllbnQsIGluaXRfcGFsLAotCQkJCQkgICAgc2l6ZW9mKGluaXRfcGFsKSk7Ci0JCQlpZiAo
ZW5jb2Rlci0+aW5wdXQgPT0gMCkKLQkJCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwZCwgMHg0
Zik7CS8vIEVuYWJsZSBnZW5sb2NrCi0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIw
TU9ERSB8IFRSMFJTVCk7Ci0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSk7
Ci0JCQlicmVhazsKLQotCQljYXNlIFZJREVPX01PREVfU0VDQU06CS8vIFdBUk5JTkchIEFEVjcx
NzYgZG9lcyBub3Qgc3VwcG9ydCBTRUNBTS4KLQkJCS8qIFRoaXMgaXMgYW4gYXR0ZW1wdCB0byBj
b252ZXJ0Ci0JCQkgKiBTRUNBTS0+UEFMICh0eXBpY2FsbHkgaXQgZG9lcyBub3Qgd29yawotCQkJ
ICogZHVlIHRvIGdlbmxvY2s6IHdoZW4gZGVjb2RlciBpcyBpbiBTRUNBTQotCQkJICogYW5kIGVu
Y29kZXIgaW4gaW4gUEFMIHRoZSBzdWJjYXJyaWVyIGNhbgotCQkJICogbm90IGJlIHN5bmNyb25p
emVkIHdpdGggaG9yaXpvbnRhbAotCQkJICogcXVlbmN5KSAqLwotCQkJYWR2NzE3NV93cml0ZV9i
bG9jayhjbGllbnQsIGluaXRfcGFsLAotCQkJCQkgICAgc2l6ZW9mKGluaXRfcGFsKSk7Ci0JCQlp
ZiAoZW5jb2Rlci0+aW5wdXQgPT0gMCkKLQkJCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwZCwg
MHg0OSk7CS8vIERpc2FibGUgZ2VubG9jawotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcs
IFRSME1PREUgfCBUUjBSU1QpOwotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1P
REUpOwotCQkJYnJlYWs7Ci0JCWRlZmF1bHQ6Ci0JCQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczog
aWxsZWdhbCBub3JtOiAlZFxuIiwKLQkJCQlJMkNfTkFNRShjbGllbnQpLCBpYXJnKTsKLQkJCXJl
dHVybiAtRUlOVkFMOwotCi0JCX0KLQkJZHByaW50aygxLCBLRVJOX0lORk8gIiVzOiBzd2l0Y2hl
ZCB0byAlc1xuIiwgSTJDX05BTUUoY2xpZW50KSwKLQkJCW5vcm1zW2lhcmddKTsKLQkJZW5jb2Rl
ci0+bm9ybSA9IGlhcmc7Ci0JfQorCWNhc2UgVklESU9DX0dfU1REOgorCQkqKHY0bDJfc3RkX2lk
ICopYXJnID0gZW5jb2Rlci0+bm9ybTsKIAkJYnJlYWs7CiAKLQljYXNlIEVOQ09ERVJfU0VUX0lO
UFVUOgotCXsKLQkJaW50IGlhcmcgPSAqKGludCAqKSBhcmc7Ci0KLQkJLyogUko6ICppYXJnID0g
MDogaW5wdXQgaXMgZnJvbSBTQUE3MTEwCi0JCSAqaWFyZyA9IDE6IGlucHV0IGlzIGZyb20gWlIz
NjA2MAotCQkgKmlhcmcgPSAyOiBjb2xvciBiYXIgKi8KLQotCQlzd2l0Y2ggKGlhcmcpIHsKLQot
CQljYXNlIDA6Ci0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwMSwgMHgwMCk7Ci0KLQkJCWlm
IChlbmNvZGVyLT5ub3JtID09IFZJREVPX01PREVfTlRTQykKLQkJCQlzZXRfc3ViY2Fycmllcl9m
cmVxKGNsaWVudCwgMSk7Ci0KLQkJCWFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDBjLCBUUjFDQVBU
KTsJLyogVFIxICovCi0JCQlpZiAoZW5jb2Rlci0+bm9ybSA9PSBWSURFT19NT0RFX1NFQ0FNKQot
CQkJCWFkdjcxNzVfd3JpdGUoY2xpZW50LCAweDBkLCAweDQ5KTsJLy8gRGlzYWJsZSBnZW5sb2Nr
Ci0JCQllbHNlCi0JCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MGQsIDB4NGYpOwkvLyBFbmFi
bGUgZ2VubG9jawotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUgfCBUUjBS
U1QpOwotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUpOwotCQkJLy91ZGVs
YXkoMTApOwotCQkJYnJlYWs7Ci0KLQkJY2FzZSAxOgotCQkJYWR2NzE3NV93cml0ZShjbGllbnQs
IDB4MDEsIDB4MDApOwotCi0JCQlpZiAoZW5jb2Rlci0+bm9ybSA9PSBWSURFT19NT0RFX05UU0Mp
Ci0JCQkJc2V0X3N1YmNhcnJpZXJfZnJlcShjbGllbnQsIDApOwotCi0JCQlhZHY3MTc1X3dyaXRl
KGNsaWVudCwgMHgwYywgVFIxUExBWSk7CS8qIFRSMSAqLwotCQkJYWR2NzE3NV93cml0ZShjbGll
bnQsIDB4MGQsIDB4NDkpOwotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUg
fCBUUjBSU1QpOwotCQkJYWR2NzE3NV93cml0ZShjbGllbnQsIDB4MDcsIFRSME1PREUpOwotCQkJ
Ly91ZGVsYXkoMTApOwotCQkJYnJlYWs7Ci0KLQkJY2FzZSAyOgotCQkJYWR2NzE3NV93cml0ZShj
bGllbnQsIDB4MDEsIDB4ODApOwotCi0JCQlpZiAoZW5jb2Rlci0+bm9ybSA9PSBWSURFT19NT0RF
X05UU0MpCi0JCQkJc2V0X3N1YmNhcnJpZXJfZnJlcShjbGllbnQsIDApOwotCi0JCQlhZHY3MTc1
X3dyaXRlKGNsaWVudCwgMHgwZCwgMHg0OSk7Ci0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgw
NywgVFIwTU9ERSB8IFRSMFJTVCk7Ci0JCQlhZHY3MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIw
TU9ERSk7Ci0JCQkvL3VkZWxheSgxMCk7Ci0JCQlicmVhazsKLQotCQlkZWZhdWx0OgotCQkJZHBy
aW50aygxLCBLRVJOX0VSUiAiJXM6IGlsbGVnYWwgaW5wdXQ6ICVkXG4iLAotCQkJCUkyQ19OQU1F
KGNsaWVudCksIGlhcmcpOwotCQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQkJfQotCQlkcHJpbnRrKDEs
IEtFUk5fSU5GTyAiJXM6IHN3aXRjaGVkIHRvICVzXG4iLCBJMkNfTkFNRShjbGllbnQpLAotCQkJ
aW5wdXRzW2lhcmddKTsKLQkJZW5jb2Rlci0+aW5wdXQgPSBpYXJnOwotCX0KKwljYXNlIFZJRElP
Q19TX0lOUFVUOgorCQlpZiAoZW5jb2Rlci0+aW5wdXQgIT0gKihpbnQgKilhcmcpCisJCQlyZXR1
cm4gYWR2NzE3NV9zZXRfaW5wdXQoY2xpZW50LCAqKGludCAqKWFyZyk7CiAJCWJyZWFrOwogCi0J
Y2FzZSBFTkNPREVSX1NFVF9PVVRQVVQ6Ci0JewotCQlpbnQgKmlhcmcgPSBhcmc7Ci0KLQkJLyog
bm90IG11Y2ggY2hvaWNlIG9mIG91dHB1dHMgKi8KLQkJaWYgKCppYXJnICE9IDApIHsKLQkJCXJl
dHVybiAtRUlOVkFMOwotCQl9Ci0JfQorCWNhc2UgVklESU9DX0dfSU5QVVQ6CisJCSooaW50ICop
YXJnID0gZW5jb2Rlci0+aW5wdXQ7CiAJCWJyZWFrOwogCisjaWYgMAogCWNhc2UgRU5DT0RFUl9F
TkFCTEVfT1VUUFVUOgogCXsKIAkJaW50ICppYXJnID0gYXJnOwpAQCAtMzc3LDcgKzMxNiw3IEBA
CiAJCWVuY29kZXItPmVuYWJsZSA9ICEhKmlhcmc7CiAJfQogCQlicmVhazsKLQorI2VuZGlmCiAJ
ZGVmYXVsdDoKIAkJcmV0dXJuIC1FSU5WQUw7CiAJfQpAQCAtNDA4LDE5ICszNDcsMTYgQEAKIHN0
YXRpYyBzdHJ1Y3QgaTJjX2RyaXZlciBpMmNfZHJpdmVyX2FkdjcxNzU7CiAKIHN0YXRpYyBpbnQK
LWFkdjcxNzVfZGV0ZWN0X2NsaWVudCAoc3RydWN0IGkyY19hZGFwdGVyICphZGFwdGVyLAotCQkg
ICAgICAgaW50ICAgICAgICAgICAgICAgICBhZGRyZXNzLAotCQkgICAgICAgaW50ICAgICAgICAg
ICAgICAgICBraW5kKQorYWR2NzE3NV9kZXRlY3RfY2xpZW50IChzdHJ1Y3QgaTJjX2FkYXB0ZXIg
KmFkYXB0ZXIsIGludCBhZGRyZXNzLCBpbnQga2luZCkKIHsKIAlpbnQgaTsKIAlzdHJ1Y3QgaTJj
X2NsaWVudCAqY2xpZW50OwogCXN0cnVjdCBhZHY3MTc1ICplbmNvZGVyOwogCWNoYXIgKmRuYW1l
OwogCi0JZHByaW50aygxLAotCQlLRVJOX0lORk8KLQkJImFkdjcxNzUuYzogZGV0ZWN0aW5nIGFk
djcxNzUgY2xpZW50IG9uIGFkZHJlc3MgMHgleFxuIiwKLQkJYWRkcmVzcyA8PCAxKTsKKwlpZiAo
ZGVidWcpCisJCXByX2luZm8oImFkdjcxNzU6IGRldGVjdGluZyBhZHY3MTc1IGNsaWVudCBvbiBh
ZGRyZXNzIDB4JXhcbiIsCisJCQlhZGRyZXNzIDw8IDEpOzsKIAogCS8qIENoZWNrIGlmIHRoZSBh
ZGFwdGVyIHN1cHBvcnRzIHRoZSBuZWVkZWQgZmVhdHVyZXMgKi8KIAlpZiAoIWkyY19jaGVja19m
dW5jdGlvbmFsaXR5KGFkYXB0ZXIsIEkyQ19GVU5DX1NNQlVTX0JZVEVfREFUQSkpCkBAIC00Mjks
OSArMzY1LDExIEBACiAJY2xpZW50ID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGkyY19jbGllbnQp
LCBHRlBfS0VSTkVMKTsKIAlpZiAoIWNsaWVudCkKIAkJcmV0dXJuIC1FTk9NRU07CisKIAljbGll
bnQtPmFkZHIgPSBhZGRyZXNzOwogCWNsaWVudC0+YWRhcHRlciA9IGFkYXB0ZXI7CiAJY2xpZW50
LT5kcml2ZXIgPSAmaTJjX2RyaXZlcl9hZHY3MTc1OworCiAJaWYgKChjbGllbnQtPmFkZHIgPT0g
STJDX0FEVjcxNzUgPj4gMSkgfHwKIAkgICAgKGNsaWVudC0+YWRkciA9PSAoSTJDX0FEVjcxNzUg
Pj4gMSkgKyAxKSkgewogCQlkbmFtZSA9IGFkdjcxNzVfbmFtZTsKQEAgLTQ1MCw4ICszODgsNyBA
QAogCQlrZnJlZShjbGllbnQpOwogCQlyZXR1cm4gLUVOT01FTTsKIAl9Ci0JZW5jb2Rlci0+bm9y
bSA9IFZJREVPX01PREVfUEFMOwotCWVuY29kZXItPmlucHV0ID0gMDsKKwllbmNvZGVyLT5ub3Jt
ID0gVjRMMl9TVERfUEFMOwogCWVuY29kZXItPmVuYWJsZSA9IDE7CiAJaTJjX3NldF9jbGllbnRk
YXRhKGNsaWVudCwgZW5jb2Rlcik7CiAKQEAgLTQ2NywzMiArNDA0LDMzIEBACiAJCWkgPSBhZHY3
MTc1X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSB8IFRSMFJTVCk7CiAJCWkgPSBhZHY3MTc1
X3dyaXRlKGNsaWVudCwgMHgwNywgVFIwTU9ERSk7CiAJCWkgPSBhZHY3MTc1X3JlYWQoY2xpZW50
LCAweDEyKTsKLQkJZHByaW50aygxLCBLRVJOX0lORk8gIiVzX2F0dGFjaDogcmV2LiAlZCBhdCAw
eCV4XG4iLAorCQl2NGxfaW5mbyhjbGllbnQsICIlc19hdHRhY2g6IHJldi4gJWQgYXQgMHgleFxu
IiwKIAkJCUkyQ19OQU1FKGNsaWVudCksIGkgJiAxLCBjbGllbnQtPmFkZHIgPDwgMSk7CiAJfQog
CWlmIChpIDwgMCkgewotCQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlc19hdHRhY2g6IGluaXQgZXJy
b3IgMHgleFxuIiwKLQkJCUkyQ19OQU1FKGNsaWVudCksIGkpOworCQl2NGxfZXJyKGNsaWVudCwg
IiVzX2F0dGFjaDogaW5pdCBlcnJvciAweCV4XG4iLAorCQkJCUkyQ19OQU1FKGNsaWVudCksIGkp
OwogCX0KIAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50Ci1hZHY3MTc1X2F0dGFjaF9hZGFw
dGVyIChzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFkYXB0ZXIpCitzdGF0aWMgaW50IGFkdjcxNzVfYXR0
YWNoX2FkYXB0ZXIgKHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcikKIHsKLQlkcHJpbnRrKDEs
Ci0JCUtFUk5fSU5GTwotCQkiYWR2NzE3NS5jOiBzdGFydGluZyBwcm9iZSBmb3IgYWRhcHRlciAl
cyAoMHgleClcbiIsCi0JCUkyQ19OQU1FKGFkYXB0ZXIpLCBhZGFwdGVyLT5pZCk7CisJaWYgKGRl
YnVnKQorCQlwcl9pbmZvKCJhZHY3MTc1OiBzdGFydGluZyBwcm9iZSBmb3IgYWRhcHRlciAlcyAo
MHgleClcbiIsCisJCQlhZGFwdGVyLT5uYW1lLCBhZGFwdGVyLT5pZCk7CisKIAlyZXR1cm4gaTJj
X3Byb2JlKGFkYXB0ZXIsICZhZGRyX2RhdGEsICZhZHY3MTc1X2RldGVjdF9jbGllbnQpOwogfQog
Ci1zdGF0aWMgaW50Ci1hZHY3MTc1X2RldGFjaF9jbGllbnQgKHN0cnVjdCBpMmNfY2xpZW50ICpj
bGllbnQpCitzdGF0aWMgaW50IGFkdjcxNzVfZGV0YWNoX2NsaWVudCAoc3RydWN0IGkyY19jbGll
bnQgKmNsaWVudCkKIHsKIAlzdHJ1Y3QgYWR2NzE3NSAqZW5jb2RlciA9IGkyY19nZXRfY2xpZW50
ZGF0YShjbGllbnQpOwogCWludCBlcnI7CisKKwl2NGxfZGJnKDEsIGRlYnVnLCBjbGllbnQsICJy
ZW1vdmluZyBhZHY3MTc1IGFkYXB0ZXIgb24gYWRkcmVzcyAweCV4XG4iLAorCQkJY2xpZW50LT5h
ZGRyIDw8IDEpOwogCiAJZXJyID0gaTJjX2RldGFjaF9jbGllbnQoY2xpZW50KTsKIAlpZiAoZXJy
KSB7Cg==
------=_Part_113134_22056253.1221068762385
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

--
video4linux-list mailing list
Unsubscribe mailto:video4linux-list-request@redhat.com?subject=unsubscribe
https://www.redhat.com/mailman/listinfo/video4linux-list
------=_Part_113134_22056253.1221068762385--
