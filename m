Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-gx0-f214.google.com ([209.85.217.214]:50038 "EHLO
	mail-gx0-f214.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1750886AbZFQEiJ (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Wed, 17 Jun 2009 00:38:09 -0400
Received: by gxk10 with SMTP id 10so154684gxk.13
        for <linux-media@vger.kernel.org>; Tue, 16 Jun 2009 21:38:10 -0700 (PDT)
MIME-Version: 1.0
Date: Wed, 17 Jun 2009 12:38:10 +0800
Message-ID: <15ed362e0906162138h206309c7qa8d595f0c94682be@mail.gmail.com>
Subject: [PATCH 1/2] [Resend] lgs8gxx: add lgs8g75 support
From: David Wong <davidtlwong@gmail.com>
To: linux-media@vger.kernel.org
Cc: Mauro Carvalho Chehab <mchehab@infradead.org>
Content-Type: multipart/mixed; boundary=00032557620ec6f4f4046c83db01
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--00032557620ec6f4f4046c83db01
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

lgs8gxx: add lgs8g75 demodulator support

Signed-off-by: David T.L. Wong <davidtlwong@gmail.com>

--00032557620ec6f4f4046c83db01
Content-Type: text/x-diff; charset=US-ASCII; name="lgs8g75.patch"
Content-Disposition: attachment; filename="lgs8g75.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_fw1jp8jc0

ZGlmZiAtciBkNGVkNzU3NTljYWUgbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xn
czhneHguYwotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eC5j
CVR1ZSBKdW4gMTYgMTk6MDI6MTAgMjAwOSAtMDMwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlh
L2R2Yi9mcm9udGVuZHMvbGdzOGd4eC5jCVdlZCBKdW4gMTcgMTA6NTg6MzcgMjAwOSArMDgwMApA
QCAtMSw5ICsxLDkgQEAKIC8qCi0gKiAgICBTdXBwb3J0IGZvciBMZWdlbmQgU2lsaWNvbiBETUIt
VEggZGVtb2R1bGF0b3IKLSAqICAgIExHUzg5MTMsIExHUzhHTDUKKyAqICAgIFN1cHBvcnQgZm9y
IExlZ2VuZCBTaWxpY29uIEdCMjA2MDAgKGEuay5hIERNQi1USCkgZGVtb2R1bGF0b3IKKyAqICAg
IExHUzg5MTMsIExHUzhHTDUsIExHUzhHNzUKICAqICAgIGV4cGVyaW1lbnRhbCBzdXBwb3J0IExH
UzhHNDIsIExHUzhHNTIKICAqCi0gKiAgICBDb3B5cmlnaHQgKEMpIDIwMDcsMjAwOCBEYXZpZCBU
LkwuIFdvbmcgPGRhdmlkdGx3b25nQGdtYWlsLmNvbT4KKyAqICAgIENvcHlyaWdodCAoQykgMjAw
Ny0yMDA5IERhdmlkIFQuTC4gV29uZyA8ZGF2aWR0bHdvbmdAZ21haWwuY29tPgogICogICAgQ29w
eXJpZ2h0IChDKSAyMDA4IFNpcml1cyBJbnRlcm5hdGlvbmFsIChIb25nIEtvbmcpIExpbWl0ZWQK
ICAqICAgIFRpbW90aHkgTGVlIDx0aW1vdGh5LmxlZUBzaXJpdXNoay5jb20+IChmb3IgaW5pdGlh
bCB3b3JrIG9uIExHUzhHTDUpCiAgKgpAQCAtNDYsNiArNDYsNDIgQEAKIE1PRFVMRV9QQVJNX0RF
U0MoZmFrZV9zaWduYWxfc3RyLCAiZmFrZSBzaWduYWwgc3RyZW5ndGggZm9yIExHUzg5MTMuIgog
IlNpZ25hbCBzdHJlbmd0aCBjYWxjdWxhdGlvbiBpcyBzbG93LihkZWZhdWx0Om9uKS4iKTsKIAor
c3RhdGljIGNvbnN0IHU4IGxnczhnNzVfaW5pdGRhdFtdID0geworCTB4MDEsIDB4MzAsIDB4RkYs
IDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsCisJMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwg
MHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwKKwkweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAw
eEZGLCAweEZGLCAweEZGLAorCTB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4
RkYsIDB4RkYsCisJMHgwMCwgMHgwMSwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhG
RiwKKwkweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLAorCTB4
RTQsIDB4RjUsIDB4QTgsIDB4RjUsIDB4QjgsIDB4RjUsIDB4ODgsIDB4RjUsCisJMHg4OSwgMHhG
NSwgMHg4NywgMHg3NSwgMHhEMCwgMHgwMCwgMHgxMSwgMHg1MCwKKwkweDExLCAweDUwLCAweEY0
LCAweEY1LCAweDgwLCAweEY1LCAweDkwLCAweEY1LAorCTB4QTAsIDB4RjUsIDB4QjAsIDB4NzUs
IDB4ODEsIDB4MzAsIDB4ODAsIDB4MDEsCisJMHgzMiwgMHg5MCwgMHg4MCwgMHgxMiwgMHg3NCwg
MHhGRiwgMHhGMCwgMHg5MCwKKwkweDgwLCAweDEzLCAweDc0LCAweDFGLCAweEYwLCAweDkwLCAw
eDgwLCAweDIzLAorCTB4NzQsIDB4MDEsIDB4RjAsIDB4OTAsIDB4ODAsIDB4MjIsIDB4RjAsIDB4
OTAsCisJMHgwMCwgMHg0OCwgMHg3NCwgMHgwMCwgMHhGMCwgMHg5MCwgMHg4MCwgMHg0RCwKKwkw
eDc0LCAweDA1LCAweEYwLCAweDkwLCAweDgwLCAweDA5LCAweEUwLCAweDYwLAorCTB4MjEsIDB4
MTIsIDB4MDAsIDB4REQsIDB4MTQsIDB4NjAsIDB4MUIsIDB4MTIsCisJMHgwMCwgMHhERCwgMHgx
NCwgMHg2MCwgMHgxNSwgMHgxMiwgMHgwMCwgMHhERCwKKwkweDE0LCAweDYwLCAweDBGLCAweDEy
LCAweDAwLCAweERELCAweDE0LCAweDYwLAorCTB4MDksIDB4MTIsIDB4MDAsIDB4REQsIDB4MTQs
IDB4NjAsIDB4MDMsIDB4MTIsCisJMHgwMCwgMHhERCwgMHg5MCwgMHg4MCwgMHg0MiwgMHhFMCwg
MHg2MCwgMHgwQiwKKwkweDE0LCAweDYwLCAweDBDLCAweDE0LCAweDYwLCAweDBELCAweDE0LCAw
eDYwLAorCTB4MEUsIDB4MDEsIDB4QjMsIDB4NzQsIDB4MDQsIDB4MDEsIDB4QjksIDB4NzQsCisJ
MHgwNSwgMHgwMSwgMHhCOSwgMHg3NCwgMHgwNywgMHgwMSwgMHhCOSwgMHg3NCwKKwkweDBBLCAw
eEMwLCAweEUwLCAweDc0LCAweEM4LCAweDEyLCAweDAwLCAweEUyLAorCTB4RDAsIDB4RTAsIDB4
MTQsIDB4NzAsIDB4RjQsIDB4OTAsIDB4ODAsIDB4MDksCisJMHhFMCwgMHg3MCwgMHhBRSwgMHgx
MiwgMHgwMCwgMHhGNiwgMHgxMiwgMHgwMCwKKwkweEZFLCAweDkwLCAweDAwLCAweDQ4LCAweEUw
LCAweDA0LCAweEYwLCAweDkwLAorCTB4ODAsIDB4NEUsIDB4RjAsIDB4MDEsIDB4NzMsIDB4OTAs
IDB4ODAsIDB4MDgsCisJMHhGMCwgMHgyMiwgMHhGOCwgMHg3QSwgMHgwQywgMHg3OSwgMHhGRCwg
MHgwMCwKKwkweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweEQ5LAor
CTB4RjYsIDB4REEsIDB4RjIsIDB4RDgsIDB4RUUsIDB4MjIsIDB4OTAsIDB4ODAsCisJMHg2NSwg
MHhFMCwgMHg1NCwgMHhGRCwgMHhGMCwgMHgyMiwgMHg5MCwgMHg4MCwKKwkweDY1LCAweEUwLCAw
eDQ0LCAweEMyLCAweEYwLCAweDIyCit9OworCiAvKiBMR1M4R1hYIGludGVybmFsIGhlbHBlciBm
dW5jdGlvbnMgKi8KIAogc3RhdGljIGludCBsZ3M4Z3h4X3dyaXRlX3JlZyhzdHJ1Y3QgbGdzOGd4
eF9zdGF0ZSAqcHJpdiwgdTggcmVnLCB1OCBkYXRhKQpAQCAtNTUsNyArOTEsNyBAQAogCXN0cnVj
dCBpMmNfbXNnIG1zZyA9IHsgLmZsYWdzID0gMCwgLmJ1ZiA9IGJ1ZiwgLmxlbiA9IDIgfTsKIAog
CW1zZy5hZGRyID0gcHJpdi0+Y29uZmlnLT5kZW1vZF9hZGRyZXNzOwotCWlmIChyZWcgPj0gMHhD
MCkKKwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kICE9IExHUzhHWFhfUFJPRF9MR1M4Rzc1ICYmIHJl
ZyA+PSAweEMwKQogCQltc2cuYWRkciArPSAweDAyOwogCiAJaWYgKGRlYnVnID49IDIpCkBAIC04
NCw3ICsxMjAsNyBAQAogCX07CiAKIAlkZXZfYWRkciA9IHByaXYtPmNvbmZpZy0+ZGVtb2RfYWRk
cmVzczsKLQlpZiAocmVnID49IDB4QzApCisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCAhPSBMR1M4
R1hYX1BST0RfTEdTOEc3NSAmJiByZWcgPj0gMHhDMCkKIAkJZGV2X2FkZHIgKz0gMHgwMjsKIAlt
c2dbMV0uYWRkciA9ICBtc2dbMF0uYWRkciA9IGRldl9hZGRyOwogCkBAIC0xMTIsMTkgKzE0OCwz
NiBAQAogCXJldHVybiAwOwogfQogCitzdGF0aWMgaW50IHdhaXRfcmVnX21hc2soc3RydWN0IGxn
czhneHhfc3RhdGUgKnByaXYsIHU4IHJlZywgdTggbWFzaywKKwl1OCB2YWwsIHU4IGRlbGF5LCB1
OCB0cmllcykKK3sKKwl1OCB0OworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IHRyaWVzOyBp
KyspIHsKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCByZWcsICZ0KTsKKworCQlpZiAoKHQgJiBt
YXNrKSA9PSB2YWwpCisJCQlyZXR1cm4gMDsKKwkJbXNsZWVwKGRlbGF5KTsKKwl9CisKKwlyZXR1
cm4gMTsKK30KKwogc3RhdGljIGludCBsZ3M4Z3h4X3NldF9hZF9tb2RlKHN0cnVjdCBsZ3M4Z3h4
X3N0YXRlICpwcml2KQogewogCWNvbnN0IHN0cnVjdCBsZ3M4Z3h4X2NvbmZpZyAqY29uZmlnID0g
cHJpdi0+Y29uZmlnOwogCXU4IGlmX2NvbmY7CiAKLQlpZl9jb25mID0gMHgxMDsgLyogQUdDIG91
dHB1dCBvbjsgKi8KKwlpZl9jb25mID0gMHgxMDsgLyogQUdDIG91dHB1dCBvbiwgUkZfQUdDIG91
dHB1dCBvZmY7ICovCiAKIAlpZl9jb25mIHw9CiAJCSgoY29uZmlnLT5leHRfYWRjKSA/IDB4ODAg
OiAweDAwKSB8CiAJCSgoY29uZmlnLT5pZl9uZWdfY2VudGVyKSA/IDB4MDQgOiAweDAwKSB8CiAJ
CSgoY29uZmlnLT5pZl9mcmVxID09IDApID8gMHgwOCA6IDB4MDApIHwgLyogQmFzZWJhbmQgKi8K
LQkJKChjb25maWctPmV4dF9hZGMgJiYgY29uZmlnLT5hZGNfc2lnbmVkKSA/IDB4MDIgOiAweDAw
KSB8Ci0JCSgoY29uZmlnLT5leHRfYWRjICYmIGNvbmZpZy0+aWZfbmVnX2VkZ2UpID8gMHgwMSA6
IDB4MDApOworCQkoKGNvbmZpZy0+YWRjX3NpZ25lZCkgPyAweDAyIDogMHgwMCkgfAorCQkoKGNv
bmZpZy0+aWZfbmVnX2VkZ2UpID8gMHgwMSA6IDB4MDApOwogCiAJaWYgKGNvbmZpZy0+ZXh0X2Fk
YyAmJgogCQkoY29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4RzUyKSkgewpAQCAtMTU3
LDM5ICsyMTAsODIgQEAKIAl9CiAJZHByaW50aygiQUZDX0lOSVRfRlJFUSA9IDB4JTA4WFxuIiwg
djMyKTsKIAotCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDksIDB4RkYgJiAodjMyKSk7Ci0J
bGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgwQSwgMHhGRiAmICh2MzIgPj4gOCkpOwotCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4MEIsIDB4RkYgJiAodjMyID4+IDE2KSk7Ci0JbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHgwQywgMHhGRiAmICh2MzIgPj4gMjQpKTsKKwlpZiAocHJpdi0+Y29u
ZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KSB7CisJCWxnczhneHhfd3JpdGVfcmVn
KHByaXYsIDB4MDgsIDB4RkYgJiAodjMyKSk7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4
MDksIDB4RkYgJiAodjMyID4+IDgpKTsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgwQSwg
MHhGRiAmICh2MzIgPj4gMTYpKTsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgwQiwgMHhG
RiAmICh2MzIgPj4gMjQpKTsKKwl9IGVsc2UgeworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAw
eDA5LCAweEZGICYgKHYzMikpOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDBBLCAweEZG
ICYgKHYzMiA+PiA4KSk7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MEIsIDB4RkYgJiAo
djMyID4+IDE2KSk7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MEMsIDB4RkYgJiAodjMy
ID4+IDI0KSk7CisJfQogCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbGdzOGd4eF9nZXRf
YWZjX3BoYXNlKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2KQoreworCXU2NCB2YWw7CisJdTMy
IHYzMiA9IDA7CisJdTggcmVnX2FkZHIsIHQ7CisJaW50IGk7CisKKwlpZiAocHJpdi0+Y29uZmln
LT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KQorCQlyZWdfYWRkciA9IDB4MjM7CisJZWxz
ZQorCQlyZWdfYWRkciA9IDB4NDg7CisKKwlmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKSB7CisJCWxn
czhneHhfcmVhZF9yZWcocHJpdiwgcmVnX2FkZHIsICZ0KTsKKwkJdjMyIDw8PSA4OworCQl2MzIg
fD0gdDsKKwkJcmVnX2FkZHItLTsKKwl9CisKKwl2YWwgPSB2MzI7CisJdmFsICo9IHByaXYtPmNv
bmZpZy0+aWZfY2xrX2ZyZXE7CisJdmFsIC89ICh1NjQpMSA8PCAzMjsKKwlkcHJpbnRrKCJBRkMg
PSAldSBrSHpcbiIsICh1MzIpdmFsKTsKIAlyZXR1cm4gMDsKIH0KIAogc3RhdGljIGludCBsZ3M4
Z3h4X3NldF9tb2RlX2F1dG8oc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYpCiB7CiAJdTggdDsK
Kwl1OCBwcm9kID0gcHJpdi0+Y29uZmlnLT5wcm9kOwogCi0JaWYgKHByaXYtPmNvbmZpZy0+cHJv
ZCA9PSBMR1M4R1hYX1BST0RfTEdTODkxMykKKwlpZiAocHJvZCA9PSBMR1M4R1hYX1BST0RfTEdT
ODkxMykKIAkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDNiwgMHgwMSk7CiAKLQlsZ3M4Z3h4
X3JlYWRfcmVnKHByaXYsIDB4N0UsICZ0KTsKLQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDdF
LCB0IHwgMHgwMSk7CisJaWYgKHByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhHNzUpIHsKKwkJbGdz
OGd4eF9yZWFkX3JlZyhwcml2LCAweDBDLCAmdCk7CisJCXQgJj0gKH4weDA0KTsKKwkJbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHgwQywgdCB8IDB4ODApOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhw
cml2LCAweDM5LCAweDAwKTsKKwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzRCwgMHgwNCk7
CisJfSBlbHNlIGlmIChwcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzIHx8CisJCXByb2QgPT0g
TEdTOEdYWF9QUk9EX0xHUzhHTDUgfHwKKwkJcHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc0MiB8
fAorCQlwcm9kID09IExHUzhHWFhfUFJPRF9MR1M4RzUyIHx8CisJCXByb2QgPT0gTEdTOEdYWF9Q
Uk9EX0xHUzhHNTQpIHsKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDdFLCAmdCk7CisJCWxn
czhneHhfd3JpdGVfcmVnKHByaXYsIDB4N0UsIHQgfCAweDAxKTsKIAotCS8qIGNsZWFyIEZFQyBz
ZWxmIHJlc2V0ICovCi0JbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweEM1LCAmdCk7Ci0JbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHhDNSwgdCAmIDB4RTApOworCQkvKiBjbGVhciBGRUMgc2VsZiBy
ZXNldCAqLworCQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QzUsICZ0KTsKKwkJbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHhDNSwgdCAmIDB4RTApOworCX0KIAotCWlmIChwcml2LT5jb25maWct
PnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpIHsKKwlpZiAocHJvZCA9PSBMR1M4R1hYX1BS
T0RfTEdTODkxMykgewogCQkvKiBGRUMgYXV0byBkZXRlY3QgKi8KIAkJbGdzOGd4eF93cml0ZV9y
ZWcocHJpdiwgMHhDMSwgMHgwMyk7CiAKIAkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDdDLCAm
dCk7CiAJCXQgPSAodCAmIDB4OEMpIHwgMHgwMzsKIAkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwg
MHg3QywgdCk7Ci0JfQogCi0KLQlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJP
RF9MR1M4OTEzKSB7CiAJCS8qIEJFUiB0ZXN0IG1vZGUgKi8KIAkJbGdzOGd4eF9yZWFkX3JlZyhw
cml2LCAweEMzLCAmdCk7CiAJCXQgPSAodCAmIDB4RUYpIHwgIDB4MTA7CkBAIC0yMDYsNiArMzAy
LDMyIEBACiB7CiAJaW50IHJldCA9IDA7CiAJdTggdDsKKworCWlmIChwcml2LT5jb25maWctPnBy
b2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhHNzUpIHsKKwkJdTggdDI7CisJCWxnczhneHhfcmVhZF9y
ZWcocHJpdiwgMHgwQywgJnQpOworCQl0ICY9ICh+MHg4MCk7CisJCWxnczhneHhfd3JpdGVfcmVn
KHByaXYsIDB4MEMsIHQpOworCisJCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHgwQywgJnQpOwor
CQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4MTksICZ0Mik7CisKKwkJaWYgKCgodCYweDAzKSA9
PSAweDAxKSAmJiAodDImMHgwMSkpIHsKKwkJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4NkUs
IDB4MDUpOworCQkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzOSwgMHgwMik7CisJCQlsZ3M4
Z3h4X3dyaXRlX3JlZyhwcml2LCAweDM5LCAweDAzKTsKKwkJCWxnczhneHhfd3JpdGVfcmVnKHBy
aXYsIDB4M0QsIDB4MDUpOworCQkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzRSwgMHgyOCk7
CisJCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDUzLCAweDgwKTsKKwkJfSBlbHNlIHsKKwkJ
CWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4NkUsIDB4M0YpOworCQkJbGdzOGd4eF93cml0ZV9y
ZWcocHJpdiwgMHgzOSwgMHgwMCk7CisJCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDNELCAw
eDA0KTsKKwkJfQorCisJCWxnczhneHhfc29mdF9yZXNldChwcml2KTsKKwkJcmV0dXJuIDA7CisJ
fQogCiAJLyogdHVybiBvZmYgYXV0by1kZXRlY3Q7IG1hbnVhbCBzZXR0aW5ncyAqLwogCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4N0UsIDApOwpAQCAtMjI2LDExICszNDgsMzkgQEAKIAlpbnQg
cmV0ID0gMDsKIAl1OCB0OwogCi0JcmV0ID0gbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDRCLCAm
dCk7CisJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc3NSkKKwkJ
cmV0ID0gbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDEzLCAmdCk7CisJZWxzZQorCQlyZXQgPSBs
Z3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4NEIsICZ0KTsKIAlpZiAocmV0ICE9IDApCiAJCXJldHVy
biByZXQ7CiAKLQkqbG9ja2VkID0gKCh0ICYgMHhDMCkgPT0gMHhDMCkgPyAxIDogMDsKKwlpZiAo
cHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KQorCQkqbG9ja2VkID0g
KCh0ICYgMHg4MCkgPT0gMHg4MCkgPyAxIDogMDsKKwllbHNlCisJCSpsb2NrZWQgPSAoKHQgJiAw
eEMwKSA9PSAweEMwKSA/IDEgOiAwOworCXJldHVybiAwOworfQorCisvKiBXYWl0IGZvciBDb2Rl
IEFjcXVpc2l0aW9uIExvY2sgKi8KK3N0YXRpYyBpbnQgbGdzOGd4eF93YWl0X2NhX2xvY2soc3Ry
dWN0IGxnczhneHhfc3RhdGUgKnByaXYsIHU4ICpsb2NrZWQpCit7CisJaW50IHJldCA9IDA7CisJ
dTggcmVnLCBtYXNrLCB2YWw7CisKKwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhf
UFJPRF9MR1M4Rzc1KSB7CisJCXJlZyA9IDB4MTM7CisJCW1hc2sgPSAweDgwOworCQl2YWwgPSAw
eDgwOworCX0gZWxzZSB7CisJCXJlZyA9IDB4NEI7CisJCW1hc2sgPSAweEMwOworCQl2YWwgPSAw
eEMwOworCX0KKworCXJldCA9IHdhaXRfcmVnX21hc2socHJpdiwgcmVnLCBtYXNrLCB2YWwsIDUw
LCA0MCk7CisJKmxvY2tlZCA9IChyZXQgPT0gMCkgPyAxIDogMDsKKwogCXJldHVybiAwOwogfQog
CkBAIC0yMzgsMjEgKzM4OCwzMCBAQAogCQkJCQkgIHU4ICpmaW5pc2hlZCkKIHsKIAlpbnQgcmV0
ID0gMDsKLQl1OCB0OworCXU4IHJlZywgbWFzaywgdmFsOwogCi0JcmV0ID0gbGdzOGd4eF9yZWFk
X3JlZyhwcml2LCAweEE0LCAmdCk7Ci0JaWYgKHJldCAhPSAwKQotCQlyZXR1cm4gcmV0OworCWlm
IChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhHNzUpIHsKKwkJcmVnID0g
MHgxZjsKKwkJbWFzayA9IDB4QzA7CisJCXZhbCA9IDB4ODA7CisJfSBlbHNlIHsKKwkJcmVnID0g
MHhBNDsKKwkJbWFzayA9IDB4MDM7CisJCXZhbCA9IDB4MDE7CisJfQogCi0JKmZpbmlzaGVkID0g
KCh0ICYgMHgzKSA9PSAweDEpID8gMSA6IDA7CisJcmV0ID0gd2FpdF9yZWdfbWFzayhwcml2LCBy
ZWcsIG1hc2ssIHZhbCwgMTAsIDIwKTsKKwkqZmluaXNoZWQgPSAocmV0ID09IDApID8gMSA6IDA7
CiAKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBsZ3M4Z3h4X2F1dG9sb2NrX2dpKHN0cnVj
dCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1OCBnaSwgdTggKmxvY2tlZCkKK3N0YXRpYyBpbnQgbGdz
OGd4eF9hdXRvbG9ja19naShzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJpdiwgdTggZ2ksIHU4IGNw
biwKKwl1OCAqbG9ja2VkKQogewotCWludCBlcnI7CisJaW50IGVyciA9IDA7CiAJdTggYWRfZmlu
aSA9IDA7CisJdTggdDEsIHQyOwogCiAJaWYgKGdpID09IEdJXzk0NSkKIAkJZHByaW50aygidHJ5
IEdJIDk0NVxuIik7CkBAIC0yNjAsMTcgKzQxOSwyOSBAQAogCQlkcHJpbnRrKCJ0cnkgR0kgNTk1
XG4iKTsKIAllbHNlIGlmIChnaSA9PSBHSV80MjApCiAJCWRwcmludGsoInRyeSBHSSA0MjBcbiIp
OwotCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDQsIGdpKTsKKwlpZiAocHJpdi0+Y29uZmln
LT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KSB7CisJCWxnczhneHhfcmVhZF9yZWcocHJp
diwgMHgwQywgJnQxKTsKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDE4LCAmdDIpOworCQl0
MSAmPSB+KEdJX01BU0spOworCQl0MSB8PSBnaTsKKwkJdDIgJj0gMHhGRTsKKwkJdDIgfD0gY3Bu
ID8gMHgwMSA6IDB4MDA7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MEMsIHQxKTsKKwkJ
bGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgxOCwgdDIpOworCX0gZWxzZSB7CisJCWxnczhneHhf
d3JpdGVfcmVnKHByaXYsIDB4MDQsIGdpKTsKKwl9CiAJbGdzOGd4eF9zb2Z0X3Jlc2V0KHByaXYp
OwotCW1zbGVlcCg1MCk7CisJZXJyID0gbGdzOGd4eF93YWl0X2NhX2xvY2socHJpdiwgbG9ja2Vk
KTsKKwlpZiAoZXJyIHx8ICEoKmxvY2tlZCkpCisJCXJldHVybiBlcnI7CiAJZXJyID0gbGdzOGd4
eF9pc19hdXRvZGV0ZWN0X2ZpbmlzaGVkKHByaXYsICZhZF9maW5pKTsKIAlpZiAoZXJyICE9IDAp
CiAJCXJldHVybiBlcnI7CiAJaWYgKGFkX2ZpbmkpIHsKLQkJZXJyID0gbGdzOGd4eF9pc19sb2Nr
ZWQocHJpdiwgbG9ja2VkKTsKLQkJaWYgKGVyciAhPSAwKQotCQkJcmV0dXJuIGVycjsKLQl9CisJ
CWRwcmludGsoImF1dG8gZGV0ZWN0IGZpbmlzaGVkXG4iKTsKKwl9IGVsc2UKKwkJKmxvY2tlZCA9
IDA7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTI4NSwxMyArNDU2LDE4IEBACiAJZHByaW50aygiJXNc
biIsIF9fZnVuY19fKTsKIAogCWxnczhneHhfc2V0X21vZGVfYXV0byhwcml2KTsKLQkvKiBHdWFy
ZCBJbnRlcnZhbCAqLwotCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4MDMsIDAwKTsKKwlpZiAo
cHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KSB7CisJCWxnczhneHhf
d3JpdGVfcmVnKHByaXYsIDB4NjcsIDB4QUEpOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAw
eDZFLCAweDNGKTsKKwl9IGVsc2UgeworCQkvKiBHdWFyZCBJbnRlcnZhbCAqLworCQlsZ3M4Z3h4
X3dyaXRlX3JlZyhwcml2LCAweDAzLCAwMCk7CisJfQogCiAJZm9yIChpID0gMDsgaSA8IDI7IGkr
KykgewogCQlmb3IgKGogPSAwOyBqIDwgMjsgaisrKSB7CiAJCQl0bXBfZ2kgPSBHSV85NDU7Ci0J
CQllcnIgPSBsZ3M4Z3h4X2F1dG9sb2NrX2dpKHByaXYsIEdJXzk0NSwgJmxvY2tlZCk7CisJCQll
cnIgPSBsZ3M4Z3h4X2F1dG9sb2NrX2dpKHByaXYsIEdJXzk0NSwgaiwgJmxvY2tlZCk7CiAJCQlp
ZiAoZXJyKQogCQkJCWdvdG8gb3V0OwogCQkJaWYgKGxvY2tlZCkKQEAgLTI5OSwxNCArNDc1LDE0
IEBACiAJCX0KIAkJZm9yIChqID0gMDsgaiA8IDI7IGorKykgewogCQkJdG1wX2dpID0gR0lfNDIw
OwotCQkJZXJyID0gbGdzOGd4eF9hdXRvbG9ja19naShwcml2LCBHSV80MjAsICZsb2NrZWQpOwor
CQkJZXJyID0gbGdzOGd4eF9hdXRvbG9ja19naShwcml2LCBHSV80MjAsIGosICZsb2NrZWQpOwog
CQkJaWYgKGVycikKIAkJCQlnb3RvIG91dDsKIAkJCWlmIChsb2NrZWQpCiAJCQkJZ290byBsb2Nr
ZWQ7CiAJCX0KIAkJdG1wX2dpID0gR0lfNTk1OwotCQllcnIgPSBsZ3M4Z3h4X2F1dG9sb2NrX2dp
KHByaXYsIEdJXzU5NSwgJmxvY2tlZCk7CisJCWVyciA9IGxnczhneHhfYXV0b2xvY2tfZ2kocHJp
diwgR0lfNTk1LCAxLCAmbG9ja2VkKTsKIAkJaWYgKGVycikKIAkJCWdvdG8gb3V0OwogCQlpZiAo
bG9ja2VkKQpAQCAtMzE3LDggKzQ5MywxMyBAQAogCWlmICgoZXJyID09IDApICYmIChsb2NrZWQg
PT0gMSkpIHsKIAkJdTggdDsKIAotCQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QTIsICZ0KTsK
LQkJKmRldGVjdGVkX3BhcmFtID0gdDsKKwkJaWYgKHByaXYtPmNvbmZpZy0+cHJvZCAhPSBMR1M4
R1hYX1BST0RfTEdTOEc3NSkgeworCQkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweEEyLCAmdCk7
CisJCQkqZGV0ZWN0ZWRfcGFyYW0gPSB0OworCQl9IGVsc2UgeworCQkJbGdzOGd4eF9yZWFkX3Jl
Zyhwcml2LCAweDFGLCAmdCk7CisJCQkqZGV0ZWN0ZWRfcGFyYW0gPSB0ICYgMHgzRjsKKwkJfQog
CiAJCWlmICh0bXBfZ2kgPT0gR0lfOTQ1KQogCQkJZHByaW50aygiR0kgOTQ1IGxvY2tlZFxuIik7
CkBAIC0zNDksMTggKzUzMCwyOCBAQAogCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDAzLCAw
eDAxKTsKICNlbmRpZgogCQlkcHJpbnRrKCJsZ3M4Z3h4X2F1dG9fZGV0ZWN0IGZhaWxlZFxuIik7
Ci0JfQorCX0gZWxzZQorCQlkcHJpbnRrKCJkZXRlY3RlZCBwYXJhbSA9IDB4JTAyWFxuIiwgZGV0
ZWN0ZWRfcGFyYW0pOwogCiAJLyogQXBwbHkgZGV0ZWN0ZWQgcGFyYW1ldGVycyAqLwogCWlmIChw
cml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpIHsKIAkJdTggaW50ZXJf
bGVhdmVfbGVuID0gZGV0ZWN0ZWRfcGFyYW0gJiBUSU1fTUFTSyA7Ci0JCWludGVyX2xlYXZlX2xl
biA9IChpbnRlcl9sZWF2ZV9sZW4gPT0gVElNX0xPTkcpID8gMHg2MCA6IDB4NDA7CisJCS8qIEZp
eCA4OTEzIHRpbWUgaW50ZXJsZWF2ZXIgZGV0ZWN0aW9uIGJ1ZyAqLworCQlpbnRlcl9sZWF2ZV9s
ZW4gPSAoaW50ZXJfbGVhdmVfbGVuID09IFRJTV9NSURETEUpID8gMHg2MCA6IDB4NDA7CiAJCWRl
dGVjdGVkX3BhcmFtICY9IENGX01BU0sgfCBTQ19NQVNLICB8IExHU19GRUNfTUFTSzsKIAkJZGV0
ZWN0ZWRfcGFyYW0gfD0gaW50ZXJfbGVhdmVfbGVuOwogCX0KLQlsZ3M4Z3h4X3dyaXRlX3JlZyhw
cml2LCAweDdELCBkZXRlY3RlZF9wYXJhbSk7Ci0JaWYgKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBM
R1M4R1hYX1BST0RfTEdTODkxMykKLQkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHhDMCwgZGV0
ZWN0ZWRfcGFyYW0pOworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xH
UzhHNzUpIHsKKwkJdTggdDsKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDE5LCAmdCk7CisJ
CXQgJj0gMHg4MTsKKwkJdCB8PSBkZXRlY3RlZF9wYXJhbSA8PCAxOworCQlsZ3M4Z3h4X3dyaXRl
X3JlZyhwcml2LCAweDE5LCB0KTsKKwl9IGVsc2UgeworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2
LCAweDdELCBkZXRlY3RlZF9wYXJhbSk7CisJCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdT
OEdYWF9QUk9EX0xHUzg5MTMpCisJCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweEMwLCBkZXRl
Y3RlZF9wYXJhbSk7CisJfQogCS8qIGxnczhneHhfc29mdF9yZXNldChwcml2KTsgKi8KIAogCS8q
IEVudGVyIG1hbnVhbCBtb2RlICovCkBAIC0zODIsOSArNTczLDEwIEBACiAJdTggc2VyaWFsLCB1
OCBjbGtfcG9sLCB1OCBjbGtfZ2F0ZWQpCiB7CiAJaW50IHJldCA9IDA7Ci0JdTggdDsKKwl1OCB0
LCByZWdfYWRkcjsKIAotCXJldCA9IGxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhDMiwgJnQpOwor
CXJlZ19hZGRyID0gKHByaXYtPmNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc3NSkg
PyAweDMwIDogMHhDMjsKKwlyZXQgPSBsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIHJlZ19hZGRyLCAm
dCk7CiAJaWYgKHJldCAhPSAwKQogCQlyZXR1cm4gcmV0OwogCkBAIC0zOTMsMTMgKzU4NSwyOSBA
QAogCXQgfD0gY2xrX3BvbCA/IFRTX0NMS19JTlZFUlRFRCA6IFRTX0NMS19OT1JNQUw7CiAJdCB8
PSBjbGtfZ2F0ZWQgPyBUU19DTEtfR0FURUQgOiBUU19DTEtfRlJFRVJVTjsKIAotCXJldCA9IGxn
czhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzIsIHQpOworCXJldCA9IGxnczhneHhfd3JpdGVfcmVn
KHByaXYsIHJlZ19hZGRyLCB0KTsKIAlpZiAocmV0ICE9IDApCiAJCXJldHVybiByZXQ7CiAKIAly
ZXR1cm4gMDsKIH0KIAorLyogQS9EIGlucHV0IHBlYWstdG8tcGVhayB2b2x0YWdlIHJhbmdlICov
CitzdGF0aWMgaW50IGxnczhnNzVfc2V0X2FkY192cHAoc3RydWN0IGxnczhneHhfc3RhdGUgKnBy
aXYsCisJdTggc2VsKQoreworCXU4IHIyNiA9IDB4NzMsIHIyNyA9IDB4OTA7CisKKwlpZiAocHJp
di0+Y29uZmlnLT5wcm9kICE9IExHUzhHWFhfUFJPRF9MR1M4Rzc1KQorCQlyZXR1cm4gMDsKKwor
CXIyNiB8PSAoc2VsICYgMHgwMSkgPDwgNzsKKwlyMjcgfD0gKHNlbCAmIDB4MDIpID4+IDE7CisJ
bGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgyNiwgcjI2KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhw
cml2LCAweDI3LCByMjcpOworCisJcmV0dXJuIDA7Cit9CiAKIC8qIExHUzg5MTMgZGVtb2QgZnJv
bnRlbmQgZnVuY3Rpb25zICovCiAKQEAgLTQyOCw2ICs2MzYsMzQgQEAKIAlyZXR1cm4gMDsKIH0K
IAorc3RhdGljIGludCBsZ3M4Zzc1X2luaXRfZGF0YShzdHJ1Y3QgbGdzOGd4eF9zdGF0ZSAqcHJp
dikKK3sKKwljb25zdCB1OCAqcCA9IGxnczhnNzVfaW5pdGRhdDsKKwlpbnQgaTsKKworCWxnczhn
eHhfd3JpdGVfcmVnKHByaXYsIDB4QzYsIDB4NDApOworCisJbGdzOGd4eF93cml0ZV9yZWcocHJp
diwgMHgzRCwgMHgwNCk7CisJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzOSwgMHgwMCk7CisK
KwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDNBLCAweDAwKTsKKwlsZ3M4Z3h4X3dyaXRlX3Jl
Zyhwcml2LCAweDM4LCAweDAwKTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDNCLCAweDAw
KTsKKwlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDM4LCAweDAwKTsKKworCWZvciAoaSA9IDA7
IGkgPCBzaXplb2YobGdzOGc3NV9pbml0ZGF0KTsgaSsrKSB7CisJCWxnczhneHhfd3JpdGVfcmVn
KHByaXYsIDB4MzgsIDB4MDApOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDNBLCAodTgp
KGkmMHhmZikpOworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweDNCLCAodTgpKGk+PjgpKTsK
KwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzQywgKnApOworCQlwKys7CisJfQorCisJbGdz
OGd4eF93cml0ZV9yZWcocHJpdiwgMHgzOCwgMHgwMCk7CisKKwlyZXR1cm4gMDsKK30KKwogc3Rh
dGljIGludCBsZ3M4Z3h4X2luaXQoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUpCiB7CiAJc3RydWN0
IGxnczhneHhfc3RhdGUgKnByaXYgPQpAQCAtNDQwLDYgKzY3Niw5IEBACiAJbGdzOGd4eF9yZWFk
X3JlZyhwcml2LCAwLCAmZGF0YSk7CiAJZHByaW50aygicmVnIDAgPSAweCUwMlhcbiIsIGRhdGEp
OwogCisJaWYgKGNvbmZpZy0+cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc3NSkKKwkJbGdzOGc3
NV9zZXRfYWRjX3ZwcChwcml2LCBjb25maWctPmFkY192cHApOworCiAJLyogU2V0dXAgTVBFRyBv
dXRwdXQgZm9ybWF0ICovCiAJZXJyID0gbGdzOGd4eF9zZXRfbXBlZ19tb2RlKHByaXYsIGNvbmZp
Zy0+c2VyaWFsX3RzLAogCQkJCSAgICBjb25maWctPnRzX2Nsa19wb2wsCkBAIC00NTAsOCArNjg5
LDcgQEAKIAlpZiAoY29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4OTEzKQogCQlsZ3M4
OTEzX2luaXQocHJpdik7CiAJbGdzOGd4eF9zZXRfaWZfZnJlcShwcml2LCBwcml2LT5jb25maWct
PmlmX2ZyZXEpOwotCWlmIChjb25maWctPnByb2QgIT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpCi0J
CWxnczhneHhfc2V0X2FkX21vZGUocHJpdik7CisJbGdzOGd4eF9zZXRfYWRfbW9kZShwcml2KTsK
IAogCXJldHVybiAwOwogfQpAQCAtNTA4LDEyICs3NDYsNiBAQAogc3RhdGljIGludCBsZ3M4Z3h4
X2dldF9mZShzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwKIAkJCSAgc3RydWN0IGR2Yl9mcm9udGVu
ZF9wYXJhbWV0ZXJzICpmZV9wYXJhbXMpCiB7Ci0Jc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYg
PSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKLQl1OCB0OwotI2lmIDAKLQlpbnQgdHJhbnNsYXRlZF9m
ZWMgPSBGRUNfMV8yOwotI2VuZGlmCi0KIAlkcHJpbnRrKCIlc1xuIiwgX19mdW5jX18pOwogCiAJ
LyogVE9ETzogZ2V0IHJlYWwgcmVhZGluZ3MgZnJvbSBkZXZpY2UgKi8KQEAgLTUyMyw0NyArNzU1
LDEwIEBACiAJLyogYmFuZHdpZHRoICovCiAJZmVfcGFyYW1zLT51Lm9mZG0uYmFuZHdpZHRoID0g
QkFORFdJRFRIXzhfTUhaOwogCi0KLQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4N0QsICZ0KTsK
LSNpZiAwCi0JLyogRkVDLiBObyBleGFjdCBtYXRjaCBmb3IgRE1CLVRILCBwaWNrIGFwcHJveC4g
dmFsdWUgKi8KLQlzd2l0Y2ggKHQgJiBMR1NfRkVDX01BU0spIHsKLQljYXNlICBMR1NfRkVDXzBf
NDogLyogRkVDIDAuNCAqLwotCQl0cmFuc2xhdGVkX2ZlYyA9IEZFQ18xXzI7Ci0JCWJyZWFrOwot
CWNhc2UgIExHU19GRUNfMF82OiAvKiBGRUMgMC42ICovCi0JCXRyYW5zbGF0ZWRfZmVjID0gRkVD
XzJfMzsKLQkJYnJlYWs7Ci0JY2FzZSAgTEdTX0ZFQ18wXzg6IC8qIEZFQyAwLjggKi8KLQkJdHJh
bnNsYXRlZF9mZWMgPSBGRUNfNV82OwotCQlicmVhazsKLQlkZWZhdWx0OgotCQl0cmFuc2xhdGVk
X2ZlYyA9IEZFQ18xXzI7Ci0JfQotCWZlX3BhcmFtcy0+dS5vZmRtLmNvZGVfcmF0ZV9IUCA9IHRy
YW5zbGF0ZWRfZmVjOwotCWZlX3BhcmFtcy0+dS5vZmRtLmNvZGVfcmF0ZV9MUCA9IHRyYW5zbGF0
ZWRfZmVjOwotI2VuZGlmCiAJZmVfcGFyYW1zLT51Lm9mZG0uY29kZV9yYXRlX0hQID0gRkVDX0FV
VE87CiAJZmVfcGFyYW1zLT51Lm9mZG0uY29kZV9yYXRlX0xQID0gRkVDX0FVVE87CiAKLQkvKiBj
b25zdGVsbGF0aW9uICovCi0Jc3dpdGNoICh0ICYgU0NfTUFTSykgewotCWNhc2UgU0NfUUFNNjQ6
Ci0JCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24gPSBRQU1fNjQ7Ci0JCWJyZWFrOwot
CWNhc2UgU0NfUUFNMzI6Ci0JCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24gPSBRQU1f
MzI7Ci0JCWJyZWFrOwotCWNhc2UgU0NfUUFNMTY6Ci0JCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0
ZWxsYXRpb24gPSBRQU1fMTY7Ci0JCWJyZWFrOwotCWNhc2UgU0NfUUFNNDoKLQljYXNlIFNDX1FB
TTROUjoKLQkJZmVfcGFyYW1zLT51Lm9mZG0uY29uc3RlbGxhdGlvbiA9IFFQU0s7Ci0JCWJyZWFr
OwotCWRlZmF1bHQ6Ci0JCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24gPSBRQU1fNjQ7
Ci0JfQorCWZlX3BhcmFtcy0+dS5vZmRtLmNvbnN0ZWxsYXRpb24gPSBRQU1fQVVUTzsKIAogCS8q
IHRyYW5zbWlzc2lvbiBtb2RlICovCiAJZmVfcGFyYW1zLT51Lm9mZG0udHJhbnNtaXNzaW9uX21v
ZGUgPSBUUkFOU01JU1NJT05fTU9ERV9BVVRPOwpAQCAtNTkyLDkgKzc4NywxOSBAQAogewogCXN0
cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7CiAJczggcmV0
OwotCXU4IHQ7CisJdTggdCwgbG9ja2VkID0gMDsKIAogCWRwcmludGsoIiVzXG4iLCBfX2Z1bmNf
Xyk7CisJKmZlX3N0YXR1cyA9IDA7CisKKwlsZ3M4Z3h4X2dldF9hZmNfcGhhc2UocHJpdik7CisJ
bGdzOGd4eF9pc19sb2NrZWQocHJpdiwgJmxvY2tlZCk7CisJaWYgKHByaXYtPmNvbmZpZy0+cHJv
ZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc3NSkgeworCQlpZiAobG9ja2VkKQorCQkJKmZlX3N0YXR1
cyB8PSBGRV9IQVNfU0lHTkFMIHwgRkVfSEFTX0NBUlJJRVIgfAorCQkJCUZFX0hBU19WSVRFUkJJ
IHwgRkVfSEFTX1NZTkMgfCBGRV9IQVNfTE9DSzsKKwkJcmV0dXJuIDA7CisJfQogCiAJcmV0ID0g
bGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDRCLCAmdCk7CiAJaWYgKHJldCAhPSAwKQpAQCAtNjk4
LDEyICs5MDMsMzMgQEAKIAlyZXR1cm4gMDsKIH0KIAorc3RhdGljIGludCBsZ3M4Zzc1X3JlYWRf
c2lnbmFsX3N0cmVuZ3RoKHN0cnVjdCBsZ3M4Z3h4X3N0YXRlICpwcml2LCB1MTYgKnNpZ25hbCkK
K3sKKwl1OCB0OworCXMxNiB2ID0gMDsKKworCWRwcmludGsoIiVzXG4iLCBfX2Z1bmNfXyk7CisK
KwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QjEsICZ0KTsKKwl2IHw9IHQ7CisJdiA8PD0gODsK
KwlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4QjAsICZ0KTsKKwl2IHw9IHQ7CisKKwkqc2lnbmFs
ID0gdjsKKwlkcHJpbnRrKCIlczogc2lnbmFsPTB4JTAyWFxuIiwgX19mdW5jX18sICpzaWduYWwp
OworCisJcmV0dXJuIDA7Cit9CisKIHN0YXRpYyBpbnQgbGdzOGd4eF9yZWFkX3NpZ25hbF9zdHJl
bmd0aChzdHJ1Y3QgZHZiX2Zyb250ZW5kICpmZSwgdTE2ICpzaWduYWwpCiB7CiAJc3RydWN0IGxn
czhneHhfc3RhdGUgKnByaXYgPSBmZS0+ZGVtb2R1bGF0b3JfcHJpdjsKIAogCWlmIChwcml2LT5j
b25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzg5MTMpCiAJCXJldHVybiBsZ3M4OTEzX3Jl
YWRfc2lnbmFsX3N0cmVuZ3RoKHByaXYsIHNpZ25hbCk7CisJZWxzZSBpZiAocHJpdi0+Y29uZmln
LT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KQorCQlyZXR1cm4gbGdzOGc3NV9yZWFkX3Np
Z25hbF9zdHJlbmd0aChwcml2LCBzaWduYWwpOwogCWVsc2UKIAkJcmV0dXJuIGxnczhneHhfcmVh
ZF9zaWduYWxfYWdjKHByaXYsIHNpZ25hbCk7CiB9CkBAIC03MTQsNyArOTQwLDEwIEBACiAJdTgg
dDsKIAkqc25yID0gMDsKIAotCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHg5NSwgJnQpOworCWlm
IChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhHNzUpCisJCWxnczhneHhf
cmVhZF9yZWcocHJpdiwgMHgzNCwgJnQpOworCWVsc2UKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2
LCAweDk1LCAmdCk7CiAJZHByaW50aygiQVZHIE5vaXNlPTB4JTAyWFxuIiwgdCk7CiAJKnNuciA9
IDI1NiAtIHQ7CiAJKnNuciA8PD0gODsKQEAgLTczMCwzMSArOTU5LDY4IEBACiAJcmV0dXJuIDA7
CiB9CiAKK3N0YXRpYyB2b2lkIHBhY2tldF9jb3VudGVyX3N0YXJ0KHN0cnVjdCBsZ3M4Z3h4X3N0
YXRlICpwcml2KQoreworCXU4IG9yaWcsIHQ7CisKKwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09
IExHUzhHWFhfUFJPRF9MR1M4Rzc1KSB7CisJCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHgzMCwg
Jm9yaWcpOworCQlvcmlnICY9IDB4RTc7CisJCXQgPSBvcmlnIHwgMHgxMDsKKwkJbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHgzMCwgdCk7CisJCXQgPSBvcmlnIHwgMHgxODsKKwkJbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHgzMCwgdCk7CisJCXQgPSBvcmlnIHwgMHgxMDsKKwkJbGdzOGd4eF93
cml0ZV9yZWcocHJpdiwgMHgzMCwgdCk7CisJfSBlbHNlIHsKKwkJbGdzOGd4eF93cml0ZV9yZWco
cHJpdiwgMHhDNiwgMHgwMSk7CisJCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4QzYsIDB4NDEp
OworCQlsZ3M4Z3h4X3dyaXRlX3JlZyhwcml2LCAweEM2LCAweDAxKTsKKwl9Cit9CisKK3N0YXRp
YyB2b2lkIHBhY2tldF9jb3VudGVyX3N0b3Aoc3RydWN0IGxnczhneHhfc3RhdGUgKnByaXYpCit7
CisJdTggdDsKKworCWlmIChwcml2LT5jb25maWctPnByb2QgPT0gTEdTOEdYWF9QUk9EX0xHUzhH
NzUpIHsKKwkJbGdzOGd4eF9yZWFkX3JlZyhwcml2LCAweDMwLCAmdCk7CisJCXQgJj0gMHhFNzsK
KwkJbGdzOGd4eF93cml0ZV9yZWcocHJpdiwgMHgzMCwgdCk7CisJfSBlbHNlIHsKKwkJbGdzOGd4
eF93cml0ZV9yZWcocHJpdiwgMHhDNiwgMHg4MSk7CisJfQorfQorCiBzdGF0aWMgaW50IGxnczhn
eHhfcmVhZF9iZXIoc3RydWN0IGR2Yl9mcm9udGVuZCAqZmUsIHUzMiAqYmVyKQogewogCXN0cnVj
dCBsZ3M4Z3h4X3N0YXRlICpwcml2ID0gZmUtPmRlbW9kdWxhdG9yX3ByaXY7Ci0JdTggcjAsIHIx
LCByMiwgcjM7Ci0JdTMyIHRvdGFsX2NudCwgZXJyX2NudDsKKwl1OCByZWdfZXJyLCByZWdfdG90
YWwsIHQ7CisJdTMyIHRvdGFsX2NudCA9IDAsIGVycl9jbnQgPSAwOworCWludCBpOwogCiAJZHBy
aW50aygiJXNcbiIsIF9fZnVuY19fKTsKIAotCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4YzYs
IDB4MDEpOwotCWxnczhneHhfd3JpdGVfcmVnKHByaXYsIDB4YzYsIDB4NDEpOwotCWxnczhneHhf
d3JpdGVfcmVnKHByaXYsIDB4YzYsIDB4MDEpOworCXBhY2tldF9jb3VudGVyX3N0YXJ0KHByaXYp
OworCW1zbGVlcCgyMDApOworCXBhY2tldF9jb3VudGVyX3N0b3AocHJpdik7CiAKLQltc2xlZXAo
MjAwKTsKKwlpZiAocHJpdi0+Y29uZmlnLT5wcm9kID09IExHUzhHWFhfUFJPRF9MR1M4Rzc1KSB7
CisJCXJlZ190b3RhbCA9IDB4Mjg7IHJlZ19lcnIgPSAweDJDOworCX0gZWxzZSB7CisJCXJlZ190
b3RhbCA9IDB4RDA7IHJlZ19lcnIgPSAweEQ0OworCX0KIAotCWxnczhneHhfd3JpdGVfcmVnKHBy
aXYsIDB4YzYsIDB4ODEpOwotCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhkMCwgJnIwKTsKLQls
Z3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDEsICZyMSk7Ci0JbGdzOGd4eF9yZWFkX3JlZyhwcml2
LCAweGQyLCAmcjIpOwotCWxnczhneHhfcmVhZF9yZWcocHJpdiwgMHhkMywgJnIzKTsKLQl0b3Rh
bF9jbnQgPSAocjMgPDwgMjQpIHwgKHIyIDw8IDE2KSB8IChyMSA8PCA4KSB8IChyMCk7Ci0JbGdz
OGd4eF9yZWFkX3JlZyhwcml2LCAweGQ0LCAmcjApOwotCWxnczhneHhfcmVhZF9yZWcocHJpdiwg
MHhkNSwgJnIxKTsKLQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIDB4ZDYsICZyMik7Ci0JbGdzOGd4
eF9yZWFkX3JlZyhwcml2LCAweGQ3LCAmcjMpOwotCWVycl9jbnQgPSAocjMgPDwgMjQpIHwgKHIy
IDw8IDE2KSB8IChyMSA8PCA4KSB8IChyMCk7CisJZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewor
CQl0b3RhbF9jbnQgPDw9IDg7CisJCWxnczhneHhfcmVhZF9yZWcocHJpdiwgcmVnX3RvdGFsKzMt
aSwgJnQpOworCQl0b3RhbF9jbnQgfD0gdDsKKwl9CisJZm9yIChpID0gMDsgaSA8IDQ7IGkrKykg
eworCQllcnJfY250IDw8PSA4OworCQlsZ3M4Z3h4X3JlYWRfcmVnKHByaXYsIHJlZ19lcnIrMy1p
LCAmdCk7CisJCWVycl9jbnQgfD0gdDsKKwl9CiAJZHByaW50aygiZXJyb3I9JWQgdG90YWw9JWRc
biIsIGVycl9jbnQsIHRvdGFsX2NudCk7CiAKIAlpZiAodG90YWxfY250ID09IDApCkBAIC04NDQs
NiArMTExMCw5IEBACiAJICAgICAgIHNpemVvZihzdHJ1Y3QgZHZiX2Zyb250ZW5kX29wcykpOwog
CXByaXYtPmZyb250ZW5kLmRlbW9kdWxhdG9yX3ByaXYgPSBwcml2OwogCisJaWYgKGNvbmZpZy0+
cHJvZCA9PSBMR1M4R1hYX1BST0RfTEdTOEc3NSkKKwkJbGdzOGc3NV9pbml0X2RhdGEocHJpdik7
CisKIAlyZXR1cm4gJnByaXYtPmZyb250ZW5kOwogCiBlcnJvcl9vdXQ6CmRpZmYgLXIgZDRlZDc1
NzU5Y2FlIGxpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL2Zyb250ZW5kcy9sZ3M4Z3h4LmgKLS0tIGEv
bGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xnczhneHguaAlUdWUgSnVuIDE2IDE5
OjAyOjEwIDIwMDkgLTAzMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRz
L2xnczhneHguaAlXZWQgSnVuIDE3IDEwOjU4OjM3IDIwMDkgKzA4MDAKQEAgLTEsOSArMSw5IEBA
CiAvKgotICogICAgU3VwcG9ydCBmb3IgTGVnZW5kIFNpbGljb24gRE1CLVRIIGRlbW9kdWxhdG9y
Ci0gKiAgICBMR1M4OTEzLCBMR1M4R0w1CisgKiAgICBTdXBwb3J0IGZvciBMZWdlbmQgU2lsaWNv
biBHQjIwNjAwIChhLmsuYSBETUItVEgpIGRlbW9kdWxhdG9yCisgKiAgICBMR1M4OTEzLCBMR1M4
R0w1LCBMR1M4Rzc1CiAgKiAgICBleHBlcmltZW50YWwgc3VwcG9ydCBMR1M4RzQyLCBMR1M4RzUy
CiAgKgotICogICAgQ29weXJpZ2h0IChDKSAyMDA3LDIwMDggRGF2aWQgVC5MLiBXb25nIDxkYXZp
ZHRsd29uZ0BnbWFpbC5jb20+CisgKiAgICBDb3B5cmlnaHQgKEMpIDIwMDctMjAwOSBEYXZpZCBU
LkwuIFdvbmcgPGRhdmlkdGx3b25nQGdtYWlsLmNvbT4KICAqICAgIENvcHlyaWdodCAoQykgMjAw
OCBTaXJpdXMgSW50ZXJuYXRpb25hbCAoSG9uZyBLb25nKSBMaW1pdGVkCiAgKiAgICBUaW1vdGh5
IExlZSA8dGltb3RoeS5sZWVAc2lyaXVzaGsuY29tPiAoZm9yIGluaXRpYWwgd29yayBvbiBMR1M4
R0w1KQogICoKQEAgLTM0LDYgKzM0LDcgQEAKICNkZWZpbmUgTEdTOEdYWF9QUk9EX0xHUzhHNDIg
MwogI2RlZmluZSBMR1M4R1hYX1BST0RfTEdTOEc1MiA0CiAjZGVmaW5lIExHUzhHWFhfUFJPRF9M
R1M4RzU0IDUKKyNkZWZpbmUgTEdTOEdYWF9QUk9EX0xHUzhHNzUgNgogCiBzdHJ1Y3QgbGdzOGd4
eF9jb25maWcgewogCkBAIC03MCw2ICs3MSwxMCBAQAogCS8qSUYgdXNlIE5lZ2F0aXZlIGNlbnRl
ciBmcmVxdWVuY3kqLwogCXU4IGlmX25lZ19jZW50ZXI7CiAKKwkvKjhHNzUgaW50ZXJuYWwgQURD
IGlucHV0IHJhbmdlIHNlbGVjdGlvbiovCisJLyowOiAwLjhWcHAsIDE6IDEuMFZwcCwgMjogMS42
VnBwLCAzOiAyLjBWcHAqLworCXU4IGFkY192cHA7CisKIAkvKiBzbGF2ZSBhZGRyZXNzIGFuZCBj
b25maWd1cmF0aW9uIG9mIHRoZSB0dW5lciAqLwogCXU4IHR1bmVyX2FkZHJlc3M7CiB9OwpkaWZm
IC1yIGQ0ZWQ3NTc1OWNhZSBsaW51eC9kcml2ZXJzL21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4
eF9wcml2LmgKLS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9kdmIvZnJvbnRlbmRzL2xnczhneHhf
cHJpdi5oCVR1ZSBKdW4gMTYgMTk6MDI6MTAgMjAwOSAtMDMwMAorKysgYi9saW51eC9kcml2ZXJz
L21lZGlhL2R2Yi9mcm9udGVuZHMvbGdzOGd4eF9wcml2LmgJV2VkIEp1biAxNyAxMDo1ODozNyAy
MDA5ICswODAwCkBAIC0xLDkgKzEsOSBAQAogLyoKLSAqICAgIFN1cHBvcnQgZm9yIExlZ2VuZCBT
aWxpY29uIERNQi1USCBkZW1vZHVsYXRvcgotICogICAgTEdTODkxMywgTEdTOEdMNQorICogICAg
U3VwcG9ydCBmb3IgTGVnZW5kIFNpbGljb24gR0IyMDYwMCAoYS5rLmEgRE1CLVRIKSBkZW1vZHVs
YXRvcgorICogICAgTEdTODkxMywgTEdTOEdMNSwgTEdTOEc3NQogICogICAgZXhwZXJpbWVudGFs
IHN1cHBvcnQgTEdTOEc0MiwgTEdTOEc1MgogICoKLSAqICAgIENvcHlyaWdodCAoQykgMjAwNywy
MDA4IERhdmlkIFQuTC4gV29uZyA8ZGF2aWR0bHdvbmdAZ21haWwuY29tPgorICogICAgQ29weXJp
Z2h0IChDKSAyMDA3LTIwMDkgRGF2aWQgVC5MLiBXb25nIDxkYXZpZHRsd29uZ0BnbWFpbC5jb20+
CiAgKiAgICBDb3B5cmlnaHQgKEMpIDIwMDggU2lyaXVzIEludGVybmF0aW9uYWwgKEhvbmcgS29u
ZykgTGltaXRlZAogICogICAgVGltb3RoeSBMZWUgPHRpbW90aHkubGVlQHNpcml1c2hrLmNvbT4g
KGZvciBpbml0aWFsIHdvcmsgb24gTEdTOEdMNSkKICAqCkBAIC0zOCw3ICszOCw3IEBACiAjZGVm
aW5lIFNDX1FBTTY0CTB4MTAJLyogNjRRQU0gbW9kdWxhdGlvbiAqLwogI2RlZmluZSBTQ19RQU0z
MgkweDBDCS8qIDMyUUFNIG1vZHVsYXRpb24gKi8KICNkZWZpbmUgU0NfUUFNMTYJMHgwOAkvKiAx
NlFBTSBtb2R1bGF0aW9uICovCi0jZGVmaW5lIFNDX1FBTTROUgkweDA0CS8qIDRRQU0gbW9kdWxh
dGlvbiAqLworI2RlZmluZSBTQ19RQU00TlIJMHgwNAkvKiA0UUFNLU5SIG1vZHVsYXRpb24gKi8K
ICNkZWZpbmUgU0NfUUFNNAkJMHgwMAkvKiA0UUFNIG1vZHVsYXRpb24gKi8KIAogI2RlZmluZSBM
R1NfRkVDX01BU0sJMHgwMwkvKiBGRUMgUmF0ZSBNYXNrICovCkBAIC00Nyw4ICs0Nyw4IEBACiAj
ZGVmaW5lIExHU19GRUNfMF84CTB4MDIJLyogRkVDIFJhdGUgMC44ICovCiAKICNkZWZpbmUgVElN
X01BU0sJICAweDIwCS8qIFRpbWUgSW50ZXJsZWF2ZSBMZW5ndGggTWFzayAqLwotI2RlZmluZSBU
SU1fTE9ORwkgIDB4MDAJLyogVGltZSBJbnRlcmxlYXZlIExlbmd0aCA9IDcyMCAqLwotI2RlZmlu
ZSBUSU1fTUlERExFICAgICAweDIwICAgLyogVGltZSBJbnRlcmxlYXZlIExlbmd0aCA9IDI0MCAq
LworI2RlZmluZSBUSU1fTE9ORwkgIDB4MjAJLyogVGltZSBJbnRlcmxlYXZlIExlbmd0aCA9IDcy
MCAqLworI2RlZmluZSBUSU1fTUlERExFICAgICAweDAwICAgLyogVGltZSBJbnRlcmxlYXZlIExl
bmd0aCA9IDI0MCAqLwogCiAjZGVmaW5lIENGX01BU0sJMHg4MAkvKiBDb250cm9sIEZyYW1lIE1h
c2sgKi8KICNkZWZpbmUgQ0ZfRU4JMHg4MAkvKiBDb250cm9sIEZyYW1lIE9uICovCg==
--00032557620ec6f4f4046c83db01--
