Return-path: <video4linux-list-bounces@redhat.com>
Received: from mx3.redhat.com (mx3.redhat.com [172.16.48.32])
	by int-mx1.corp.redhat.com (8.13.1/8.13.1) with ESMTP id mBF57BaT013484
	for <video4linux-list@redhat.com>; Mon, 15 Dec 2008 00:07:11 -0500
Received: from mail05.idc.renesas.com (mail.renesas.com [202.234.163.13])
	by mx3.redhat.com (8.13.8/8.13.8) with ESMTP id mBF56vQQ026520
	for <video4linux-list@redhat.com>; Mon, 15 Dec 2008 00:06:58 -0500
Date: Mon, 15 Dec 2008 14:06:51 +0900
From: morimoto.kuninori@renesas.com
In-reply-to: <Pine.LNX.4.64.0812132131410.10954@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Message-id: <umyeyuivo.wl%morimoto.kuninori@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <utz9bmtgn.wl%morimoto.kuninori@renesas.com>
	<Pine.LNX.4.64.0812132131410.10954@axis700.grange>
Cc: V4L-Linux <video4linux-list@redhat.com>
Subject: Re: [PATCH] Add tw9910 driver
List-Unsubscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=unsubscribe>
List-Archive: <https://www.redhat.com/mailman/private/video4linux-list>
List-Post: <mailto:video4linux-list@redhat.com>
List-Help: <mailto:video4linux-list-request@redhat.com?subject=help>
List-Subscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=subscribe>
Sender: video4linux-list-bounces@redhat.com
Errors-To: video4linux-list-bounces@redhat.com
List-ID: <video4linux-list@redhat.com>


Dear Guennadi

Thank you for checking my patch

> > +static const struct tw9910_scale_ctrl tw9910_pal_scales[] = {
> > +	{
> > +		.name   = "PAL SQ",
> > +		.width  = 768,
> > +		.height = 576,
> > +		.hscale = 0x0100,
> > +		.vscale = 0x0100,
> > +	},
(snip)
> At the moment there's no way to switch to any of these PAL norms, as 
> soc-camera doesn't support s_std yet. I suspect, we shall expect a patch 
> for that soon?:-)

? really ?
I can select PAL by mplayer.
icd->vdev->current_norm == V4L2_STD_PAL is works well on tw9910_select_norm.


> Now, this is the actual reason why I'd like an improved version of this 
> driver. Your try_fmt() method only limits frame width and height to lie 
> within a supported range. Your set_fmt() and set_bus_param() just return 
> 0. But here what you do in your tw9910_select_norm(), you check the 
> currently set width and height against a fixed set of your scales matching 
> various tv-norms, and if no exact match found you take default. This 
> means, it can happen, that a user requests a format, which you don't 
> support, you return no error on try_fmt and on s_fmt, but on streamon you 
> silently change it to your default... I think it would be better to check 
> requested format in your try_fmt() and select the nearest if no exact 
> match is found, perform your select_norm not in start_capture(), but in 
> set_fmt().

Yes. I can understand !!
I will fix try_fmt and start_capture function.

> > +start_capture_end:
> > +	priv->scale = NULL;
> > +	icd->vdev->current_norm = V4L2_STD_NTSC;
> 
> You probably do not want to do this in ok-case, although, it doesn't hurt 
> ATM - priv->scale is not used outside of this function, and current_norm 
> is anyway constant ATM, but you'll want to remove them as you move 
> configuration into set_fmt().

I think current_norm is able to changed to PAL or NTSC
by v4l2-ioctl :: VIDIOC_S_STD.
I can select it to PAL (and NTSC).

> > +	icd->formats     = &tw9910_color_fmt;
> > +	icd->num_formats = 1;
> 
> ...still better to use ARRAY_SIZE - costs nothing at runtime anyway.

OK thanks

Best regards
--
Kuninori Morimoto
 

--
video4linux-list mailing list
Unsubscribe mailto:video4linux-list-request@redhat.com?subject=unsubscribe
https://www.redhat.com/mailman/listinfo/video4linux-list
