Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-qw0-f46.google.com ([209.85.216.46]:63919 "EHLO
	mail-qw0-f46.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752306Ab1KBMC6 (ORCPT
	<rfc822;linux-media@vger.kernel.org>); Wed, 2 Nov 2011 08:02:58 -0400
Received: by qabj40 with SMTP id j40so75183qab.19
        for <linux-media@vger.kernel.org>; Wed, 02 Nov 2011 05:02:57 -0700 (PDT)
MIME-Version: 1.0
From: Sergio Otero Lopez <sergio.otero@gmail.com>
Date: Wed, 2 Nov 2011 13:02:36 +0100
Message-ID: <CAJBVG-KKbk3j=hpod9Xxn7=tvRrp8D5z3tYH11h3a_2LJ8f6TA@mail.gmail.com>
Subject: Updated unofficial driver for Pinnacle PCTV200e
To: Linux Media Mailing List <linux-media@vger.kernel.org>
Content-Type: multipart/mixed; boundary=bcaec520eaedac205604b0bf4087
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--bcaec520eaedac205604b0bf4087
Content-Type: text/plain; charset=ISO-8859-1

Hi

I've been using the driver posted in
http://linuxtv.org/wiki/index.php/Pinnacle_PCTV_200e a few years, but
it didn't compile with the last git repository, so i've made a few
changes:

 * Change "adap->fe" to "adap->fe_adap[0].fe"
 * Change "adap->priv" to "adap->fe_adap[0].priv"
 * Change "dvb_usb_device_properties" initialization to include
"{		.num_frontends = 1,		.fe = {{"

Making this changes, the drivers works perfectly.

I think it would be useful to update the linuxtv page with this
changes. I've attached the file.

Thanks

Sergio

--bcaec520eaedac205604b0bf4087
Content-Type: text/x-csrc; charset=US-ASCII; name="pctv200e.c"
Content-Disposition: attachment; filename="pctv200e.c"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_gui9yjtx0

LyoKICogRFZCIFVTQiBjb21wbGlhbnQgbGludXggZHJpdmVyIGZvciBQaW5uYWNsZSBQQ1RWIDIw
MGUgRFZCLVQgcmVjaWV2ZXIKICoKICogQ29weXJpZ2h0IChDKSAyMDA3IEpha29iIFN0ZWlkbCAo
amFrb2Iuc3RlaWRsQGdtYWlsLmNvbSkKICogICAgICAgICAgICAgICBiYXNlZCBvbiAgUGF0cmlj
ayBCb2V0dGNoZXIncyBkcml2ZXIgZm9yIHRoZSBOZWJ1bGEgRWxlY3Ryb25pY3MgdURpZ2lUVgog
KgogKgogKglUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogKgl1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZQogKglTb2Z0d2FyZSBG
b3VuZGF0aW9uLCB2ZXJzaW9uIDIuCiAqCiAqIHNlZSBEb2N1bWVudGF0aW9uL2R2Yi9SRUFETUUu
ZHZiLXVzYiBmb3IgbW9yZSBpbmZvcm1hdGlvbgogKi8KCi8vIG10MzUyIHJlZ2lzdGVycwojZGVm
aW5lIENMT0NLX0NUTAkJMHg4OQojZGVmaW5lIFJFU0VUCQkJMHg1MAojZGVmaW5lCUFDUV9DVEwg
ICAgICAgICAJMHg1MwojZGVmaW5lCVRSTF9OT01JTkFMX1JBVEVfMSAgCTB4NTQKI2RlZmluZQlJ
TlBVVF9GUkVRXzEgICAgCTB4NTYKI2RlZmluZQlVTktOT1dOXzMJICAgIAkweDVlCiNkZWZpbmUg
QUdDX1RBUkdFVAkJMHg2NwojZGVmaW5lIENBUFRfUkFOR0UJCTB4NzUKI2RlZmluZQlTTlJfU0VM
RUNUXzEgICAgCTB4NzkKI2RlZmluZSBVTktOT1dOXzEJCTB4N0IKI2RlZmluZQlTQ0FOX0NUTAkJ
MHg4OAojZGVmaW5lCU1DTEtfUkFUSU8JCTB4OEIKI2RlZmluZSBHUFBfQ1RMCQkJMHg4QwojZGVm
aW5lIEFEQ19DVExfMQkJMHg4RQojZGVmaW5lIFVOS05PV05fMgkJMHg5OAoKI2luY2x1ZGUgInBj
dHYyMDBlLmgiCgojaW5jbHVkZSAiZHZiLXVzYi5oIgojaW5jbHVkZSAibXQzNTIuaCIKI2luY2x1
ZGUgIm10MjA2MC5oIgojaW5jbHVkZSAibXQyMDYwX3ByaXYuaCIKCgoKLyogZGVidWcgKi8KLy8g
VG8gZW5hYmxlIHRoZSBkZWJ1ZyBzZXQgYSB2YWx1ZSAxIGZvciBkdmJfdXNiX3BjdHYyMDBlX2Rl
YnVnCmludCBkdmJfdXNiX3BjdHYyMDBlX2RlYnVnPTA7CnN0YXRpYyBpbnQgY3RybF9tc2dfbGFz
dF9kZXZpY2U9MDsKc3RhdGljIGludCBjdHJsX21zZ19sYXN0X29wZXJhdGlvbj0wOwoKc3RhdGlj
IHN0cnVjdCBtdDM1Ml9jb25maWcgcGN0djIwMGVfbXQzNTJfY29uZmlnOwpzdGF0aWMgc3RydWN0
IG10MjA2MF9jb25maWcgcGN0djIwMGVfbXQyMDYwX2NvbmZpZzsKCm1vZHVsZV9wYXJhbV9uYW1l
ZChkZWJ1ZyxkdmJfdXNiX3BjdHYyMDBlX2RlYnVnLCBpbnQsIDA2NDQpOwpNT0RVTEVfUEFSTV9E
RVNDKCBkZWJ1ZywgIlNldCBkZWJ1ZyBsZXZlbCAoMT1pbmZvLHhmZXI9MixyYz00IChSQyBpcyB0
aGUgY29kZXdvcmQgZm9yIEFMTCA7KSAofC1hYmxlKSkuIiBEVkJfVVNCX0RFQlVHX1NUQVRVUyAp
OwoKRFZCX0RFRklORV9NT0RfT1BUX0FEQVBURVJfTlIoYWRhcHRlcl9ucik7CgovKiBJMkMgKi8K
LyoKMDEgYzAgMDIgMDMgODAKIC0gIHJlcXVlc3QgdHlwZSAocmVhZDogMHgwMSwgd3JpdGU6IDB4
MDIpCiAgICAgLSBhZGRyIHRvIGJlIHJlYWQgb3Igd3JpdHRlbiAoMHhjMCAuLi4gdHVuZXIpCgkg
LSBudW1iZXIgb2Ygb2YgYml0cyB0aGF0IGZvbGxvdwoJICAgICAtIGp1c3QgZGF0YQoJCSAtIGRh
dGEgKG9wdGlvbmFsLCBpZiBudW1iZXIgZGF0YSA+MSkKKi8KCnN0YXRpYyBpbnQgcGN0djIwMGVf
Y3RybF9tc2coc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkLAoJCXU4IGFkZHIsIHU4IHJ3LCB1OCBy
ZWcsIHU4ICp3YnVmLCBpbnQgd2xlbiwgdTggKnJidWYsaW50IHJsZW4pCnsKCS8vIGF0bSwgIHU4
IHJ3IGlzIGJlaW5nIGlnbm9yZWQsIGl0IHNob3VsZCBiZSBjbGVhciBmcm9tIHRoZQoJaW50IHdv
ID0gKHJidWYgPT0gTlVMTCB8fCBybGVuID09IDApOyAvKiB0aGVuIGl0cyBhIHdyaXRlLW9ubHkq
LwoJaW50IGNvdW50ZXI7Cgl1OCBzbmRidWZbNV0scmN2YnVmWzY0XSA9IHsgMCB9OwovLwl1OCBz
bmRidWZbOF0scmN2YnVmWzVdOyAvKiBhY3R1YWxseSB3ZSBkb24ndCBrbm93IHRoZSBtYXguIGFu
c3dlciBsZW5naHQgLy95ZXQuLiAKCglpZiAod2xlbj42NCkgewoJCXdhcm4gKCJwY3R2MjAwZV9j
dHJsX21zZzogZmFpbGVkLCBjb21tYW5kIHRvbyBsb25nISIpOwoJCXJldHVybiAwOwoJfQoKCW1l
bXNldChzbmRidWYsMCw1KTsgbWVtc2V0KHJjdmJ1ZiwwLDY0KTsKCglpZiAoY3RybF9tc2dfbGFz
dF9kZXZpY2UgPT0gMCkgewoKLy8gVGhlIHZlcnkgZmlyc3QgdGltZSB3ZSBzZW5kIHRoZSBmb2xs
b3dpbmcgc2VxdWVuY2UgIjB4MTUgMHg4MCIgYW5kIHRoZW4gIjB4MTYgMHgwMCIKCQlzbmRidWZb
MF0gPSAweDE1OwoJCXNuZGJ1ZlsxXSA9IDB4ODA7CgkJZHZiX3VzYl9nZW5lcmljX3J3KGQsc25k
YnVmLDIscmN2YnVmLDY0LDQpOwoJCWlmIChkdmJfdXNiX3BjdHYyMDBlX2RlYnVnKSB7CgkJCXdh
cm4oImNydGxfbXNnKCkgd2xlbjogJWQsIHJsZW46ICVkLCBSRUFEOiAleCAleCAleCAleCAleCIs
d2xlbixybGVuLHNuZGJ1ZlswXSxzbmRidWZbMV0sc25kYnVmWzJdLHNuZGJ1ZlszXSxzbmRidWZb
NF0pOwoJCQl3YXJuKCJjcnRsX21zZygpIFJFQ0VJVkVEOiAleCAleCAleCAleCAleCAleCAleCAl
eCAleCAleCAleCAleCAleCIscmN2YnVmWzBdLHJjdmJ1ZlsxXSxyY3ZidWZbMl0scmN2YnVmWzNd
LHJjdmJ1Zls0XSxyY3ZidWZbNV0scmN2YnVmWzZdLHJjdmJ1Zls3XSxyY3ZidWZbOF0scmN2YnVm
WzldLHJjdmJ1ZlsxMF0scmN2YnVmWzExXSxyY3ZidWZbMTJdKTsKCgkJCXNuZGJ1ZlswXSA9IDB4
MTY7CgkJCXNuZGJ1ZlsxXSA9IDB4MDA7CgkJCWR2Yl91c2JfZ2VuZXJpY19ydyhkLHNuZGJ1Ziwy
LHJjdmJ1Ziw2NCw0KTsKCQkJd2FybigiY3J0bF9tc2coKSB3bGVuOiAlZCwgcmxlbjogJWQsIFJF
QUQ6ICV4ICV4ICV4ICV4ICV4Iix3bGVuLHJsZW4sc25kYnVmWzBdLHNuZGJ1ZlsxXSxzbmRidWZb
Ml0sc25kYnVmWzNdLHNuZGJ1Zls0XSk7CgkJCXdhcm4oImNydGxfbXNnKCkgUkVDRUlWRUQ6ICV4
ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4IixyY3ZidWZbMF0scmN2YnVmWzFd
LHJjdmJ1ZlsyXSxyY3ZidWZbM10scmN2YnVmWzRdLHJjdmJ1Zls1XSxyY3ZidWZbNl0scmN2YnVm
WzddLHJjdmJ1Zls4XSxyY3ZidWZbOV0scmN2YnVmWzEwXSxyY3ZidWZbMTFdLHJjdmJ1ZlsxMl0p
OwoJCX0KCX0gCgoJLy8gTm93IHN0YXJ0IHRvIGNoZWNrIHRoZSBsYXN0IG9wZXJhdGlvbiBhbmQg
c2VuZCB0aGUgaW50ZXJtZWRpdW0gc2VxdWVuY2UJCgkvLyBJZiB0aGUgY29tbWFuZCBpcyBzZW50
IHRvIHRoZSB0dW5lciBtdDIwNjAKCS8vIGZpcnN0IHdlIHNlbnQgdGhlIHNlcXVlbmNlICIweDE2
IDB4MDEiLCBhbmQgYmVsb3cgYWZ0ZXIgdGhlIGNvbW1hbmQKCS8vIHRoZW4gd2Ugc2VuZCB0aGUg
c2VxdWVuY2UgIjB4MTYgMHgwMCIuCgkvLyBUaGlzIGlzIG5vdCBuZWVkZWQgd2hlbiB0aGUgY29t
bWFuZCBnb2VzIHRvIHRoZSBkZW1vZCBtdDM1MgoKCWlmIChhZGRyID09IHBjdHYyMDBlX210MjA2
MF9jb25maWcuaTJjX2FkZHJlc3MgKSB7CgoJCXNuZGJ1ZlswXSA9IDB4MTY7CgkJc25kYnVmWzFd
ID0gMHgwMTsKCQlkdmJfdXNiX2dlbmVyaWNfcncoZCxzbmRidWYsMixyY3ZidWYsNjQsNCk7CgoJ
CWlmIChkdmJfdXNiX3BjdHYyMDBlX2RlYnVnKSB7CgkJCXdhcm4oImNydGxfbXNnKCkgd2xlbjog
JWQsIHJsZW46ICVkLCBSRUFEOiAleCAleCAleCAleCAleCIsd2xlbixybGVuLHNuZGJ1ZlswXSxz
bmRidWZbMV0sc25kYnVmWzJdLHNuZGJ1ZlszXSxzbmRidWZbNF0pOwoJCQl3YXJuKCJjcnRsX21z
ZygpIFJFQ0VJVkVEOiAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCIscmN2
YnVmWzBdLHJjdmJ1ZlsxXSxyY3ZidWZbMl0scmN2YnVmWzNdLHJjdmJ1Zls0XSxyY3ZidWZbNV0s
cmN2YnVmWzZdLHJjdmJ1Zls3XSxyY3ZidWZbOF0scmN2YnVmWzldLHJjdmJ1ZlsxMF0scmN2YnVm
WzExXSxyY3ZidWZbMTJdKTsKCQl9CgoJfQoKCXNuZGJ1ZlsxXSA9IGFkZHI7CgoJY3RybF9tc2df
bGFzdF9kZXZpY2UgPSBhZGRyOwoJLy8gV2Ugc3RvcmUgd2hvIHdoaWNoIGFkZHJlc3Mgd2FzIGFj
Y2VzcyAoREVNT0Qgb3IgVFVORVIpCi8vCW1lbWNweSgmc25kYnVmWzVdLHdidWYsd2xlbik7CgoJ
aWYgKHdvKSB7CgkJY3RybF9tc2dfbGFzdF9vcGVyYXRpb24gPSAweDAxOwoJCXNuZGJ1ZlswXSA9
IDB4MDE7CgkJc25kYnVmWzJdID0gMHgwMjsKCQlzbmRidWZbM10gPSByZWc7CgoJCS8vIFdlIGNv
bnZlcnQgbXVsdGlwbGUgd3JpdGVzIGludG8gc2luZ2xlIHdyaXRlcwoJCWZvciAoY291bnRlcj0w
OyBjb3VudGVyIDwgd2xlbjsgY291bnRlcisrKSB7CgkJCXNuZGJ1Zls0XSA9IHdidWZbY291bnRl
cl07CgoJCS8vIEZvciBQaW5uYWNsZSBjYXJkcyBpdCBzaG91bGQgYmUgc2VuZCAweGY0IGZvciBB
Q1FfQ1RMIGFzIG1lbnRpb25lZAoJCS8vIGluIG10MzUyLmMuIEF0IHRoaXMgbW9tZW50IHRoZSBt
dDM1Mi5jIHNlbmQgYnkgZGVmYXVsdCAweDUwLAoJCS8vIHNvIHdlIGludGVyY2VwdCBhbmQgY2hh
bmdlIHRoZSB2YWx1ZSBoZXJlLgoJCS8vIFRoaXMgd2F5IHdlIGRvbid0IG5lZWQgdG8gY2hhbmdl
ICBtdDM1Mi5jCgoJCQlpZiAoKGFkZHIgPT0gMHgzZSkgJiAoc25kYnVmWzNdID09IEFDUV9DVEwp
ICYgKHNuZGJ1Zls0XSA9PSAweDUwKSkgewoJCQkJaWYgKGR2Yl91c2JfcGN0djIwMGVfZGVidWcp
CgkJCQkJd2FybigiY3J0bF9tc2coKTogQ2hhbmdlZCBBQ1FfQ1RMIGNhbHVlIHRvIDB4ZjQhISEi
KTsKCQkJCXNuZGJ1Zls0XSA9IDB4ZjQ7CgkJCX0KCi8vCQkJbWVtY3B5KCZzbmRidWZbM10sd2J1
Zix3bGVuKTsKCQkJaWYgKGR2Yl91c2JfcGN0djIwMGVfZGVidWcpIHsKCQkJCXdhcm4oImNydGxf
bXNnKCkgd2xlbjogJWQsIHJsZW46ICVkLFdSSVRFOiAleCAleCAleCAleCAleCIsd2xlbixybGVu
LHNuZGJ1ZlswXSxzbmRidWZbMV0sc25kYnVmWzJdLHNuZGJ1ZlszXSxzbmRidWZbNF0pOwoJCQl9
CgoJCQlkdmJfdXNiX2dlbmVyaWNfcncoZCxzbmRidWYsNSxyY3ZidWYsNjQsNCk7CgoJCQlpZiAo
ZHZiX3VzYl9wY3R2MjAwZV9kZWJ1ZykgewoJCQkJd2FybigiY3J0bF9tc2coKSBSRUNFSVZFRDog
JXggJXggJXggJXggJXggJXggJXggJXggJXggJXggJXggJXggJXgiLHJjdmJ1ZlswXSxyY3ZidWZb
MV0scmN2YnVmWzJdLHJjdmJ1ZlszXSxyY3ZidWZbNF0scmN2YnVmWzVdLHJjdmJ1Zls2XSxyY3Zi
dWZbN10scmN2YnVmWzhdLHJjdmJ1Zls5XSxyY3ZidWZbMTBdLHJjdmJ1ZlsxMV0scmN2YnVmWzEy
XSk7CgkJCX0KCgkJCWlmIChyY3ZidWZbMF0gIT0gMHgxKSB7CgkJCXdhcm4oImNydGxfbXNnKCkg
V1JJVEUgRVJST1I6IHJldHVybmVkIGJ5dGUgWzBdIG5vdCAweDEiKTsKLy8JCQlyZXR1cm4gLUVJ
TzsKCQkJfQoKCQkJaWYgKHJjdmJ1ZlsxXSAhPSAweDApIHsKCQkJd2FybigiY3J0bF9tc2coKSBX
UklURSBFUlJPUjogcmV0dXJuZWQgZXJyb3IhIik7Ci8vCQkJcmV0dXJuIC1FSU87CgkJCX0KCQkJ
Ly8gaXQgaXMgd3JpdGVfcmVncywgc28gd2UgaW5jcmVtZW50IHRoZSByZWdpc3RlciB2YWx1ZQoJ
CQlzbmRidWZbM10gPSBzbmRidWZbM10rMTsKCQl9CgoJfSBlbHNlIHsKCQljdHJsX21zZ19sYXN0
X29wZXJhdGlvbiA9IDB4MDI7CgkJc25kYnVmWzBdID0gMHgwMjsKCQlzbmRidWZbMl0gPSAweDAx
OwoJCXNuZGJ1ZlszXSA9IDB4MDE7CgkJc25kYnVmWzRdID0gcmVnOwoKCQlpZiAoZHZiX3VzYl9w
Y3R2MjAwZV9kZWJ1ZykgewoJCQl3YXJuKCJjcnRsX21zZygpIHdsZW46ICVkLCBybGVuOiAlZCwg
UkVBRDogJXggJXggJXggJXggJXgiLHdsZW4scmxlbixzbmRidWZbMF0sc25kYnVmWzFdLHNuZGJ1
ZlsyXSxzbmRidWZbM10sc25kYnVmWzRdKTsKCQl9CgoJCWR2Yl91c2JfZ2VuZXJpY19ydyhkLHNu
ZGJ1Ziw1LHJjdmJ1Ziw2NCw0KTsKCgkJaWYgKHJsZW4gPiAwKSB7CgkJCW1lbWNweShyYnVmLCZy
Y3ZidWZbMl0scmxlbik7CgkJfQoKCQlpZiAoZHZiX3VzYl9wY3R2MjAwZV9kZWJ1ZykgewoJCQl3
YXJuKCJjcnRsX21zZygpIFJFQ0VJVkVEOiAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAl
eCAleCAleCIscmN2YnVmWzBdLHJjdmJ1ZlsxXSxyY3ZidWZbMl0scmN2YnVmWzNdLHJjdmJ1Zls0
XSxyY3ZidWZbNV0scmN2YnVmWzZdLHJjdmJ1Zls3XSxyY3ZidWZbOF0scmN2YnVmWzldLHJjdmJ1
ZlsxMF0scmN2YnVmWzExXSxyY3ZidWZbMTJdKTsKCQl9Cgl9CgoJaWYgKGFkZHIgPT0gcGN0djIw
MGVfbXQyMDYwX2NvbmZpZy5pMmNfYWRkcmVzcyApIHsKCgkJc25kYnVmWzBdID0gMHgxNjsKCQlz
bmRidWZbMV0gPSAweDAwOwoJCWR2Yl91c2JfZ2VuZXJpY19ydyhkLHNuZGJ1ZiwyLHJjdmJ1Ziw2
NCw0KTsKCgkJaWYgKGR2Yl91c2JfcGN0djIwMGVfZGVidWcpIHsKCQkJd2FybigiY3J0bF9tc2co
KSB3bGVuOiAlZCwgcmxlbjogJWQsIFJFQUQ6ICV4ICV4ICV4ICV4ICV4Iix3bGVuLHJsZW4sc25k
YnVmWzBdLHNuZGJ1ZlsxXSxzbmRidWZbMl0sc25kYnVmWzNdLHNuZGJ1Zls0XSk7CgkJCXdhcm4o
ImNydGxfbXNnKCkgUkVDRUlWRUQ6ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4ICV4
ICV4IixyY3ZidWZbMF0scmN2YnVmWzFdLHJjdmJ1ZlsyXSxyY3ZidWZbM10scmN2YnVmWzRdLHJj
dmJ1Zls1XSxyY3ZidWZbNl0scmN2YnVmWzddLHJjdmJ1Zls4XSxyY3ZidWZbOV0scmN2YnVmWzEw
XSxyY3ZidWZbMTFdLHJjdmJ1ZlsxMl0pOwoJCX0KCgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBp
bnQgcGN0djIwMGVfY21kX21zZyhzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmQsIHU4ICp3YnVmLCBp
bnQgd2xlbikKewoJdTggc25kYnVmWzY0XSA9IHsgMCB9OwoJdTggcmN2YnVmWzY0XSA9IHsgMCB9
OwovLwl1OCBzbmRidWZbOF0scmN2YnVmWzVdOyAvKiBhY3R1YWxseSB3ZSBkb24ndCBrbm93IHRo
ZSBtYXguIGFuc3dlciBsZW5naHQgLy95ZXQuLiAqLwoJaWYgKHdsZW4+NjQpIHsKCQl3YXJuICgi
cGN0djIwMGVfY21kX21zZzogZmFpbGVkLCBjb21tYW5kIHRvbyBsb25nISIpOwoJCXJldHVybiAw
OwoJfQoJbWVtc2V0KHNuZGJ1ZiwwLDY0KTsgbWVtc2V0KHJjdmJ1ZiwwLDY0KTsKCW1lbWNweShz
bmRidWYsd2J1Zix3bGVuKTsKCglpZiAoZHZiX3VzYl9wY3R2MjAwZV9kZWJ1ZykKCQl3YXJuKCJj
bWRfbXNnKCkgd2xlbjogJWQsIFdSSVRFOiAleCAleCAleCAleCAleCIsd2xlbixzbmRidWZbMF0s
c25kYnVmWzFdLHNuZGJ1ZlsyXSxzbmRidWZbM10sc25kYnVmWzRdKTsKCglkdmJfdXNiX2dlbmVy
aWNfcncoZCxzbmRidWYsd2xlbixyY3ZidWYsNjQsNCk7CgoJaWYgKHJjdmJ1ZlsxXSAhPSAweDAw
KSB7CgkJd2FybigiY3J0bF9tc2coKSBXUklURSBFUlJPUjogcmV0dXJuZWQgZXJyb3IhIik7Cgl9
CgoJaWYgKGR2Yl91c2JfcGN0djIwMGVfZGVidWcpCgkJd2FybigiY21kX21zZygpIFJFQ0VJVkVE
OiAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCAleCIscmN2YnVmWzBdLHJjdmJ1
ZlsxXSxyY3ZidWZbMl0scmN2YnVmWzNdLHJjdmJ1Zls0XSxyY3ZidWZbNV0scmN2YnVmWzZdLHJj
dmJ1Zls3XSxyY3ZidWZbOF0scmN2YnVmWzldLHJjdmJ1ZlsxMF0scmN2YnVmWzExXSxyY3ZidWZb
MTJdKTsKCglyZXR1cm4gMDsKfQoKCnN0YXRpYyBpbnQgcGN0djIwMGVfaTJjX3hmZXIoc3RydWN0
IGkyY19hZGFwdGVyICphZGFwLHN0cnVjdCBpMmNfbXNnIG1zZ1tdLGludCBudW0pCnsKCXN0cnVj
dCBkdmJfdXNiX2RldmljZSAqZCA9IGkyY19nZXRfYWRhcGRhdGEoYWRhcCk7CglpbnQgaTsKCglp
ZiAobXV0ZXhfbG9ja19pbnRlcnJ1cHRpYmxlKCZkLT5pMmNfbXV0ZXgpIDwgMCkKCQlyZXR1cm4g
LUVBR0FJTjsKCglpZiAobnVtID4gMikKCQl3YXJuKCJtb3JlIHRoYW4gMiBpMmMgbWVzc2FnZXMg
YXQgYSB0aW1lIGlzIG5vdCBoYW5kbGVkIHlldC4gVE9ETy4iKTsKCglmb3IgKGkgPSAwOyBpIDwg
bnVtOyBpKyspIHsKCQkvKiB3cml0ZS9yZWFkIHJlcXVlc3QgKi8KCQlpZiAoaSsxIDwgbnVtICYm
IChtc2dbaSsxXS5mbGFncyAmIEkyQ19NX1JEKSkgewoJCQlpZiAocGN0djIwMGVfY3RybF9tc2co
ZCwgbXNnW2ldLmFkZHIsVVNCX1JFQUQsIG1zZ1tpXS5idWZbMF0sIE5VTEwsIDAsIG1zZ1tpKzFd
LmJ1Zixtc2dbaSsxXS5sZW4pIDwgMCkKCQkJCWJyZWFrOwoJCQlpKys7CgkJfSBlbHNlCgkJCWlm
IChwY3R2MjAwZV9jdHJsX21zZyhkLG1zZ1tpXS5hZGRyLFVTQl9XUklURSwgbXNnW2ldLmJ1Zlsw
XSwmbXNnW2ldLmJ1ZlsxXSxtc2dbaV0ubGVuLTEsTlVMTCwwKSA8IDApCgkJCQlicmVhazsKCX0K
CgltdXRleF91bmxvY2soJmQtPmkyY19tdXRleCk7CglpZiAoZHZiX3VzYl9wY3R2MjAwZV9kZWJ1
ZykKCQl3YXJuKCJwY3R2MjAwZV9pMmNfeGZlcigpIGNhbGxlZC4iKTsKCXJldHVybiBpOwp9Cgpz
dGF0aWMgdTMyIHBjdHYyMDBlX2kyY19mdW5jKHN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcikK
ewoJd2FybiAoInBjdHYyMDBlX2kyY19mdW5jOiBlbnRlcmluZywgZG9uZSBub3RoaW5nIik7Cgly
ZXR1cm4gSTJDX0ZVTkNfSTJDOwp9CgpzdGF0aWMgc3RydWN0IGkyY19hbGdvcml0aG0gcGN0djIw
MGVfaTJjX2FsZ28gPSB7CgkubWFzdGVyX3hmZXIgICA9IHBjdHYyMDBlX2kyY194ZmVyLAoJLmZ1
bmN0aW9uYWxpdHkgPSBwY3R2MjAwZV9pMmNfZnVuYywKfTsKCi8qIENhbGxiYWNrcyBmb3IgRFZC
IFVTQiAqLwpzdGF0aWMgaW50IHBjdHYyMDBlX2lkZW50aWZ5X3N0YXRlIChzdHJ1Y3QgdXNiX2Rl
dmljZSAqdWRldiwgc3RydWN0CgkJZHZiX3VzYl9kZXZpY2VfcHJvcGVydGllcyAqcHJvcHMsIHN0
cnVjdCBkdmJfdXNiX2RldmljZV9kZXNjcmlwdGlvbiAqKmRlc2MsCgkJaW50ICpjb2xkKQp7Cgkq
Y29sZCA9IHVkZXYtPmRlc2NyaXB0b3IuaU1hbnVmYWN0dXJlciA9PSAwICYmIHVkZXYtPmRlc2Ny
aXB0b3IuaVByb2R1Y3QgPT0gMDsKCXJldHVybiAwOwp9Ci8vIHByb2JhYmx5IHRoaXMgbmVlZHMg
dG8gYmUgY2hhbmdlZC4Kc3RhdGljIGludCBwY3R2MjAwZV9tdDM1Ml9kZW1vZF9pbml0KHN0cnVj
dCBkdmJfZnJvbnRlbmQgKmZlKQp7Ci8vCVdlIGltcGxlbWVudCB0aGUgUkVTRVQgc2VxdWVuY2Ug
Zm9yIHRoZSBkZW1vZCBtdDM1MgoJc3RhdGljIHU4IGNsb2NrX2NvbmZpZyBbXSAgPSB7IENMT0NL
X0NUTCwgIDB4YmQsIDB4MjggfTsKCXN0YXRpYyB1OCByZXNldCBbXSAgICAgICAgID0geyBSRVNF
VCwgICAgICAweDgwIH07CglzdGF0aWMgdTggcmVzZXRfc3RvcCBbXSAgICA9IHsgUkVTRVQsICAg
ICAgMHgwMCB9OwoJc3RhdGljIHU4IGFkY19jdGxfMV9jZmcgW10gPSB7IEFEQ19DVExfMSwgIDB4
NDAgfTsKCXN0YXRpYyB1OCBhZ2NfY2ZnIFtdICAgICAgID0geyBBR0NfVEFSR0VULCAweDFjIH07
Ci8vCXN0YXRpYyB1OCBncHBfY3RsX2NmZyBbXSAgID0geyBHUFBfQ1RMLCAgICAweDMzIH07Cglz
dGF0aWMgdTggY2FwdF9yYW5nZV9jZmdbXSA9IHsgQ0FQVF9SQU5HRSwgMHgzMCB9OwoKCXN0YXRp
YyB1OCBpbnB1dF9mcmVxW10gICAgICAgID0geyBJTlBVVF9GUkVRXzEsIDB4MzEsIDB4YjUgfTsK
CXN0YXRpYyB1OCBjbG9ja19yYXRpb1tdICAgICAgID0geyBNQ0xLX1JBVElPLCAweDAwIH07Cglz
dGF0aWMgdTggc2Nhbl9jdGxbXSAgICAgICAgICA9IHsgU0NBTl9DVEwsIDB4MGQgfTsKCXN0YXRp
YyB1OCB1bmtub3duXzFbXSAgICAgICAgID0geyBVTktOT1dOXzEsIDB4MDQgfTsKCglzdGF0aWMg
dTggYWNxX2N0bFtdICAgICAgICAgICA9IHsgQUNRX0NUTCwgMHhmNCB9OwoKCXN0YXRpYyB1OCB0
cmxfbm9taW5hbF9yYXRlW10gID0geyBUUkxfTk9NSU5BTF9SQVRFXzEsIDB4NzMsIDB4MWMgfTsK
CglzdGF0aWMgdTggdW5rbm93bl8yW10gID0geyBVTktOT1dOXzIsIDB4MDAsIDB4MDAsIDB4ODAs
IDB4MjAsIDB4ODAsIDB4ODAsIDB4NTUsIDB4NjIsIDB4MDAgfTsKCglzdGF0aWMgdTggdW5rbm93
bl8zW10gID0geyBVTktOT1dOXzMsIDB4MDEgfTsKCi8vCXN0YXRpYyB1OCBzbnJfc2VsZWN0XzFb
XSAgPSB7IFNOUl9TRUxFQ1RfMSwgMHgyMCwgMHgwMCB9OwoKCW10MzUyX3dyaXRlKGZlLCBjbG9j
a19jb25maWcsICAgc2l6ZW9mKGNsb2NrX2NvbmZpZykpOwoJdWRlbGF5KDEwMDApOwoJbXQzNTJf
d3JpdGUoZmUsIHJlc2V0LCAgICAgICAgICBzaXplb2YocmVzZXQpKTsKCW10MzUyX3dyaXRlKGZl
LCByZXNldF9zdG9wLCAgICAgc2l6ZW9mKHJlc2V0X3N0b3ApKTsKCgltdDM1Ml93cml0ZShmZSwg
YWRjX2N0bF8xX2NmZywgIHNpemVvZihhZGNfY3RsXzFfY2ZnKSk7CgltdDM1Ml93cml0ZShmZSwg
aW5wdXRfZnJlcSwgICAgIHNpemVvZihpbnB1dF9mcmVxKSk7CgltdDM1Ml93cml0ZShmZSwgY2xv
Y2tfcmF0aW8sICAgIHNpemVvZihjbG9ja19yYXRpbykpOwoJbXQzNTJfd3JpdGUoZmUsIHNjYW5f
Y3RsLCAgICAgICBzaXplb2Yoc2Nhbl9jdGwpKTsKCgltdDM1Ml93cml0ZShmZSwgdW5rbm93bl8x
LCAgICAgIHNpemVvZih1bmtub3duXzEpKTsKCgltdDM1Ml93cml0ZShmZSwgYWNxX2N0bCwgICAg
ICAgICAgc2l6ZW9mKGFjcV9jdGwpKTsKCW10MzUyX3dyaXRlKGZlLCBjYXB0X3JhbmdlX2NmZywg
ICBzaXplb2YoY2FwdF9yYW5nZV9jZmcpKTsKCW10MzUyX3dyaXRlKGZlLCBhZ2NfY2ZnLCAgICAg
ICAgICBzaXplb2YoYWdjX2NmZykpOwoJbXQzNTJfd3JpdGUoZmUsIHRybF9ub21pbmFsX3JhdGUs
IHNpemVvZih0cmxfbm9taW5hbF9yYXRlKSk7CgoJbXQzNTJfd3JpdGUoZmUsIHVua25vd25fMiwg
ICAgICBzaXplb2YodW5rbm93bl8yKSk7CgltdDM1Ml93cml0ZShmZSwgdW5rbm93bl8zLCAgICAg
IHNpemVvZih1bmtub3duXzMpKTsKCi8vCW10MzUyX3dyaXRlKGZlLCBzbnJfc2VsZWN0XzEsICAg
c2l6ZW9mKHNucl9zZWxlY3RfMSkpOwovLwltdDM1Ml93cml0ZShmZSwgZ3BwX2N0bF9jZmcsICAg
IHNpemVvZihncHBfY3RsX2NmZykpOwoKCXdhcm4gKCJQQ1RWMjAwZSBpbml0aWFsaXplZCBtdDM1
MiIpOwoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBzdHJ1Y3QgbXQzNTJfY29uZmlnIHBjdHYyMDBlX210
MzUyX2NvbmZpZyA9IHsKCS5kZW1vZF9hZGRyZXNzID0gMHgzZSwKCS5kZW1vZF9pbml0ICAgID0g
cGN0djIwMGVfbXQzNTJfZGVtb2RfaW5pdCwKCS5ub190dW5lciAgICAgID0gMSwKCS5hZGNfY2xv
Y2sgICAgID0gMjAzMzMsCgkuaWYyICAgICAgICAgICA9IDU2NDY4LAp9OwoKc3RhdGljIHN0cnVj
dCBtdDIwNjBfY29uZmlnIHBjdHYyMDBlX210MjA2MF9jb25maWcgPSB7CgkuaTJjX2FkZHJlc3Mg
PSAweGMwLAoJLmNsb2NrX291dCAgID0gMSwKfTsKCnN0YXRpYyBpbnQgcGN0djIwMGVfbXQyMDYw
X3R1bmVyX3NldF9wYXJhbXMgKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLCBzdHJ1Y3QgZHZiX2Zy
b250ZW5kX3BhcmFtZXRlcnMgKmZlcCkKewoJc3RydWN0IGR2Yl91c2JfYWRhcHRlciAqYWRhcCA9
IGZlLT5kdmItPnByaXY7CglzdHJ1Y3QgcGN0djIwMGVfYWRhcHRlcl9zdGF0ZSAqc3RhdGUgPSBh
ZGFwLT5mZV9hZGFwWzBdLnByaXY7CgoJd2FybiAoInBjdHYyMDBlX210MjA2MF90dW5lcl9zZXRf
cGFyYW1zOiBzZXR0aW5nIHBhcmFtZXRlcnMhIik7CgovLwlvcHMtPnR1bmVyX29wcy5zZXRfcGFy
YW1zIChvcHMsZmVwKTsKCWlmIChzdGF0ZSA9PSBOVUxMKSB3YXJuICgiSnVhbjogU1RBVEUgcG9p
bnRlciBpcyBOVUxMISEhISIpOwoJcmV0dXJuIHN0YXRlLT5zZXRfcGFyYW1fc2F2ZShmZSwgZmVw
KTsKfQoKc3RhdGljIHUxNiBpZjEgPSAxMjIwOyAvLyB0aGlzIGlzIHByb2JhYmx5IHdyb25nLCBi
dXQgd2UgbmVlZCBzb21lIHZhbHVlIHRvIGNvbXBpbGUgdGhpcyBzaGl0ZQoKCi8vIHNvdXJjZSAo
Zm9yIHRoZSB0dW5lciBhdHRhY2g6IGRpYnVzYi1jb21tb24uYykKc3RhdGljIGludCBwY3R2MjAw
ZV9mcm9udGVuZF9hdHRhY2ggKHN0cnVjdCBkdmJfdXNiX2FkYXB0ZXIgKmFkYXApCnsKCglzdGF0
aWMgdTggY21kX2J1ZjNbXSA9IHsgMHgxMCwgMHhFRH07CglzdGF0aWMgdTggY21kX2J1ZjRbXSA9
IHsgMHgxMSwgMHg0MX07CglzdGF0aWMgdTggY21kX2J1ZjVbXSA9IHsgMHgxMiwgMHgwMX07Cgkv
LyBTZW5kaW5nICIweDE4IDB4MDEiIHR1cm5zIHRoZSBhbnRlbm5hIHBvd2VyIG9uCgkvLyBTZW5k
aW5nICIweDE4IDB4MDAiIHR1cm5zIHRoZSBhbnRlbm5hIHBvd2VyIG9mZgoJc3RhdGljIHU4IGNt
ZF9idWY2W10gPSB7IDB4MTgsIDB4MDF9OwoKCWlmICgoYWRhcC0+ZmVfYWRhcFswXS5mZSA9IGR2
Yl9hdHRhY2ggKG10MzUyX2F0dGFjaCwgJnBjdHYyMDBlX210MzUyX2NvbmZpZywgJmFkYXAtPmRl
di0+aTJjX2FkYXApKSAhPSBOVUxMKSB7Ci8vCQlhZGFwLT5mZS0+b3BzLnR1bmVyX29wcy5jYWxj
X3JlZ3MgPSBkdmJfdXNiX3R1bmVyX2NhbGNfcmVnczsKCQl3YXJuKCJhdHRhY2hpbmcgYW5kIGlu
aXRpYWxpemluZyBtdDM1MiBmcm9udGVuZC4iKTsKLy8JCXBjdHYyMDBlX2NtZF9tc2coYWRhcC0+
ZGV2LCBjbWRfYnVmMSwgc2l6ZW9mKGNtZF9idWYxKSk7CgkJcGN0djIwMGVfbXQzNTJfZGVtb2Rf
aW5pdCAoYWRhcC0+ZmVfYWRhcFswXS5mZSk7CgkJLy8gU2VuZCwgbWF5YmUgaXMgc3RhcnQgY29t
bWFuZD8KLy8JCXBjdHYyMDBlX2NtZF9tc2coYWRhcC0+ZGV2LCBjbWRfYnVmMSwgc2l6ZW9mKGNt
ZF9idWYxKSk7Ci8vCQlwY3R2MjAwZV9jbWRfbXNnKGFkYXAtPmRldiwgY21kX2J1ZjIsIHNpemVv
ZihjbWRfYnVmMikpOwoJCXBjdHYyMDBlX2NtZF9tc2cgKGFkYXAtPmRldiwgY21kX2J1ZjMsIHNp
emVvZihjbWRfYnVmMykpOwoJCXBjdHYyMDBlX2NtZF9tc2cgKGFkYXAtPmRldiwgY21kX2J1ZjQs
IHNpemVvZihjbWRfYnVmNCkpOwoJCXBjdHYyMDBlX2NtZF9tc2cgKGFkYXAtPmRldiwgY21kX2J1
ZjUsIHNpemVvZihjbWRfYnVmNSkpOwoJCXBjdHYyMDBlX2NtZF9tc2cgKGFkYXAtPmRldiwgY21k
X2J1ZjYsIHNpemVvZihjbWRfYnVmNikpOwovLwkJcGN0djIwMGVfY21kX21zZyhhZGFwLT5kZXYs
IGNtZF9idWYxLCBzaXplb2YoY21kX2J1ZjEpKTsKCgkJd2FybiAoIm10MzUyIGZyb250ZW5kIGF0
dGFjaGVkLiIpOwoJCXJldHVybiAwOwoJfSAKCgl3YXJuICgiZmFpbGVkIGF0dGFjaGluZyBmcm9u
dGVuZCBtdDM1Mi4iKTsKCXJldHVybiAtRUlPOwp9CgpzdGF0aWMgaW50IHBjdHYyMDBlX3R1bmVy
X2F0dGFjaCAoc3RydWN0IGR2Yl91c2JfYWRhcHRlciAqYWRhcCkKewoJc3RydWN0IHBjdHYyMDBl
X2FkYXB0ZXJfc3RhdGUgKnN0ID0gYWRhcC0+ZmVfYWRhcFswXS5wcml2OwovLwlhZGFwLT5mZS0+
b3BzLnR1bmVyX29wcy5mZSA9IGFkYXAtPmZlOwoKLy8JaWYgKChhZGFwLT5mZSA9IGR2Yl9hdHRh
Y2gobXQyMDYwX2F0dGFjaCwgJmFkYXAtPmZlLT5vcHMudHVuZXJfb3BzLCAKCWlmICgoZHZiX2F0
dGFjaChtdDIwNjBfYXR0YWNoLCBhZGFwLT5mZV9hZGFwWzBdLmZlLCAmYWRhcC0+ZGV2LT5pMmNf
YWRhcCwgJnBjdHYyMDBlX210MjA2MF9jb25maWcsIGlmMSkpICE9IE5VTEwpIHsKLy8JCWFkYXAt
PmZlLT5vcHMudHVuZXJfb3BzLmZlID0gYWRhcC0+ZmU7Ci8vCQlhZGFwLT5mZS0+b3BzLnR1bmVy
X29wcy5zZXRfcGFyYW1zID0gcGN0djIwMGVfbXQyMDYwX3R1bmVyX3NldF9wYXJhbXM7Ci8vCQlh
ZGFwLT5wbGxfYWRkciA9IDB4YzA7Ci8vCQlhZGFwLT5wbGxfZGVzYyA9ICZkdmJfcGxsX3RkZWQ0
OwoJCXdhcm4oInR1bmVyIG10MjA2MCBhdHRhY2hlZC4iKTsKCQkKCQl3YXJuKCJ0dW5lciBtdDIw
NjAgc2V0X3BhcmFtcyBzdGFydGluZy4iKTsKCQlzdC0+c2V0X3BhcmFtX3NhdmUgPSBhZGFwLT5m
ZV9hZGFwWzBdLmZlLT5vcHMudHVuZXJfb3BzLnNldF9wYXJhbXM7CgkJYWRhcC0+ZmVfYWRhcFsw
XS5mZS0+b3BzLnR1bmVyX29wcy5zZXRfcGFyYW1zID0gcGN0djIwMGVfbXQyMDYwX3R1bmVyX3Nl
dF9wYXJhbXM7CgkJd2FybigidHVuZXIgbXQyMDYwIHNldF9wYXJhbXMgcGFzc2VkLiIpOwoJCXJl
dHVybiAwOwoJfQoKCXdhcm4oImZhaWxlZCBhdHRhY2hpbmcgZnJvbnRlbmRfYXR0YWNoIChtdDIw
NjApIik7CgoJcmV0dXJuIC1FSU87Cn0KCi8vIGN1cnJlbnRseSBub3QgYWltIG9mIG15IG1pc3Np
b24KI2lmIDAKCnN0YXRpYyBzdHJ1Y3QgZHZiX3VzYl9yY19rZXkgcGN0djIwMGVfcmNfa2V5c1td
ID0gewoJeyAweDVmLCAweDU1LCBLRVlfMCB9LAoJeyAweDZmLCAweDU1LCBLRVlfMSB9LAoJeyAw
eDlmLCAweDU1LCBLRVlfMiB9LAoJeyAweGFmLCAweDU1LCBLRVlfMyB9LAoJeyAweDVmLCAweDU2
LCBLRVlfNCB9LAoJeyAweDZmLCAweDU2LCBLRVlfNSB9LAoJeyAweDlmLCAweDU2LCBLRVlfNiB9
LAoJeyAweGFmLCAweDU2LCBLRVlfNyB9LAoJeyAweDVmLCAweDU5LCBLRVlfOCB9LAoJeyAweDZm
LCAweDU5LCBLRVlfOSB9LAoJeyAweDlmLCAweDU5LCBLRVlfVFYgfSwKCXsgMHhhZiwgMHg1OSwg
S0VZX0FVWCB9LAoJeyAweDVmLCAweDVhLCBLRVlfRFZEIH0sCgl7IDB4NmYsIDB4NWEsIEtFWV9Q
T1dFUiB9LAoJeyAweDlmLCAweDVhLCBLRVlfTUhQIH0sICAgICAvKiBsYWJlbGxlZCAnUGljdHVy
ZScgKi8KCXsgMHhhZiwgMHg1YSwgS0VZX0FVRElPIH0sCgl7IDB4NWYsIDB4NjUsIEtFWV9JTkZP
IH0sCgl7IDB4NmYsIDB4NjUsIEtFWV9GMTMgfSwgICAgIC8qIDE2OjkgKi8KCXsgMHg5ZiwgMHg2
NSwgS0VZX0YxNCB9LCAgICAgLyogMTQ6OSAqLwoJeyAweGFmLCAweDY1LCBLRVlfRVBHIH0sCgl7
IDB4NWYsIDB4NjYsIEtFWV9FWElUIH0sCgl7IDB4NmYsIDB4NjYsIEtFWV9NRU5VIH0sCgl7IDB4
OWYsIDB4NjYsIEtFWV9VUCB9LAoJeyAweGFmLCAweDY2LCBLRVlfRE9XTiB9LAoJeyAweDVmLCAw
eDY5LCBLRVlfTEVGVCB9LAoJeyAweDZmLCAweDY5LCBLRVlfUklHSFQgfSwKCXsgMHg5ZiwgMHg2
OSwgS0VZX0VOVEVSIH0sCgl7IDB4YWYsIDB4NjksIEtFWV9DSEFOTkVMVVAgfSwKCXsgMHg1Ziwg
MHg2YSwgS0VZX0NIQU5ORUxET1dOIH0sCgl7IDB4NmYsIDB4NmEsIEtFWV9WT0xVTUVVUCB9LAoJ
eyAweDlmLCAweDZhLCBLRVlfVk9MVU1FRE9XTiB9LAoJeyAweGFmLCAweDZhLCBLRVlfUkVEIH0s
Cgl7IDB4NWYsIDB4OTUsIEtFWV9HUkVFTiB9LAoJeyAweDZmLCAweDk1LCBLRVlfWUVMTE9XIH0s
Cgl7IDB4OWYsIDB4OTUsIEtFWV9CTFVFIH0sCgl7IDB4YWYsIDB4OTUsIEtFWV9TVUJUSVRMRSB9
LAoJeyAweDVmLCAweDk2LCBLRVlfRjE1IH0sICAgICAvKiBBRCAqLwoJeyAweDZmLCAweDk2LCBL
RVlfVEVYVCB9LAoJeyAweDlmLCAweDk2LCBLRVlfTVVURSB9LAoJeyAweGFmLCAweDk2LCBLRVlf
UkVXSU5EIH0sCgl7IDB4NWYsIDB4OTksIEtFWV9TVE9QIH0sCgl7IDB4NmYsIDB4OTksIEtFWV9Q
TEFZIH0sCgl7IDB4OWYsIDB4OTksIEtFWV9GQVNURk9SV0FSRCB9LAoJeyAweGFmLCAweDk5LCBL
RVlfRjE2IH0sICAgICAvKiBjaGFwdGVyICovCgl7IDB4NWYsIDB4OWEsIEtFWV9QQVVTRSB9LAoJ
eyAweDZmLCAweDlhLCBLRVlfUExBWSB9LAoJeyAweDlmLCAweDlhLCBLRVlfUkVDT1JEIH0sCgl7
IDB4YWYsIDB4OWEsIEtFWV9GMTcgfSwgICAgIC8qIHBpY3R1cmUgaW4gcGljdHVyZSAqLwoJeyAw
eDVmLCAweGE1LCBLRVlfS1BQTFVTIH0sICAvKiB6b29tIGluICovCgl7IDB4NmYsIDB4YTUsIEtF
WV9LUE1JTlVTIH0sIC8qIHpvb20gb3V0ICovCgl7IDB4OWYsIDB4YTUsIEtFWV9GMTggfSwgICAg
IC8qIGNhcHR1cmUgKi8KCXsgMHhhZiwgMHhhNSwgS0VZX0YxOSB9LCAgICAgLyogd2ViICovCgl7
IDB4NWYsIDB4YTYsIEtFWV9FTUFJTCB9LAoJeyAweDZmLCAweGE2LCBLRVlfUEhPTkUgfSwKCXsg
MHg5ZiwgMHhhNiwgS0VZX1BDIH0sCn07CgpzdGF0aWMgaW50IHBjdHYyMDBlX3JjX3F1ZXJ5KHN0
cnVjdCBkdmJfdXNiX2RldmljZSAqZCwgdTMyICpldmVudCwgaW50ICpzdGF0ZSkKewoJaW50IGk7
Cgl1OCBrZXlbNV07Cgl1OCBiWzRdID0geyAwIH07CgoJKmV2ZW50ID0gMDsKCSpzdGF0ZSA9IFJF
TU9URV9OT19LRVlfUFJFU1NFRDsKCglwY3R2MjAwZV9jdHJsX21zZyhkLFVTQl9SRUFEX1JFTU9U
RSwwLE5VTEwsMCwma2V5WzFdLDQpOwoKCS8qIFRlbGwgdGhlIGRldmljZSB3ZSd2ZSByZWFkIHRo
ZSByZW1vdGUuIE5vdCBzdXJlIGhvdyBuZWNlc3NhcnkKCSAgIHRoaXMgaXMsIGJ1dCB0aGUgTmVi
dWxhIFNESyBkb2VzIGl0LiAqLwoJcGN0djIwMGVfY3RybF9tc2coZCxVU0JfV1JJVEVfUkVNT1RF
LDAsYiw0LE5VTEwsMCk7CgoJLyogaWYgc29tZXRoaW5nIGlzIGluc2lkZSB0aGUgYnVmZmVyLCBz
aW11bGF0ZSBrZXkgcHJlc3MgKi8KCWlmIChrZXlbMV0gIT0gMCkKCXsKCQkgIGZvciAoaSA9IDA7
IGkgPCBkLT5wcm9wcy5yY19rZXlfbWFwX3NpemU7IGkrKykgewoJCQlpZiAoZC0+cHJvcHMucmNf
a2V5X21hcFtpXS5jdXN0b20gPT0ga2V5WzFdICYmCgkJCSAgICBkLT5wcm9wcy5yY19rZXlfbWFw
W2ldLmRhdGEgPT0ga2V5WzJdKSB7CgkJCQkqZXZlbnQgPSBkLT5wcm9wcy5yY19rZXlfbWFwW2ld
LmV2ZW50OwoJCQkJKnN0YXRlID0gUkVNT1RFX0tFWV9QUkVTU0VEOwoJCQkJcmV0dXJuIDA7CgkJ
CX0KCQl9Cgl9CgoJaWYgKGtleVswXSAhPSAwKQoJCXdhcm4oImtleTogJXggJXggJXggJXggJXhc
biIsa2V5WzBdLGtleVsxXSxrZXlbMl0sa2V5WzNdLGtleVs0XSk7CglyZXR1cm4gMDsKfQojZW5k
aWYKCi8qIERWQiBVU0IgRHJpdmVyIHN0dWZmICovCnN0YXRpYyBzdHJ1Y3QgZHZiX3VzYl9kZXZp
Y2VfcHJvcGVydGllcyBwY3R2MjAwZV9wcm9wZXJ0aWVzOwoKc3RhdGljIGludCBwY3R2MjAwZV9w
cm9iZSAoc3RydWN0IHVzYl9pbnRlcmZhY2UgKmludGYsCgkJY29uc3Qgc3RydWN0IHVzYl9kZXZp
Y2VfaWQgKmlkKQp7CglzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmQ7CglpbnQgcmV0OwoJaWYgKChy
ZXQgPSBkdmJfdXNiX2RldmljZV9pbml0IChpbnRmLCAmcGN0djIwMGVfcHJvcGVydGllcywgVEhJ
U19NT0RVTEUsICZkLCBhZGFwdGVyX25yKSkgPT0gMCkgewojaWYgMAoJCXU4IGJbNF0gPSB7IDAg
fTsKCgkJLyogZG8gd2UgbmVlZCB0aGF0Pz8gKi8KCQlpZiAoZCAhPSBOVUxMKSB7ICAvKiBkbyB0
aGF0IG9ubHkgd2hlbiB0aGUgZmlybXdhcmUgaXMgbG9hZGVkICAqLwoJCQliWzBdID0gMTsKCQkJ
cGN0djIwMGVfY3RybF9tc2coZCxVU0JfV1JJVEVfUkVNT1RFX1RZUEUsMCxiLDQsTlVMTCwwKTsK
CgkJCWJbMF0gPSAwOwoJCQlwY3R2MjAwZV9jdHJsX21zZyhkLFVTQl9XUklURV9SRU1PVEUsMCxi
LDQsTlVMTCwwKTsKCQl9CiNlbmRpZgoJfQoJd2FybigidXNiX2RldmljZV9pbml0IHN1Y2Vzc2Z1
bGwuIik7CglyZXR1cm4gcmV0Owp9CgoKc3RhdGljIHN0cnVjdCB1c2JfZGV2aWNlX2lkIHBjdHYy
MDBlX3RhYmxlIFtdID0gewoJCXsgVVNCX0RFVklDRShVU0JfVklEX1BJTk5BQ0xFLCBVU0JfUElE
X1BDVFZfMjAwRSkgfSwKCQl7IFVTQl9ERVZJQ0UoVVNCX1ZJRF9QSU5OQUNMRSwgVVNCX1BJRF9Q
Q1RWXzYwRSkgfSwKCQl7IH0JCS8qIFRlcm1pbmF0aW5nIGVudHJ5ICovCn07Ck1PRFVMRV9ERVZJ
Q0VfVEFCTEUgKHVzYiwgcGN0djIwMGVfdGFibGUpOwoKI2RlZmluZSBESUIwNzAwX0RFRkFVTFRf
REVWSUNFX1BST1BFUlRJRVMgXAoJLnNpemVfb2ZfcHJpdiAgICAgID0gc2l6ZW9mKHN0cnVjdCBk
aWIwNzAwX3N0YXRlKQoKc3RhdGljIHN0cnVjdCBkdmJfdXNiX2RldmljZV9wcm9wZXJ0aWVzIHBj
dHYyMDBlX3Byb3BlcnRpZXMgPSB7CgkuY2FwcyA9IERWQl9VU0JfQURBUF9IQVNfUElEX0ZJTFRF
UiB8IERWQl9VU0JfQURBUF9ORUVEX1BJRF9GSUxURVJJTkcgfCBEVkJfVVNCX0lTX0FOX0kyQ19B
REFQVEVSLAoJLnVzYl9jdHJsID0gQ1lQUkVTU19GWDIsCgkvLy5maXJtd2FyZSA9ICJkdmItdXNi
LWRpZ2l0di0wMi5mdyIsIC8vIG5vIQoKCS5udW1fYWRhcHRlcnMgPSAxLAoJLmFkYXB0ZXIgPSB7
ewoJCS5udW1fZnJvbnRlbmRzID0gMSwKCQkuZmUgPSB7ewoJCQkuZnJvbnRlbmRfYXR0YWNoICA9
IHBjdHYyMDBlX2Zyb250ZW5kX2F0dGFjaCwKCQkJLnR1bmVyX2F0dGFjaCAgICAgPSBwY3R2MjAw
ZV90dW5lcl9hdHRhY2gsCgoJCQkuc2l6ZV9vZl9wcml2ICAgICA9IHNpemVvZihzdHJ1Y3QgcGN0
djIwMGVfYWRhcHRlcl9zdGF0ZSksCgoJCQkvKiBwYXJhbWV0ZXIgZm9yIHRoZSBNUEVHMi1kYXRh
IHRyYW5zZmVyICovCgkJCS5zdHJlYW0gPSB7CgkJCQkudHlwZSA9IFVTQl9CVUxLLAoJCQkJLmNv
dW50ID0gNywKCQkJCS5lbmRwb2ludCA9IDB4MDIsCgkJCQkudSA9IHsKCQkJCQkuYnVsayA9IHsK
CQkJCQkJLmJ1ZmZlcnNpemUgPSA0MDk2LAoJCQkJCX0KCQkJCX0KCQkJfSwKCQl9fSwKCX19LAoJ
LmlkZW50aWZ5X3N0YXRlICAgPSBwY3R2MjAwZV9pZGVudGlmeV9zdGF0ZSwKCgkvKi5yY19pbnRl
cnZhbCAgICAgID0gMTAwMCwKCS5yY19rZXlfbWFwICAgICAgID0gcGN0djIwMGVfcmNfa2V5cywK
CS5yY19rZXlfbWFwX3NpemUgID0gQVJSQVlfU0laRShwY3R2MjAwZV9yY19rZXlzKSwKCS5yY19x
dWVyeSAgICAgICAgID0gcGN0djIwMGVfcmNfcXVlcnksKi8KCgkuaTJjX2FsZ28gICAgICAgICA9
ICZwY3R2MjAwZV9pMmNfYWxnbywKCgkuZ2VuZXJpY19idWxrX2N0cmxfZW5kcG9pbnQgPSAweDAx
LAoKCS5udW1fZGV2aWNlX2Rlc2NzID0gMiwKCS5kZXZpY2VzID0gewoJCXsgIlBpbm5hY2xlIFBD
VFYgMjAwZSBEVkItVCIsCgkJCXsgJnBjdHYyMDBlX3RhYmxlWzBdLCBOVUxMIH0sCgkJCXsgTlVM
TCB9LAoJCX0sCgkJeyAiUGlubmFjbGUgUENUViA2MGUgRFZCLVQiLAoJCQl7ICZwY3R2MjAwZV90
YWJsZVsxXSwgTlVMTCB9LAoJCQl7IE5VTEwgfSwKCQl9LAoJCXsgTlVMTCB9LAoJfQp9OwoKc3Rh
dGljIHN0cnVjdCB1c2JfZHJpdmVyIHBjdHYyMDBlX2RyaXZlciA9IHsKI2lmIExJTlVYX1ZFUlNJ
T05fQ09ERSA8PSAgS0VSTkVMX1ZFUlNJT04oMiw2LDE1KQoJLm93bmVyCQk9IFRISVNfTU9EVUxF
LAojZW5kaWYKCS5uYW1lCQk9ICJkdmJfdXNiX3BjdHYyMDBlIiwKCS5wcm9iZQkJPSBwY3R2MjAw
ZV9wcm9iZSwKCS5kaXNjb25uZWN0IAk9IGR2Yl91c2JfZGV2aWNlX2V4aXQsCgkuaWRfdGFibGUJ
PSBwY3R2MjAwZV90YWJsZSwKfTsKCi8qIG1vZHVsZSBzdHVmZiAqLwpzdGF0aWMgaW50IF9faW5p
dCBwY3R2MjAwZV9tb2R1bGVfaW5pdCAodm9pZCkKewoJaW50IHJlc3VsdDsKCWlmICgocmVzdWx0
ID0gdXNiX3JlZ2lzdGVyKCZwY3R2MjAwZV9kcml2ZXIpKSkgewoJCWVycigidXNiX3JlZ2lzdGVy
IGZhaWxlZC4gRXJyb3IgbnVtYmVyICVkIixyZXN1bHQpOwoJCXJldHVybiByZXN1bHQ7Cgl9Cgl3
YXJuKCJ1c2JfcmVnaXN0ZXIgc3VjY2Vzc2Z1bGwuIik7CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyB2
b2lkIF9fZXhpdCBwY3R2MjAwZV9tb2R1bGVfZXhpdCAodm9pZCkKewoJLyogZGVyZWdpc3RlciB0
aGlzIGRyaXZlciBmcm9tIHRoZSBVU0Igc3Vic3lzdGVtICovCgl3YXJuKCJ1c2JfREVyZWdpc3Rl
ciBzdGFydGVkLiIpOwoJdXNiX2RlcmVnaXN0ZXIgKCZwY3R2MjAwZV9kcml2ZXIpOwoJd2Fybigi
dXNiX0RFcmVnaXN0ZXIgc3VjY2Vzc2Z1bGwuIik7Cn0KCm1vZHVsZV9pbml0IChwY3R2MjAwZV9t
b2R1bGVfaW5pdCk7Cm1vZHVsZV9leGl0IChwY3R2MjAwZV9tb2R1bGVfZXhpdCk7CgpNT0RVTEVf
QVVUSE9SKCJKYWtvYiBTdGVpZGwgPGpha29iLnN0ZWlkbEBnbWFpbC5jb20+Iik7Ck1PRFVMRV9E
RVNDUklQVElPTigiRHJpdmVyIGZvciBQaW5uYWNsZSBQQ1RWIDIwMGUgRFZCLVQgVVNCMi4wIik7
Ck1PRFVMRV9WRVJTSU9OKCIwLjEiKTsKTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOwo=
--bcaec520eaedac205604b0bf4087--
