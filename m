Return-path: <video4linux-list-bounces@redhat.com>
Received: from mx3.redhat.com (mx3.redhat.com [172.16.48.32])
	by int-mx1.corp.redhat.com (8.13.1/8.13.1) with ESMTP id mAQIjBSK024094
	for <video4linux-list@redhat.com>; Wed, 26 Nov 2008 13:45:11 -0500
Received: from mail-qy0-f21.google.com (mail-qy0-f21.google.com
	[209.85.221.21])
	by mx3.redhat.com (8.13.8/8.13.8) with ESMTP id mAQIiqqk007998
	for <video4linux-list@redhat.com>; Wed, 26 Nov 2008 13:44:52 -0500
Received: by qyk14 with SMTP id 14so842182qyk.3
	for <video4linux-list@redhat.com>; Wed, 26 Nov 2008 10:44:52 -0800 (PST)
Message-ID: <5d5443650811261044w30748b75w5a47ce8b04680f79@mail.gmail.com>
Date: Thu, 27 Nov 2008 00:14:51 +0530
From: "Trilok Soni" <soni.trilok@gmail.com>
To: v4l <video4linux-list@redhat.com>
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_Part_31752_12096784.1227725091218"
Cc: Sakari Ailus <sakari.ailus@nokia.com>,
	"linux-omap@vger.kernel.org Mailing List" <linux-omap@vger.kernel.org>
Subject: [PATCH] Add OMAP2 camera driver
List-Unsubscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=unsubscribe>
List-Archive: <https://www.redhat.com/mailman/private/video4linux-list>
List-Post: <mailto:video4linux-list@redhat.com>
List-Help: <mailto:video4linux-list-request@redhat.com?subject=help>
List-Subscribe: <https://www.redhat.com/mailman/listinfo/video4linux-list>,
	<mailto:video4linux-list-request@redhat.com?subject=subscribe>
Sender: video4linux-list-bounces@redhat.com
Errors-To: video4linux-list-bounces@redhat.com
List-ID: <video4linux-list@redhat.com>

------=_Part_31752_12096784.1227725091218
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

This patch was living at linux-omap GIT tree from long time and seem
to survive the testing. It is also used in N800/N810 Internet Tablet.
Sakari Ailus can give more information about this. I am not able to
submit this patch as inline one due to my git-send-email configuration
with Gmail.

-- 
---Trilok Soni
http://triloksoni.wordpress.com
http://www.linkedin.com/in/triloksoni

------=_Part_31752_12096784.1227725091218
Content-Type: text/x-patch; name=0001-Add-OMAP2-camera-driver.patch
Content-Transfer-Encoding: base64
X-Attachment-Id: f_fo0brpbt0
Content-Disposition: attachment;
 filename=0001-Add-OMAP2-camera-driver.patch

RnJvbSA5MDdlZWFkZGQ4NTQ3ODhkNmRlZDk4M2EyNTA3MWRhMmZkZTlmYWJhIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTYWthcmkgQWlsdXMgPHNha2FyaS5haWx1c0Bub2tpYS5jb20+
CkRhdGU6IFRodSwgMjcgTm92IDIwMDggMDA6MDg6MjcgKzA1MzAKU3ViamVjdDogW1BBVENIXSBB
ZGQgT01BUDIgY2FtZXJhIGRyaXZlci4KCkFkZCBhIGRyaXZlciBmb3IgdGhlIE9NQVAyIGNhbWVy
YSBibG9jay4gT01BUCAyIGlzIHVzZWQgaW4gZS5nLiBOb2tpYQpOODAwIGludGVybmV0IHRhYmxl
dC4KClRoaXMgZHJpdmVyIHVzZXMgdGhlIFY0TDIgaW50ZXJuYWwgaW9jdGwgaW50ZXJmYWNlLgoK
U2lnbmVkLW9mZi1ieTogVHJpbG9rIFNvbmkgPHNvbmkudHJpbG9rQGdtYWlsLmNvbT4KLS0tCiBk
cml2ZXJzL21lZGlhL3ZpZGVvL0tjb25maWcgICAgICAgICAgIHwgICAgNyArCiBkcml2ZXJzL21l
ZGlhL3ZpZGVvL01ha2VmaWxlICAgICAgICAgIHwgICAgMSArCiBkcml2ZXJzL21lZGlhL3ZpZGVv
L29tYXAyNHh4Y2FtLWRtYS5jIHwgIDYwMSArKysrKysrKysrKwogZHJpdmVycy9tZWRpYS92aWRl
by9vbWFwMjR4eGNhbS5jICAgICB8IDE5MDggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrCiBkcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAyNHh4Y2FtLmggICAgIHwgIDU5MyArKysrKysr
KysrCiA1IGZpbGVzIGNoYW5nZWQsIDMxMTAgaW5zZXJ0aW9ucygrKSwgMCBkZWxldGlvbnMoLSkK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAyNHh4Y2FtLWRtYS5j
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9tZWRpYS92aWRlby9vbWFwMjR4eGNhbS5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9tZWRpYS92aWRlby9vbWFwMjR4eGNhbS5oCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9LY29uZmlnIGIvZHJpdmVycy9tZWRpYS92aWRl
by9LY29uZmlnCmluZGV4IDQ3MTAyYzIuLmI2MWY3YmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVk
aWEvdmlkZW8vS2NvbmZpZworKysgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL0tjb25maWcKQEAgLTc2
NCw2ICs3NjQsMTMgQEAgY29uZmlnIFZJREVPX1NIX01PQklMRV9DRVUKIAktLS1oZWxwLS0tCiAJ
ICBUaGlzIGlzIGEgdjRsMiBkcml2ZXIgZm9yIHRoZSBTdXBlckggTW9iaWxlIENFVSBJbnRlcmZh
Y2UKIAorY29uZmlnIFZJREVPX09NQVAyCisJdHJpc3RhdGUgIlRleGFzIEluc3RydW1lbnRzIE9N
QVAyIENhbWVyYSBDYXB0dXJlIEludGVyZmFjZSBkcml2ZXIiCisJZGVwZW5kcyBvbiBWSURFT19E
RVYKKwlzZWxlY3QgVklERU9CVUZfRE1BX1NHCisJLS0taGVscC0tLQorCSAgVGhpcyBpcyBhIHY0
bDIgZHJpdmVyIGZvciB0aGUgVEkgT01BUDIgY2FtZXJhIGNhcHR1cmUgaW50ZXJmYWNlCisKICMK
ICMgVVNCIE11bHRpbWVkaWEgZGV2aWNlIGNvbmZpZ3VyYXRpb24KICMKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvdmlkZW8vTWFrZWZpbGUgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL01ha2VmaWxl
CmluZGV4IDE2OTYyZjMuLmU0NzI5MGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdmlkZW8v
TWFrZWZpbGUKKysrIGIvZHJpdmVycy9tZWRpYS92aWRlby9NYWtlZmlsZQpAQCAtMTI5LDYgKzEy
OSw3IEBAIG9iai0kKENPTkZJR19WSURFT19DWDIzODg1KSArPSBjeDIzODg1LwogCiBvYmotJChD
T05GSUdfVklERU9fUFhBMjd4KQkrPSBweGFfY2FtZXJhLm8KIG9iai0kKENPTkZJR19WSURFT19T
SF9NT0JJTEVfQ0VVKQkrPSBzaF9tb2JpbGVfY2V1X2NhbWVyYS5vCitvYmotJChDT05GSUdfVklE
RU9fT01BUDIpCQkrPSBvbWFwMjR4eGNhbS5vIG9tYXAyNHh4Y2FtLWRtYS5vCiBvYmotJChDT05G
SUdfU09DX0NBTUVSQSkJKz0gc29jX2NhbWVyYS5vCiBvYmotJChDT05GSUdfU09DX0NBTUVSQV9N
VDlNMDAxKQkrPSBtdDltMDAxLm8KIG9iai0kKENPTkZJR19TT0NfQ0FNRVJBX01UOU0xMTEpCSs9
IG10OW0xMTEubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9vbWFwMjR4eGNhbS1k
bWEuYyBiL2RyaXZlcnMvbWVkaWEvdmlkZW8vb21hcDI0eHhjYW0tZG1hLmMKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uM2E1NzM3OAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZl
cnMvbWVkaWEvdmlkZW8vb21hcDI0eHhjYW0tZG1hLmMKQEAgLTAsMCArMSw2MDEgQEAKKy8qCisg
KiBkcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAyNHh4Y2FtLWRtYS5jCisgKgorICogQ29weXJpZ2h0
IChDKSAyMDA0IE1vbnRhVmlzdGEgU29mdHdhcmUsIEluYy4KKyAqIENvcHlyaWdodCAoQykgMjAw
NCBUZXhhcyBJbnN0cnVtZW50cy4KKyAqIENvcHlyaWdodCAoQykgMjAwNyBOb2tpYSBDb3Jwb3Jh
dGlvbi4KKyAqCisgKiBDb250YWN0OiBTYWthcmkgQWlsdXMgPHNha2FyaS5haWx1c0Bub2tpYS5j
b20+CisgKgorICogQmFzZWQgb24gY29kZSBmcm9tIEFuZHkgTG93ZSA8c291cmNlQG12aXN0YS5j
b20+IGFuZAorICogICAgICAgICAgICAgICAgICAgIERhdmlkIENvaGVuIDxkYXZpZC5jb2hlbkBp
bmR0Lm9yZy5icj4uCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqIHZlcnNpb24gMiBhcyBwdWJsaXNo
ZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbi4KKyAqCisgKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwgYnV0Cisg
KiBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBP
U0UuICBTZWUgdGhlIEdOVQorICogR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisgKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90
LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQorICogRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJh
bmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BCisgKiAwMjExMC0xMzAxIFVTQQorICov
CisKKyNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KKyNpbmNsdWRlIDxsaW51eC9pby5oPgorI2lu
Y2x1ZGUgPGxpbnV4L3NjYXR0ZXJsaXN0Lmg+CisKKyNpbmNsdWRlICJvbWFwMjR4eGNhbS5oIgor
CisvKgorICoKKyAqIERNQSBoYXJkd2FyZS4KKyAqCisgKi8KKworLyogQWNrIGFsbCBpbnRlcnJ1
cHQgb24gQ1NSIGFuZCBJUlFTVEFUVVNfTDAgKi8KK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2Rt
YWh3X2Fja19hbGwodW5zaWduZWQgbG9uZyBiYXNlKQoreworCXUzMiBjc3I7CisJaW50IGk7CisK
Kwlmb3IgKGkgPSAwOyBpIDwgTlVNX0NBTURNQV9DSEFOTkVMUzsgKytpKSB7CisJCWNzciA9IG9t
YXAyNHh4Y2FtX3JlZ19pbihiYXNlLCBDQU1ETUFfQ1NSKGkpKTsKKwkJLyogYWNrIGludGVycnVw
dCBpbiBDU1IgKi8KKwkJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFfQ1NSKGkpLCBj
c3IpOworCX0KKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9JUlFTVEFUVVNfTDAs
IDB4Zik7Cit9CisKKy8qIEFjayBkbWFjaCBvbiBDU1IgYW5kIElSUVNUQVRVU19MMCAqLworc3Rh
dGljIHUzMiBvbWFwMjR4eGNhbV9kbWFod19hY2tfY2godW5zaWduZWQgbG9uZyBiYXNlLCBpbnQg
ZG1hY2gpCit7CisJdTMyIGNzcjsKKworCWNzciA9IG9tYXAyNHh4Y2FtX3JlZ19pbihiYXNlLCBD
QU1ETUFfQ1NSKGRtYWNoKSk7CisJLyogYWNrIGludGVycnVwdCBpbiBDU1IgKi8KKwlvbWFwMjR4
eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9DU1IoZG1hY2gpLCBjc3IpOworCS8qIGFjayBpbnRl
cnJ1cHQgaW4gSVJRU1RBVFVTICovCisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFf
SVJRU1RBVFVTX0wwLCAoMSA8PCBkbWFjaCkpOworCisJcmV0dXJuIGNzcjsKK30KKworc3RhdGlj
IGludCBvbWFwMjR4eGNhbV9kbWFod19ydW5uaW5nKHVuc2lnbmVkIGxvbmcgYmFzZSwgaW50IGRt
YWNoKQoreworCXJldHVybiBvbWFwMjR4eGNhbV9yZWdfaW4oYmFzZSwgQ0FNRE1BX0NDUihkbWFj
aCkpICYgQ0FNRE1BX0NDUl9FTkFCTEU7Cit9CisKK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2Rt
YWh3X3RyYW5zZmVyX3NldHVwKHVuc2lnbmVkIGxvbmcgYmFzZSwgaW50IGRtYWNoLAorCQkJCQkg
ICAgIGRtYV9hZGRyX3Qgc3RhcnQsIHUzMiBsZW4pCit7CisJb21hcDI0eHhjYW1fcmVnX291dChi
YXNlLCBDQU1ETUFfQ0NSKGRtYWNoKSwKKwkJCSAgICBDQU1ETUFfQ0NSX1NFTF9TUkNfRFNUX1NZ
TkMKKwkJCSAgICB8IENBTURNQV9DQ1JfQlMKKwkJCSAgICB8IENBTURNQV9DQ1JfRFNUX0FNT0RF
X1BPU1RfSU5DCisJCQkgICAgfCBDQU1ETUFfQ0NSX1NSQ19BTU9ERV9QT1NUX0lOQworCQkJICAg
IHwgQ0FNRE1BX0NDUl9GUworCQkJICAgIHwgQ0FNRE1BX0NDUl9XUl9BQ1RJVkUKKwkJCSAgICB8
IENBTURNQV9DQ1JfUkRfQUNUSVZFCisJCQkgICAgfCBDQU1ETUFfQ0NSX1NZTkNIUk9fQ0FNRVJB
KTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9DTE5LX0NUUkwoZG1hY2gpLCAw
KTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9DRU4oZG1hY2gpLCBsZW4pOwor
CW9tYXAyNHh4Y2FtX3JlZ19vdXQoYmFzZSwgQ0FNRE1BX0NGTihkbWFjaCksIDEpOworCW9tYXAy
NHh4Y2FtX3JlZ19vdXQoYmFzZSwgQ0FNRE1BX0NTRFAoZG1hY2gpLAorCQkJICAgIENBTURNQV9D
U0RQX1dSSVRFX01PREVfUE9TVEVECisJCQkgICAgfCBDQU1ETUFfQ1NEUF9EU1RfQlVSU1RfRU5f
MzIKKwkJCSAgICB8IENBTURNQV9DU0RQX0RTVF9QQUNLRUQKKwkJCSAgICB8IENBTURNQV9DU0RQ
X1NSQ19CVVJTVF9FTl8zMgorCQkJICAgIHwgQ0FNRE1BX0NTRFBfU1JDX1BBQ0tFRAorCQkJICAg
IHwgQ0FNRE1BX0NTRFBfREFUQV9UWVBFXzhCSVRTKTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJh
c2UsIENBTURNQV9DU1NBKGRtYWNoKSwgMCk7CisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBD
QU1ETUFfQ0RTQShkbWFjaCksIHN0YXJ0KTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENB
TURNQV9DU0VJKGRtYWNoKSwgMCk7CisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFf
Q1NGSShkbWFjaCksIERNQV9USFJFU0hPTEQpOworCW9tYXAyNHh4Y2FtX3JlZ19vdXQoYmFzZSwg
Q0FNRE1BX0NERUkoZG1hY2gpLCAwKTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURN
QV9DREZJKGRtYWNoKSwgMCk7CisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFfQ1NS
KGRtYWNoKSwKKwkJCSAgICBDQU1ETUFfQ1NSX01JU0FMSUdORURfRVJSCisJCQkgICAgfCBDQU1E
TUFfQ1NSX1NFQ1VSRV9FUlIKKwkJCSAgICB8IENBTURNQV9DU1JfVFJBTlNfRVJSCisJCQkgICAg
fCBDQU1ETUFfQ1NSX0JMT0NLCisJCQkgICAgfCBDQU1ETUFfQ1NSX0RST1ApOworCW9tYXAyNHh4
Y2FtX3JlZ19vdXQoYmFzZSwgQ0FNRE1BX0NJQ1IoZG1hY2gpLAorCQkJICAgIENBTURNQV9DSUNS
X01JU0FMSUdORURfRVJSX0lFCisJCQkgICAgfCBDQU1ETUFfQ0lDUl9TRUNVUkVfRVJSX0lFCisJ
CQkgICAgfCBDQU1ETUFfQ0lDUl9UUkFOU19FUlJfSUUKKwkJCSAgICB8IENBTURNQV9DSUNSX0JM
T0NLX0lFCisJCQkgICAgfCBDQU1ETUFfQ0lDUl9EUk9QX0lFKTsKK30KKworc3RhdGljIHZvaWQg
b21hcDI0eHhjYW1fZG1haHdfdHJhbnNmZXJfc3RhcnQodW5zaWduZWQgbG9uZyBiYXNlLCBpbnQg
ZG1hY2gpCit7CisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFfQ0NSKGRtYWNoKSwK
KwkJCSAgICBDQU1ETUFfQ0NSX1NFTF9TUkNfRFNUX1NZTkMKKwkJCSAgICB8IENBTURNQV9DQ1Jf
QlMKKwkJCSAgICB8IENBTURNQV9DQ1JfRFNUX0FNT0RFX1BPU1RfSU5DCisJCQkgICAgfCBDQU1E
TUFfQ0NSX1NSQ19BTU9ERV9QT1NUX0lOQworCQkJICAgIHwgQ0FNRE1BX0NDUl9FTkFCTEUKKwkJ
CSAgICB8IENBTURNQV9DQ1JfRlMKKwkJCSAgICB8IENBTURNQV9DQ1JfU1lOQ0hST19DQU1FUkEp
OworfQorCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9kbWFod190cmFuc2Zlcl9jaGFpbih1bnNp
Z25lZCBsb25nIGJhc2UsIGludCBkbWFjaCwKKwkJCQkJICAgICBpbnQgZnJlZV9kbWFjaCkKK3sK
KwlpbnQgcHJldl9kbWFjaCwgY2g7CisKKwlpZiAoZG1hY2ggPT0gMCkKKwkJcHJldl9kbWFjaCA9
IE5VTV9DQU1ETUFfQ0hBTk5FTFMgLSAxOworCWVsc2UKKwkJcHJldl9kbWFjaCA9IGRtYWNoIC0g
MTsKKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9DTE5LX0NUUkwocHJldl9kbWFj
aCksCisJCQkgICAgQ0FNRE1BX0NMTktfQ1RSTF9FTkFCTEVfTE5LIHwgZG1hY2gpOworCS8qIERp
ZCB3ZSBjaGFpbiB0aGUgRE1BIHRyYW5zZmVyIGJlZm9yZSB0aGUgcHJldmlvdXMgb25lCisJICog
ZmluaXNoZWQ/CisJICovCisJY2ggPSAoZG1hY2ggKyBmcmVlX2RtYWNoKSAlIE5VTV9DQU1ETUFf
Q0hBTk5FTFM7CisJd2hpbGUgKCEob21hcDI0eHhjYW1fcmVnX2luKGJhc2UsIENBTURNQV9DQ1Io
Y2gpKQorCQkgJiBDQU1ETUFfQ0NSX0VOQUJMRSkpIHsKKwkJaWYgKGNoID09IGRtYWNoKSB7CisJ
CQkvKiBUaGUgcHJldmlvdXMgdHJhbnNmZXIgaGFzIGVuZGVkIGFuZCB0aGlzIG9uZQorCQkJICog
aGFzbid0IHN0YXJ0ZWQsIHNvIHdlIG11c3Qgbm90IGhhdmUgY2hhaW5lZAorCQkJICogdG8gdGhl
IHByZXZpb3VzIG9uZSBpbiB0aW1lLiAgV2UnbGwgaGF2ZSB0bworCQkJICogc3RhcnQgaXQgbm93
LgorCQkJICovCisJCQlvbWFwMjR4eGNhbV9kbWFod190cmFuc2Zlcl9zdGFydChiYXNlLCBkbWFj
aCk7CisJCQlicmVhazsKKwkJfSBlbHNlCisJCQljaCA9IChjaCArIDEpICUgTlVNX0NBTURNQV9D
SEFOTkVMUzsKKwl9Cit9CisKKy8qIEFib3J0IGFsbCBjaGFpbmVkIERNQSB0cmFuc2ZlcnMuIEFm
dGVyIGFsbCB0cmFuc2ZlcnMgaGF2ZSBiZWVuCisgKiBhYm9ydGVkIGFuZCB0aGUgRE1BIGNvbnRy
b2xsZXIgaXMgaWRsZSwgdGhlIGNvbXBsZXRpb24gcm91dGluZXMgZm9yCisgKiBhbnkgYWJvcnRl
ZCB0cmFuc2ZlcnMgd2lsbCBiZSBjYWxsZWQgaW4gc2VxdWVuY2UuIFRoZSBETUEKKyAqIGNvbnRy
b2xsZXIgbWF5IG5vdCBiZSBpZGxlIGFmdGVyIHRoaXMgcm91dGluZSBjb21wbGV0ZXMsIGJlY2F1
c2UKKyAqIHRoZSBjb21wbGV0aW9uIHJvdXRpbmVzIG1pZ2h0IHN0YXJ0IG5ldyB0cmFuc2ZlcnMu
CisgKi8KK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2RtYWh3X2Fib3J0X2NoKHVuc2lnbmVkIGxv
bmcgYmFzZSwgaW50IGRtYWNoKQoreworCS8qIG1hc2sgYWxsIGludGVycnVwdHMgZnJvbSB0aGlz
IGNoYW5uZWwgKi8KKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGJhc2UsIENBTURNQV9DSUNSKGRtYWNo
KSwgMCk7CisJLyogdW5saW5rIHRoaXMgY2hhbm5lbCAqLworCW9tYXAyNHh4Y2FtX3JlZ19tZXJn
ZShiYXNlLCBDQU1ETUFfQ0xOS19DVFJMKGRtYWNoKSwgMCwKKwkJCSAgICAgIENBTURNQV9DTE5L
X0NUUkxfRU5BQkxFX0xOSyk7CisJLyogZGlzYWJsZSB0aGlzIGNoYW5uZWwgKi8KKwlvbWFwMjR4
eGNhbV9yZWdfbWVyZ2UoYmFzZSwgQ0FNRE1BX0NDUihkbWFjaCksIDAsIENBTURNQV9DQ1JfRU5B
QkxFKTsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1fZG1haHdfaW5pdCh1bnNpZ25lZCBs
b25nIGJhc2UpCit7CisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFfT0NQX1NZU0NP
TkZJRywKKwkJCSAgICBDQU1ETUFfT0NQX1NZU0NPTkZJR19NSURMRU1PREVfRlNUQU5EQlkKKwkJ
CSAgICB8IENBTURNQV9PQ1BfU1lTQ09ORklHX1NJRExFTU9ERV9GSURMRQorCQkJICAgIHwgQ0FN
RE1BX09DUF9TWVNDT05GSUdfQVVUT0lETEUpOworCisJb21hcDI0eHhjYW1fcmVnX21lcmdlKGJh
c2UsIENBTURNQV9HQ1IsIDB4MTAsCisJCQkgICAgICBDQU1ETUFfR0NSX01BWF9DSEFOTkVMX0ZJ
Rk9fREVQVEgpOworCisJb21hcDI0eHhjYW1fcmVnX291dChiYXNlLCBDQU1ETUFfSVJRRU5BQkxF
X0wwLCAweGYpOworfQorCisvKgorICoKKyAqIEluZGl2aWR1YWwgRE1BIGNoYW5uZWwgaGFuZGxp
bmcuCisgKgorICovCisKKy8qIFN0YXJ0IGEgRE1BIHRyYW5zZmVyIGZyb20gdGhlIGNhbWVyYSB0
byBtZW1vcnkuCisgKiBSZXR1cm5zIHplcm8gaWYgdGhlIHRyYW5zZmVyIHdhcyBzdWNjZXNzZnVs
bHkgc3RhcnRlZCwgb3Igbm9uLXplcm8gaWYgYWxsCisgKiBETUEgY2hhbm5lbHMgYXJlIGFscmVh
ZHkgaW4gdXNlIG9yIHN0YXJ0aW5nIGlzIGN1cnJlbnRseSBpbmhpYml0ZWQuCisgKi8KK3N0YXRp
YyBpbnQgb21hcDI0eHhjYW1fZG1hX3N0YXJ0KHN0cnVjdCBvbWFwMjR4eGNhbV9kbWEgKmRtYSwg
ZG1hX2FkZHJfdCBzdGFydCwKKwkJCQkgdTMyIGxlbiwgZG1hX2NhbGxiYWNrX3QgY2FsbGJhY2ss
IHZvaWQgKmFyZykKK3sKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCWludCBkbWFjaDsKKworCXNw
aW5fbG9ja19pcnFzYXZlKCZkbWEtPmxvY2ssIGZsYWdzKTsKKworCWlmICghZG1hLT5mcmVlX2Rt
YWNoIHx8IGF0b21pY19yZWFkKCZkbWEtPmRtYV9zdG9wKSkgeworCQlzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZkbWEtPmxvY2ssIGZsYWdzKTsKKwkJcmV0dXJuIC1FQlVTWTsKKwl9CisKKwlkbWFj
aCA9IGRtYS0+bmV4dF9kbWFjaDsKKworCWRtYS0+Y2hfc3RhdGVbZG1hY2hdLmNhbGxiYWNrID0g
Y2FsbGJhY2s7CisJZG1hLT5jaF9zdGF0ZVtkbWFjaF0uYXJnID0gYXJnOworCisJb21hcDI0eHhj
YW1fZG1haHdfdHJhbnNmZXJfc2V0dXAoZG1hLT5iYXNlLCBkbWFjaCwgc3RhcnQsIGxlbik7CisK
KwkvKiBXZSdyZSByZWFkeSB0byBzdGFydCB0aGUgRE1BIHRyYW5zZmVyLiAqLworCisJaWYgKGRt
YS0+ZnJlZV9kbWFjaCA8IE5VTV9DQU1ETUFfQ0hBTk5FTFMpIHsKKwkJLyogQSB0cmFuc2ZlciBp
cyBhbHJlYWR5IGluIHByb2dyZXNzLCBzbyB0cnkgdG8gY2hhaW4gdG8gaXQuICovCisJCW9tYXAy
NHh4Y2FtX2RtYWh3X3RyYW5zZmVyX2NoYWluKGRtYS0+YmFzZSwgZG1hY2gsCisJCQkJCQkgZG1h
LT5mcmVlX2RtYWNoKTsKKwl9IGVsc2UgeworCQkvKiBObyB0cmFuc2ZlciBpcyBpbiBwcm9ncmVz
cywgc28gd2UnbGwganVzdCBzdGFydCB0aGlzIG9uZQorCQkgKiBub3cuCisJCSAqLworCQlvbWFw
MjR4eGNhbV9kbWFod190cmFuc2Zlcl9zdGFydChkbWEtPmJhc2UsIGRtYWNoKTsKKwl9CisKKwlk
bWEtPm5leHRfZG1hY2ggPSAoZG1hLT5uZXh0X2RtYWNoICsgMSkgJSBOVU1fQ0FNRE1BX0NIQU5O
RUxTOworCWRtYS0+ZnJlZV9kbWFjaC0tOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZG1h
LT5sb2NrLCBmbGFncyk7CisKKwlyZXR1cm4gMDsKK30KKworLyogQWJvcnQgYWxsIGNoYWluZWQg
RE1BIHRyYW5zZmVycy4gQWZ0ZXIgYWxsIHRyYW5zZmVycyBoYXZlIGJlZW4KKyAqIGFib3J0ZWQg
YW5kIHRoZSBETUEgY29udHJvbGxlciBpcyBpZGxlLCB0aGUgY29tcGxldGlvbiByb3V0aW5lcyBm
b3IKKyAqIGFueSBhYm9ydGVkIHRyYW5zZmVycyB3aWxsIGJlIGNhbGxlZCBpbiBzZXF1ZW5jZS4g
VGhlIERNQQorICogY29udHJvbGxlciBtYXkgbm90IGJlIGlkbGUgYWZ0ZXIgdGhpcyByb3V0aW5l
IGNvbXBsZXRlcywgYmVjYXVzZQorICogdGhlIGNvbXBsZXRpb24gcm91dGluZXMgbWlnaHQgc3Rh
cnQgbmV3IHRyYW5zZmVycy4KKyAqLworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1fZG1hX2Fib3J0
KHN0cnVjdCBvbWFwMjR4eGNhbV9kbWEgKmRtYSwgdTMyIGNzcikKK3sKKwl1bnNpZ25lZCBsb25n
IGZsYWdzOworCWludCBkbWFjaCwgaSwgZnJlZV9kbWFjaDsKKwlkbWFfY2FsbGJhY2tfdCBjYWxs
YmFjazsKKwl2b2lkICphcmc7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmZG1hLT5sb2NrLCBmbGFn
cyk7CisKKwkvKiBzdG9wIGFueSBETUEgdHJhbnNmZXJzIGluIHByb2dyZXNzICovCisJZG1hY2gg
PSAoZG1hLT5uZXh0X2RtYWNoICsgZG1hLT5mcmVlX2RtYWNoKSAlIE5VTV9DQU1ETUFfQ0hBTk5F
TFM7CisJZm9yIChpID0gMDsgaSA8IE5VTV9DQU1ETUFfQ0hBTk5FTFM7IGkrKykgeworCQlvbWFw
MjR4eGNhbV9kbWFod19hYm9ydF9jaChkbWEtPmJhc2UsIGRtYWNoKTsKKwkJZG1hY2ggPSAoZG1h
Y2ggKyAxKSAlIE5VTV9DQU1ETUFfQ0hBTk5FTFM7CisJfQorCisJLyogV2UgaGF2ZSB0byBiZSBj
YXJlZnVsIGhlcmUgYmVjYXVzZSB0aGUgY2FsbGJhY2sgcm91dGluZQorCSAqIG1pZ2h0IHN0YXJ0
IGEgbmV3IERNQSB0cmFuc2ZlciwgYW5kIHdlIG9ubHkgd2FudCB0byBhYm9ydAorCSAqIHRyYW5z
ZmVycyB0aGF0IHdlcmUgc3RhcnRlZCBiZWZvcmUgdGhpcyByb3V0aW5lIHdhcyBjYWxsZWQuCisJ
ICovCisJZnJlZV9kbWFjaCA9IGRtYS0+ZnJlZV9kbWFjaDsKKwl3aGlsZSAoKGRtYS0+ZnJlZV9k
bWFjaCA8IE5VTV9DQU1ETUFfQ0hBTk5FTFMpICYmCisJICAgICAgIChmcmVlX2RtYWNoIDwgTlVN
X0NBTURNQV9DSEFOTkVMUykpIHsKKwkJZG1hY2ggPSAoZG1hLT5uZXh0X2RtYWNoICsgZG1hLT5m
cmVlX2RtYWNoKQorCQkJJSBOVU1fQ0FNRE1BX0NIQU5ORUxTOworCQljYWxsYmFjayA9IGRtYS0+
Y2hfc3RhdGVbZG1hY2hdLmNhbGxiYWNrOworCQlhcmcgPSBkbWEtPmNoX3N0YXRlW2RtYWNoXS5h
cmc7CisJCWRtYS0+ZnJlZV9kbWFjaCsrOworCQlmcmVlX2RtYWNoKys7CisJCWlmIChjYWxsYmFj
aykgeworCQkJLyogbGVhdmUgaW50ZXJydXB0cyBkaXNhYmxlZCBkdXJpbmcgY2FsbGJhY2sgKi8K
KwkJCXNwaW5fdW5sb2NrKCZkbWEtPmxvY2spOworCQkJKCpjYWxsYmFjaykgKGRtYSwgY3NyLCBh
cmcpOworCQkJc3Bpbl9sb2NrKCZkbWEtPmxvY2spOworCQl9CisJfQorCisJc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmZG1hLT5sb2NrLCBmbGFncyk7Cit9CisKKy8qIEFib3J0IGFsbCBjaGFpbmVk
IERNQSB0cmFuc2ZlcnMuIEFmdGVyIGFsbCB0cmFuc2ZlcnMgaGF2ZSBiZWVuCisgKiBhYm9ydGVk
IGFuZCB0aGUgRE1BIGNvbnRyb2xsZXIgaXMgaWRsZSwgdGhlIGNvbXBsZXRpb24gcm91dGluZXMg
Zm9yCisgKiBhbnkgYWJvcnRlZCB0cmFuc2ZlcnMgd2lsbCBiZSBjYWxsZWQgaW4gc2VxdWVuY2Uu
IElmIHRoZSBjb21wbGV0aW9uCisgKiByb3V0aW5lcyBhdHRlbXB0IHRvIHN0YXJ0IGEgbmV3IERN
QSB0cmFuc2ZlciBpdCB3aWxsIGZhaWwsIHNvIHRoZQorICogRE1BIGNvbnRyb2xsZXIgd2lsbCBi
ZSBpZGxlIGFmdGVyIHRoaXMgcm91dGluZSBjb21wbGV0ZXMuCisgKi8KK3N0YXRpYyB2b2lkIG9t
YXAyNHh4Y2FtX2RtYV9zdG9wKHN0cnVjdCBvbWFwMjR4eGNhbV9kbWEgKmRtYSwgdTMyIGNzcikK
K3sKKwlhdG9taWNfaW5jKCZkbWEtPmRtYV9zdG9wKTsKKwlvbWFwMjR4eGNhbV9kbWFfYWJvcnQo
ZG1hLCBjc3IpOworCWF0b21pY19kZWMoJmRtYS0+ZG1hX3N0b3ApOworfQorCisvKiBDYW1lcmEg
RE1BIGludGVycnVwdCBzZXJ2aWNlIHJvdXRpbmUuICovCit2b2lkIG9tYXAyNHh4Y2FtX2RtYV9p
c3Ioc3RydWN0IG9tYXAyNHh4Y2FtX2RtYSAqZG1hKQoreworCWludCBkbWFjaDsKKwlkbWFfY2Fs
bGJhY2tfdCBjYWxsYmFjazsKKwl2b2lkICphcmc7CisJdTMyIGNzcjsKKwljb25zdCB1MzIgY3Ny
X2Vycm9yID0gQ0FNRE1BX0NTUl9NSVNBTElHTkVEX0VSUgorCQl8IENBTURNQV9DU1JfU1VQRVJW
SVNPUl9FUlIgfCBDQU1ETUFfQ1NSX1NFQ1VSRV9FUlIKKwkJfCBDQU1ETUFfQ1NSX1RSQU5TX0VS
UiB8IENBTURNQV9DU1JfRFJPUDsKKworCXNwaW5fbG9jaygmZG1hLT5sb2NrKTsKKworCWlmIChk
bWEtPmZyZWVfZG1hY2ggPT0gTlVNX0NBTURNQV9DSEFOTkVMUykgeworCQkvKiBBIGNhbWVyYSBE
TUEgaW50ZXJydXB0IG9jY3VycmVkIHdoaWxlIGFsbCBjaGFubmVscworCQkgKiBhcmUgaWRsZSwg
c28gd2UnbGwgYWNrbm93bGVkZ2UgdGhlIGludGVycnVwdCBpbiB0aGUKKwkJICogSVJRU1RBVFVT
IHJlZ2lzdGVyIGFuZCBleGl0LgorCQkgKi8KKwkJb21hcDI0eHhjYW1fZG1haHdfYWNrX2FsbChk
bWEtPmJhc2UpOworCQlzcGluX3VubG9jaygmZG1hLT5sb2NrKTsKKwkJcmV0dXJuOworCX0KKwor
CXdoaWxlIChkbWEtPmZyZWVfZG1hY2ggPCBOVU1fQ0FNRE1BX0NIQU5ORUxTKSB7CisJCWRtYWNo
ID0gKGRtYS0+bmV4dF9kbWFjaCArIGRtYS0+ZnJlZV9kbWFjaCkKKwkJCSUgTlVNX0NBTURNQV9D
SEFOTkVMUzsKKwkJaWYgKG9tYXAyNHh4Y2FtX2RtYWh3X3J1bm5pbmcoZG1hLT5iYXNlLCBkbWFj
aCkpIHsKKwkJCS8qIFRoaXMgYnVmZmVyIGhhc24ndCBmaW5pc2hlZCB5ZXQsIHNvIHdlJ3JlIGRv
bmUuICovCisJCQlicmVhazsKKwkJfQorCQljc3IgPSBvbWFwMjR4eGNhbV9kbWFod19hY2tfY2go
ZG1hLT5iYXNlLCBkbWFjaCk7CisJCWlmIChjc3IgJiBjc3JfZXJyb3IpIHsKKwkJCS8qIEEgRE1B
IGVycm9yIG9jY3VycmVkLCBzbyBzdG9wIGFsbCBETUEKKwkJCSAqIHRyYW5zZmVycyBpbiBwcm9n
cmVzcy4KKwkJCSAqLworCQkJc3Bpbl91bmxvY2soJmRtYS0+bG9jayk7CisJCQlvbWFwMjR4eGNh
bV9kbWFfc3RvcChkbWEsIGNzcik7CisJCQlyZXR1cm47CisJCX0gZWxzZSB7CisJCQljYWxsYmFj
ayA9IGRtYS0+Y2hfc3RhdGVbZG1hY2hdLmNhbGxiYWNrOworCQkJYXJnID0gZG1hLT5jaF9zdGF0
ZVtkbWFjaF0uYXJnOworCQkJZG1hLT5mcmVlX2RtYWNoKys7CisJCQlpZiAoY2FsbGJhY2spIHsK
KwkJCQlzcGluX3VubG9jaygmZG1hLT5sb2NrKTsKKwkJCQkoKmNhbGxiYWNrKSAoZG1hLCBjc3Is
IGFyZyk7CisJCQkJc3Bpbl9sb2NrKCZkbWEtPmxvY2spOworCQkJfQorCQl9CisJfQorCisJc3Bp
bl91bmxvY2soJmRtYS0+bG9jayk7CisKKwlvbWFwMjR4eGNhbV9zZ2RtYV9wcm9jZXNzKAorCQlj
b250YWluZXJfb2YoZG1hLCBzdHJ1Y3Qgb21hcDI0eHhjYW1fc2dkbWEsIGRtYSkpOworfQorCit2
b2lkIG9tYXAyNHh4Y2FtX2RtYV9od2luaXQoY29uc3Qgc3RydWN0IG9tYXAyNHh4Y2FtX2RtYSAq
ZG1hKQoreworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmZG1h
LT5sb2NrLCBmbGFncyk7CisKKwlvbWFwMjR4eGNhbV9kbWFod19pbml0KGRtYS0+YmFzZSk7CisK
KwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkbWEtPmxvY2ssIGZsYWdzKTsKK30KKworc3RhdGlj
IHZvaWQgb21hcDI0eHhjYW1fZG1hX2luaXQoc3RydWN0IG9tYXAyNHh4Y2FtX2RtYSAqZG1hLAor
CQkJCSB1bnNpZ25lZCBsb25nIGJhc2UpCit7CisJaW50IGNoOworCisJLyogZ3JvdXAgYWxsIGNo
YW5uZWxzIG9uIERNQSBJUlEwIGFuZCB1bm1hc2sgaXJxICovCisJc3Bpbl9sb2NrX2luaXQoJmRt
YS0+bG9jayk7CisJZG1hLT5iYXNlID0gYmFzZTsKKwlkbWEtPmZyZWVfZG1hY2ggPSBOVU1fQ0FN
RE1BX0NIQU5ORUxTOworCWRtYS0+bmV4dF9kbWFjaCA9IDA7CisJZm9yIChjaCA9IDA7IGNoIDwg
TlVNX0NBTURNQV9DSEFOTkVMUzsgY2grKykgeworCQlkbWEtPmNoX3N0YXRlW2NoXS5jYWxsYmFj
ayA9IE5VTEw7CisJCWRtYS0+Y2hfc3RhdGVbY2hdLmFyZyA9IE5VTEw7CisJfQorfQorCisvKgor
ICoKKyAqIFNjYXR0ZXItZ2F0aGVyIERNQS4KKyAqCisgKiBIaWdoLWxldmVsIERNQSBjb25zdHJ1
Y3QgZm9yIHRyYW5zZmVycmluZyB3aG9sZSBwaWN0dXJlIGZyYW1lcyB0bworICogbWVtb3J5IHRo
YXQgaXMgZGlzY29udGludW91cy4KKyAqCisgKi8KKworLyogRE1BIGNvbXBsZXRpb24gcm91dGlu
ZSBmb3IgdGhlIHNjYXR0ZXItZ2F0aGVyIERNQSBmcmFnbWVudHMuICovCitzdGF0aWMgdm9pZCBv
bWFwMjR4eGNhbV9zZ2RtYV9jYWxsYmFjayhzdHJ1Y3Qgb21hcDI0eHhjYW1fZG1hICpkbWEsIHUz
MiBjc3IsCisJCQkJICAgICAgIHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fc2dk
bWEgKnNnZG1hID0KKwkJY29udGFpbmVyX29mKGRtYSwgc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1h
LCBkbWEpOworCWludCBzZ3Nsb3QgPSAoaW50KWFyZzsKKwlzdHJ1Y3Qgc2dkbWFfc3RhdGUgKnNn
X3N0YXRlOworCWNvbnN0IHUzMiBjc3JfZXJyb3IgPSBDQU1ETUFfQ1NSX01JU0FMSUdORURfRVJS
CisJCXwgQ0FNRE1BX0NTUl9TVVBFUlZJU09SX0VSUiB8IENBTURNQV9DU1JfU0VDVVJFX0VSUgor
CQl8IENBTURNQV9DU1JfVFJBTlNfRVJSIHwgQ0FNRE1BX0NTUl9EUk9QOworCisJc3Bpbl9sb2Nr
KCZzZ2RtYS0+bG9jayk7CisKKwkvKiBXZSBnb3QgYW4gaW50ZXJydXB0LCB3ZSBjYW4gcmVtb3Zl
IHRoZSB0aW1lciAqLworCWRlbF90aW1lcigmc2dkbWEtPnJlc2V0X3RpbWVyKTsKKworCXNnX3N0
YXRlID0gc2dkbWEtPnNnX3N0YXRlICsgc2dzbG90OworCWlmICghc2dfc3RhdGUtPnF1ZXVlZF9z
Z2xpc3QpIHsKKwkJc3Bpbl91bmxvY2soJnNnZG1hLT5sb2NrKTsKKwkJcHJpbnRrKEtFUk5fRVJS
ICIlczogc2dkbWEgY29tcGxldGVkIHdoZW4gbm9uZSBxdWV1ZWQhXG4iLAorCQkgICAgICAgX19m
dW5jX18pOworCQlyZXR1cm47CisJfQorCisJc2dfc3RhdGUtPmNzciB8PSBjc3I7CisJaWYgKCEt
LXNnX3N0YXRlLT5xdWV1ZWRfc2dsaXN0KSB7CisJCS8qIFF1ZXVlIGZvciB0aGlzIHNnbGlzdCBp
cyBlbXB0eSwgc28gY2hlY2sgdG8gc2VlIGlmIHdlJ3JlCisJCSAqIGRvbmUuCisJCSAqLworCQlp
ZiAoKHNnX3N0YXRlLT5uZXh0X3NnbGlzdCA9PSBzZ19zdGF0ZS0+c2dsZW4pCisJCSAgICB8fCAo
c2dfc3RhdGUtPmNzciAmIGNzcl9lcnJvcikpIHsKKwkJCXNnZG1hX2NhbGxiYWNrX3QgY2FsbGJh
Y2sgPSBzZ19zdGF0ZS0+Y2FsbGJhY2s7CisJCQl2b2lkICphcmcgPSBzZ19zdGF0ZS0+YXJnOwor
CQkJdTMyIHNnX2NzciA9IHNnX3N0YXRlLT5jc3I7CisJCQkvKiBBbGwgZG9uZSB3aXRoIHRoaXMg
c2dsaXN0ICovCisJCQlzZ2RtYS0+ZnJlZV9zZ2RtYSsrOworCQkJaWYgKGNhbGxiYWNrKSB7CisJ
CQkJc3Bpbl91bmxvY2soJnNnZG1hLT5sb2NrKTsKKwkJCQkoKmNhbGxiYWNrKSAoc2dkbWEsIHNn
X2NzciwgYXJnKTsKKwkJCQlyZXR1cm47CisJCQl9CisJCX0KKwl9CisKKwlzcGluX3VubG9jaygm
c2dkbWEtPmxvY2spOworfQorCisvKiBTdGFydCBxdWV1ZWQgc2NhdHRlci1nYXRoZXIgRE1BIHRy
YW5zZmVycy4gKi8KK3ZvaWQgb21hcDI0eHhjYW1fc2dkbWFfcHJvY2VzcyhzdHJ1Y3Qgb21hcDI0
eHhjYW1fc2dkbWEgKnNnZG1hKQoreworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisJaW50IHF1ZXVl
ZF9zZ2RtYSwgc2dzbG90OworCXN0cnVjdCBzZ2RtYV9zdGF0ZSAqc2dfc3RhdGU7CisJY29uc3Qg
dTMyIGNzcl9lcnJvciA9IENBTURNQV9DU1JfTUlTQUxJR05FRF9FUlIKKwkJfCBDQU1ETUFfQ1NS
X1NVUEVSVklTT1JfRVJSIHwgQ0FNRE1BX0NTUl9TRUNVUkVfRVJSCisJCXwgQ0FNRE1BX0NTUl9U
UkFOU19FUlIgfCBDQU1ETUFfQ1NSX0RST1A7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmc2dkbWEt
PmxvY2ssIGZsYWdzKTsKKworCXF1ZXVlZF9zZ2RtYSA9IE5VTV9TR19ETUEgLSBzZ2RtYS0+ZnJl
ZV9zZ2RtYTsKKwlzZ3Nsb3QgPSAoc2dkbWEtPm5leHRfc2dkbWEgKyBzZ2RtYS0+ZnJlZV9zZ2Rt
YSkgJSBOVU1fU0dfRE1BOworCXdoaWxlIChxdWV1ZWRfc2dkbWEgPiAwKSB7CisJCXNnX3N0YXRl
ID0gc2dkbWEtPnNnX3N0YXRlICsgc2dzbG90OworCQl3aGlsZSAoKHNnX3N0YXRlLT5uZXh0X3Nn
bGlzdCA8IHNnX3N0YXRlLT5zZ2xlbikgJiYKKwkJICAgICAgICEoc2dfc3RhdGUtPmNzciAmIGNz
cl9lcnJvcikpIHsKKwkJCWNvbnN0IHN0cnVjdCBzY2F0dGVybGlzdCAqc2dsaXN0OworCQkJdW5z
aWduZWQgaW50IGxlbjsKKworCQkJc2dsaXN0ID0gc2dfc3RhdGUtPnNnbGlzdCArIHNnX3N0YXRl
LT5uZXh0X3NnbGlzdDsKKwkJCS8qIHRyeSB0byBzdGFydCB0aGUgbmV4dCBETUEgdHJhbnNmZXIg
Ki8KKwkJCWlmIChzZ19zdGF0ZS0+bmV4dF9zZ2xpc3QgKyAxID09IHNnX3N0YXRlLT5zZ2xlbikg
eworCQkJCS8qCisJCQkJICogIE9uIHRoZSBsYXN0IHNnLCB3ZSBoYW5kbGUgdGhlIGNhc2Ugd2hl
cmUKKwkJCQkgKiAgY2FtLT5pbWcucGl4LnNpemVpbWFnZSAlIFBBR0VfQUxJR04gIT0gMAorCQkJ
CSAqLworCQkJCWxlbiA9IHNnX3N0YXRlLT5sZW4gLSBzZ19zdGF0ZS0+Ynl0ZXNfcmVhZDsKKwkJ
CX0gZWxzZSB7CisJCQkJbGVuID0gc2dfZG1hX2xlbihzZ2xpc3QpOworCQkJfQorCisJCQlpZiAo
b21hcDI0eHhjYW1fZG1hX3N0YXJ0KCZzZ2RtYS0+ZG1hLAorCQkJCQkJICBzZ19kbWFfYWRkcmVz
cyhzZ2xpc3QpLAorCQkJCQkJICBsZW4sCisJCQkJCQkgIG9tYXAyNHh4Y2FtX3NnZG1hX2NhbGxi
YWNrLAorCQkJCQkJICAodm9pZCAqKXNnc2xvdCkpIHsKKwkJCQkvKiBETUEgc3RhcnQgZmFpbGVk
ICovCisJCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmc2dkbWEtPmxvY2ssIGZsYWdzKTsKKwkJ
CQlyZXR1cm47CisJCQl9IGVsc2UgeworCQkJCXVuc2lnbmVkIGxvbmcgZXhwaXJlczsKKwkJCQkv
KiBETUEgc3RhcnQgd2FzIHN1Y2Nlc3NmdWwgKi8KKwkJCQlzZ19zdGF0ZS0+bmV4dF9zZ2xpc3Qr
KzsKKwkJCQlzZ19zdGF0ZS0+Ynl0ZXNfcmVhZCArPSBsZW47CisJCQkJc2dfc3RhdGUtPnF1ZXVl
ZF9zZ2xpc3QrKzsKKworCQkJCS8qIFdlIHN0YXJ0IHRoZSByZXNldCB0aW1lciAqLworCQkJCWV4
cGlyZXMgPSBqaWZmaWVzICsgSFo7CisJCQkJbW9kX3RpbWVyKCZzZ2RtYS0+cmVzZXRfdGltZXIs
IGV4cGlyZXMpOworCQkJfQorCQl9CisJCXF1ZXVlZF9zZ2RtYS0tOworCQlzZ3Nsb3QgPSAoc2dz
bG90ICsgMSkgJSBOVU1fU0dfRE1BOworCX0KKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnNn
ZG1hLT5sb2NrLCBmbGFncyk7Cit9CisKKy8qCisgKiBRdWV1ZSBhIHNjYXR0ZXItZ2F0aGVyIERN
QSB0cmFuc2ZlciBmcm9tIHRoZSBjYW1lcmEgdG8gbWVtb3J5LgorICogUmV0dXJucyB6ZXJvIGlm
IHRoZSB0cmFuc2ZlciB3YXMgc3VjY2Vzc2Z1bGx5IHF1ZXVlZCwgb3Igbm9uLXplcm8KKyAqIGlm
IGFsbCBvZiB0aGUgc2NhdHRlci1nYXRoZXIgc2xvdHMgYXJlIGFscmVhZHkgaW4gdXNlLgorICov
CitpbnQgb21hcDI0eHhjYW1fc2dkbWFfcXVldWUoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpz
Z2RtYSwKKwkJCSAgICBjb25zdCBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnNnbGlzdCwgaW50IHNnbGVu
LAorCQkJICAgIGludCBsZW4sIHNnZG1hX2NhbGxiYWNrX3QgY2FsbGJhY2ssIHZvaWQgKmFyZykK
K3sKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCXN0cnVjdCBzZ2RtYV9zdGF0ZSAqc2dfc3RhdGU7
CisKKwlpZiAoKHNnbGVuIDwgMCkgfHwgKChzZ2xlbiA+IDApICYgIXNnbGlzdCkpCisJCXJldHVy
biAtRUlOVkFMOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnNnZG1hLT5sb2NrLCBmbGFncyk7CisK
KwlpZiAoIXNnZG1hLT5mcmVlX3NnZG1hKSB7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnNn
ZG1hLT5sb2NrLCBmbGFncyk7CisJCXJldHVybiAtRUJVU1k7CisJfQorCisJc2dfc3RhdGUgPSBz
Z2RtYS0+c2dfc3RhdGUgKyBzZ2RtYS0+bmV4dF9zZ2RtYTsKKworCXNnX3N0YXRlLT5zZ2xpc3Qg
PSBzZ2xpc3Q7CisJc2dfc3RhdGUtPnNnbGVuID0gc2dsZW47CisJc2dfc3RhdGUtPm5leHRfc2ds
aXN0ID0gMDsKKwlzZ19zdGF0ZS0+Ynl0ZXNfcmVhZCA9IDA7CisJc2dfc3RhdGUtPmxlbiA9IGxl
bjsKKwlzZ19zdGF0ZS0+cXVldWVkX3NnbGlzdCA9IDA7CisJc2dfc3RhdGUtPmNzciA9IDA7CisJ
c2dfc3RhdGUtPmNhbGxiYWNrID0gY2FsbGJhY2s7CisJc2dfc3RhdGUtPmFyZyA9IGFyZzsKKwor
CXNnZG1hLT5uZXh0X3NnZG1hID0gKHNnZG1hLT5uZXh0X3NnZG1hICsgMSkgJSBOVU1fU0dfRE1B
OworCXNnZG1hLT5mcmVlX3NnZG1hLS07CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZzZ2Rt
YS0+bG9jaywgZmxhZ3MpOworCisJb21hcDI0eHhjYW1fc2dkbWFfcHJvY2VzcyhzZ2RtYSk7CisK
KwlyZXR1cm4gMDsKK30KKworLyogU3luYyBzY2F0dGVyLWdhdGhlciBETUEgYnkgYWJvcnRpbmcg
YW55IERNQSB0cmFuc2ZlcnMgY3VycmVudGx5IGluIHByb2dyZXNzLgorICogQW55IHF1ZXVlZCBz
Y2F0dGVyLWdhdGhlciBETUEgdHJhbnNhY3Rpb25zIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gc3Rh
cnRlZAorICogd2lsbCByZW1haW4gcXVldWVkLiAgVGhlIERNQSBjb250cm9sbGVyIHdpbGwgYmUg
aWRsZSBhZnRlciB0aGlzIHJvdXRpbmUKKyAqIGNvbXBsZXRlcy4gIFdoZW4gdGhlIHNjYXR0ZXIt
Z2F0aGVyIHF1ZXVlIGlzIHJlc3RhcnRlZCwgdGhlIG5leHQKKyAqIHNjYXR0ZXItZ2F0aGVyIERN
QSB0cmFuc2ZlciB3aWxsIGJlZ2luIGF0IHRoZSBzdGFydCBvZiBhIG5ldyB0cmFuc2FjdGlvbi4K
KyAqLwordm9pZCBvbWFwMjR4eGNhbV9zZ2RtYV9zeW5jKHN0cnVjdCBvbWFwMjR4eGNhbV9zZ2Rt
YSAqc2dkbWEpCit7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwlpbnQgc2dzbG90OworCXN0cnVj
dCBzZ2RtYV9zdGF0ZSAqc2dfc3RhdGU7CisJdTMyIGNzciA9IENBTURNQV9DU1JfVFJBTlNfRVJS
OworCisJLyogc3RvcCBhbnkgRE1BIHRyYW5zZmVycyBpbiBwcm9ncmVzcyAqLworCW9tYXAyNHh4
Y2FtX2RtYV9zdG9wKCZzZ2RtYS0+ZG1hLCBjc3IpOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnNn
ZG1hLT5sb2NrLCBmbGFncyk7CisKKwlpZiAoc2dkbWEtPmZyZWVfc2dkbWEgPCBOVU1fU0dfRE1B
KSB7CisJCXNnc2xvdCA9IChzZ2RtYS0+bmV4dF9zZ2RtYSArIHNnZG1hLT5mcmVlX3NnZG1hKSAl
IE5VTV9TR19ETUE7CisJCXNnX3N0YXRlID0gc2dkbWEtPnNnX3N0YXRlICsgc2dzbG90OworCQlp
ZiAoc2dfc3RhdGUtPm5leHRfc2dsaXN0ICE9IDApIHsKKwkJCS8qIFRoaXMgRE1BIHRyYW5zZmVy
IHdhcyBpbiBwcm9ncmVzcywgc28gYWJvcnQgaXQuICovCisJCQlzZ2RtYV9jYWxsYmFja190IGNh
bGxiYWNrID0gc2dfc3RhdGUtPmNhbGxiYWNrOworCQkJdm9pZCAqYXJnID0gc2dfc3RhdGUtPmFy
ZzsKKwkJCXNnZG1hLT5mcmVlX3NnZG1hKys7CisJCQlpZiAoY2FsbGJhY2spIHsKKwkJCQkvKiBs
ZWF2ZSBpbnRlcnJ1cHRzIG1hc2tlZCAqLworCQkJCXNwaW5fdW5sb2NrKCZzZ2RtYS0+bG9jayk7
CisJCQkJKCpjYWxsYmFjaykgKHNnZG1hLCBjc3IsIGFyZyk7CisJCQkJc3Bpbl9sb2NrKCZzZ2Rt
YS0+bG9jayk7CisJCQl9CisJCX0KKwl9CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZzZ2Rt
YS0+bG9jaywgZmxhZ3MpOworfQorCit2b2lkIG9tYXAyNHh4Y2FtX3NnZG1hX2luaXQoc3RydWN0
IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSwKKwkJCSAgICB1bnNpZ25lZCBsb25nIGJhc2UsCisJ
CQkgICAgdm9pZCAoKnJlc2V0X2NhbGxiYWNrKSh1bnNpZ25lZCBsb25nIGRhdGEpLAorCQkJICAg
IHVuc2lnbmVkIGxvbmcgcmVzZXRfY2FsbGJhY2tfZGF0YSkKK3sKKwlpbnQgc2c7CisKKwlzcGlu
X2xvY2tfaW5pdCgmc2dkbWEtPmxvY2spOworCXNnZG1hLT5mcmVlX3NnZG1hID0gTlVNX1NHX0RN
QTsKKwlzZ2RtYS0+bmV4dF9zZ2RtYSA9IDA7CisJZm9yIChzZyA9IDA7IHNnIDwgTlVNX1NHX0RN
QTsgc2crKykgeworCQlzZ2RtYS0+c2dfc3RhdGVbc2ddLnNnbGVuID0gMDsKKwkJc2dkbWEtPnNn
X3N0YXRlW3NnXS5uZXh0X3NnbGlzdCA9IDA7CisJCXNnZG1hLT5zZ19zdGF0ZVtzZ10uYnl0ZXNf
cmVhZCA9IDA7CisJCXNnZG1hLT5zZ19zdGF0ZVtzZ10ucXVldWVkX3NnbGlzdCA9IDA7CisJCXNn
ZG1hLT5zZ19zdGF0ZVtzZ10uY3NyID0gMDsKKwkJc2dkbWEtPnNnX3N0YXRlW3NnXS5jYWxsYmFj
ayA9IE5VTEw7CisJCXNnZG1hLT5zZ19zdGF0ZVtzZ10uYXJnID0gTlVMTDsKKwl9CisKKwlvbWFw
MjR4eGNhbV9kbWFfaW5pdCgmc2dkbWEtPmRtYSwgYmFzZSk7CisJc2V0dXBfdGltZXIoJnNnZG1h
LT5yZXNldF90aW1lciwgcmVzZXRfY2FsbGJhY2ssIHJlc2V0X2NhbGxiYWNrX2RhdGEpOworfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92aWRlby9vbWFwMjR4eGNhbS5jIGIvZHJpdmVycy9t
ZWRpYS92aWRlby9vbWFwMjR4eGNhbS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAuLjM2ZDJlYWYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAy
NHh4Y2FtLmMKQEAgLTAsMCArMSwxOTA4IEBACisvKgorICogZHJpdmVycy9tZWRpYS92aWRlby9v
bWFwMjR4eGNhbS5jCisgKgorICogT01BUCAyIGNhbWVyYSBibG9jayBkcml2ZXIuCisgKgorICog
Q29weXJpZ2h0IChDKSAyMDA0IE1vbnRhVmlzdGEgU29mdHdhcmUsIEluYy4KKyAqIENvcHlyaWdo
dCAoQykgMjAwNCBUZXhhcyBJbnN0cnVtZW50cy4KKyAqIENvcHlyaWdodCAoQykgMjAwNy0yMDA4
IE5va2lhIENvcnBvcmF0aW9uLgorICoKKyAqIENvbnRhY3Q6IFNha2FyaSBBaWx1cyA8c2FrYXJp
LmFpbHVzQG5va2lhLmNvbT4KKyAqCisgKiBCYXNlZCBvbiBjb2RlIGZyb20gQW5keSBMb3dlIDxz
b3VyY2VAbXZpc3RhLmNvbT4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogdmVyc2lvbiAyIGFzIHB1
Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLgorICoKKyAqIFRoaXMgcHJv
Z3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBi
dXQKKyAqIFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2Fy
cmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUgR05VCisgKiBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUg
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKyAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBp
ZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiBGb3VuZGF0aW9uLCBJbmMuLCA1
MSBGcmFua2xpbiBTdCwgRmlmdGggRmxvb3IsIEJvc3RvbiwgTUEKKyAqIDAyMTEwLTEzMDEgVVNB
CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisjaW5jbHVkZSA8bGludXgva2VybmVs
Lmg+CisjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+CisjaW5jbHVkZSA8bGludXgvdmlkZW9k
ZXYyLmg+CisjaW5jbHVkZSA8bGludXgvcGNpLmg+CQkvKiBuZWVkZWQgZm9yIHZpZGVvYnVmcyAq
LworI2luY2x1ZGUgPGxpbnV4L3ZlcnNpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9k
ZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9pby5oPgor
CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jb21tb24uaD4KKyNpbmNsdWRlIDxtZWRpYS92NGwyLWlv
Y3RsLmg+CisKKyNpbmNsdWRlICJvbWFwMjR4eGNhbS5oIgorCisjZGVmaW5lIE9NQVAyNFhYQ0FN
X1ZFUlNJT04gS0VSTkVMX1ZFUlNJT04oMCwgMCwgMCkKKworI2RlZmluZSBSRVNFVF9USU1FT1VU
X05TIDEwMDAwCisKK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX3Jlc2V0KHN0cnVjdCBvbWFwMjR4
eGNhbV9kZXZpY2UgKmNhbSk7CitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX3NlbnNvcl9pZl9lbmFi
bGUoc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKTsKK3N0YXRpYyB2b2lkIG9tYXAyNHh4
Y2FtX2RldmljZV91bnJlZ2lzdGVyKHN0cnVjdCB2NGwyX2ludF9kZXZpY2UgKnMpOworc3RhdGlj
IGludCBvbWFwMjR4eGNhbV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldik7CisK
Ky8qIG1vZHVsZSBwYXJhbWV0ZXJzICovCitzdGF0aWMgaW50IHZpZGVvX25yID0gLTE7CS8qIHZp
ZGVvIGRldmljZSBtaW5vciAoLTEgPT0+IGF1dG8gYXNzaWduKSAqLworLyoKKyAqIE1heGltdW0g
YW1vdW50IG9mIG1lbW9yeSB0byB1c2UgZm9yIGNhcHR1cmUgYnVmZmVycy4KKyAqIERlZmF1bHQg
aXMgNDgwMEtCLCBlbm91Z2ggdG8gZG91YmxlLWJ1ZmZlciBTWEdBLgorICovCitzdGF0aWMgaW50
IGNhcHR1cmVfbWVtID0gMTI4MCAqIDk2MCAqIDIgKiAyOworCitzdGF0aWMgc3RydWN0IHY0bDJf
aW50X2RldmljZSBvbWFwMjR4eGNhbTsKKworLyoKKyAqCisgKiBDbG9ja3MuCisgKgorICovCisK
K3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2Nsb2NrX3B1dChzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2
aWNlICpjYW0pCit7CisJaWYgKGNhbS0+aWNrICE9IE5VTEwgJiYgIUlTX0VSUihjYW0tPmljaykp
CisJCWNsa19wdXQoY2FtLT5pY2spOworCWlmIChjYW0tPmZjayAhPSBOVUxMICYmICFJU19FUlIo
Y2FtLT5mY2spKQorCQljbGtfcHV0KGNhbS0+ZmNrKTsKKworCWNhbS0+aWNrID0gY2FtLT5mY2sg
PSBOVUxMOworfQorCitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX2Nsb2NrX2dldChzdHJ1Y3Qgb21h
cDI0eHhjYW1fZGV2aWNlICpjYW0pCit7CisJaW50IHJ2YWwgPSAwOworCisJY2FtLT5mY2sgPSBj
bGtfZ2V0KGNhbS0+ZGV2LCAiY2FtX2ZjayIpOworCWlmIChJU19FUlIoY2FtLT5mY2spKSB7CisJ
CWRldl9lcnIoY2FtLT5kZXYsICJjYW4ndCBnZXQgY2FtX2ZjayIpOworCQlydmFsID0gUFRSX0VS
UihjYW0tPmZjayk7CisJCW9tYXAyNHh4Y2FtX2Nsb2NrX3B1dChjYW0pOworCQlyZXR1cm4gcnZh
bDsKKwl9CisKKwljYW0tPmljayA9IGNsa19nZXQoY2FtLT5kZXYsICJjYW1faWNrIik7CisJaWYg
KElTX0VSUihjYW0tPmljaykpIHsKKwkJZGV2X2VycihjYW0tPmRldiwgImNhbid0IGdldCBjYW1f
aWNrIik7CisJCXJ2YWwgPSBQVFJfRVJSKGNhbS0+aWNrKTsKKwkJb21hcDI0eHhjYW1fY2xvY2tf
cHV0KGNhbSk7CisJfQorCisJcmV0dXJuIHJ2YWw7Cit9CisKK3N0YXRpYyB2b2lkIG9tYXAyNHh4
Y2FtX2Nsb2NrX29uKHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSkKK3sKKwljbGtfZW5h
YmxlKGNhbS0+ZmNrKTsKKwljbGtfZW5hYmxlKGNhbS0+aWNrKTsKK30KKworc3RhdGljIHZvaWQg
b21hcDI0eHhjYW1fY2xvY2tfb2ZmKHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSkKK3sK
KwljbGtfZGlzYWJsZShjYW0tPmZjayk7CisJY2xrX2Rpc2FibGUoY2FtLT5pY2spOworfQorCisv
KgorICoKKyAqIENhbWVyYSBjb3JlCisgKgorICovCisKKy8qCisgKiBTZXQgeGNsay4KKyAqCisg
KiBUbyBkaXNhYmxlIHhjbGssIHVzZSB2YWx1ZSB6ZXJvLgorICovCitzdGF0aWMgdm9pZCBvbWFw
MjR4eGNhbV9jb3JlX3hjbGtfc2V0KGNvbnN0IHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNh
bSwKKwkJCQkgICAgICB1MzIgeGNsaykKK3sKKwlpZiAoeGNsaykgeworCQl1MzIgZGl2aXNvciA9
IENBTV9NQ0xLIC8geGNsazsKKworCQlpZiAoZGl2aXNvciA9PSAxKQorCQkJb21hcDI0eHhjYW1f
cmVnX291dChjYW0tPm1taW9fYmFzZSArIENDX1JFR19PRkZTRVQsCisJCQkJCSAgICBDQ19DVFJM
X1hDTEssCisJCQkJCSAgICBDQ19DVFJMX1hDTEtfRElWX0JZUEFTUyk7CisJCWVsc2UKKwkJCW9t
YXAyNHh4Y2FtX3JlZ19vdXQoY2FtLT5tbWlvX2Jhc2UgKyBDQ19SRUdfT0ZGU0VULAorCQkJCQkg
ICAgQ0NfQ1RSTF9YQ0xLLCBkaXZpc29yKTsKKwl9IGVsc2UKKwkJb21hcDI0eHhjYW1fcmVnX291
dChjYW0tPm1taW9fYmFzZSArIENDX1JFR19PRkZTRVQsCisJCQkJICAgIENDX0NUUkxfWENMSywg
Q0NfQ1RSTF9YQ0xLX0RJVl9TVEFCTEVfTE9XKTsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhj
YW1fY29yZV9od2luaXQoY29uc3Qgc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQorewor
CS8qCisJICogU2V0dGluZyB0aGUgY2FtZXJhIGNvcmUgQVVUT0lETEUgYml0IGNhdXNlcyBwcm9i
bGVtcyB3aXRoIGZyYW1lCisJICogc3luY2hyb25pemF0aW9uLCBzbyB3ZSB3aWxsIGNsZWFyIHRo
ZSBBVVRPSURMRSBiaXQgaW5zdGVhZC4KKwkgKi8KKwlvbWFwMjR4eGNhbV9yZWdfb3V0KGNhbS0+
bW1pb19iYXNlICsgQ0NfUkVHX09GRlNFVCwgQ0NfU1lTQ09ORklHLAorCQkJICAgIENDX1NZU0NP
TkZJR19BVVRPSURMRSk7CisKKwkvKiBwcm9ncmFtIHRoZSBjYW1lcmEgaW50ZXJmYWNlIERNQSBw
YWNrZXQgc2l6ZSAqLworCW9tYXAyNHh4Y2FtX3JlZ19vdXQoY2FtLT5tbWlvX2Jhc2UgKyBDQ19S
RUdfT0ZGU0VULCBDQ19DVFJMX0RNQSwKKwkJCSAgICBDQ19DVFJMX0RNQV9FTiB8IChETUFfVEhS
RVNIT0xEIC8gNCAtIDEpKTsKKworCS8qIGVuYWJsZSBjYW1lcmEgY29yZSBlcnJvciBpbnRlcnJ1
cHRzICovCisJb21hcDI0eHhjYW1fcmVnX291dChjYW0tPm1taW9fYmFzZSArIENDX1JFR19PRkZT
RVQsIENDX0lSUUVOQUJMRSwKKwkJCSAgICBDQ19JUlFFTkFCTEVfRldfRVJSX0lSUQorCQkJICAg
IHwgQ0NfSVJRRU5BQkxFX0ZTQ19FUlJfSVJRCisJCQkgICAgfCBDQ19JUlFFTkFCTEVfU1NDX0VS
Ul9JUlEKKwkJCSAgICB8IENDX0lSUUVOQUJMRV9GSUZPX09GX0lSUSk7Cit9CisKKy8qCisgKiBF
bmFibGUgdGhlIGNhbWVyYSBjb3JlLgorICoKKyAqIERhdGEgdHJhbnNmZXIgdG8gdGhlIGNhbWVy
YSBETUEgc3RhcnRzIGZyb20gbmV4dCBzdGFydGluZyBmcmFtZS4KKyAqLworc3RhdGljIHZvaWQg
b21hcDI0eHhjYW1fY29yZV9lbmFibGUoY29uc3Qgc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAq
Y2FtKQoreworCisJb21hcDI0eHhjYW1fcmVnX291dChjYW0tPm1taW9fYmFzZSArIENDX1JFR19P
RkZTRVQsIENDX0NUUkwsCisJCQkgICAgY2FtLT5jY19jdHJsKTsKK30KKworLyoKKyAqIERpc2Fi
bGUgY2FtZXJhIGNvcmUuCisgKgorICogVGhlIGRhdGEgdHJhbnNmZXIgd2lsbCBiZSBzdG9wcGVk
IGltbWVkaWF0ZWx5IChDQ19DVFJMX0NDX1JTVCkuIFRoZQorICogY29yZSBpbnRlcm5hbCBzdGF0
ZSBtYWNoaW5lcyB3aWxsIGJlIHJlc2V0LiBVc2UKKyAqIENDX0NUUkxfQ0NfRlJBTUVfVFJJRyBp
bnN0ZWFkIGlmIHlvdSB3YW50IHRvIHRyYW5zZmVyIHRoZSBjdXJyZW50CisgKiBmcmFtZSBjb21w
bGV0ZWx5LgorICovCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9jb3JlX2Rpc2FibGUoY29uc3Qg
c3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQoreworCW9tYXAyNHh4Y2FtX3JlZ19vdXQo
Y2FtLT5tbWlvX2Jhc2UgKyBDQ19SRUdfT0ZGU0VULCBDQ19DVFJMLAorCQkJICAgIENDX0NUUkxf
Q0NfUlNUKTsKK30KKworLyogSW50ZXJydXB0IHNlcnZpY2Ugcm91dGluZSBmb3IgY2FtZXJhIGNv
cmUgaW50ZXJydXB0cy4gKi8KK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2NvcmVfaXNyKHN0cnVj
dCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSkKK3sKKwl1MzIgY2NfaXJxc3RhdHVzOworCWNvbnN0
IHUzMiBjY19pcnFzdGF0dXNfZXJyID0KKwkJQ0NfSVJRU1RBVFVTX0ZXX0VSUl9JUlEKKwkJfCBD
Q19JUlFTVEFUVVNfRlNDX0VSUl9JUlEKKwkJfCBDQ19JUlFTVEFUVVNfU1NDX0VSUl9JUlEKKwkJ
fCBDQ19JUlFTVEFUVVNfRklGT19VRl9JUlEKKwkJfCBDQ19JUlFTVEFUVVNfRklGT19PRl9JUlE7
CisKKwljY19pcnFzdGF0dXMgPSBvbWFwMjR4eGNhbV9yZWdfaW4oY2FtLT5tbWlvX2Jhc2UgKyBD
Q19SRUdfT0ZGU0VULAorCQkJCQkgIENDX0lSUVNUQVRVUyk7CisJb21hcDI0eHhjYW1fcmVnX291
dChjYW0tPm1taW9fYmFzZSArIENDX1JFR19PRkZTRVQsIENDX0lSUVNUQVRVUywKKwkJCSAgICBj
Y19pcnFzdGF0dXMpOworCisJaWYgKGNjX2lycXN0YXR1cyAmIGNjX2lycXN0YXR1c19lcnIKKwkg
ICAgJiYgIWF0b21pY19yZWFkKCZjYW0tPmluX3Jlc2V0KSkgeworCQlkZXZfZGJnKGNhbS0+ZGV2
LCAicmVzZXR0aW5nIGNhbWVyYSwgY2NfaXJxc3RhdHVzIDB4JXhcbiIsCisJCQljY19pcnFzdGF0
dXMpOworCQlvbWFwMjR4eGNhbV9yZXNldChjYW0pOworCX0KK30KKworLyoKKyAqCisgKiB2aWRl
b2J1Zl9idWZmZXIgaGFuZGxpbmcuCisgKgorICogTWVtb3J5IGZvciBtbWFwcGVkIHZpZGVvYnVm
X2J1ZmZlcnMgaXMgbm90IGFsbG9jYXRlZAorICogY29udmVudGlvbmFsbHksIGJ1dCBieSBzZXZl
cmFsIGttYWxsb2MgYWxsb2NhdGlvbnMgYW5kIHRoZW4KKyAqIGNyZWF0aW5nIHRoZSBzY2F0dGVy
bGlzdCBvbiBvdXIgb3duLiBVc2VyLXNwYWNlIGJ1ZmZlcnMgYXJlIGhhbmRsZWQKKyAqIG5vcm1h
bGx5LgorICoKKyAqLworCisvKgorICogRnJlZSB0aGUgbWVtb3J5LW1hcHBlZCBidWZmZXIgbWVt
b3J5IGFsbG9jYXRlZCBmb3IgYQorICogdmlkZW9idWZfYnVmZmVyIGFuZCB0aGUgYXNzb2NpYXRl
ZCBzY2F0dGVybGlzdC4KKyAqLworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1fdmJxX2ZyZWVfbW1h
cF9idWZmZXIoc3RydWN0IHZpZGVvYnVmX2J1ZmZlciAqdmIpCit7CisJc3RydWN0IHZpZGVvYnVm
X2RtYWJ1ZiAqZG1hID0gdmlkZW9idWZfdG9fZG1hKHZiKTsKKwlzaXplX3QgYWxsb2Nfc2l6ZTsK
KwlzdHJ1Y3QgcGFnZSAqcGFnZTsKKwlpbnQgaTsKKworCWlmIChkbWEtPnNnbGlzdCA9PSBOVUxM
KQorCQlyZXR1cm47CisKKwlpID0gZG1hLT5zZ2xlbjsKKwl3aGlsZSAoaSkgeworCQlpLS07CisJ
CWFsbG9jX3NpemUgPSBzZ19kbWFfbGVuKCZkbWEtPnNnbGlzdFtpXSk7CisJCXBhZ2UgPSBzZ19w
YWdlKCZkbWEtPnNnbGlzdFtpXSk7CisJCWRvIHsKKwkJCUNsZWFyUGFnZVJlc2VydmVkKHBhZ2Ur
Kyk7CisJCX0gd2hpbGUgKGFsbG9jX3NpemUgLT0gUEFHRV9TSVpFKTsKKwkJX19mcmVlX3BhZ2Vz
KHNnX3BhZ2UoJmRtYS0+c2dsaXN0W2ldKSwKKwkJCSAgICAgZ2V0X29yZGVyKHNnX2RtYV9sZW4o
JmRtYS0+c2dsaXN0W2ldKSkpOworCX0KKworCWtmcmVlKGRtYS0+c2dsaXN0KTsKKwlkbWEtPnNn
bGlzdCA9IE5VTEw7Cit9CisKKy8qIFJlbGVhc2UgYWxsIG1lbW9yeSByZWxhdGVkIHRvIHRoZSB2
aWRlb2J1Zl9xdWV1ZS4gKi8KK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX3ZicV9mcmVlX21tYXBf
YnVmZmVycyhzdHJ1Y3QgdmlkZW9idWZfcXVldWUgKnZicSkKK3sKKwlpbnQgaTsKKworCW11dGV4
X2xvY2soJnZicS0+dmJfbG9jayk7CisKKwlmb3IgKGkgPSAwOyBpIDwgVklERU9fTUFYX0ZSQU1F
OyBpKyspIHsKKwkJaWYgKE5VTEwgPT0gdmJxLT5idWZzW2ldKQorCQkJY29udGludWU7CisJCWlm
IChWNEwyX01FTU9SWV9NTUFQICE9IHZicS0+YnVmc1tpXS0+bWVtb3J5KQorCQkJY29udGludWU7
CisJCXZicS0+b3BzLT5idWZfcmVsZWFzZSh2YnEsIHZicS0+YnVmc1tpXSk7CisJCW9tYXAyNHh4
Y2FtX3ZicV9mcmVlX21tYXBfYnVmZmVyKHZicS0+YnVmc1tpXSk7CisJCWtmcmVlKHZicS0+YnVm
c1tpXSk7CisJCXZicS0+YnVmc1tpXSA9IE5VTEw7CisJfQorCisJbXV0ZXhfdW5sb2NrKCZ2YnEt
PnZiX2xvY2spOworCisJdmlkZW9idWZfbW1hcF9mcmVlKHZicSk7Cit9CisKKy8qCisgKiBBbGxv
Y2F0ZSBwaHlzaWNhbGx5IGFzIGNvbnRpZ3VvdXMgYXMgcG9zc2libGUgYnVmZmVyIGZvciB2aWRl
bworICogZnJhbWUgYW5kIGFsbG9jYXRlIGFuZCBidWlsZCBETUEgc2NhdHRlci1nYXRoZXIgbGlz
dCBmb3IgaXQuCisgKi8KK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1fdmJxX2FsbG9jX21tYXBfYnVm
ZmVyKHN0cnVjdCB2aWRlb2J1Zl9idWZmZXIgKnZiKQoreworCXVuc2lnbmVkIGludCBvcmRlcjsK
KwlzaXplX3QgYWxsb2Nfc2l6ZSwgc2l6ZSA9IHZiLT5ic2l6ZTsgLyogdmItPmJzaXplIGlzIHBh
Z2UgYWxpZ25lZCAqLworCXN0cnVjdCBwYWdlICpwYWdlOworCWludCBtYXhfcGFnZXMsIGVyciA9
IDAsIGkgPSAwOworCXN0cnVjdCB2aWRlb2J1Zl9kbWFidWYgKmRtYSA9IHZpZGVvYnVmX3RvX2Rt
YSh2Yik7CisKKwkvKgorCSAqIGFsbG9jYXRlIG1heGltdW0gc2l6ZSBzY2F0dGVyLWdhdGhlciBs
aXN0LiBOb3RlIHRoaXMgaXMKKwkgKiBvdmVyaGVhZC4gV2UgbWF5IG5vdCB1c2UgYXMgbWFueSBl
bnRyaWVzIGFzIHdlIGFsbG9jYXRlCisJICovCisJbWF4X3BhZ2VzID0gdmItPmJzaXplID4+IFBB
R0VfU0hJRlQ7CisJZG1hLT5zZ2xpc3QgPSBrY2FsbG9jKG1heF9wYWdlcywgc2l6ZW9mKCpkbWEt
PnNnbGlzdCksIEdGUF9LRVJORUwpOworCWlmIChkbWEtPnNnbGlzdCA9PSBOVUxMKSB7CisJCWVy
ciA9IC1FTk9NRU07CisJCWdvdG8gb3V0OworCX0KKworCXdoaWxlIChzaXplKSB7CisJCW9yZGVy
ID0gZ2V0X29yZGVyKHNpemUpOworCQkvKgorCQkgKiBkbyBub3Qgb3Zlci1hbGxvY2F0ZSBldmVu
IGlmIHdlIHdvdWxkIGdldCBsYXJnZXIKKwkJICogY29udGlndW91cyBjaHVuayB0aGF0IHdheQor
CQkgKi8KKwkJaWYgKChQQUdFX1NJWkUgPDwgb3JkZXIpID4gc2l6ZSkKKwkJCW9yZGVyLS07CisK
KwkJLyogdHJ5IHRvIGFsbG9jYXRlIGFzIG1hbnkgY29udGlndW91cyBwYWdlcyBhcyBwb3NzaWJs
ZSAqLworCQlwYWdlID0gYWxsb2NfcGFnZXMoR0ZQX0tFUk5FTCB8IEdGUF9ETUEsIG9yZGVyKTsK
KwkJLyogaWYgYWxsb2NhdGlvbiBmYWlscywgdHJ5IHRvIGFsbG9jYXRlIHNtYWxsZXIgYW1vdW50
ICovCisJCXdoaWxlIChwYWdlID09IE5VTEwpIHsKKwkJCW9yZGVyLS07CisJCQlwYWdlID0gYWxs
b2NfcGFnZXMoR0ZQX0tFUk5FTCB8IEdGUF9ETUEsIG9yZGVyKTsKKwkJCWlmIChwYWdlID09IE5V
TEwgJiYgIW9yZGVyKSB7CisJCQkJZXJyID0gLUVOT01FTTsKKwkJCQlnb3RvIG91dDsKKwkJCX0K
KwkJfQorCQlzaXplIC09IChQQUdFX1NJWkUgPDwgb3JkZXIpOworCisJCS8qIGFwcGVuZCBhbGxv
Y2F0ZWQgY2h1bmsgb2YgcGFnZXMgaW50byBzY2F0dGVyLWdhdGhlciBsaXN0ICovCisJCXNnX3Nl
dF9wYWdlKCZkbWEtPnNnbGlzdFtpXSwgcGFnZSwgUEFHRV9TSVpFIDw8IG9yZGVyLCAwKTsKKwkJ
ZG1hLT5zZ2xlbisrOworCQlpKys7CisKKwkJYWxsb2Nfc2l6ZSA9IChQQUdFX1NJWkUgPDwgb3Jk
ZXIpOworCisJCS8qIGNsZWFyIHBhZ2VzIGJlZm9yZSBnaXZpbmcgdGhlbSB0byB1c2VyIHNwYWNl
ICovCisJCW1lbXNldChwYWdlX2FkZHJlc3MocGFnZSksIDAsIGFsbG9jX3NpemUpOworCisJCS8q
IG1hcmsgYWxsb2NhdGVkIHBhZ2VzIHJlc2VydmVkICovCisJCWRvIHsKKwkJCVNldFBhZ2VSZXNl
cnZlZChwYWdlKyspOworCQl9IHdoaWxlIChhbGxvY19zaXplIC09IFBBR0VfU0laRSk7CisJfQor
CS8qCisJICogUkVWSVNJVDogbm90IGZ1bGx5IGNvcnJlY3QgdG8gYXNzaWduIG5yX3BhZ2VzID09
IHNnbGVuIGJ1dAorCSAqIHZpZGVvLWJ1ZiBpcyBwYXNzaW5nIG5yX3BhZ2VzIGZvciBlLmcuIHVu
bWFwX3NnIGNhbGxzCisJICovCisJZG1hLT5ucl9wYWdlcyA9IGRtYS0+c2dsZW47CisJZG1hLT5k
aXJlY3Rpb24gPSBQQ0lfRE1BX0ZST01ERVZJQ0U7CisKKwlyZXR1cm4gMDsKKworb3V0OgorCW9t
YXAyNHh4Y2FtX3ZicV9mcmVlX21tYXBfYnVmZmVyKHZiKTsKKwlyZXR1cm4gZXJyOworfQorCitz
dGF0aWMgaW50IG9tYXAyNHh4Y2FtX3ZicV9hbGxvY19tbWFwX2J1ZmZlcnMoc3RydWN0IHZpZGVv
YnVmX3F1ZXVlICp2YnEsCisJCQkJCSAgICAgIHVuc2lnbmVkIGludCBjb3VudCkKK3sKKwlpbnQg
aSwgZXJyID0gMDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKmZoID0KKwkJY29udGFpbmVyX29m
KHZicSwgc3RydWN0IG9tYXAyNHh4Y2FtX2ZoLCB2YnEpOworCisJbXV0ZXhfbG9jaygmdmJxLT52
Yl9sb2NrKTsKKworCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CisJCWVyciA9IG9tYXAy
NHh4Y2FtX3ZicV9hbGxvY19tbWFwX2J1ZmZlcih2YnEtPmJ1ZnNbaV0pOworCQlpZiAoZXJyKQor
CQkJZ290byBvdXQ7CisJCWRldl9kYmcoZmgtPmNhbS0+ZGV2LCAic2dsZW4gaXMgJWQgZm9yIGJ1
ZmZlciAlZFxuIiwKKwkJCXZpZGVvYnVmX3RvX2RtYSh2YnEtPmJ1ZnNbaV0pLT5zZ2xlbiwgaSk7
CisJfQorCisJbXV0ZXhfdW5sb2NrKCZ2YnEtPnZiX2xvY2spOworCisJcmV0dXJuIDA7CitvdXQ6
CisJd2hpbGUgKGkpIHsKKwkJaS0tOworCQlvbWFwMjR4eGNhbV92YnFfZnJlZV9tbWFwX2J1ZmZl
cih2YnEtPmJ1ZnNbaV0pOworCX0KKworCW11dGV4X3VubG9jaygmdmJxLT52Yl9sb2NrKTsKKwor
CXJldHVybiBlcnI7Cit9CisKKy8qCisgKiBUaGlzIHJvdXRpbmUgaXMgY2FsbGVkIGZyb20gaW50
ZXJydXB0IGNvbnRleHQgd2hlbiBhIHNjYXR0ZXItZ2F0aGVyIERNQQorICogdHJhbnNmZXIgb2Yg
YSB2aWRlb2J1Zl9idWZmZXIgY29tcGxldGVzLgorICovCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNh
bV92YnFfY29tcGxldGUoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSwKKwkJCQkgICAg
IHUzMiBjc3IsIHZvaWQgKmFyZykKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0g
PQorCQljb250YWluZXJfb2Yoc2dkbWEsIHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UsIHNnZG1h
KTsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKmZoID0gY2FtLT5zdHJlYW1pbmctPnByaXZhdGVf
ZGF0YTsKKwlzdHJ1Y3QgdmlkZW9idWZfYnVmZmVyICp2YiA9IChzdHJ1Y3QgdmlkZW9idWZfYnVm
ZmVyICopYXJnOworCWNvbnN0IHUzMiBjc3JfZXJyb3IgPSBDQU1ETUFfQ1NSX01JU0FMSUdORURf
RVJSCisJCXwgQ0FNRE1BX0NTUl9TVVBFUlZJU09SX0VSUiB8IENBTURNQV9DU1JfU0VDVVJFX0VS
UgorCQl8IENBTURNQV9DU1JfVFJBTlNfRVJSIHwgQ0FNRE1BX0NTUl9EUk9QOworCXVuc2lnbmVk
IGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2FtLT5jb3JlX2VuYWJsZV9kaXNh
YmxlX2xvY2ssIGZsYWdzKTsKKwlpZiAoLS1jYW0tPnNnZG1hX2luX3F1ZXVlID09IDApCisJCW9t
YXAyNHh4Y2FtX2NvcmVfZGlzYWJsZShjYW0pOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNh
bS0+Y29yZV9lbmFibGVfZGlzYWJsZV9sb2NrLCBmbGFncyk7CisKKwlkb19nZXR0aW1lb2ZkYXko
JnZiLT50cyk7CisJdmItPmZpZWxkX2NvdW50ID0gYXRvbWljX2FkZF9yZXR1cm4oMiwgJmZoLT5m
aWVsZF9jb3VudCk7CisJaWYgKGNzciAmIGNzcl9lcnJvcikgeworCQl2Yi0+c3RhdGUgPSBWSURF
T0JVRl9FUlJPUjsKKwkJaWYgKCFhdG9taWNfcmVhZCgmZmgtPmNhbS0+aW5fcmVzZXQpKSB7CisJ
CQlkZXZfZGJnKGNhbS0+ZGV2LCAicmVzZXR0aW5nIGNhbWVyYSwgY3NyIDB4JXhcbiIsIGNzcik7
CisJCQlvbWFwMjR4eGNhbV9yZXNldChjYW0pOworCQl9CisJfSBlbHNlCisJCXZiLT5zdGF0ZSA9
IFZJREVPQlVGX0RPTkU7CisJd2FrZV91cCgmdmItPmRvbmUpOworfQorCitzdGF0aWMgdm9pZCBv
bWFwMjR4eGNhbV92YnFfcmVsZWFzZShzdHJ1Y3QgdmlkZW9idWZfcXVldWUgKnZicSwKKwkJCQkg
ICAgc3RydWN0IHZpZGVvYnVmX2J1ZmZlciAqdmIpCit7CisJc3RydWN0IHZpZGVvYnVmX2RtYWJ1
ZiAqZG1hID0gdmlkZW9idWZfdG9fZG1hKHZiKTsKKworCS8qIHdhaXQgZm9yIGJ1ZmZlciwgZXNw
ZWNpYWxseSB0byBnZXQgb3V0IG9mIHRoZSBzZ2RtYSBxdWV1ZSAqLworCXZpZGVvYnVmX3dhaXRv
bih2YiwgMCwgMCk7CisJaWYgKHZiLT5tZW1vcnkgPT0gVjRMMl9NRU1PUllfTU1BUCkgeworCQlk
bWFfdW5tYXBfc2codmJxLT5kZXYsIGRtYS0+c2dsaXN0LCBkbWEtPnNnbGVuLAorCQkJICAgICBk
bWEtPmRpcmVjdGlvbik7CisJCWRtYS0+ZGlyZWN0aW9uID0gRE1BX05PTkU7CisJfSBlbHNlIHsK
KwkJdmlkZW9idWZfZG1hX3VubWFwKHZicSwgdmlkZW9idWZfdG9fZG1hKHZiKSk7CisJCXZpZGVv
YnVmX2RtYV9mcmVlKHZpZGVvYnVmX3RvX2RtYSh2YikpOworCX0KKworCXZiLT5zdGF0ZSA9IFZJ
REVPQlVGX05FRURTX0lOSVQ7Cit9CisKKy8qCisgKiBMaW1pdCB0aGUgbnVtYmVyIG9mIGF2YWls
YWJsZSBrZXJuZWwgaW1hZ2UgY2FwdHVyZSBidWZmZXJzIGJhc2VkIG9uIHRoZQorICogbnVtYmVy
IHJlcXVlc3RlZCwgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBpbWFnZSBzaXplLCBhbmQgdGhlIG1h
eGltdW0KKyAqIGFtb3VudCBvZiBtZW1vcnkgcGVybWl0dGVkIGZvciBrZXJuZWwgY2FwdHVyZSBi
dWZmZXJzLgorICovCitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX3ZicV9zZXR1cChzdHJ1Y3Qgdmlk
ZW9idWZfcXVldWUgKnZicSwgdW5zaWduZWQgaW50ICpjbnQsCisJCQkJIHVuc2lnbmVkIGludCAq
c2l6ZSkKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKmZoID0gdmJxLT5wcml2X2RhdGE7CisK
KwlpZiAoKmNudCA8PSAwKQorCQkqY250ID0gVklERU9fTUFYX0ZSQU1FOwkvKiBzdXBwbHkgYSBk
ZWZhdWx0IG51bWJlciBvZiBidWZmZXJzICovCisKKwlpZiAoKmNudCA+IFZJREVPX01BWF9GUkFN
RSkKKwkJKmNudCA9IFZJREVPX01BWF9GUkFNRTsKKworCSpzaXplID0gZmgtPnBpeC5zaXplaW1h
Z2U7CisKKwkvKiBhY2Nlc3NpbmcgZmgtPmNhbS0+Y2FwdHVyZV9tZW0gaXMgb2ssIGl0J3MgY29u
c3RhbnQgKi8KKwl3aGlsZSAoKnNpemUgKiAqY250ID4gZmgtPmNhbS0+Y2FwdHVyZV9tZW0pCisJ
CSgqY250KS0tOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1fZG1h
X2lvbG9jayhzdHJ1Y3QgdmlkZW9idWZfcXVldWUgKnZicSwKKwkJCQkgIHN0cnVjdCB2aWRlb2J1
Zl9kbWFidWYgKmRtYSkKK3sKKwlpbnQgZXJyID0gMDsKKworCWRtYS0+ZGlyZWN0aW9uID0gUENJ
X0RNQV9GUk9NREVWSUNFOworCWlmICghZG1hX21hcF9zZyh2YnEtPmRldiwgZG1hLT5zZ2xpc3Qs
IGRtYS0+c2dsZW4sIGRtYS0+ZGlyZWN0aW9uKSkgeworCQlrZnJlZShkbWEtPnNnbGlzdCk7CisJ
CWRtYS0+c2dsaXN0ID0gTlVMTDsKKwkJZG1hLT5zZ2xlbiA9IDA7CisJCWVyciA9IC1FSU87CisJ
fQorCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBvbWFwMjR4eGNhbV92YnFfcHJlcGFy
ZShzdHJ1Y3QgdmlkZW9idWZfcXVldWUgKnZicSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9idWZfYnVm
ZmVyICp2YiwKKwkJCQkgICBlbnVtIHY0bDJfZmllbGQgZmllbGQpCit7CisJc3RydWN0IG9tYXAy
NHh4Y2FtX2ZoICpmaCA9IHZicS0+cHJpdl9kYXRhOworCWludCBlcnIgPSAwOworCisJLyoKKwkg
KiBBY2Nlc3NpbmcgcGl4IGhlcmUgaXMgb2theSBzaW5jZSBpdCdzIGNvbnN0YW50IHdoaWxlCisJ
ICogc3RyZWFtaW5nIGlzIG9uIChhbmQgd2Ugb25seSBnZXQgY2FsbGVkIHRoZW4pLgorCSAqLwor
CWlmICh2Yi0+YmFkZHIpIHsKKwkJLyogVGhpcyBpcyBhIHVzZXJzcGFjZSBidWZmZXIuICovCisJ
CWlmIChmaC0+cGl4LnNpemVpbWFnZSA+IHZiLT5ic2l6ZSkgeworCQkJLyogVGhlIGJ1ZmZlciBp
c24ndCBiaWcgZW5vdWdoLiAqLworCQkJZXJyID0gLUVJTlZBTDsKKwkJfSBlbHNlCisJCQl2Yi0+
c2l6ZSA9IGZoLT5waXguc2l6ZWltYWdlOworCX0gZWxzZSB7CisJCWlmICh2Yi0+c3RhdGUgIT0g
VklERU9CVUZfTkVFRFNfSU5JVCkgeworCQkJLyoKKwkJCSAqIFdlIGhhdmUgYSBrZXJuZWwgYm91
bmNlIGJ1ZmZlciB0aGF0IGhhcworCQkJICogYWxyZWFkeSBiZWVuIGFsbG9jYXRlZC4KKwkJCSAq
LworCQkJaWYgKGZoLT5waXguc2l6ZWltYWdlID4gdmItPnNpemUpIHsKKwkJCQkvKgorCQkJCSAq
IFRoZSBpbWFnZSBzaXplIGhhcyBiZWVuIGNoYW5nZWQgdG8KKwkJCQkgKiBhIGxhcmdlciBzaXpl
IHNpbmNlIHRoaXMgYnVmZmVyIHdhcworCQkJCSAqIGFsbG9jYXRlZCwgc28gd2UgbmVlZCB0byBm
cmVlIGFuZAorCQkJCSAqIHJlYWxsb2NhdGUgaXQuCisJCQkJICovCisJCQkJb21hcDI0eHhjYW1f
dmJxX3JlbGVhc2UodmJxLCB2Yik7CisJCQkJdmItPnNpemUgPSBmaC0+cGl4LnNpemVpbWFnZTsK
KwkJCX0KKwkJfSBlbHNlIHsKKwkJCS8qIFdlIG5lZWQgdG8gYWxsb2NhdGUgYSBuZXcga2VybmVs
IGJvdW5jZSBidWZmZXIuICovCisJCQl2Yi0+c2l6ZSA9IGZoLT5waXguc2l6ZWltYWdlOworCQl9
CisJfQorCisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCXZiLT53aWR0aCA9IGZoLT5waXgu
d2lkdGg7CisJdmItPmhlaWdodCA9IGZoLT5waXguaGVpZ2h0OworCXZiLT5maWVsZCA9IGZpZWxk
OworCisJaWYgKHZiLT5zdGF0ZSA9PSBWSURFT0JVRl9ORUVEU19JTklUKSB7CisJCWlmICh2Yi0+
bWVtb3J5ID09IFY0TDJfTUVNT1JZX01NQVApCisJCQkvKgorCQkJICogd2UgaGF2ZSBidWlsdCB0
aGUgc2NhdHRlci1nYXRoZXIgbGlzdCBieSBvdXJzZWxmIHNvCisJCQkgKiBkbyB0aGUgc2NhdHRl
ci1nYXRoZXIgbWFwcGluZyBhcyB3ZWxsCisJCQkgKi8KKwkJCWVyciA9IG9tYXAyNHh4Y2FtX2Rt
YV9pb2xvY2sodmJxLCB2aWRlb2J1Zl90b19kbWEodmIpKTsKKwkJZWxzZQorCQkJZXJyID0gdmlk
ZW9idWZfaW9sb2NrKHZicSwgdmIsIE5VTEwpOworCX0KKworCWlmICghZXJyKQorCQl2Yi0+c3Rh
dGUgPSBWSURFT0JVRl9QUkVQQVJFRDsKKwllbHNlCisJCW9tYXAyNHh4Y2FtX3ZicV9yZWxlYXNl
KHZicSwgdmIpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1f
dmJxX3F1ZXVlKHN0cnVjdCB2aWRlb2J1Zl9xdWV1ZSAqdmJxLAorCQkJCSAgc3RydWN0IHZpZGVv
YnVmX2J1ZmZlciAqdmIpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpmaCA9IHZicS0+cHJp
dl9kYXRhOworCXN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9IGZoLT5jYW07CisJZW51
bSB2aWRlb2J1Zl9zdGF0ZSBzdGF0ZSA9IHZiLT5zdGF0ZTsKKwl1bnNpZ25lZCBsb25nIGZsYWdz
OworCWludCBlcnI7CisKKwkvKgorCSAqIEZJWE1FOiBXZSdyZSBtYXJraW5nIHRoZSBidWZmZXIg
YWN0aXZlIHNpbmNlIHdlIGhhdmUgbm8KKwkgKiBwcmV0dHkgd2F5IG9mIG1hcmtpbmcgaXQgYWN0
aXZlIGV4YWN0bHkgd2hlbiB0aGUKKwkgKiBzY2F0dGVyLWdhdGhlciB0cmFuc2ZlciBzdGFydHMu
CisJICovCisJdmItPnN0YXRlID0gVklERU9CVUZfQUNUSVZFOworCisJZXJyID0gb21hcDI0eHhj
YW1fc2dkbWFfcXVldWUoJmZoLT5jYW0tPnNnZG1hLAorCQkJCSAgICAgIHZpZGVvYnVmX3RvX2Rt
YSh2YiktPnNnbGlzdCwKKwkJCQkgICAgICB2aWRlb2J1Zl90b19kbWEodmIpLT5zZ2xlbiwgdmIt
PnNpemUsCisJCQkJICAgICAgb21hcDI0eHhjYW1fdmJxX2NvbXBsZXRlLCB2Yik7CisKKwlpZiAo
IWVycikgeworCQlzcGluX2xvY2tfaXJxc2F2ZSgmY2FtLT5jb3JlX2VuYWJsZV9kaXNhYmxlX2xv
Y2ssIGZsYWdzKTsKKwkJaWYgKCsrY2FtLT5zZ2RtYV9pbl9xdWV1ZSA9PSAxCisJCSAgICAmJiAh
YXRvbWljX3JlYWQoJmNhbS0+aW5fcmVzZXQpKQorCQkJb21hcDI0eHhjYW1fY29yZV9lbmFibGUo
Y2FtKTsKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY2FtLT5jb3JlX2VuYWJsZV9kaXNhYmxl
X2xvY2ssIGZsYWdzKTsKKwl9IGVsc2UgeworCQkvKgorCQkgKiBPb3BzLiBXZSdyZSBub3Qgc3Vw
cG9zZWQgdG8gZ2V0IGFueSBlcnJvcnMgaGVyZS4KKwkJICogVGhlIG9ubHkgd2F5IHdlIGNvdWxk
IGdldCBhbiBlcnJvciBpcyBpZiB3ZSByYW4gb3V0CisJCSAqIG9mIHNjYXR0ZXItZ2F0aGVyIERN
QSBzbG90cywgYnV0IHdlIGFyZSBzdXBwb3NlZCB0bworCQkgKiBoYXZlIGF0IGxlYXN0IGFzIG1h
bnkgc2NhdHRlci1nYXRoZXIgRE1BIHNsb3RzIGFzCisJCSAqIHZpZGVvIGJ1ZmZlcnMgc28gdGhh
dCBjYW4ndCBoYXBwZW4uCisJCSAqLworCQlkZXZfZXJyKGNhbS0+ZGV2LCAiZmFpbGVkIHRvIHF1
ZXVlIGEgdmlkZW8gYnVmZmVyIGZvciBkbWEhXG4iKTsKKwkJZGV2X2VycihjYW0tPmRldiwgImxp
a2VseSBhIGJ1ZyBpbiB0aGUgZHJpdmVyIVxuIik7CisJCXZiLT5zdGF0ZSA9IHN0YXRlOworCX0K
K30KKworc3RhdGljIHN0cnVjdCB2aWRlb2J1Zl9xdWV1ZV9vcHMgb21hcDI0eHhjYW1fdmJxX29w
cyA9IHsKKwkuYnVmX3NldHVwICAgPSBvbWFwMjR4eGNhbV92YnFfc2V0dXAsCisJLmJ1Zl9wcmVw
YXJlID0gb21hcDI0eHhjYW1fdmJxX3ByZXBhcmUsCisJLmJ1Zl9xdWV1ZSAgID0gb21hcDI0eHhj
YW1fdmJxX3F1ZXVlLAorCS5idWZfcmVsZWFzZSA9IG9tYXAyNHh4Y2FtX3ZicV9yZWxlYXNlLAor
fTsKKworLyoKKyAqCisgKiBPTUFQIG1haW4gY2FtZXJhIHN5c3RlbQorICoKKyAqLworCisvKgor
ICogUmVzZXQgY2FtZXJhIGJsb2NrIHRvIHBvd2VyLW9uIHN0YXRlLgorICovCitzdGF0aWMgdm9p
ZCBvbWFwMjR4eGNhbV9wb3dlcm9uX3Jlc2V0KGNvbnN0IHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZp
Y2UgKmNhbSkKK3sKKwlpbnQgbWF4X2xvb3AgPSBSRVNFVF9USU1FT1VUX05TOworCisJLyogUmVz
ZXQgd2hvbGUgY2FtZXJhIHN1YnN5c3RlbSAqLworCW9tYXAyNHh4Y2FtX3JlZ19vdXQoY2FtLT5t
bWlvX2Jhc2UsCisJCQkgICAgQ0FNX1NZU0NPTkZJRywKKwkJCSAgICBDQU1fU1lTQ09ORklHX1NP
RlRSRVNFVCk7CisKKwkvKiBXYWl0IHRpbGwgaXQncyBmaW5pc2hlZCAqLworCXdoaWxlICghKG9t
YXAyNHh4Y2FtX3JlZ19pbihjYW0tPm1taW9fYmFzZSwgQ0FNX1NZU1NUQVRVUykKKwkJICYgQ0FN
X1NZU1NUQVRVU19SRVNFVERPTkUpCisJICAgICAgICYmIC0tbWF4X2xvb3ApIHsKKwkJbmRlbGF5
KDEpOworCX0KKworCWlmICghKG9tYXAyNHh4Y2FtX3JlZ19pbihjYW0tPm1taW9fYmFzZSwgQ0FN
X1NZU1NUQVRVUykKKwkgICAgICAmIENBTV9TWVNTVEFUVVNfUkVTRVRET05FKSkKKwkJZGV2X2Vy
cihjYW0tPmRldiwgImNhbWVyYSBzb2Z0IHJlc2V0IHRpbWVvdXRcbiIpOworfQorCisvKgorICog
KFJlKWluaXRpYWxpc2UgdGhlIGNhbWVyYSBibG9jay4KKyAqLworc3RhdGljIHZvaWQgb21hcDI0
eHhjYW1faHdpbml0KGNvbnN0IHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSkKK3sKKwlv
bWFwMjR4eGNhbV9wb3dlcm9uX3Jlc2V0KGNhbSk7CisKKwkvKiBzZXQgdGhlIGNhbWVyYSBzdWJz
eXN0ZW0gYXV0b2lkbGUgYml0ICovCisJb21hcDI0eHhjYW1fcmVnX291dChjYW0tPm1taW9fYmFz
ZSwgQ0FNX1NZU0NPTkZJRywKKwkJCSAgICBDQU1fU1lTQ09ORklHX0FVVE9JRExFKTsKKworCS8q
IHNldCB0aGUgY2FtZXJhIE1NVSBhdXRvaWRsZSBiaXQgKi8KKwlvbWFwMjR4eGNhbV9yZWdfb3V0
KGNhbS0+bW1pb19iYXNlLAorCQkJICAgIENBTU1NVV9SRUdfT0ZGU0VUICsgQ0FNTU1VX1NZU0NP
TkZJRywKKwkJCSAgICBDQU1NTVVfU1lTQ09ORklHX0FVVE9JRExFKTsKKworCW9tYXAyNHh4Y2Ft
X2NvcmVfaHdpbml0KGNhbSk7CisKKwlvbWFwMjR4eGNhbV9kbWFfaHdpbml0KCZjYW0tPnNnZG1h
LmRtYSk7Cit9CisKKy8qCisgKiBDYWxsYmFjayBmb3IgZG1hIHRyYW5zZmVyIHN0YWxsaW5nLgor
ICovCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9zdGFsbGVkX2RtYV9yZXNldCh1bnNpZ25lZCBs
b25nIGRhdGEpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gKHN0cnVjdCBv
bWFwMjR4eGNhbV9kZXZpY2UgKilkYXRhOworCisJaWYgKCFhdG9taWNfcmVhZCgmY2FtLT5pbl9y
ZXNldCkpIHsKKwkJZGV2X2RiZyhjYW0tPmRldiwgImRtYSBzdGFsbGVkLCByZXNldHRpbmcgY2Ft
ZXJhXG4iKTsKKwkJb21hcDI0eHhjYW1fcmVzZXQoY2FtKTsKKwl9Cit9CisKKy8qCisgKiBTdG9w
IGNhcHR1cmUuIE1hcmsgd2UncmUgZG9pbmcgYSByZXNldCwgc3RvcCBETUEgdHJhbnNmZXJzIGFu
ZAorICogY29yZS4gKE5vIG5ldyBzY2F0dGVyLWdhdGhlciB0cmFuc2ZlcnMgd2lsbCBiZSBxdWV1
ZWQgd2hpbHN0CisgKiBpbl9yZXNldCBpcyBub24temVyby4pCisgKgorICogSWYgb21hcDI0eHhj
YW1fY2FwdHVyZV9zdG9wIGlzIGNhbGxlZCBmcm9tIHNldmVyYWwgcGxhY2VzIGF0CisgKiBvbmNl
LCBvbmx5IHRoZSBmaXJzdCBjYWxsIHdpbGwgaGF2ZSBhbiBlZmZlY3QuIFNpbWlsYXJseSwgdGhl
IGxhc3QKKyAqIGNhbGwgb21hcDI0eHhjYW1fc3RyZWFtaW5nX2NvbnQgd2lsbCBoYXZlIGVmZmVj
dC4KKyAqCisgKiBTZXJpYWxpc2F0aW9uIGlzIGVuc3VyZWQgYnkgdXNpbmcgY2FtLT5jb3JlX2Vu
YWJsZV9kaXNhYmxlX2xvY2suCisgKi8KK3N0YXRpYyB2b2lkIG9tYXAyNHh4Y2FtX2NhcHR1cmVf
c3RvcChzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0pCit7CisJdW5zaWduZWQgbG9uZyBm
bGFnczsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZjYW0tPmNvcmVfZW5hYmxlX2Rpc2FibGVfbG9j
aywgZmxhZ3MpOworCisJaWYgKGF0b21pY19pbmNfcmV0dXJuKCZjYW0tPmluX3Jlc2V0KSAhPSAx
KSB7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNhbS0+Y29yZV9lbmFibGVfZGlzYWJsZV9s
b2NrLCBmbGFncyk7CisJCXJldHVybjsKKwl9CisKKwlvbWFwMjR4eGNhbV9jb3JlX2Rpc2FibGUo
Y2FtKTsKKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmNhbS0+Y29yZV9lbmFibGVfZGlzYWJs
ZV9sb2NrLCBmbGFncyk7CisKKwlvbWFwMjR4eGNhbV9zZ2RtYV9zeW5jKCZjYW0tPnNnZG1hKTsK
K30KKworLyoKKyAqIFJlc2V0IGFuZCBjb250aW51ZSBzdHJlYW1pbmcuCisgKgorICogTm90ZTog
UmVzZXR0aW5nIHRoZSBjYW1lcmEgRklGTyB2aWEgdGhlIENDX1JTVCBiaXQgaW4gdGhlIENDX0NU
UkwKKyAqIHJlZ2lzdGVyIGlzIHN1cHBvc2VkIHRvIGJlIHN1ZmZpY2llbnQgdG8gcmVjb3ZlciBm
cm9tIGEgY2FtZXJhCisgKiBpbnRlcmZhY2UgZXJyb3IsIGJ1dCBpdCBkb2Vzbid0IHNlZW0gdG8g
YmUgZW5vdWdoLiBJZiB3ZSBvbmx5IGRvCisgKiB0aGF0IHRoZW4gc3Vic2VxdWVudCBpbWFnZSBj
YXB0dXJlcyBhcmUgb3V0IG9mIHN5bmMgYnkgZWl0aGVyIG9uZQorICogb3IgdHdvIHRpbWVzIERN
QV9USFJFU0hPTEQgYnl0ZXMuIFJlc2V0dGluZyBhbmQgcmUtaW5pdGlhbGl6aW5nIHRoZQorICog
ZW50aXJlIGNhbWVyYSBzdWJzeXN0ZW0gcHJldmVudHMgdGhlIHByb2JsZW0gd2l0aCBmcmFtZQor
ICogc3luY2hyb25pemF0aW9uLgorICovCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9jYXB0dXJl
X2NvbnQoc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQoreworCXVuc2lnbmVkIGxvbmcg
ZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmY2FtLT5jb3JlX2VuYWJsZV9kaXNhYmxlX2xv
Y2ssIGZsYWdzKTsKKworCWlmIChhdG9taWNfcmVhZCgmY2FtLT5pbl9yZXNldCkgIT0gMSkKKwkJ
Z290byBvdXQ7CisKKwlvbWFwMjR4eGNhbV9od2luaXQoY2FtKTsKKworCW9tYXAyNHh4Y2FtX3Nl
bnNvcl9pZl9lbmFibGUoY2FtKTsKKworCW9tYXAyNHh4Y2FtX3NnZG1hX3Byb2Nlc3MoJmNhbS0+
c2dkbWEpOworCisJaWYgKGNhbS0+c2dkbWFfaW5fcXVldWUpCisJCW9tYXAyNHh4Y2FtX2NvcmVf
ZW5hYmxlKGNhbSk7CisKK291dDoKKwlhdG9taWNfZGVjKCZjYW0tPmluX3Jlc2V0KTsKKwlzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZjYW0tPmNvcmVfZW5hYmxlX2Rpc2FibGVfbG9jaywgZmxhZ3Mp
OworfQorCitzdGF0aWMgc3NpemVfdAorb21hcDI0eHhjYW1fc3RyZWFtaW5nX3Nob3coc3RydWN0
IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJY2hhciAqYnVm
KQoreworCXN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9IGRldl9nZXRfZHJ2ZGF0YShk
ZXYpOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNhbS0+c3RyZWFtaW5nID8gICJh
Y3RpdmUiIDogImluYWN0aXZlIik7Cit9CitzdGF0aWMgREVWSUNFX0FUVFIoc3RyZWFtaW5nLCBT
X0lSVUdPLCBvbWFwMjR4eGNhbV9zdHJlYW1pbmdfc2hvdywgTlVMTCk7CisKKy8qCisgKiBTdG9w
IGNhcHR1cmUgYW5kIHJlc3RhcnQgaXQuIEkuZS4gcmVzZXQgdGhlIGNhbWVyYSBkdXJpbmcgdXNl
LgorICovCitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9yZXNldChzdHJ1Y3Qgb21hcDI0eHhjYW1f
ZGV2aWNlICpjYW0pCit7CisJb21hcDI0eHhjYW1fY2FwdHVyZV9zdG9wKGNhbSk7CisJb21hcDI0
eHhjYW1fY2FwdHVyZV9jb250KGNhbSk7Cit9CisKKy8qCisgKiBUaGUgbWFpbiBpbnRlcnJ1cHQg
aGFuZGxlci4KKyAqLworc3RhdGljIGlycXJldHVybl90IG9tYXAyNHh4Y2FtX2lzcihpbnQgaXJx
LCB2b2lkICphcmcpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gKHN0cnVj
dCBvbWFwMjR4eGNhbV9kZXZpY2UgKilhcmc7CisJdTMyIGlycXN0YXR1czsKKwl1bnNpZ25lZCBp
bnQgaXJxaGFuZGxlZCA9IDA7CisKKwlpcnFzdGF0dXMgPSBvbWFwMjR4eGNhbV9yZWdfaW4oY2Ft
LT5tbWlvX2Jhc2UsIENBTV9JUlFTVEFUVVMpOworCisJaWYgKGlycXN0YXR1cyAmCisJICAgIChD
QU1fSVJRU1RBVFVTX0RNQV9JUlEyIHwgQ0FNX0lSUVNUQVRVU19ETUFfSVJRMQorCSAgICAgfCBD
QU1fSVJRU1RBVFVTX0RNQV9JUlEwKSkgeworCQlvbWFwMjR4eGNhbV9kbWFfaXNyKCZjYW0tPnNn
ZG1hLmRtYSk7CisJCWlycWhhbmRsZWQgPSAxOworCX0KKwlpZiAoaXJxc3RhdHVzICYgQ0FNX0lS
UVNUQVRVU19DQ19JUlEpIHsKKwkJb21hcDI0eHhjYW1fY29yZV9pc3IoY2FtKTsKKwkJaXJxaGFu
ZGxlZCA9IDE7CisJfQorCWlmIChpcnFzdGF0dXMgJiBDQU1fSVJRU1RBVFVTX01NVV9JUlEpCisJ
CWRldl9lcnIoY2FtLT5kZXYsICJ1bmhhbmRsZWQgY2FtZXJhIE1NVSBpbnRlcnJ1cHQhXG4iKTsK
KworCXJldHVybiBJUlFfUkVUVkFMKGlycWhhbmRsZWQpOworfQorCisvKgorICoKKyAqIFNlbnNv
ciBoYW5kbGluZy4KKyAqCisgKi8KKworLyoKKyAqIEVuYWJsZSB0aGUgZXh0ZXJuYWwgc2Vuc29y
IGludGVyZmFjZS4gVHJ5IHRvIG5lZ290aWF0ZSBpbnRlcmZhY2UKKyAqIHBhcmFtZXRlcnMgd2l0
aCB0aGUgc2Vuc29yIGFuZCBzdGFydCB1c2luZyB0aGUgbmV3IG9uZXMuIFRoZSBjYWxscworICog
dG8gc2Vuc29yX2lmX2VuYWJsZSBhbmQgc2Vuc29yX2lmX2Rpc2FibGUgbmVlZCBub3QgdG8gYmUg
YmFsYW5jZWQuCisgKi8KK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1fc2Vuc29yX2lmX2VuYWJsZShz
dHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0pCit7CisJaW50IHJ2YWw7CisJc3RydWN0IHY0
bDJfaWZwYXJtIHA7CisKKwlydmFsID0gdmlkaW9jX2ludF9nX2lmcGFybShjYW0tPnNkZXYsICZw
KTsKKwlpZiAocnZhbCkgeworCQlkZXZfZXJyKGNhbS0+ZGV2LCAidmlkaW9jX2ludF9nX2lmcGFy
bSBmYWlsZWQgd2l0aCAlZFxuIiwgcnZhbCk7CisJCXJldHVybiBydmFsOworCX0KKworCWNhbS0+
aWZfdHlwZSA9IHAuaWZfdHlwZTsKKworCWNhbS0+Y2NfY3RybCA9IENDX0NUUkxfQ0NfRU47CisK
Kwlzd2l0Y2ggKHAuaWZfdHlwZSkgeworCWNhc2UgVjRMMl9JRl9UWVBFX0JUNjU2OgorCQlpZiAo
cC51LmJ0NjU2LmZyYW1lX3N0YXJ0X29uX3Jpc2luZ192cykKKwkJCWNhbS0+Y2NfY3RybCB8PSBD
Q19DVFJMX05PQlRfU1lOQ0hSTzsKKwkJaWYgKHAudS5idDY1Ni5idF9zeW5jX2NvcnJlY3QpCisJ
CQljYW0tPmNjX2N0cmwgfD0gQ0NfQ1RSTF9CVF9DT1JSRUNUOworCQlpZiAocC51LmJ0NjU2LnN3
YXApCisJCQljYW0tPmNjX2N0cmwgfD0gQ0NfQ1RSTF9QQVJfT1JERVJDQU07CisJCWlmIChwLnUu
YnQ2NTYubGF0Y2hfY2xrX2ludikKKwkJCWNhbS0+Y2NfY3RybCB8PSBDQ19DVFJMX1BBUl9DTEtf
UE9MOworCQlpZiAocC51LmJ0NjU2Lm5vYnRfaHNfaW52KQorCQkJY2FtLT5jY19jdHJsIHw9IEND
X0NUUkxfTk9CVF9IU19QT0w7CisJCWlmIChwLnUuYnQ2NTYubm9idF92c19pbnYpCisJCQljYW0t
PmNjX2N0cmwgfD0gQ0NfQ1RSTF9OT0JUX1ZTX1BPTDsKKworCQlzd2l0Y2ggKHAudS5idDY1Ni5t
b2RlKSB7CisJCWNhc2UgVjRMMl9JRl9UWVBFX0JUNjU2X01PREVfTk9CVF84QklUOgorCQkJY2Ft
LT5jY19jdHJsIHw9IENDX0NUUkxfUEFSX01PREVfTk9CVDg7CisJCQlicmVhazsKKwkJY2FzZSBW
NEwyX0lGX1RZUEVfQlQ2NTZfTU9ERV9OT0JUXzEwQklUOgorCQkJY2FtLT5jY19jdHJsIHw9IEND
X0NUUkxfUEFSX01PREVfTk9CVDEwOworCQkJYnJlYWs7CisJCWNhc2UgVjRMMl9JRl9UWVBFX0JU
NjU2X01PREVfTk9CVF8xMkJJVDoKKwkJCWNhbS0+Y2NfY3RybCB8PSBDQ19DVFJMX1BBUl9NT0RF
X05PQlQxMjsKKwkJCWJyZWFrOworCQljYXNlIFY0TDJfSUZfVFlQRV9CVDY1Nl9NT0RFX0JUXzhC
SVQ6CisJCQljYW0tPmNjX2N0cmwgfD0gQ0NfQ1RSTF9QQVJfTU9ERV9CVDg7CisJCQlicmVhazsK
KwkJY2FzZSBWNEwyX0lGX1RZUEVfQlQ2NTZfTU9ERV9CVF8xMEJJVDoKKwkJCWNhbS0+Y2NfY3Ry
bCB8PSBDQ19DVFJMX1BBUl9NT0RFX0JUMTA7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCWRl
dl9lcnIoY2FtLT5kZXYsCisJCQkJImJ0NjU2IGludGVyZmFjZSBtb2RlICVkIG5vdCBzdXBwb3J0
ZWRcbiIsCisJCQkJcC51LmJ0NjU2Lm1vZGUpOworCQkJcmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJ
LyoKKwkJICogVGhlIGNsb2NrIHJhdGUgdGhhdCB0aGUgc2Vuc29yIHdhbnRzIGhhcyBjaGFuZ2Vk
LgorCQkgKiBXZSBoYXZlIHRvIGFkanVzdCB0aGUgeGNsayBmcm9tIE9NQVAgMiBzaWRlIHRvCisJ
CSAqIG1hdGNoIHRoZSBzZW5zb3IncyB3aXNoIGFzIGNsb3NlbHkgYXMgcG9zc2libGUuCisJCSAq
LworCQlpZiAocC51LmJ0NjU2LmNsb2NrX2N1cnIgIT0gY2FtLT5pZl91LmJ0NjU2LnhjbGspIHsK
KwkJCXUzMiB4Y2xrID0gcC51LmJ0NjU2LmNsb2NrX2N1cnI7CisJCQl1MzIgZGl2aXNvcjsKKwor
CQkJaWYgKHhjbGsgPT0gMCkKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKworCQkJaWYgKHhjbGsgPiBD
QU1fTUNMSykKKwkJCQl4Y2xrID0gQ0FNX01DTEs7CisKKwkJCWRpdmlzb3IgPSBDQU1fTUNMSyAv
IHhjbGs7CisJCQlpZiAoZGl2aXNvciAqIHhjbGsgPCBDQU1fTUNMSykKKwkJCQlkaXZpc29yKys7
CisJCQlpZiAoQ0FNX01DTEsgLyBkaXZpc29yIDwgcC51LmJ0NjU2LmNsb2NrX21pbgorCQkJICAg
ICYmIGRpdmlzb3IgPiAxKQorCQkJCWRpdmlzb3ItLTsKKwkJCWlmIChkaXZpc29yID4gMzApCisJ
CQkJZGl2aXNvciA9IDMwOworCisJCQl4Y2xrID0gQ0FNX01DTEsgLyBkaXZpc29yOworCisJCQlp
ZiAoeGNsayA8IHAudS5idDY1Ni5jbG9ja19taW4KKwkJCSAgICB8fCB4Y2xrID4gcC51LmJ0NjU2
LmNsb2NrX21heCkKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKworCQkJY2FtLT5pZl91LmJ0NjU2Lnhj
bGsgPSB4Y2xrOworCQl9CisJCW9tYXAyNHh4Y2FtX2NvcmVfeGNsa19zZXQoY2FtLCBjYW0tPmlm
X3UuYnQ2NTYueGNsayk7CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCS8qIEZJWE1FOiBob3cgYWJv
dXQgb3RoZXIgaW50ZXJmYWNlcz8gKi8KKwkJZGV2X2VycihjYW0tPmRldiwgImludGVyZmFjZSB0
eXBlICVkIG5vdCBzdXBwb3J0ZWRcbiIsCisJCQlwLmlmX3R5cGUpOworCQlyZXR1cm4gLUVJTlZB
TDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1fc2Vuc29y
X2lmX2Rpc2FibGUoY29uc3Qgc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQoreworCXN3
aXRjaCAoY2FtLT5pZl90eXBlKSB7CisJY2FzZSBWNEwyX0lGX1RZUEVfQlQ2NTY6CisJCW9tYXAy
NHh4Y2FtX2NvcmVfeGNsa19zZXQoY2FtLCAwKTsKKwkJYnJlYWs7CisJfQorfQorCisvKgorICog
SW5pdGlhbGlzZSB0aGUgc2Vuc29yIGhhcmR3YXJlLgorICovCitzdGF0aWMgaW50IG9tYXAyNHh4
Y2FtX3NlbnNvcl9pbml0KHN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSkKK3sKKwlpbnQg
ZXJyID0gMDsKKwlzdHJ1Y3QgdjRsMl9pbnRfZGV2aWNlICpzZGV2ID0gY2FtLT5zZGV2OworCisJ
b21hcDI0eHhjYW1fY2xvY2tfb24oY2FtKTsKKwllcnIgPSBvbWFwMjR4eGNhbV9zZW5zb3JfaWZf
ZW5hYmxlKGNhbSk7CisJaWYgKGVycikgeworCQlkZXZfZXJyKGNhbS0+ZGV2LCAic2Vuc29yIGlu
dGVyZmFjZSBjb3VsZCBub3QgYmUgZW5hYmxlZCBhdCAiCisJCQkiaW5pdGlhbGlzYXRpb24sICVk
XG4iLCBlcnIpOworCQljYW0tPnNkZXYgPSBOVUxMOworCQlnb3RvIG91dDsKKwl9CisKKwkvKiBw
b3dlciB1cCBzZW5zb3IgZHVyaW5nIHNlbnNvciBpbml0aWFsaXphdGlvbiAqLworCXZpZGlvY19p
bnRfc19wb3dlcihzZGV2LCAxKTsKKworCWVyciA9IHZpZGlvY19pbnRfZGV2X2luaXQoc2Rldik7
CisJaWYgKGVycikgeworCQlkZXZfZXJyKGNhbS0+ZGV2LCAiY2Fubm90IGluaXRpYWxpemUgc2Vu
c29yLCBlcnJvciAlZFxuIiwgZXJyKTsKKwkJLyogU2Vuc29yIGluaXQgZmFpbGVkIC0tLSBpdCdz
IG5vbmV4aXN0ZW50IHRvIHVzISAqLworCQljYW0tPnNkZXYgPSBOVUxMOworCQlnb3RvIG91dDsK
Kwl9CisKKwlkZXZfaW5mbyhjYW0tPmRldiwgInNlbnNvciBpcyAlc1xuIiwgc2Rldi0+bmFtZSk7
CisKK291dDoKKwlvbWFwMjR4eGNhbV9zZW5zb3JfaWZfZGlzYWJsZShjYW0pOworCW9tYXAyNHh4
Y2FtX2Nsb2NrX29mZihjYW0pOworCisJdmlkaW9jX2ludF9zX3Bvd2VyKHNkZXYsIDApOworCisJ
cmV0dXJuIGVycjsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1fc2Vuc29yX2V4aXQoc3Ry
dWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQoreworCWlmIChjYW0tPnNkZXYpCisJCXZpZGlv
Y19pbnRfZGV2X2V4aXQoY2FtLT5zZGV2KTsKK30KKworc3RhdGljIHZvaWQgb21hcDI0eHhjYW1f
c2Vuc29yX2Rpc2FibGUoc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtKQoreworCW9tYXAy
NHh4Y2FtX3NlbnNvcl9pZl9kaXNhYmxlKGNhbSk7CisJb21hcDI0eHhjYW1fY2xvY2tfb2ZmKGNh
bSk7CisJdmlkaW9jX2ludF9zX3Bvd2VyKGNhbS0+c2RldiwgMCk7Cit9CisKKy8qCisgKiBQb3dl
ci11cCBhbmQgY29uZmlndXJlIGNhbWVyYSBzZW5zb3IuIEl0J3MgcmVhZHkgZm9yIGNhcHR1cmlu
ZyBub3cuCisgKi8KK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1fc2Vuc29yX2VuYWJsZShzdHJ1Y3Qg
b21hcDI0eHhjYW1fZGV2aWNlICpjYW0pCit7CisJaW50IHJ2YWw7CisKKwlvbWFwMjR4eGNhbV9j
bG9ja19vbihjYW0pOworCisJb21hcDI0eHhjYW1fc2Vuc29yX2lmX2VuYWJsZShjYW0pOworCisJ
cnZhbCA9IHZpZGlvY19pbnRfc19wb3dlcihjYW0tPnNkZXYsIDEpOworCWlmIChydmFsKQorCQln
b3RvIG91dDsKKworCXJ2YWwgPSB2aWRpb2NfaW50X2luaXQoY2FtLT5zZGV2KTsKKwlpZiAocnZh
bCkKKwkJZ290byBvdXQ7CisKKwlyZXR1cm4gMDsKKworb3V0OgorCW9tYXAyNHh4Y2FtX3NlbnNv
cl9kaXNhYmxlKGNhbSk7CisKKwlyZXR1cm4gcnZhbDsKK30KKworc3RhdGljIHZvaWQgb21hcDI0
eHhjYW1fc2Vuc29yX3Jlc2V0X3dvcmsoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQoreworCXN0
cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9CisJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1
Y3Qgb21hcDI0eHhjYW1fZGV2aWNlLAorCQkJICAgICBzZW5zb3JfcmVzZXRfd29yayk7CisKKwlp
ZiAoYXRvbWljX3JlYWQoJmNhbS0+cmVzZXRfZGlzYWJsZSkpCisJCXJldHVybjsKKworCW9tYXAy
NHh4Y2FtX2NhcHR1cmVfc3RvcChjYW0pOworCisJaWYgKHZpZGlvY19pbnRfcmVzZXQoY2FtLT5z
ZGV2KSA9PSAwKSB7CisJCXZpZGlvY19pbnRfaW5pdChjYW0tPnNkZXYpOworCX0gZWxzZSB7CisJ
CS8qIENhbid0IHJlc2V0IGl0IGJ5IHZpZGlvY19pbnRfcmVzZXQuICovCisJCW9tYXAyNHh4Y2Ft
X3NlbnNvcl9kaXNhYmxlKGNhbSk7CisJCW9tYXAyNHh4Y2FtX3NlbnNvcl9lbmFibGUoY2FtKTsK
Kwl9CisKKwlvbWFwMjR4eGNhbV9jYXB0dXJlX2NvbnQoY2FtKTsKK30KKworLyoKKyAqCisgKiBJ
T0NUTCBpbnRlcmZhY2UuCisgKgorICovCisKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKKwkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKm9maCA9IGZoOworCXN0cnVjdCBvbWFw
MjR4eGNhbV9kZXZpY2UgKmNhbSA9IG9maC0+Y2FtOworCisJc3RybGNweShjYXAtPmRyaXZlciwg
Q0FNX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOworCXN0cmxjcHkoY2FwLT5jYXJkLCBjYW0t
PnZmZC0+bmFtZSwgc2l6ZW9mKGNhcC0+Y2FyZCkpOworCWNhcC0+dmVyc2lvbiA9IE9NQVAyNFhY
Q0FNX1ZFUlNJT047CisJY2FwLT5jYXBhYmlsaXRpZXMgPSBWNEwyX0NBUF9WSURFT19DQVBUVVJF
IHwgVjRMMl9DQVBfU1RSRUFNSU5HOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorCQkJCSAg
IHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmgg
PSBmaDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvZmgtPmNhbTsKKwlpbnQg
cnZhbDsKKworCXJ2YWwgPSB2aWRpb2NfaW50X2VudW1fZm10X2NhcChjYW0tPnNkZXYsIGYpOwor
CisJcmV0dXJuIHJ2YWw7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3sK
KwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKm9maCA9IGZoOworCXN0cnVjdCBvbWFwMjR4eGNhbV9k
ZXZpY2UgKmNhbSA9IG9maC0+Y2FtOworCWludCBydmFsOworCisJbXV0ZXhfbG9jaygmY2FtLT5t
dXRleCk7CisJcnZhbCA9IHZpZGlvY19pbnRfZ19mbXRfY2FwKGNhbS0+c2RldiwgZik7CisJbXV0
ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsKKworCXJldHVybiBydmFsOworfQorCitzdGF0aWMgaW50
IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKKwkJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmggPSBm
aDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvZmgtPmNhbTsKKwlpbnQgcnZh
bDsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCWlmIChjYW0tPnN0cmVhbWluZykgewor
CQlydmFsID0gLUVCVVNZOworCQlnb3RvIG91dDsKKwl9CisKKwlydmFsID0gdmlkaW9jX2ludF9z
X2ZtdF9jYXAoY2FtLT5zZGV2LCBmKTsKKworb3V0OgorCW11dGV4X3VubG9jaygmY2FtLT5tdXRl
eCk7CisKKwlpZiAoIXJ2YWwpIHsKKwkJbXV0ZXhfbG9jaygmb2ZoLT52YnEudmJfbG9jayk7CisJ
CW9maC0+cGl4ID0gZi0+Zm10LnBpeDsKKwkJbXV0ZXhfdW5sb2NrKCZvZmgtPnZicS52Yl9sb2Nr
KTsKKwl9CisKKwltZW1zZXQoZiwgMCwgc2l6ZW9mKCpmKSk7CisJdmlkaW9jX2dfZm10X3ZpZF9j
YXAoZmlsZSwgZmgsIGYpOworCisJcmV0dXJuIHJ2YWw7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9j
X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCisJCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmggPSBmaDsK
KwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvZmgtPmNhbTsKKwlpbnQgcnZhbDsK
KworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCXJ2YWwgPSB2aWRpb2NfaW50X3RyeV9mbXRf
Y2FwKGNhbS0+c2RldiwgZik7CisJbXV0ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsKKworCXJldHVy
biBydmFsOworfQorCitzdGF0aWMgaW50IHZpZGlvY19yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKKwkJCSAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKmIpCit7CisJc3Ry
dWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmggPSBmaDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNl
ICpjYW0gPSBvZmgtPmNhbTsKKwlpbnQgcnZhbDsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgp
OworCWlmIChjYW0tPnN0cmVhbWluZykgeworCQltdXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOwor
CQlyZXR1cm4gLUVCVVNZOworCX0KKworCW9tYXAyNHh4Y2FtX3ZicV9mcmVlX21tYXBfYnVmZmVy
cygmb2ZoLT52YnEpOworCW11dGV4X3VubG9jaygmY2FtLT5tdXRleCk7CisKKwlydmFsID0gdmlk
ZW9idWZfcmVxYnVmcygmb2ZoLT52YnEsIGIpOworCisJLyoKKwkgKiBFaXRoZXIgdmlkZW9idWZf
cmVxYnVmcyBmYWlsZWQgb3IgdGhlIGJ1ZmZlcnMgYXJlIG5vdAorCSAqIG1lbW9yeS1tYXBwZWQg
KHdoaWNoIHdvdWxkIG5lZWQgc3BlY2lhbCBhdHRlbnRpb24pLgorCSAqLworCWlmIChydmFsIDwg
MCB8fCBiLT5tZW1vcnkgIT0gVjRMMl9NRU1PUllfTU1BUCkKKwkJZ290byBvdXQ7CisKKwlydmFs
ID0gb21hcDI0eHhjYW1fdmJxX2FsbG9jX21tYXBfYnVmZmVycygmb2ZoLT52YnEsIHJ2YWwpOwor
CWlmIChydmFsKQorCQlvbWFwMjR4eGNhbV92YnFfZnJlZV9tbWFwX2J1ZmZlcnMoJm9maC0+dmJx
KTsKKworb3V0OgorCXJldHVybiBydmFsOworfQorCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWJ1
ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCisJCQkgICBzdHJ1Y3QgdjRsMl9idWZmZXIg
KmIpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmggPSBmaDsKKworCXJldHVybiB2aWRl
b2J1Zl9xdWVyeWJ1Zigmb2ZoLT52YnEsIGIpOworfQorCitzdGF0aWMgaW50IHZpZGlvY19xYnVm
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYnVmZmVyICpiKQorewor
CXN0cnVjdCBvbWFwMjR4eGNhbV9maCAqb2ZoID0gZmg7CisKKwlyZXR1cm4gdmlkZW9idWZfcWJ1
Zigmb2ZoLT52YnEsIGIpOworfQorCitzdGF0aWMgaW50IHZpZGlvY19kcWJ1ZihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKK3sKKwlzdHJ1Y3Qgb21h
cDI0eHhjYW1fZmggKm9maCA9IGZoOworCXN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9
IG9maC0+Y2FtOworCXN0cnVjdCB2aWRlb2J1Zl9idWZmZXIgKnZiOworCWludCBydmFsOworCit2
aWRlb2J1Zl9kcWJ1Zl9hZ2FpbjoKKwlydmFsID0gdmlkZW9idWZfZHFidWYoJm9maC0+dmJxLCBi
LCBmaWxlLT5mX2ZsYWdzICYgT19OT05CTE9DSyk7CisJaWYgKHJ2YWwpCisJCWdvdG8gb3V0Owor
CisJdmIgPSBvZmgtPnZicS5idWZzW2ItPmluZGV4XTsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0
ZXgpOworCS8qIF9uZWVkc19yZXNldCByZXR1cm5zIC1FSU8gaWYgcmVzZXQgaXMgcmVxdWlyZWQu
ICovCisJcnZhbCA9IHZpZGlvY19pbnRfZ19uZWVkc19yZXNldChjYW0tPnNkZXYsICh2b2lkICop
dmItPmJhZGRyKTsKKwltdXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOworCWlmIChydmFsID09IC1F
SU8pCisJCXNjaGVkdWxlX3dvcmsoJmNhbS0+c2Vuc29yX3Jlc2V0X3dvcmspOworCWVsc2UKKwkJ
cnZhbCA9IDA7CisKK291dDoKKwkvKgorCSAqIFRoaXMgaXMgYSBoYWNrLiBXZSBkb24ndCB3YW50
IHRvIHNob3cgLUVJTyB0byB0aGUgdXNlcgorCSAqIHNwYWNlLiBSZXF1ZXVlIHRoZSBidWZmZXIg
YW5kIHRyeSBhZ2FpbiBpZiB3ZSdyZSBub3QgZG9pbmcKKwkgKiB0aGlzIGluIG5vbi1ibG9ja2lu
ZyBtb2RlLgorCSAqLworCWlmIChydmFsID09IC1FSU8pIHsKKwkJdmlkZW9idWZfcWJ1Zigmb2Zo
LT52YnEsIGIpOworCQlpZiAoIShmaWxlLT5mX2ZsYWdzICYgT19OT05CTE9DSykpCisJCQlnb3Rv
IHZpZGVvYnVmX2RxYnVmX2FnYWluOworCQkvKgorCQkgKiBXZSBkb24ndCBoYXZlIGEgdmlkZW9i
dWZfYnVmZmVyIG5vdyAtLS0gbWF5YmUgbmV4dAorCQkgKiB0aW1lLi4uCisJCSAqLworCQlydmFs
ID0gLUVBR0FJTjsKKwl9CisKKwlyZXR1cm4gcnZhbDsKK30KKworc3RhdGljIGludCB2aWRpb2Nf
c3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBlbnVtIHY0bDJfYnVmX3R5cGUg
aSkKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggKm9maCA9IGZoOworCXN0cnVjdCBvbWFwMjR4
eGNhbV9kZXZpY2UgKmNhbSA9IG9maC0+Y2FtOworCWludCBydmFsOworCisJbXV0ZXhfbG9jaygm
Y2FtLT5tdXRleCk7CisJaWYgKGNhbS0+c3RyZWFtaW5nKSB7CisJCXJ2YWwgPSAtRUJVU1k7CisJ
CWdvdG8gb3V0OworCX0KKworCXJ2YWwgPSBvbWFwMjR4eGNhbV9zZW5zb3JfaWZfZW5hYmxlKGNh
bSk7CisJaWYgKHJ2YWwpIHsKKwkJZGV2X2RiZyhjYW0tPmRldiwgInZpZGlvY19pbnRfZ19pZnBh
cm0gZmFpbGVkXG4iKTsKKwkJZ290byBvdXQ7CisJfQorCisJcnZhbCA9IHZpZGVvYnVmX3N0cmVh
bW9uKCZvZmgtPnZicSk7CisJaWYgKCFydmFsKSB7CisJCWNhbS0+c3RyZWFtaW5nID0gZmlsZTsK
KwkJc3lzZnNfbm90aWZ5KCZjYW0tPmRldi0+a29iaiwgTlVMTCwgInN0cmVhbWluZyIpOworCX0K
Kworb3V0OgorCW11dGV4X3VubG9jaygmY2FtLT5tdXRleCk7CisKKwlyZXR1cm4gcnZhbDsKK30K
Kworc3RhdGljIGludCB2aWRpb2Nfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgZW51bSB2NGwyX2J1Zl90eXBlIGkpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpvZmgg
PSBmaDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvZmgtPmNhbTsKKwlzdHJ1
Y3QgdmlkZW9idWZfcXVldWUgKnEgPSAmb2ZoLT52YnE7CisJaW50IHJ2YWw7CisKKwlhdG9taWNf
aW5jKCZjYW0tPnJlc2V0X2Rpc2FibGUpOworCisJZmx1c2hfc2NoZWR1bGVkX3dvcmsoKTsKKwor
CXJ2YWwgPSB2aWRlb2J1Zl9zdHJlYW1vZmYocSk7CisJaWYgKCFydmFsKSB7CisJCW11dGV4X2xv
Y2soJmNhbS0+bXV0ZXgpOworCQljYW0tPnN0cmVhbWluZyA9IE5VTEw7CisJCW11dGV4X3VubG9j
aygmY2FtLT5tdXRleCk7CisJCXN5c2ZzX25vdGlmeSgmY2FtLT5kZXYtPmtvYmosIE5VTEwsICJz
dHJlYW1pbmciKTsKKwl9CisKKwlhdG9taWNfZGVjKCZjYW0tPnJlc2V0X2Rpc2FibGUpOworCisJ
cmV0dXJuIHJ2YWw7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorCQkJICAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQorewor
CWlmIChpbnAtPmluZGV4ID4gMCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzdHJsY3B5KGlucC0+
bmFtZSwgImNhbWVyYSIsIHNpemVvZihpbnAtPm5hbWUpKTsKKwlpbnAtPnR5cGUgPSBWNEwyX0lO
UFVUX1RZUEVfQ0FNRVJBOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCit7CisJ
KmkgPSAwOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaSkKK3sKKwlpZiAoaSA+IDAp
CisJCXJldHVybiAtRUlOVkFMOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9j
X3F1ZXJ5Y3RybChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCisJCQkgICAgc3RydWN0IHY0
bDJfcXVlcnljdHJsICphKQoreworCXN0cnVjdCBvbWFwMjR4eGNhbV9maCAqb2ZoID0gZmg7CisJ
c3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gb2ZoLT5jYW07CisJaW50IHJ2YWw7CisK
KwlydmFsID0gdmlkaW9jX2ludF9xdWVyeWN0cmwoY2FtLT5zZGV2LCBhKTsKKworCXJldHVybiBy
dmFsOworfQorCitzdGF0aWMgaW50IHZpZGlvY19nX2N0cmwoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorCQkJIHN0cnVjdCB2NGwyX2NvbnRyb2wgKmEpCit7CisJc3RydWN0IG9tYXAyNHh4
Y2FtX2ZoICpvZmggPSBmaDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvZmgt
PmNhbTsKKwlpbnQgcnZhbDsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCXJ2YWwgPSB2
aWRpb2NfaW50X2dfY3RybChjYW0tPnNkZXYsIGEpOworCW11dGV4X3VubG9jaygmY2FtLT5tdXRl
eCk7CisKKwlyZXR1cm4gcnZhbDsKK30KKworc3RhdGljIGludCB2aWRpb2Nfc19jdHJsKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKKwkJCSBzdHJ1Y3QgdjRsMl9jb250cm9sICphKQorewor
CXN0cnVjdCBvbWFwMjR4eGNhbV9maCAqb2ZoID0gZmg7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2Rl
dmljZSAqY2FtID0gb2ZoLT5jYW07CisJaW50IHJ2YWw7CisKKwltdXRleF9sb2NrKCZjYW0tPm11
dGV4KTsKKwlydmFsID0gdmlkaW9jX2ludF9zX2N0cmwoY2FtLT5zZGV2LCBhKTsKKwltdXRleF91
bmxvY2soJmNhbS0+bXV0ZXgpOworCisJcmV0dXJuIHJ2YWw7Cit9CisKK3N0YXRpYyBpbnQgdmlk
aW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCisJCQkgc3RydWN0IHY0bDJf
c3RyZWFtcGFybSAqYSkgeworCXN0cnVjdCBvbWFwMjR4eGNhbV9maCAqb2ZoID0gZmg7CisJc3Ry
dWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gb2ZoLT5jYW07CisJaW50IHJ2YWw7CisKKwlp
ZiAoYS0+dHlwZSAhPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUpCisJCXJldHVybiAtRUlO
VkFMOworCisJbXV0ZXhfbG9jaygmY2FtLT5tdXRleCk7CisJcnZhbCA9IHZpZGlvY19pbnRfZ19w
YXJtKGNhbS0+c2RldiwgYSk7CisJbXV0ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsKKworCXJldHVy
biBydmFsOworfQorCitzdGF0aWMgaW50IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCit7CisJc3RydWN0IG9t
YXAyNHh4Y2FtX2ZoICpvZmggPSBmaDsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0g
PSBvZmgtPmNhbTsKKwlzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtIG9sZF9zdHJlYW1wYXJtOworCWlu
dCBydmFsOworCisJaWYgKGEtPnR5cGUgIT0gVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFKQor
CQlyZXR1cm4gLUVJTlZBTDsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCWlmIChjYW0t
PnN0cmVhbWluZykgeworCQlydmFsID0gLUVCVVNZOworCQlnb3RvIG91dDsKKwl9CisKKwlvbGRf
c3RyZWFtcGFybS50eXBlID0gVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFOworCXJ2YWwgPSB2
aWRpb2NfaW50X2dfcGFybShjYW0tPnNkZXYsICZvbGRfc3RyZWFtcGFybSk7CisJaWYgKHJ2YWwp
CisJCWdvdG8gb3V0OworCisJcnZhbCA9IHZpZGlvY19pbnRfc19wYXJtKGNhbS0+c2RldiwgYSk7
CisJaWYgKHJ2YWwpCisJCWdvdG8gb3V0OworCisJcnZhbCA9IG9tYXAyNHh4Y2FtX3NlbnNvcl9p
Zl9lbmFibGUoY2FtKTsKKwkvKgorCSAqIFJldmVydCB0byBvbGQgc3RyZWFtaW5nIHBhcmFtZXRl
cnMgaWYgZW5hYmxpbmcgc2Vuc29yCisJICogaW50ZXJmYWNlIHdpdGggdGhlIG5ldyBvbmVzIGZh
aWxlZC4KKwkgKi8KKwlpZiAocnZhbCkKKwkJdmlkaW9jX2ludF9zX3Bhcm0oY2FtLT5zZGV2LCAm
b2xkX3N0cmVhbXBhcm0pOworCitvdXQ6CisJbXV0ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsKKwor
CXJldHVybiBydmFsOworfQorCisvKgorICoKKyAqIEZpbGUgb3BlcmF0aW9ucy4KKyAqCisgKi8K
Kworc3RhdGljIHVuc2lnbmVkIGludCBvbWFwMjR4eGNhbV9wb2xsKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICAgc3RydWN0IHBvbGxfdGFibGVfc3RydWN0ICp3YWl0KQoreworCXN0cnVjdCBv
bWFwMjR4eGNhbV9maCAqZmggPSBmaWxlLT5wcml2YXRlX2RhdGE7CisJc3RydWN0IG9tYXAyNHh4
Y2FtX2RldmljZSAqY2FtID0gZmgtPmNhbTsKKwlzdHJ1Y3QgdmlkZW9idWZfYnVmZmVyICp2YjsK
KworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCWlmIChjYW0tPnN0cmVhbWluZyAhPSBmaWxl
KSB7CisJCW11dGV4X3VubG9jaygmY2FtLT5tdXRleCk7CisJCXJldHVybiBQT0xMRVJSOworCX0K
KwltdXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOworCisJbXV0ZXhfbG9jaygmZmgtPnZicS52Yl9s
b2NrKTsKKwlpZiAobGlzdF9lbXB0eSgmZmgtPnZicS5zdHJlYW0pKSB7CisJCW11dGV4X3VubG9j
aygmZmgtPnZicS52Yl9sb2NrKTsKKwkJcmV0dXJuIFBPTExFUlI7CisJfQorCXZiID0gbGlzdF9l
bnRyeShmaC0+dmJxLnN0cmVhbS5uZXh0LCBzdHJ1Y3QgdmlkZW9idWZfYnVmZmVyLCBzdHJlYW0p
OworCW11dGV4X3VubG9jaygmZmgtPnZicS52Yl9sb2NrKTsKKworCXBvbGxfd2FpdChmaWxlLCAm
dmItPmRvbmUsIHdhaXQpOworCisJaWYgKHZiLT5zdGF0ZSA9PSBWSURFT0JVRl9ET05FIHx8IHZi
LT5zdGF0ZSA9PSBWSURFT0JVRl9FUlJPUikKKwkJcmV0dXJuIFBPTExJTiB8IFBPTExSRE5PUk07
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBvbWFwMjR4eGNhbV9tbWFwX2J1ZmZlcnMo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQor
eworCXN0cnVjdCBvbWFwMjR4eGNhbV9maCAqZmggPSBmaWxlLT5wcml2YXRlX2RhdGE7CisJc3Ry
dWN0IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gZmgtPmNhbTsKKwlzdHJ1Y3QgdmlkZW9idWZf
cXVldWUgKnZicSA9ICZmaC0+dmJxOworCXVuc2lnbmVkIGludCBmaXJzdCwgbGFzdCwgc2l6ZSwg
aSwgajsKKwlpbnQgZXJyID0gMDsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0ZXgpOworCWlmIChj
YW0tPnN0cmVhbWluZykgeworCQltdXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOworCQlyZXR1cm4g
LUVCVVNZOworCX0KKwltdXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOworCW11dGV4X2xvY2soJnZi
cS0+dmJfbG9jayk7CisKKwkvKiBsb29rIGZvciBmaXJzdCBidWZmZXIgdG8gbWFwICovCisJZm9y
IChmaXJzdCA9IDA7IGZpcnN0IDwgVklERU9fTUFYX0ZSQU1FOyBmaXJzdCsrKSB7CisJCWlmIChO
VUxMID09IHZicS0+YnVmc1tmaXJzdF0pCisJCQljb250aW51ZTsKKwkJaWYgKFY0TDJfTUVNT1JZ
X01NQVAgIT0gdmJxLT5idWZzW2ZpcnN0XS0+bWVtb3J5KQorCQkJY29udGludWU7CisJCWlmICh2
YnEtPmJ1ZnNbZmlyc3RdLT5ib2ZmID09ICh2bWEtPnZtX3Bnb2ZmIDw8IFBBR0VfU0hJRlQpKQor
CQkJYnJlYWs7CisJfQorCisJLyogbG9vayBmb3IgbGFzdCBidWZmZXIgdG8gbWFwICovCisJZm9y
IChzaXplID0gMCwgbGFzdCA9IGZpcnN0OyBsYXN0IDwgVklERU9fTUFYX0ZSQU1FOyBsYXN0Kysp
IHsKKwkJaWYgKE5VTEwgPT0gdmJxLT5idWZzW2xhc3RdKQorCQkJY29udGludWU7CisJCWlmIChW
NEwyX01FTU9SWV9NTUFQICE9IHZicS0+YnVmc1tsYXN0XS0+bWVtb3J5KQorCQkJY29udGludWU7
CisJCXNpemUgKz0gdmJxLT5idWZzW2xhc3RdLT5ic2l6ZTsKKwkJaWYgKHNpemUgPT0gKHZtYS0+
dm1fZW5kIC0gdm1hLT52bV9zdGFydCkpCisJCQlicmVhazsKKwl9CisKKwlzaXplID0gMDsKKwlm
b3IgKGkgPSBmaXJzdDsgaSA8PSBsYXN0OyBpKyspIHsKKwkJc3RydWN0IHZpZGVvYnVmX2RtYWJ1
ZiAqZG1hID0gdmlkZW9idWZfdG9fZG1hKHZicS0+YnVmc1tpXSk7CisKKwkJZm9yIChqID0gMDsg
aiA8IGRtYS0+c2dsZW47IGorKykgeworCQkJZXJyID0gcmVtYXBfcGZuX3JhbmdlKAorCQkJCXZt
YSwgdm1hLT52bV9zdGFydCArIHNpemUsCisJCQkJcGFnZV90b19wZm4oc2dfcGFnZSgmZG1hLT5z
Z2xpc3Rbal0pKSwKKwkJCQlzZ19kbWFfbGVuKCZkbWEtPnNnbGlzdFtqXSksIHZtYS0+dm1fcGFn
ZV9wcm90KTsKKwkJCWlmIChlcnIpCisJCQkJZ290byBvdXQ7CisJCQlzaXplICs9IHNnX2RtYV9s
ZW4oJmRtYS0+c2dsaXN0W2pdKTsKKwkJfQorCX0KKworb3V0OgorCW11dGV4X3VubG9jaygmdmJx
LT52Yl9sb2NrKTsKKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1f
bW1hcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEpCit7CisJ
c3RydWN0IG9tYXAyNHh4Y2FtX2ZoICpmaCA9IGZpbGUtPnByaXZhdGVfZGF0YTsKKwlpbnQgcnZh
bDsKKworCS8qIGxldCB0aGUgdmlkZW8tYnVmIG1hcHBlciBjaGVjayBhcmd1bWVudHMgYW5kIHNl
dC11cCBzdHJ1Y3R1cmVzICovCisJcnZhbCA9IHZpZGVvYnVmX21tYXBfbWFwcGVyKCZmaC0+dmJx
LCB2bWEpOworCWlmIChydmFsKQorCQlyZXR1cm4gcnZhbDsKKworCXZtYS0+dm1fcGFnZV9wcm90
ID0gcGdwcm90X25vbmNhY2hlZCh2bWEtPnZtX3BhZ2VfcHJvdCk7CisKKwkvKiBkbyBtYXBwaW5n
IHRvIG91ciBhbGxvY2F0ZWQgYnVmZmVycyAqLworCXJ2YWwgPSBvbWFwMjR4eGNhbV9tbWFwX2J1
ZmZlcnMoZmlsZSwgdm1hKTsKKwkvKgorCSAqIEluIGNhc2Ugb2YgZXJyb3IsIGZyZWUgdm1hLT52
bV9wcml2YXRlX2RhdGEgYWxsb2NhdGVkIGJ5CisJICogdmlkZW9idWZfbW1hcF9tYXBwZXIuCisJ
ICovCisJaWYgKHJ2YWwpCisJCWtmcmVlKHZtYS0+dm1fcHJpdmF0ZV9kYXRhKTsKKworCXJldHVy
biBydmFsOworfQorCitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX29wZW4oc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCit7CisJaW50IG1pbm9yID0gaW1pbm9yKGlub2RlKTsK
KwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0gPSBvbWFwMjR4eGNhbS5wcml2OworCXN0
cnVjdCBvbWFwMjR4eGNhbV9maCAqZmg7CisJc3RydWN0IHY0bDJfZm9ybWF0IGZvcm1hdDsKKwor
CWlmICghY2FtIHx8ICFjYW0tPnZmZCB8fCAoY2FtLT52ZmQtPm1pbm9yICE9IG1pbm9yKSkKKwkJ
cmV0dXJuIC1FTk9ERVY7CisKKwlmaCA9IGt6YWxsb2Moc2l6ZW9mKCpmaCksIEdGUF9LRVJORUwp
OworCWlmIChmaCA9PSBOVUxMKQorCQlyZXR1cm4gLUVOT01FTTsKKworCW11dGV4X2xvY2soJmNh
bS0+bXV0ZXgpOworCWlmIChjYW0tPnNkZXYgPT0gTlVMTCB8fCAhdHJ5X21vZHVsZV9nZXQoY2Ft
LT5zZGV2LT5tb2R1bGUpKSB7CisJCW11dGV4X3VubG9jaygmY2FtLT5tdXRleCk7CisJCWdvdG8g
b3V0X3RyeV9tb2R1bGVfZ2V0OworCX0KKworCWlmIChhdG9taWNfaW5jX3JldHVybigmY2FtLT51
c2VycykgPT0gMSkgeworCQlvbWFwMjR4eGNhbV9od2luaXQoY2FtKTsKKwkJaWYgKG9tYXAyNHh4
Y2FtX3NlbnNvcl9lbmFibGUoY2FtKSkgeworCQkJbXV0ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsK
KwkJCWdvdG8gb3V0X29tYXAyNHh4Y2FtX3NlbnNvcl9lbmFibGU7CisJCX0KKwl9CisJbXV0ZXhf
dW5sb2NrKCZjYW0tPm11dGV4KTsKKworCWZoLT5jYW0gPSBjYW07CisJbXV0ZXhfbG9jaygmY2Ft
LT5tdXRleCk7CisJdmlkaW9jX2ludF9nX2ZtdF9jYXAoY2FtLT5zZGV2LCAmZm9ybWF0KTsKKwlt
dXRleF91bmxvY2soJmNhbS0+bXV0ZXgpOworCS8qIEZJWE1FOiBob3cgYWJvdXQgZmgtPnBpeCB3
aGVuIHRoZXJlIGFyZSBtb3JlIHVzZXJzPyAqLworCWZoLT5waXggPSBmb3JtYXQuZm10LnBpeDsK
KworCWZpbGUtPnByaXZhdGVfZGF0YSA9IGZoOworCisJc3Bpbl9sb2NrX2luaXQoJmZoLT52YnFf
bG9jayk7CisKKwl2aWRlb2J1Zl9xdWV1ZV9zZ19pbml0KCZmaC0+dmJxLCAmb21hcDI0eHhjYW1f
dmJxX29wcywgTlVMTCwKKwkJCQkmZmgtPnZicV9sb2NrLCBWNEwyX0JVRl9UWVBFX1ZJREVPX0NB
UFRVUkUsCisJCQkJVjRMMl9GSUVMRF9OT05FLAorCQkJCXNpemVvZihzdHJ1Y3QgdmlkZW9idWZf
YnVmZmVyKSwgZmgpOworCisJcmV0dXJuIDA7CisKK291dF9vbWFwMjR4eGNhbV9zZW5zb3JfZW5h
YmxlOgorCW9tYXAyNHh4Y2FtX3Bvd2Vyb25fcmVzZXQoY2FtKTsKKwltb2R1bGVfcHV0KGNhbS0+
c2Rldi0+bW9kdWxlKTsKKworb3V0X3RyeV9tb2R1bGVfZ2V0OgorCWtmcmVlKGZoKTsKKworCXJl
dHVybiAtRU5PREVWOworfQorCitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX3JlbGVhc2Uoc3RydWN0
IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpCit7CisJc3RydWN0IG9tYXAyNHh4Y2Ft
X2ZoICpmaCA9IGZpbGUtPnByaXZhdGVfZGF0YTsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNl
ICpjYW0gPSBmaC0+Y2FtOworCisJYXRvbWljX2luYygmY2FtLT5yZXNldF9kaXNhYmxlKTsKKwor
CWZsdXNoX3NjaGVkdWxlZF93b3JrKCk7CisKKwkvKiBzdG9wIHN0cmVhbWluZyBjYXB0dXJlICov
CisJdmlkZW9idWZfc3RyZWFtb2ZmKCZmaC0+dmJxKTsKKworCW11dGV4X2xvY2soJmNhbS0+bXV0
ZXgpOworCWlmIChjYW0tPnN0cmVhbWluZyA9PSBmaWxlKSB7CisJCWNhbS0+c3RyZWFtaW5nID0g
TlVMTDsKKwkJbXV0ZXhfdW5sb2NrKCZjYW0tPm11dGV4KTsKKwkJc3lzZnNfbm90aWZ5KCZjYW0t
PmRldi0+a29iaiwgTlVMTCwgInN0cmVhbWluZyIpOworCX0gZWxzZSB7CisJCW11dGV4X3VubG9j
aygmY2FtLT5tdXRleCk7CisJfQorCisJYXRvbWljX2RlYygmY2FtLT5yZXNldF9kaXNhYmxlKTsK
KworCW9tYXAyNHh4Y2FtX3ZicV9mcmVlX21tYXBfYnVmZmVycygmZmgtPnZicSk7CisKKwkvKgor
CSAqIE1ha2Ugc3VyZSB0aGUgcmVzZXQgd29yayB3ZSBtaWdodCBoYXZlIHNjaGVkdWxlZCBpcyBu
b3QKKwkgKiBwZW5kaW5nISBJdCBtYXkgYmUgcnVuICpvbmx5KiBpZiB3ZSBoYXZlIHVzZXJzLiAo
QW5kIGl0IG1heQorCSAqIG5vdCBiZSBzY2hlZHVsZWQgYW55bW9yZSBzaW5jZSBzdHJlYW1pbmcg
aXMgYWxyZWFkeQorCSAqIGRpc2FibGVkLikKKwkgKi8KKwlmbHVzaF9zY2hlZHVsZWRfd29yaygp
OworCisJbXV0ZXhfbG9jaygmY2FtLT5tdXRleCk7CisJaWYgKGF0b21pY19kZWNfcmV0dXJuKCZj
YW0tPnVzZXJzKSA9PSAwKSB7CisJCW9tYXAyNHh4Y2FtX3NlbnNvcl9kaXNhYmxlKGNhbSk7CisJ
CW9tYXAyNHh4Y2FtX3Bvd2Vyb25fcmVzZXQoY2FtKTsKKwl9CisJbXV0ZXhfdW5sb2NrKCZjYW0t
Pm11dGV4KTsKKworCWZpbGUtPnByaXZhdGVfZGF0YSA9IE5VTEw7CisKKwltb2R1bGVfcHV0KGNh
bS0+c2Rldi0+bW9kdWxlKTsKKwlrZnJlZShmaCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGlj
IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgb21hcDI0eHhjYW1fZm9wcyA9IHsKKwkubGxzZWVrCSA9
IG5vX2xsc2VlaywKKwkuaW9jdGwJID0gdmlkZW9faW9jdGwyLAorCS5wb2xsCSA9IG9tYXAyNHh4
Y2FtX3BvbGwsCisJLm1tYXAJID0gb21hcDI0eHhjYW1fbW1hcCwKKwkub3BlbgkgPSBvbWFwMjR4
eGNhbV9vcGVuLAorCS5yZWxlYXNlID0gb21hcDI0eHhjYW1fcmVsZWFzZSwKK307CisKKy8qCisg
KgorICogUG93ZXIgbWFuYWdlbWVudC4KKyAqCisgKi8KKworI2lmZGVmIENPTkZJR19QTQorc3Rh
dGljIGludCBvbWFwMjR4eGNhbV9zdXNwZW5kKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYs
IHBtX21lc3NhZ2VfdCBzdGF0ZSkKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpjYW0g
PSBwbGF0Zm9ybV9nZXRfZHJ2ZGF0YShwZGV2KTsKKworCWlmIChhdG9taWNfcmVhZCgmY2FtLT51
c2VycykgPT0gMCkKKwkJcmV0dXJuIDA7CisKKwlpZiAoIWF0b21pY19yZWFkKCZjYW0tPnJlc2V0
X2Rpc2FibGUpKQorCQlvbWFwMjR4eGNhbV9jYXB0dXJlX3N0b3AoY2FtKTsKKworCW9tYXAyNHh4
Y2FtX3NlbnNvcl9kaXNhYmxlKGNhbSk7CisJb21hcDI0eHhjYW1fcG93ZXJvbl9yZXNldChjYW0p
OworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgb21hcDI0eHhjYW1fcmVzdW1lKHN0cnVj
dCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IG9tYXAyNHh4Y2FtX2RldmljZSAq
Y2FtID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwlpZiAoYXRvbWljX3JlYWQoJmNh
bS0+dXNlcnMpID09IDApCisJCXJldHVybiAwOworCisJb21hcDI0eHhjYW1faHdpbml0KGNhbSk7
CisJb21hcDI0eHhjYW1fc2Vuc29yX2VuYWJsZShjYW0pOworCisJaWYgKCFhdG9taWNfcmVhZCgm
Y2FtLT5yZXNldF9kaXNhYmxlKSkKKwkJb21hcDI0eHhjYW1fY2FwdHVyZV9jb250KGNhbSk7CisK
KwlyZXR1cm4gMDsKK30KKyNlbmRpZiAvKiBDT05GSUdfUE0gKi8KKworc3RhdGljIGNvbnN0IHN0
cnVjdCB2NGwyX2lvY3RsX29wcyBvbWFwMjR4eGNhbV9pb2N0bF9mb3BzID0geworCS52aWRpb2Nf
cXVlcnljYXAJPSB2aWRpb2NfcXVlcnljYXAsCisJLnZpZGlvY19lbnVtX2ZtdF92aWRfY2FwCT0g
dmlkaW9jX2VudW1fZm10X3ZpZF9jYXAsCisJLnZpZGlvY19nX2ZtdF92aWRfY2FwCT0gdmlkaW9j
X2dfZm10X3ZpZF9jYXAsCisJLnZpZGlvY19zX2ZtdF92aWRfY2FwCT0gdmlkaW9jX3NfZm10X3Zp
ZF9jYXAsCisJLnZpZGlvY190cnlfZm10X3ZpZF9jYXAJPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2Fw
LAorCS52aWRpb2NfcmVxYnVmcwkJPSB2aWRpb2NfcmVxYnVmcywKKwkudmlkaW9jX3F1ZXJ5YnVm
CT0gdmlkaW9jX3F1ZXJ5YnVmLAorCS52aWRpb2NfcWJ1ZgkJPSB2aWRpb2NfcWJ1ZiwKKwkudmlk
aW9jX2RxYnVmCQk9IHZpZGlvY19kcWJ1ZiwKKwkudmlkaW9jX3N0cmVhbW9uCT0gdmlkaW9jX3N0
cmVhbW9uLAorCS52aWRpb2Nfc3RyZWFtb2ZmCT0gdmlkaW9jX3N0cmVhbW9mZiwKKwkudmlkaW9j
X2VudW1faW5wdXQJPSB2aWRpb2NfZW51bV9pbnB1dCwKKwkudmlkaW9jX2dfaW5wdXQJCT0gdmlk
aW9jX2dfaW5wdXQsCisJLnZpZGlvY19zX2lucHV0CQk9IHZpZGlvY19zX2lucHV0LAorCS52aWRp
b2NfcXVlcnljdHJsCT0gdmlkaW9jX3F1ZXJ5Y3RybCwKKwkudmlkaW9jX2dfY3RybAkJPSB2aWRp
b2NfZ19jdHJsLAorCS52aWRpb2Nfc19jdHJsCQk9IHZpZGlvY19zX2N0cmwsCisJLnZpZGlvY19n
X3Bhcm0JCT0gdmlkaW9jX2dfcGFybSwKKwkudmlkaW9jX3NfcGFybQkJPSB2aWRpb2Nfc19wYXJt
LAorfTsKKworLyoKKyAqCisgKiBDYW1lcmEgZGV2aWNlIChpLmUuIC9kZXYvdmlkZW8pLgorICoK
KyAqLworCitzdGF0aWMgaW50IG9tYXAyNHh4Y2FtX2RldmljZV9yZWdpc3RlcihzdHJ1Y3QgdjRs
Ml9pbnRfZGV2aWNlICpzKQoreworCXN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9IHMt
PnUuc2xhdmUtPm1hc3Rlci0+cHJpdjsKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZmQ7CisJaW50
IHJ2YWw7CisKKwkvKiBXZSBhbHJlYWR5IGhhdmUgYSBzbGF2ZS4gKi8KKwlpZiAoY2FtLT5zZGV2
KQorCQlyZXR1cm4gLUVCVVNZOworCisJY2FtLT5zZGV2ID0gczsKKworCWlmIChkZXZpY2VfY3Jl
YXRlX2ZpbGUoY2FtLT5kZXYsICZkZXZfYXR0cl9zdHJlYW1pbmcpICE9IDApIHsKKwkJZGV2X2Vy
cihjYW0tPmRldiwgImNvdWxkIG5vdCByZWdpc3RlciBzeXNmcyBlbnRyeVxuIik7CisJCXJ2YWwg
PSAtRUJVU1k7CisJCWdvdG8gZXJyOworCX0KKworCS8qIGluaXRpYWxpemUgdGhlIHZpZGVvX2Rl
dmljZSBzdHJ1Y3QgKi8KKwl2ZmQgPSBjYW0tPnZmZCA9IHZpZGVvX2RldmljZV9hbGxvYygpOwor
CWlmICghdmZkKSB7CisJCWRldl9lcnIoY2FtLT5kZXYsICJjb3VsZCBub3QgYWxsb2NhdGUgdmlk
ZW8gZGV2aWNlIHN0cnVjdFxuIik7CisJCXJ2YWwgPSAtRU5PTUVNOworCQlnb3RvIGVycjsKKwl9
CisJdmZkLT5yZWxlYXNlID0gdmlkZW9fZGV2aWNlX3JlbGVhc2U7CisKKwl2ZmQtPnBhcmVudCA9
IGNhbS0+ZGV2OworCisJc3RybGNweSh2ZmQtPm5hbWUsIENBTV9OQU1FLCBzaXplb2YodmZkLT5u
YW1lKSk7CisJdmZkLT52ZmxfdHlwZQkJID0gVklEX1RZUEVfQ0FQVFVSRSB8IFZJRF9UWVBFX0NI
Uk9NQUtFWTsKKwl2ZmQtPmZvcHMJCSA9ICZvbWFwMjR4eGNhbV9mb3BzOworCXZmZC0+bWlub3IJ
CSA9IC0xOworCXZmZC0+aW9jdGxfb3BzCQkgPSAmb21hcDI0eHhjYW1faW9jdGxfZm9wczsKKwor
CW9tYXAyNHh4Y2FtX2h3aW5pdChjYW0pOworCisJcnZhbCA9IG9tYXAyNHh4Y2FtX3NlbnNvcl9p
bml0KGNhbSk7CisJaWYgKHJ2YWwpCisJCWdvdG8gZXJyOworCisJaWYgKHZpZGVvX3JlZ2lzdGVy
X2RldmljZSh2ZmQsIFZGTF9UWVBFX0dSQUJCRVIsIHZpZGVvX25yKSA8IDApIHsKKwkJZGV2X2Vy
cihjYW0tPmRldiwgImNvdWxkIG5vdCByZWdpc3RlciBWNEwgZGV2aWNlXG4iKTsKKwkJdmZkLT5t
aW5vciA9IC0xOworCQlydmFsID0gLUVCVVNZOworCQlnb3RvIGVycjsKKwl9CisKKwlvbWFwMjR4
eGNhbV9wb3dlcm9uX3Jlc2V0KGNhbSk7CisKKwlkZXZfaW5mbyhjYW0tPmRldiwgInJlZ2lzdGVy
ZWQgZGV2aWNlIHZpZGVvJWRcbiIsIHZmZC0+bWlub3IpOworCisJcmV0dXJuIDA7CisKK2VycjoK
KwlvbWFwMjR4eGNhbV9kZXZpY2VfdW5yZWdpc3RlcihzKTsKKworCXJldHVybiBydmFsOworfQor
CitzdGF0aWMgdm9pZCBvbWFwMjR4eGNhbV9kZXZpY2VfdW5yZWdpc3RlcihzdHJ1Y3QgdjRsMl9p
bnRfZGV2aWNlICpzKQoreworCXN0cnVjdCBvbWFwMjR4eGNhbV9kZXZpY2UgKmNhbSA9IHMtPnUu
c2xhdmUtPm1hc3Rlci0+cHJpdjsKKworCW9tYXAyNHh4Y2FtX3NlbnNvcl9leGl0KGNhbSk7CisK
KwlpZiAoY2FtLT52ZmQpIHsKKwkJaWYgKGNhbS0+dmZkLT5taW5vciA9PSAtMSkgeworCQkJLyoK
KwkJCSAqIFRoZSBkZXZpY2Ugd2FzIG5ldmVyIHJlZ2lzdGVyZWQsIHNvIHJlbGVhc2UgdGhlCisJ
CQkgKiB2aWRlb19kZXZpY2Ugc3RydWN0IGRpcmVjdGx5LgorCQkJICovCisJCQl2aWRlb19kZXZp
Y2VfcmVsZWFzZShjYW0tPnZmZCk7CisJCX0gZWxzZSB7CisJCQkvKgorCQkJICogVGhlIHVucmVn
aXN0ZXIgZnVuY3Rpb24gd2lsbCByZWxlYXNlIHRoZQorCQkJICogdmlkZW9fZGV2aWNlIHN0cnVj
dCBhcyB3ZWxsIGFzCisJCQkgKiB1bnJlZ2lzdGVyaW5nIGl0LgorCQkJICovCisJCQl2aWRlb191
bnJlZ2lzdGVyX2RldmljZShjYW0tPnZmZCk7CisJCX0KKwkJY2FtLT52ZmQgPSBOVUxMOworCX0K
KworCWRldmljZV9yZW1vdmVfZmlsZShjYW0tPmRldiwgJmRldl9hdHRyX3N0cmVhbWluZyk7CisK
KwljYW0tPnNkZXYgPSBOVUxMOworfQorCitzdGF0aWMgc3RydWN0IHY0bDJfaW50X21hc3RlciBv
bWFwMjR4eGNhbV9tYXN0ZXIgPSB7CisJLmF0dGFjaCA9IG9tYXAyNHh4Y2FtX2RldmljZV9yZWdp
c3RlciwKKwkuZGV0YWNoID0gb21hcDI0eHhjYW1fZGV2aWNlX3VucmVnaXN0ZXIsCit9OworCitz
dGF0aWMgc3RydWN0IHY0bDJfaW50X2RldmljZSBvbWFwMjR4eGNhbSA9IHsKKwkubW9kdWxlCT0g
VEhJU19NT0RVTEUsCisJLm5hbWUJPSBDQU1fTkFNRSwKKwkudHlwZQk9IHY0bDJfaW50X3R5cGVf
bWFzdGVyLAorCS51CT0geworCQkubWFzdGVyID0gJm9tYXAyNHh4Y2FtX21hc3RlcgorCX0sCit9
OworCisvKgorICoKKyAqIERyaXZlciBpbml0aWFsaXNhdGlvbiBhbmQgZGVpbml0aWFsaXNhdGlv
bi4KKyAqCisgKi8KKworc3RhdGljIGludCBfX2luaXQgb21hcDI0eHhjYW1fcHJvYmUoc3RydWN0
IHBsYXRmb3JtX2RldmljZSAqcGRldikKK3sKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlICpj
YW07CisJc3RydWN0IHJlc291cmNlICptZW07CisJaW50IGlycTsKKworCWNhbSA9IGt6YWxsb2Mo
c2l6ZW9mKCpjYW0pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWNhbSkgeworCQlkZXZfZXJyKCZwZGV2
LT5kZXYsICJjb3VsZCBub3QgYWxsb2NhdGUgbWVtb3J5XG4iKTsKKwkJZ290byBlcnI7CisJfQor
CisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgY2FtKTsKKworCWNhbS0+ZGV2ID0gJnBkZXYt
PmRldjsKKworCS8qCisJICogSW1wb3NlIGEgbG93ZXIgbGltaXQgb24gdGhlIGFtb3VudCBvZiBt
ZW1vcnkgYWxsb2NhdGVkIGZvcgorCSAqIGNhcHR1cmUuIFdlIHJlcXVpcmUgYXQgbGVhc3QgZW5v
dWdoIG1lbW9yeSB0byBkb3VibGUtYnVmZmVyCisJICogUVZHQSAoMzAwS0IpLgorCSAqLworCWlm
IChjYXB0dXJlX21lbSA8IDMyMCAqIDI0MCAqIDIgKiAyKQorCQljYXB0dXJlX21lbSA9IDMyMCAq
IDI0MCAqIDIgKiAyOworCWNhbS0+Y2FwdHVyZV9tZW0gPSBjYXB0dXJlX21lbTsKKworCS8qIHJl
cXVlc3QgdGhlIG1lbSByZWdpb24gZm9yIHRoZSBjYW1lcmEgcmVnaXN0ZXJzICovCisJbWVtID0g
cGxhdGZvcm1fZ2V0X3Jlc291cmNlKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAwKTsKKwlpZiAoIW1l
bSkgeworCQlkZXZfZXJyKGNhbS0+ZGV2LCAibm8gbWVtIHJlc291cmNlP1xuIik7CisJCWdvdG8g
ZXJyOworCX0KKwlpZiAoIXJlcXVlc3RfbWVtX3JlZ2lvbihtZW0tPnN0YXJ0LCAobWVtLT5lbmQg
LSBtZW0tPnN0YXJ0KSArIDEsCisJCQkJcGRldi0+bmFtZSkpIHsKKwkJZGV2X2VycihjYW0tPmRl
diwKKwkJCSJjYW5ub3QgcmVzZXJ2ZSBjYW1lcmEgcmVnaXN0ZXIgSS9PIHJlZ2lvblxuIik7CisJ
CWdvdG8gZXJyOworCX0KKwljYW0tPm1taW9fYmFzZV9waHlzID0gbWVtLT5zdGFydDsKKwljYW0t
Pm1taW9fc2l6ZSA9IChtZW0tPmVuZCAtIG1lbS0+c3RhcnQpICsgMTsKKworCS8qIG1hcCB0aGUg
cmVnaW9uICovCisJY2FtLT5tbWlvX2Jhc2UgPSAodW5zaWduZWQgbG9uZykKKwkJaW9yZW1hcF9u
b2NhY2hlKGNhbS0+bW1pb19iYXNlX3BoeXMsIGNhbS0+bW1pb19zaXplKTsKKwlpZiAoIWNhbS0+
bW1pb19iYXNlKSB7CisJCWRldl9lcnIoY2FtLT5kZXYsICJjYW5ub3QgbWFwIGNhbWVyYSByZWdp
c3RlciBJL08gcmVnaW9uXG4iKTsKKwkJZ290byBlcnI7CisJfQorCisJaXJxID0gcGxhdGZvcm1f
Z2V0X2lycShwZGV2LCAwKTsKKwlpZiAoaXJxIDw9IDApIHsKKwkJZGV2X2VycihjYW0tPmRldiwg
Im5vIGlycSBmb3IgY2FtZXJhP1xuIik7CisJCWdvdG8gZXJyOworCX0KKworCS8qIGluc3RhbGwg
dGhlIGludGVycnVwdCBzZXJ2aWNlIHJvdXRpbmUgKi8KKwlpZiAocmVxdWVzdF9pcnEoaXJxLCBv
bWFwMjR4eGNhbV9pc3IsIDAsIENBTV9OQU1FLCBjYW0pKSB7CisJCWRldl9lcnIoY2FtLT5kZXYs
CisJCQkiY291bGQgbm90IGluc3RhbGwgaW50ZXJydXB0IHNlcnZpY2Ugcm91dGluZVxuIik7CisJ
CWdvdG8gZXJyOworCX0KKwljYW0tPmlycSA9IGlycTsKKworCWlmIChvbWFwMjR4eGNhbV9jbG9j
a19nZXQoY2FtKSkKKwkJZ290byBlcnI7CisKKwlJTklUX1dPUksoJmNhbS0+c2Vuc29yX3Jlc2V0
X3dvcmssIG9tYXAyNHh4Y2FtX3NlbnNvcl9yZXNldF93b3JrKTsKKworCW11dGV4X2luaXQoJmNh
bS0+bXV0ZXgpOworCXNwaW5fbG9ja19pbml0KCZjYW0tPmNvcmVfZW5hYmxlX2Rpc2FibGVfbG9j
ayk7CisKKwlvbWFwMjR4eGNhbV9zZ2RtYV9pbml0KCZjYW0tPnNnZG1hLAorCQkJICAgICAgIGNh
bS0+bW1pb19iYXNlICsgQ0FNRE1BX1JFR19PRkZTRVQsCisJCQkgICAgICAgb21hcDI0eHhjYW1f
c3RhbGxlZF9kbWFfcmVzZXQsCisJCQkgICAgICAgKHVuc2lnbmVkIGxvbmcpY2FtKTsKKworCW9t
YXAyNHh4Y2FtLnByaXYgPSBjYW07CisKKwlpZiAodjRsMl9pbnRfZGV2aWNlX3JlZ2lzdGVyKCZv
bWFwMjR4eGNhbSkpCisJCWdvdG8gZXJyOworCisJcmV0dXJuIDA7CisKK2VycjoKKwlvbWFwMjR4
eGNhbV9yZW1vdmUocGRldik7CisJcmV0dXJuIC1FTk9ERVY7Cit9CisKK3N0YXRpYyBpbnQgb21h
cDI0eHhjYW1fcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0
IG9tYXAyNHh4Y2FtX2RldmljZSAqY2FtID0gcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisK
KwlpZiAoIWNhbSkKKwkJcmV0dXJuIDA7CisKKwlpZiAob21hcDI0eHhjYW0ucHJpdiAhPSBOVUxM
KQorCQl2NGwyX2ludF9kZXZpY2VfdW5yZWdpc3Rlcigmb21hcDI0eHhjYW0pOworCW9tYXAyNHh4
Y2FtLnByaXYgPSBOVUxMOworCisJb21hcDI0eHhjYW1fY2xvY2tfcHV0KGNhbSk7CisKKwlpZiAo
Y2FtLT5pcnEpIHsKKwkJZnJlZV9pcnEoY2FtLT5pcnEsIGNhbSk7CisJCWNhbS0+aXJxID0gMDsK
Kwl9CisKKwlpZiAoY2FtLT5tbWlvX2Jhc2UpIHsKKwkJaW91bm1hcCgodm9pZCAqKWNhbS0+bW1p
b19iYXNlKTsKKwkJY2FtLT5tbWlvX2Jhc2UgPSAwOworCX0KKworCWlmIChjYW0tPm1taW9fYmFz
ZV9waHlzKSB7CisJCXJlbGVhc2VfbWVtX3JlZ2lvbihjYW0tPm1taW9fYmFzZV9waHlzLCBjYW0t
Pm1taW9fc2l6ZSk7CisJCWNhbS0+bW1pb19iYXNlX3BoeXMgPSAwOworCX0KKworCWtmcmVlKGNh
bSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgb21h
cDI0eHhjYW1fZHJpdmVyID0geworCS5wcm9iZQkgPSBvbWFwMjR4eGNhbV9wcm9iZSwKKwkucmVt
b3ZlCSA9IG9tYXAyNHh4Y2FtX3JlbW92ZSwKKyNpZmRlZiBDT05GSUdfUE0KKwkuc3VzcGVuZCA9
IG9tYXAyNHh4Y2FtX3N1c3BlbmQsCisJLnJlc3VtZQkgPSBvbWFwMjR4eGNhbV9yZXN1bWUsCisj
ZW5kaWYKKwkuZHJpdmVyCSA9IHsKKwkJLm5hbWUgPSBDQU1fTkFNRSwKKwkJLm93bmVyID0gVEhJ
U19NT0RVTEUsCisJfSwKK307CisKKy8qCisgKgorICogTW9kdWxlIGluaXRpYWxpc2F0aW9uIGFu
ZCBkZWluaXRpYWxpc2F0aW9uCisgKgorICovCisKK3N0YXRpYyBpbnQgX19pbml0IG9tYXAyNHh4
Y2FtX2luaXQodm9pZCkKK3sKKwlyZXR1cm4gcGxhdGZvcm1fZHJpdmVyX3JlZ2lzdGVyKCZvbWFw
MjR4eGNhbV9kcml2ZXIpOworfQorCitzdGF0aWMgdm9pZCBfX2V4aXQgb21hcDI0eHhjYW1fY2xl
YW51cCh2b2lkKQoreworCXBsYXRmb3JtX2RyaXZlcl91bnJlZ2lzdGVyKCZvbWFwMjR4eGNhbV9k
cml2ZXIpOworfQorCitNT0RVTEVfQVVUSE9SKCJTYWthcmkgQWlsdXMgPHNha2FyaS5haWx1c0Bu
b2tpYS5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIk9NQVAyNHh4IFZpZGVvIGZvciBMaW51
eCBjYW1lcmEgZHJpdmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7Cittb2R1bGVfcGFyYW0o
dmlkZW9fbnIsIGludCwgMCk7CitNT0RVTEVfUEFSTV9ERVNDKHZpZGVvX25yLAorCQkgIk1pbm9y
IG51bWJlciBmb3IgdmlkZW8gZGV2aWNlICgtMSA9PT4gYXV0byBhc3NpZ24pIik7Cittb2R1bGVf
cGFyYW0oY2FwdHVyZV9tZW0sIGludCwgMCk7CitNT0RVTEVfUEFSTV9ERVNDKGNhcHR1cmVfbWVt
LCAiTWF4aW11bSBhbW91bnQgb2YgbWVtb3J5IGZvciBjYXB0dXJlICIKKwkJICJidWZmZXJzIChk
ZWZhdWx0IDQ4MDBraUIpIik7CisKK21vZHVsZV9pbml0KG9tYXAyNHh4Y2FtX2luaXQpOworbW9k
dWxlX2V4aXQob21hcDI0eHhjYW1fY2xlYW51cCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlh
L3ZpZGVvL29tYXAyNHh4Y2FtLmggYi9kcml2ZXJzL21lZGlhL3ZpZGVvL29tYXAyNHh4Y2FtLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNmQyY2RlYQotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvbWVkaWEvdmlkZW8vb21hcDI0eHhjYW0uaApAQCAtMCwwICsxLDU5MyBA
QAorLyoKKyAqIGRyaXZlcnMvbWVkaWEvdmlkZW8vb21hcDI0eHhjYW0uaAorICoKKyAqIENvcHly
aWdodCAoQykgMjAwNCBNb250YVZpc3RhIFNvZnR3YXJlLCBJbmMuCisgKiBDb3B5cmlnaHQgKEMp
IDIwMDQgVGV4YXMgSW5zdHJ1bWVudHMuCisgKiBDb3B5cmlnaHQgKEMpIDIwMDcgTm9raWEgQ29y
cG9yYXRpb24uCisgKgorICogQ29udGFjdDogU2FrYXJpIEFpbHVzIDxzYWthcmkuYWlsdXNAbm9r
aWEuY29tPgorICoKKyAqIEJhc2VkIG9uIGNvZGUgZnJvbSBBbmR5IExvd2UgPHNvdXJjZUBtdmlz
dGEuY29tPi4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRo
ZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQorICogdmVyc2lvbiAyIGFzIHB1Ymxpc2hlZCBi
eSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBk
aXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQKKyAqIFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YK
KyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4g
IFNlZSB0aGUgR05VCisgKiBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMu
CisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UKKyAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBpZiBub3QsIHdy
aXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCisgKiBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xp
biBTdCwgRmlmdGggRmxvb3IsIEJvc3RvbiwgTUEKKyAqIDAyMTEwLTEzMDEgVVNBCisgKi8KKwor
I2lmbmRlZiBPTUFQMjRYWENBTV9ICisjZGVmaW5lIE9NQVAyNFhYQ0FNX0gKKworI2luY2x1ZGUg
PG1lZGlhL3ZpZGVvYnVmLWRtYS1zZy5oPgorI2luY2x1ZGUgPG1lZGlhL3Y0bDItaW50LWRldmlj
ZS5oPgorCisvKgorICoKKyAqIEdlbmVyYWwgZHJpdmVyIHJlbGF0ZWQgZGVmaW5pdGlvbnMuCisg
KgorICovCisKKyNkZWZpbmUgQ0FNX05BTUUJCQkJIm9tYXAyNHh4Y2FtIgorCisjZGVmaW5lIENB
TV9NQ0xLCQkJCTk2MDAwMDAwCisKKy8qIG51bWJlciBvZiBieXRlcyB0cmFuc2ZlcnJlZCBwZXIg
RE1BIHJlcXVlc3QgKi8KKyNkZWZpbmUgRE1BX1RIUkVTSE9MRAkJCQkzMgorCisvKgorICogTlVN
X0NBTURNQV9DSEFOTkVMUyBpcyB0aGUgbnVtYmVyIG9mIGxvZ2ljYWwgY2hhbm5lbHMgcHJvdmlk
ZWQgYnkKKyAqIHRoZSBjYW1lcmEgRE1BIGNvbnRyb2xsZXIuCisgKi8KKyNkZWZpbmUgTlVNX0NB
TURNQV9DSEFOTkVMUwkJCTQKKworLyoKKyAqIE5VTV9TR19ETUEgaXMgdGhlIG51bWJlciBvZiBz
Y2F0dGVyLWdhdGhlciBETUEgdHJhbnNmZXJzIHRoYXQgY2FuCisgKiBiZSBxdWV1ZWQuIChXZSBk
b24ndCBoYXZlIGFueSBvdmVybGF5IHNnbGlzdHMgbm93LikKKyAqLworI2RlZmluZSBOVU1fU0df
RE1BCQkJCShWSURFT19NQVhfRlJBTUUpCisKKy8qCisgKgorICogUmVnaXN0ZXIgZGVmaW5pdGlv
bnMuCisgKgorICovCisKKy8qIHN1YnN5c3RlbSByZWdpc3RlciBibG9jayBvZmZzZXRzICovCisj
ZGVmaW5lIENDX1JFR19PRkZTRVQJCQkJMHgwMDAwMDQwMAorI2RlZmluZSBDQU1ETUFfUkVHX09G
RlNFVAkJCTB4MDAwMDA4MDAKKyNkZWZpbmUgQ0FNTU1VX1JFR19PRkZTRVQJCQkweDAwMDAwQzAw
CisKKy8qIGRlZmluZSBjYW1lcmEgc3Vic3lzdGVtIHJlZ2lzdGVyIG9mZnNldHMgKi8KKyNkZWZp
bmUgQ0FNX1JFVklTSU9OCQkJCTB4MDAwCisjZGVmaW5lIENBTV9TWVNDT05GSUcJCQkJMHgwMTAK
KyNkZWZpbmUgQ0FNX1NZU1NUQVRVUwkJCQkweDAxNAorI2RlZmluZSBDQU1fSVJRU1RBVFVTCQkJ
CTB4MDE4CisjZGVmaW5lIENBTV9HUE8JCQkJCTB4MDQwCisjZGVmaW5lIENBTV9HUEkJCQkJCTB4
MDUwCisKKy8qIGRlZmluZSBjYW1lcmEgY29yZSByZWdpc3RlciBvZmZzZXRzICovCisjZGVmaW5l
IENDX1JFVklTSU9OCQkJCTB4MDAwCisjZGVmaW5lIENDX1NZU0NPTkZJRwkJCQkweDAxMAorI2Rl
ZmluZSBDQ19TWVNTVEFUVVMJCQkJMHgwMTQKKyNkZWZpbmUgQ0NfSVJRU1RBVFVTCQkJCTB4MDE4
CisjZGVmaW5lIENDX0lSUUVOQUJMRQkJCQkweDAxQworI2RlZmluZSBDQ19DVFJMCQkJCQkweDA0
MAorI2RlZmluZSBDQ19DVFJMX0RNQQkJCQkweDA0NAorI2RlZmluZSBDQ19DVFJMX1hDTEsJCQkJ
MHgwNDgKKyNkZWZpbmUgQ0NfRklGT0RBVEEJCQkJMHgwNEMKKyNkZWZpbmUgQ0NfVEVTVAkJCQkJ
MHgwNTAKKyNkZWZpbmUgQ0NfR0VOUEFSCQkJCTB4MDU0CisjZGVmaW5lIENDX0NDUEZTQ1IJCQkJ
MHgwNTgKKyNkZWZpbmUgQ0NfQ0NQRkVDUgkJCQkweDA1QworI2RlZmluZSBDQ19DQ1BMU0NSCQkJ
CTB4MDYwCisjZGVmaW5lIENDX0NDUExFQ1IJCQkJMHgwNjQKKyNkZWZpbmUgQ0NfQ0NQREZSCQkJ
CTB4MDY4CisKKy8qIGRlZmluZSBjYW1lcmEgZG1hIHJlZ2lzdGVyIG9mZnNldHMgKi8KKyNkZWZp
bmUgQ0FNRE1BX1JFVklTSU9OCQkJCTB4MDAwCisjZGVmaW5lIENBTURNQV9JUlFTVEFUVVNfTDAJ
CQkweDAwOAorI2RlZmluZSBDQU1ETUFfSVJRU1RBVFVTX0wxCQkJMHgwMEMKKyNkZWZpbmUgQ0FN
RE1BX0lSUVNUQVRVU19MMgkJCTB4MDEwCisjZGVmaW5lIENBTURNQV9JUlFTVEFUVVNfTDMJCQkw
eDAxNAorI2RlZmluZSBDQU1ETUFfSVJRRU5BQkxFX0wwCQkJMHgwMTgKKyNkZWZpbmUgQ0FNRE1B
X0lSUUVOQUJMRV9MMQkJCTB4MDFDCisjZGVmaW5lIENBTURNQV9JUlFFTkFCTEVfTDIJCQkweDAy
MAorI2RlZmluZSBDQU1ETUFfSVJRRU5BQkxFX0wzCQkJMHgwMjQKKyNkZWZpbmUgQ0FNRE1BX1NZ
U1NUQVRVUwkJCTB4MDI4CisjZGVmaW5lIENBTURNQV9PQ1BfU1lTQ09ORklHCQkJMHgwMkMKKyNk
ZWZpbmUgQ0FNRE1BX0NBUFNfMAkJCQkweDA2NAorI2RlZmluZSBDQU1ETUFfQ0FQU18yCQkJCTB4
MDZDCisjZGVmaW5lIENBTURNQV9DQVBTXzMJCQkJMHgwNzAKKyNkZWZpbmUgQ0FNRE1BX0NBUFNf
NAkJCQkweDA3NAorI2RlZmluZSBDQU1ETUFfR0NSCQkJCTB4MDc4CisjZGVmaW5lIENBTURNQV9D
Q1IobikJCQkJKDB4MDgwICsgKG4pKjB4NjApCisjZGVmaW5lIENBTURNQV9DTE5LX0NUUkwobikJ
CQkoMHgwODQgKyAobikqMHg2MCkKKyNkZWZpbmUgQ0FNRE1BX0NJQ1IobikJCQkJKDB4MDg4ICsg
KG4pKjB4NjApCisjZGVmaW5lIENBTURNQV9DU1IobikJCQkJKDB4MDhDICsgKG4pKjB4NjApCisj
ZGVmaW5lIENBTURNQV9DU0RQKG4pCQkJCSgweDA5MCArIChuKSoweDYwKQorI2RlZmluZSBDQU1E
TUFfQ0VOKG4pCQkJCSgweDA5NCArIChuKSoweDYwKQorI2RlZmluZSBDQU1ETUFfQ0ZOKG4pCQkJ
CSgweDA5OCArIChuKSoweDYwKQorI2RlZmluZSBDQU1ETUFfQ1NTQShuKQkJCQkoMHgwOUMgKyAo
bikqMHg2MCkKKyNkZWZpbmUgQ0FNRE1BX0NEU0EobikJCQkJKDB4MEEwICsgKG4pKjB4NjApCisj
ZGVmaW5lIENBTURNQV9DU0VJKG4pCQkJCSgweDBBNCArIChuKSoweDYwKQorI2RlZmluZSBDQU1E
TUFfQ1NGSShuKQkJCQkoMHgwQTggKyAobikqMHg2MCkKKyNkZWZpbmUgQ0FNRE1BX0NERUkobikJ
CQkJKDB4MEFDICsgKG4pKjB4NjApCisjZGVmaW5lIENBTURNQV9DREZJKG4pCQkJCSgweDBCMCAr
IChuKSoweDYwKQorI2RlZmluZSBDQU1ETUFfQ1NBQyhuKQkJCQkoMHgwQjQgKyAobikqMHg2MCkK
KyNkZWZpbmUgQ0FNRE1BX0NEQUMobikJCQkJKDB4MEI4ICsgKG4pKjB4NjApCisjZGVmaW5lIENB
TURNQV9DQ0VOKG4pCQkJCSgweDBCQyArIChuKSoweDYwKQorI2RlZmluZSBDQU1ETUFfQ0NGTihu
KQkJCQkoMHgwQzAgKyAobikqMHg2MCkKKyNkZWZpbmUgQ0FNRE1BX0NPTE9SKG4pCQkJCSgweDBD
NCArIChuKSoweDYwKQorCisvKiBkZWZpbmUgY2FtZXJhIG1tdSByZWdpc3RlciBvZmZzZXRzICov
CisjZGVmaW5lIENBTU1NVV9SRVZJU0lPTgkJCQkweDAwMAorI2RlZmluZSBDQU1NTVVfU1lTQ09O
RklHCQkJMHgwMTAKKyNkZWZpbmUgQ0FNTU1VX1NZU1NUQVRVUwkJCTB4MDE0CisjZGVmaW5lIENB
TU1NVV9JUlFTVEFUVVMJCQkweDAxOAorI2RlZmluZSBDQU1NTVVfSVJRRU5BQkxFCQkJMHgwMUMK
KyNkZWZpbmUgQ0FNTU1VX1dBTEtJTkdfU1QJCQkweDA0MAorI2RlZmluZSBDQU1NTVVfQ05UTAkJ
CQkweDA0NAorI2RlZmluZSBDQU1NTVVfRkFVTFRfQUQJCQkJMHgwNDgKKyNkZWZpbmUgQ0FNTU1V
X1RUQgkJCQkweDA0QworI2RlZmluZSBDQU1NTVVfTE9DSwkJCQkweDA1MAorI2RlZmluZSBDQU1N
TVVfTERfVExCCQkJCTB4MDU0CisjZGVmaW5lIENBTU1NVV9DQU0JCQkJMHgwNTgKKyNkZWZpbmUg
Q0FNTU1VX1JBTQkJCQkweDA1QworI2RlZmluZSBDQU1NTVVfR0ZMVVNICQkJCTB4MDYwCisjZGVm
aW5lIENBTU1NVV9GTFVTSF9FTlRSWQkJCTB4MDY0CisjZGVmaW5lIENBTU1NVV9SRUFEX0NBTQkJ
CQkweDA2OAorI2RlZmluZSBDQU1NTVVfUkVBRF9SQU0JCQkJMHgwNkMKKyNkZWZpbmUgQ0FNTU1V
X0VNVV9GQVVMVF9BRAkJCTB4MDcwCisKKy8qIERlZmluZSBiaXQgZmllbGRzIHdpdGhpbiBzZWxl
Y3RlZCByZWdpc3RlcnMgKi8KKyNkZWZpbmUgQ0FNX1JFVklTSU9OX01BSk9SCQkJKDE1IDw8IDQp
CisjZGVmaW5lIENBTV9SRVZJU0lPTl9NQUpPUl9TSElGVAkJNAorI2RlZmluZSBDQU1fUkVWSVNJ
T05fTUlOT1IJCQkoMTUgPDwgMCkKKyNkZWZpbmUgQ0FNX1JFVklTSU9OX01JTk9SX1NISUZUCQkw
CisKKyNkZWZpbmUgQ0FNX1NZU0NPTkZJR19TT0ZUUkVTRVQJCQkoMSA8PCAgMSkKKyNkZWZpbmUg
Q0FNX1NZU0NPTkZJR19BVVRPSURMRQkJCSgxIDw8ICAwKQorCisjZGVmaW5lIENBTV9TWVNTVEFU
VVNfUkVTRVRET05FCQkJKDEgPDwgIDApCisKKyNkZWZpbmUgQ0FNX0lSUVNUQVRVU19DQ19JUlEJ
CQkoMSA8PCAgNCkKKyNkZWZpbmUgQ0FNX0lSUVNUQVRVU19NTVVfSVJRCQkJKDEgPDwgIDMpCisj
ZGVmaW5lIENBTV9JUlFTVEFUVVNfRE1BX0lSUTIJCQkoMSA8PCAgMikKKyNkZWZpbmUgQ0FNX0lS
UVNUQVRVU19ETUFfSVJRMQkJCSgxIDw8ICAxKQorI2RlZmluZSBDQU1fSVJRU1RBVFVTX0RNQV9J
UlEwCQkJKDEgPDwgIDApCisKKyNkZWZpbmUgQ0FNX0dQT19DQU1fU19QX0VOCQkJKDEgPDwgIDEp
CisjZGVmaW5lIENBTV9HUE9fQ0FNX0NDUF9NT0RFCQkJKDEgPDwgIDApCisKKyNkZWZpbmUgQ0FN
X0dQSV9DQ19ETUFfUkVRMQkJCSgxIDw8IDI0KQorI2RlZmluZSBDQVBfR1BJX0NDX0RNQV9SRVEw
CQkJKDEgPDwgMjMpCisjZGVmaW5lIENBUF9HUElfQ0FNX01TVEFOREJZCQkJKDEgPDwgMjEpCisj
ZGVmaW5lIENBUF9HUElfQ0FNX1dBSVQJCQkoMSA8PCAyMCkKKyNkZWZpbmUgQ0FQX0dQSV9DQU1f
U19EQVRBCQkJKDEgPDwgMTcpCisjZGVmaW5lIENBUF9HUElfQ0FNX1NfQ0xLCQkJKDEgPDwgMTYp
CisjZGVmaW5lIENBUF9HUElfQ0FNX1BfREFUQQkJCSgweEZGRiA8PCAzKQorI2RlZmluZSBDQVBf
R1BJX0NBTV9QX0RBVEFfU0hJRlQJCTMKKyNkZWZpbmUgQ0FQX0dQSV9DQU1fUF9WUwkJCSgxIDw8
ICAyKQorI2RlZmluZSBDQVBfR1BJX0NBTV9QX0hTCQkJKDEgPDwgIDEpCisjZGVmaW5lIENBUF9H
UElfQ0FNX1BfQ0xLCQkJKDEgPDwgIDApCisKKyNkZWZpbmUgQ0NfUkVWSVNJT05fTUFKT1IJCQko
MTUgPDwgNCkKKyNkZWZpbmUgQ0NfUkVWSVNJT05fTUFKT1JfU0hJRlQJCQk0CisjZGVmaW5lIEND
X1JFVklTSU9OX01JTk9SCQkJKDE1IDw8IDApCisjZGVmaW5lIENDX1JFVklTSU9OX01JTk9SX1NI
SUZUCQkJMAorCisjZGVmaW5lIENDX1NZU0NPTkZJR19TSURMRU1PREUJCQkoMyA8PCAgMykKKyNk
ZWZpbmUgQ0NfU1lTQ09ORklHX1NJRExFTU9ERV9GSURMRQkJKDAgPDwgIDMpCisjZGVmaW5lIEND
X1NZU0NPTkZJR19TSURMRU1PREVfTklETEUJCSgxIDw8ICAzKQorI2RlZmluZSBDQ19TWVNDT05G
SUdfU09GVFJFU0VUCQkJKDEgPDwgIDEpCisjZGVmaW5lIENDX1NZU0NPTkZJR19BVVRPSURMRQkJ
CSgxIDw8ICAwKQorCisjZGVmaW5lIENDX1NZU1NUQVRVU19SRVNFVERPTkUJCQkoMSA8PCAgMCkK
KworI2RlZmluZSBDQ19JUlFTVEFUVVNfRlNfSVJRCQkJKDEgPDwgMTkpCisjZGVmaW5lIENDX0lS
UVNUQVRVU19MRV9JUlEJCQkoMSA8PCAxOCkKKyNkZWZpbmUgQ0NfSVJRU1RBVFVTX0xTX0lSUQkJ
CSgxIDw8IDE3KQorI2RlZmluZSBDQ19JUlFTVEFUVVNfRkVfSVJRCQkJKDEgPDwgMTYpCisjZGVm
aW5lIENDX0lSUVNUQVRVU19GV19FUlJfSVJRCQkJKDEgPDwgMTApCisjZGVmaW5lIENDX0lSUVNU
QVRVU19GU0NfRVJSX0lSUQkJKDEgPDwgIDkpCisjZGVmaW5lIENDX0lSUVNUQVRVU19TU0NfRVJS
X0lSUQkJKDEgPDwgIDgpCisjZGVmaW5lIENDX0lSUVNUQVRVU19GSUZPX05PRU1QVFlfSVJRCQko
MSA8PCAgNCkKKyNkZWZpbmUgQ0NfSVJRU1RBVFVTX0ZJRk9fRlVMTF9JUlEJCSgxIDw8ICAzKQor
I2RlZmluZSBDQ19JUlFTVEFUVVNfRklGT19USFJfSVJRCQkoMSA8PCAgMikKKyNkZWZpbmUgQ0Nf
SVJRU1RBVFVTX0ZJRk9fT0ZfSVJRCQkoMSA8PCAgMSkKKyNkZWZpbmUgQ0NfSVJRU1RBVFVTX0ZJ
Rk9fVUZfSVJRCQkoMSA8PCAgMCkKKworI2RlZmluZSBDQ19JUlFFTkFCTEVfRlNfSVJRCQkJKDEg
PDwgMTkpCisjZGVmaW5lIENDX0lSUUVOQUJMRV9MRV9JUlEJCQkoMSA8PCAxOCkKKyNkZWZpbmUg
Q0NfSVJRRU5BQkxFX0xTX0lSUQkJCSgxIDw8IDE3KQorI2RlZmluZSBDQ19JUlFFTkFCTEVfRkVf
SVJRCQkJKDEgPDwgMTYpCisjZGVmaW5lIENDX0lSUUVOQUJMRV9GV19FUlJfSVJRCQkJKDEgPDwg
MTApCisjZGVmaW5lIENDX0lSUUVOQUJMRV9GU0NfRVJSX0lSUQkJKDEgPDwgIDkpCisjZGVmaW5l
IENDX0lSUUVOQUJMRV9TU0NfRVJSX0lSUQkJKDEgPDwgIDgpCisjZGVmaW5lIENDX0lSUUVOQUJM
RV9GSUZPX05PRU1QVFlfSVJRCQkoMSA8PCAgNCkKKyNkZWZpbmUgQ0NfSVJRRU5BQkxFX0ZJRk9f
RlVMTF9JUlEJCSgxIDw8ICAzKQorI2RlZmluZSBDQ19JUlFFTkFCTEVfRklGT19USFJfSVJRCQko
MSA8PCAgMikKKyNkZWZpbmUgQ0NfSVJRRU5BQkxFX0ZJRk9fT0ZfSVJRCQkoMSA8PCAgMSkKKyNk
ZWZpbmUgQ0NfSVJRRU5BQkxFX0ZJRk9fVUZfSVJRCQkoMSA8PCAgMCkKKworI2RlZmluZSBDQ19D
VFJMX0NDX09ORV9TSE9UCQkJKDEgPDwgMjApCisjZGVmaW5lIENDX0NUUkxfQ0NfSUZfU1lOQ0hS
TwkJCSgxIDw8IDE5KQorI2RlZmluZSBDQ19DVFJMX0NDX1JTVAkJCQkoMSA8PCAxOCkKKyNkZWZp
bmUgQ0NfQ1RSTF9DQ19GUkFNRV9UUklHCQkJKDEgPDwgMTcpCisjZGVmaW5lIENDX0NUUkxfQ0Nf
RU4JCQkJKDEgPDwgMTYpCisjZGVmaW5lIENDX0NUUkxfTk9CVF9TWU5DSFJPCQkJKDEgPDwgMTMp
CisjZGVmaW5lIENDX0NUUkxfQlRfQ09SUkVDVAkJCSgxIDw8IDEyKQorI2RlZmluZSBDQ19DVFJM
X1BBUl9PUkRFUkNBTQkJCSgxIDw8IDExKQorI2RlZmluZSBDQ19DVFJMX1BBUl9DTEtfUE9MCQkJ
KDEgPDwgMTApCisjZGVmaW5lIENDX0NUUkxfTk9CVF9IU19QT0wJCQkoMSA8PCAgOSkKKyNkZWZp
bmUgQ0NfQ1RSTF9OT0JUX1ZTX1BPTAkJCSgxIDw8ICA4KQorI2RlZmluZSBDQ19DVFJMX1BBUl9N
T0RFCQkJKDcgPDwgIDEpCisjZGVmaW5lIENDX0NUUkxfUEFSX01PREVfU0hJRlQJCQkxCisjZGVm
aW5lIENDX0NUUkxfUEFSX01PREVfTk9CVDgJCQkoMCA8PCAgMSkKKyNkZWZpbmUgQ0NfQ1RSTF9Q
QVJfTU9ERV9OT0JUMTAJCQkoMSA8PCAgMSkKKyNkZWZpbmUgQ0NfQ1RSTF9QQVJfTU9ERV9OT0JU
MTIJCQkoMiA8PCAgMSkKKyNkZWZpbmUgQ0NfQ1RSTF9QQVJfTU9ERV9CVDgJCQkoNCA8PCAgMSkK
KyNkZWZpbmUgQ0NfQ1RSTF9QQVJfTU9ERV9CVDEwCQkJKDUgPDwgIDEpCisjZGVmaW5lIENDX0NU
UkxfUEFSX01PREVfRklGT1RFU1QJCSg3IDw8ICAxKQorI2RlZmluZSBDQ19DVFJMX0NDUF9NT0RF
CQkJKDEgPDwgIDApCisKKyNkZWZpbmUgQ0NfQ1RSTF9ETUFfRU4JCQkJKDEgPDwgIDgpCisjZGVm
aW5lIENDX0NUUkxfRE1BX0ZJRk9fVEhSRVNIT0xECQkoMHg3RiA8PCAwKQorI2RlZmluZSBDQ19D
VFJMX0RNQV9GSUZPX1RIUkVTSE9MRF9TSElGVAkwCisKKyNkZWZpbmUgQ0NfQ1RSTF9YQ0xLX0RJ
VgkJCSgweDFGIDw8IDApCisjZGVmaW5lIENDX0NUUkxfWENMS19ESVZfU0hJRlQJCQkwCisjZGVm
aW5lIENDX0NUUkxfWENMS19ESVZfU1RBQkxFX0xPVwkJKDAgPDwgIDApCisjZGVmaW5lIENDX0NU
UkxfWENMS19ESVZfU1RBQkxFX0hJR0gJCSgxIDw8ICAwKQorI2RlZmluZSBDQ19DVFJMX1hDTEtf
RElWX0JZUEFTUwkJCSgzMSA8PCAwKQorCisjZGVmaW5lIENDX1RFU1RfRklGT19SRF9QT0lOVEVS
CQkJKDB4RkYgPDwgMjQpCisjZGVmaW5lIENDX1RFU1RfRklGT19SRF9QT0lOVEVSX1NISUZUCQky
NAorI2RlZmluZSBDQ19URVNUX0ZJRk9fV1JfUE9JTlRFUgkJCSgweEZGIDw8IDE2KQorI2RlZmlu
ZSBDQ19URVNUX0ZJRk9fV1JfUE9JTlRFUl9TSElGVAkJMTYKKyNkZWZpbmUgQ0NfVEVTVF9GSUZP
X0xFVkVMCQkJKDB4RkYgPDwgIDgpCisjZGVmaW5lIENDX1RFU1RfRklGT19MRVZFTF9TSElGVAkJ
OAorI2RlZmluZSBDQ19URVNUX0ZJRk9fTEVWRUxfUEVBSwkJCSgweEZGIDw8ICAwKQorI2RlZmlu
ZSBDQ19URVNUX0ZJRk9fTEVWRUxfUEVBS19TSElGVAkJMAorCisjZGVmaW5lIENDX0dFTlBBUl9G
SUZPX0RFUFRICQkJKDcgPDwgIDApCisjZGVmaW5lIENDX0dFTlBBUl9GSUZPX0RFUFRIX1NISUZU
CQkwCisKKyNkZWZpbmUgQ0NfQ0NQREZSX0FMUEhBCQkJCSgweEZGIDw8ICA4KQorI2RlZmluZSBD
Q19DQ1BERlJfQUxQSEFfU0hJRlQJCQk4CisjZGVmaW5lIENDX0NDUERGUl9EQVRBRk9STUFUCQkJ
KDE1IDw8ICAwKQorI2RlZmluZSBDQ19DQ1BERlJfREFUQUZPUk1BVF9TSElGVAkJMAorI2RlZmlu
ZSBDQ19DQ1BERlJfREFUQUZPUk1BVF9ZVVY0MjJCRQkJKDAgPDwgIDApCisjZGVmaW5lIENDX0ND
UERGUl9EQVRBRk9STUFUX1lVVjQyMgkJKDEgPDwgIDApCisjZGVmaW5lIENDX0NDUERGUl9EQVRB
Rk9STUFUX1lVVjQyMAkJKDIgPDwgIDApCisjZGVmaW5lIENDX0NDUERGUl9EQVRBRk9STUFUX1JH
QjQ0NAkJKDQgPDwgIDApCisjZGVmaW5lIENDX0NDUERGUl9EQVRBRk9STUFUX1JHQjU2NQkJKDUg
PDwgIDApCisjZGVmaW5lIENDX0NDUERGUl9EQVRBRk9STUFUX1JHQjg4OE5ERQkJKDYgPDwgIDAp
CisjZGVmaW5lIENDX0NDUERGUl9EQVRBRk9STUFUX1JHQjg4OAkJKDcgPDwgIDApCisjZGVmaW5l
IENDX0NDUERGUl9EQVRBRk9STUFUX1JBVzhOREUJCSg4IDw8ICAwKQorI2RlZmluZSBDQ19DQ1BE
RlJfREFUQUZPUk1BVF9SQVc4CQkoOSA8PCAgMCkKKyNkZWZpbmUgQ0NfQ0NQREZSX0RBVEFGT1JN
QVRfUkFXMTBOREUJCSgxMCA8PCAgMCkKKyNkZWZpbmUgQ0NfQ0NQREZSX0RBVEFGT1JNQVRfUkFX
MTAJCSgxMSA8PCAgMCkKKyNkZWZpbmUgQ0NfQ0NQREZSX0RBVEFGT1JNQVRfUkFXMTJOREUJCSgx
MiA8PCAgMCkKKyNkZWZpbmUgQ0NfQ0NQREZSX0RBVEFGT1JNQVRfUkFXMTIJCSgxMyA8PCAgMCkK
KyNkZWZpbmUgQ0NfQ0NQREZSX0RBVEFGT1JNQVRfSlBFRzgJCSgxNSA8PCAgMCkKKworI2RlZmlu
ZSBDQU1ETUFfUkVWSVNJT05fTUFKT1IJCQkoMTUgPDwgNCkKKyNkZWZpbmUgQ0FNRE1BX1JFVklT
SU9OX01BSk9SX1NISUZUCQk0CisjZGVmaW5lIENBTURNQV9SRVZJU0lPTl9NSU5PUgkJCSgxNSA8
PCAwKQorI2RlZmluZSBDQU1ETUFfUkVWSVNJT05fTUlOT1JfU0hJRlQJCTAKKworI2RlZmluZSBD
QU1ETUFfT0NQX1NZU0NPTkZJR19NSURMRU1PREUJCSgzIDw8IDEyKQorI2RlZmluZSBDQU1ETUFf
T0NQX1NZU0NPTkZJR19NSURMRU1PREVfRlNUQU5EQlkJKDAgPDwgMTIpCisjZGVmaW5lIENBTURN
QV9PQ1BfU1lTQ09ORklHX01JRExFTU9ERV9OU1RBTkRCWQkoMSA8PCAxMikKKyNkZWZpbmUgQ0FN
RE1BX09DUF9TWVNDT05GSUdfTUlETEVNT0RFX1NTVEFOREJZCSgyIDw8IDEyKQorI2RlZmluZSBD
QU1ETUFfT0NQX1NZU0NPTkZJR19GVU5DX0NMT0NLCQkoMSA8PCAgOSkKKyNkZWZpbmUgQ0FNRE1B
X09DUF9TWVNDT05GSUdfT0NQX0NMT0NLCQkoMSA8PCAgOCkKKyNkZWZpbmUgQ0FNRE1BX09DUF9T
WVNDT05GSUdfRU1VRlJFRQkJKDEgPDwgIDUpCisjZGVmaW5lIENBTURNQV9PQ1BfU1lTQ09ORklH
X1NJRExFTU9ERQkJKDMgPDwgIDMpCisjZGVmaW5lIENBTURNQV9PQ1BfU1lTQ09ORklHX1NJRExF
TU9ERV9GSURMRQkoMCA8PCAgMykKKyNkZWZpbmUgQ0FNRE1BX09DUF9TWVNDT05GSUdfU0lETEVN
T0RFX05JRExFCSgxIDw8ICAzKQorI2RlZmluZSBDQU1ETUFfT0NQX1NZU0NPTkZJR19TSURMRU1P
REVfU0lETEUJKDIgPDwgIDMpCisjZGVmaW5lIENBTURNQV9PQ1BfU1lTQ09ORklHX1NPRlRSRVNF
VAkJKDEgPDwgIDEpCisjZGVmaW5lIENBTURNQV9PQ1BfU1lTQ09ORklHX0FVVE9JRExFCQkoMSA8
PCAgMCkKKworI2RlZmluZSBDQU1ETUFfU1lTU1RBVFVTX1JFU0VURE9ORQkJKDEgPDwgIDApCisK
KyNkZWZpbmUgQ0FNRE1BX0dDUl9BUkJJVFJBVElPTl9SQVRFCQkoMHhGRiA8PCAxNikKKyNkZWZp
bmUgQ0FNRE1BX0dDUl9BUkJJVFJBVElPTl9SQVRFX1NISUZUCTE2CisjZGVmaW5lIENBTURNQV9H
Q1JfTUFYX0NIQU5ORUxfRklGT19ERVBUSAkoMHhGRiA8PCAwKQorI2RlZmluZSBDQU1ETUFfR0NS
X01BWF9DSEFOTkVMX0ZJRk9fREVQVEhfU0hJRlQJMAorCisjZGVmaW5lIENBTURNQV9DQ1JfU0VM
X1NSQ19EU1RfU1lOQwkJKDEgPDwgMjQpCisjZGVmaW5lIENBTURNQV9DQ1JfUFJFRkVUQ0gJCQko
MSA8PCAyMykKKyNkZWZpbmUgQ0FNRE1BX0NDUl9TVVBFUlZJU09SCQkJKDEgPDwgMjIpCisjZGVm
aW5lIENBTURNQV9DQ1JfU0VDVVJFCQkJKDEgPDwgMjEpCisjZGVmaW5lIENBTURNQV9DQ1JfQlMJ
CQkJKDEgPDwgMTgpCisjZGVmaW5lIENBTURNQV9DQ1JfVFJBTlNQQVJFTlRfQ09QWV9FTkFCTEUJ
KDEgPDwgMTcpCisjZGVmaW5lIENBTURNQV9DQ1JfQ09OU1RBTlRfRklMTF9FTkFCTEUJCSgxIDw8
IDE2KQorI2RlZmluZSBDQU1ETUFfQ0NSX0RTVF9BTU9ERQkJCSgzIDw8IDE0KQorI2RlZmluZSBD
QU1ETUFfQ0NSX0RTVF9BTU9ERV9DT05TVF9BRERSCQkoMCA8PCAxNCkKKyNkZWZpbmUgQ0FNRE1B
X0NDUl9EU1RfQU1PREVfUE9TVF9JTkMJCSgxIDw8IDE0KQorI2RlZmluZSBDQU1ETUFfQ0NSX0RT
VF9BTU9ERV9TR0xfSURYCQkoMiA8PCAxNCkKKyNkZWZpbmUgQ0FNRE1BX0NDUl9EU1RfQU1PREVf
REJMX0lEWAkJKDMgPDwgMTQpCisjZGVmaW5lIENBTURNQV9DQ1JfU1JDX0FNT0RFCQkJKDMgPDwg
MTIpCisjZGVmaW5lIENBTURNQV9DQ1JfU1JDX0FNT0RFX0NPTlNUX0FERFIJCSgwIDw8IDEyKQor
I2RlZmluZSBDQU1ETUFfQ0NSX1NSQ19BTU9ERV9QT1NUX0lOQwkJKDEgPDwgMTIpCisjZGVmaW5l
IENBTURNQV9DQ1JfU1JDX0FNT0RFX1NHTF9JRFgJCSgyIDw8IDEyKQorI2RlZmluZSBDQU1ETUFf
Q0NSX1NSQ19BTU9ERV9EQkxfSURYCQkoMyA8PCAxMikKKyNkZWZpbmUgQ0FNRE1BX0NDUl9XUl9B
Q1RJVkUJCQkoMSA8PCAxMCkKKyNkZWZpbmUgQ0FNRE1BX0NDUl9SRF9BQ1RJVkUJCQkoMSA8PCAg
OSkKKyNkZWZpbmUgQ0FNRE1BX0NDUl9TVVNQRU5EX1NFTlNJVElWRQkJKDEgPDwgIDgpCisjZGVm
aW5lIENBTURNQV9DQ1JfRU5BQkxFCQkJKDEgPDwgIDcpCisjZGVmaW5lIENBTURNQV9DQ1JfUFJJ
TwkJCQkoMSA8PCAgNikKKyNkZWZpbmUgQ0FNRE1BX0NDUl9GUwkJCQkoMSA8PCAgNSkKKyNkZWZp
bmUgQ0FNRE1BX0NDUl9TWU5DSFJPCQkJKCgzIDw8IDE5KSB8ICgzMSA8PCAwKSkKKyNkZWZpbmUg
Q0FNRE1BX0NDUl9TWU5DSFJPX0NBTUVSQQkJMHgwMQorCisjZGVmaW5lIENBTURNQV9DTE5LX0NU
UkxfRU5BQkxFX0xOSwkJKDEgPDwgMTUpCisjZGVmaW5lIENBTURNQV9DTE5LX0NUUkxfTkVYVExD
SF9JRAkJKDB4MUYgPDwgMCkKKyNkZWZpbmUgQ0FNRE1BX0NMTktfQ1RSTF9ORVhUTENIX0lEX1NI
SUZUCTAKKworI2RlZmluZSBDQU1ETUFfQ0lDUl9NSVNBTElHTkVEX0VSUl9JRQkJKDEgPDwgMTEp
CisjZGVmaW5lIENBTURNQV9DSUNSX1NVUEVSVklTT1JfRVJSX0lFCQkoMSA8PCAxMCkKKyNkZWZp
bmUgQ0FNRE1BX0NJQ1JfU0VDVVJFX0VSUl9JRQkJKDEgPDwgIDkpCisjZGVmaW5lIENBTURNQV9D
SUNSX1RSQU5TX0VSUl9JRQkJKDEgPDwgIDgpCisjZGVmaW5lIENBTURNQV9DSUNSX1BBQ0tFVF9J
RQkJCSgxIDw8ICA3KQorI2RlZmluZSBDQU1ETUFfQ0lDUl9CTE9DS19JRQkJCSgxIDw8ICA1KQor
I2RlZmluZSBDQU1ETUFfQ0lDUl9MQVNUX0lFCQkJKDEgPDwgIDQpCisjZGVmaW5lIENBTURNQV9D
SUNSX0ZSQU1FX0lFCQkJKDEgPDwgIDMpCisjZGVmaW5lIENBTURNQV9DSUNSX0hBTEZfSUUJCQko
MSA8PCAgMikKKyNkZWZpbmUgQ0FNRE1BX0NJQ1JfRFJPUF9JRQkJCSgxIDw8ICAxKQorCisjZGVm
aW5lIENBTURNQV9DU1JfTUlTQUxJR05FRF9FUlIJCSgxIDw8IDExKQorI2RlZmluZSBDQU1ETUFf
Q1NSX1NVUEVSVklTT1JfRVJSCQkoMSA8PCAxMCkKKyNkZWZpbmUgQ0FNRE1BX0NTUl9TRUNVUkVf
RVJSCQkJKDEgPDwgIDkpCisjZGVmaW5lIENBTURNQV9DU1JfVFJBTlNfRVJSCQkJKDEgPDwgIDgp
CisjZGVmaW5lIENBTURNQV9DU1JfUEFDS0VUCQkJKDEgPDwgIDcpCisjZGVmaW5lIENBTURNQV9D
U1JfU1lOQwkJCQkoMSA8PCAgNikKKyNkZWZpbmUgQ0FNRE1BX0NTUl9CTE9DSwkJCSgxIDw8ICA1
KQorI2RlZmluZSBDQU1ETUFfQ1NSX0xBU1QJCQkJKDEgPDwgIDQpCisjZGVmaW5lIENBTURNQV9D
U1JfRlJBTUUJCQkoMSA8PCAgMykKKyNkZWZpbmUgQ0FNRE1BX0NTUl9IQUxGCQkJCSgxIDw8ICAy
KQorI2RlZmluZSBDQU1ETUFfQ1NSX0RST1AJCQkJKDEgPDwgIDEpCisKKyNkZWZpbmUgQ0FNRE1B
X0NTRFBfU1JDX0VORElBTk5FU1MJCSgxIDw8IDIxKQorI2RlZmluZSBDQU1ETUFfQ1NEUF9TUkNf
RU5ESUFOTkVTU19MT0NLCQkoMSA8PCAyMCkKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfRFNUX0VORElB
Tk5FU1MJCSgxIDw8IDE5KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9EU1RfRU5ESUFOTkVTU19MT0NL
CQkoMSA8PCAxOCkKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfV1JJVEVfTU9ERQkJCSgzIDw8IDE2KQor
I2RlZmluZSBDQU1ETUFfQ1NEUF9XUklURV9NT0RFX1dSTlAJCSgwIDw8IDE2KQorI2RlZmluZSBD
QU1ETUFfQ1NEUF9XUklURV9NT0RFX1BPU1RFRAkJKDEgPDwgMTYpCisjZGVmaW5lIENBTURNQV9D
U0RQX1dSSVRFX01PREVfUE9TVEVEX0xBU1RfV1JOUAkoMiA8PCAxNikKKyNkZWZpbmUgQ0FNRE1B
X0NTRFBfRFNUX0JVUlNUX0VOCQkoMyA8PCAxNCkKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfRFNUX0JV
UlNUX0VOXzEJCSgwIDw8IDE0KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9EU1RfQlVSU1RfRU5fMTYJ
CSgxIDw8IDE0KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9EU1RfQlVSU1RfRU5fMzIJCSgyIDw8IDE0
KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9EU1RfQlVSU1RfRU5fNjQJCSgzIDw8IDE0KQorI2RlZmlu
ZSBDQU1ETUFfQ1NEUF9EU1RfUEFDS0VECQkJKDEgPDwgMTMpCisjZGVmaW5lIENBTURNQV9DU0RQ
X1dSX0FERF9UUlNMVAkJKDE1IDw8IDkpCisjZGVmaW5lIENBTURNQV9DU0RQX1dSX0FERF9UUlNM
VF9FTkFCTEVfTVJFUUFERAkoMyA8PCAgOSkKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfU1JDX0JVUlNU
X0VOCQkoMyA8PCAgNykKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfU1JDX0JVUlNUX0VOXzEJCSgwIDw8
ICA3KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9TUkNfQlVSU1RfRU5fMTYJCSgxIDw8ICA3KQorI2Rl
ZmluZSBDQU1ETUFfQ1NEUF9TUkNfQlVSU1RfRU5fMzIJCSgyIDw8ICA3KQorI2RlZmluZSBDQU1E
TUFfQ1NEUF9TUkNfQlVSU1RfRU5fNjQJCSgzIDw8ICA3KQorI2RlZmluZSBDQU1ETUFfQ1NEUF9T
UkNfUEFDS0VECQkJKDEgPDwgIDYpCisjZGVmaW5lIENBTURNQV9DU0RQX1JEX0FERF9UUlNMVAkJ
KDE1IDw8IDIpCisjZGVmaW5lIENBTURNQV9DU0RQX1JEX0FERF9UUlNMVF9FTkFCTEVfTVJFUUFE
RAkoMyA8PCAgMikKKyNkZWZpbmUgQ0FNRE1BX0NTRFBfREFUQV9UWVBFCQkJKDMgPDwgIDApCisj
ZGVmaW5lIENBTURNQV9DU0RQX0RBVEFfVFlQRV84QklUUwkJKDAgPDwgIDApCisjZGVmaW5lIENB
TURNQV9DU0RQX0RBVEFfVFlQRV8xNkJJVFMJCSgxIDw8ICAwKQorI2RlZmluZSBDQU1ETUFfQ1NE
UF9EQVRBX1RZUEVfMzJCSVRTCQkoMiA8PCAgMCkKKworI2RlZmluZSBDQU1NTVVfU1lTQ09ORklH
X0FVVE9JRExFCQkoMSA8PCAgMCkKKworLyoKKyAqCisgKiBEZWNsYXJhdGlvbnMuCisgKgorICov
CisKKy8qIGZvcndhcmQgZGVjbGFyYXRpb25zICovCitzdHJ1Y3Qgb21hcDI0eHhjYW1fc2dkbWE7
CitzdHJ1Y3Qgb21hcDI0eHhjYW1fZG1hOworCit0eXBlZGVmIHZvaWQgKCpzZ2RtYV9jYWxsYmFj
a190KShzdHJ1Y3Qgb21hcDI0eHhjYW1fc2dkbWEgKmNhbSwKKwkJCQkgdTMyIHN0YXR1cywgdm9p
ZCAqYXJnKTsKK3R5cGVkZWYgdm9pZCAoKmRtYV9jYWxsYmFja190KShzdHJ1Y3Qgb21hcDI0eHhj
YW1fZG1hICpjYW0sCisJCQkgICAgICAgdTMyIHN0YXR1cywgdm9pZCAqYXJnKTsKKworc3RydWN0
IGNoYW5uZWxfc3RhdGUgeworCWRtYV9jYWxsYmFja190IGNhbGxiYWNrOworCXZvaWQgKmFyZzsK
K307CisKKy8qIHNnZG1hIHN0YXRlIGZvciBlYWNoIG9mIHRoZSBwb3NzaWJsZSB2aWRlb2J1Zl9i
dWZmZXJzICsgMiBvdmVybGF5cyAqLworc3RydWN0IHNnZG1hX3N0YXRlIHsKKwljb25zdCBzdHJ1
Y3Qgc2NhdHRlcmxpc3QgKnNnbGlzdDsKKwlpbnQgc2dsZW47CQkgLyogbnVtYmVyIG9mIHNnbGlz
dCBlbnRyaWVzICovCisJaW50IG5leHRfc2dsaXN0OwkgLyogaW5kZXggb2YgbmV4dCBzZ2xpc3Qg
ZW50cnkgdG8gcHJvY2VzcyAqLworCXVuc2lnbmVkIGludCBieXRlc19yZWFkOyAvKiBudW1iZXIg
b2YgYnl0ZXMgcmVhZCAqLworCXVuc2lnbmVkIGludCBsZW47ICAgICAgICAvKiB0b3RhbCBsZW5n
dGggb2Ygc2dsaXN0IChleGNsdWRpbmcKKwkJCQkgICogYnl0ZXMgZHVlIHRvIHBhZ2UgYWxpZ25t
ZW50KSAqLworCWludCBxdWV1ZWRfc2dsaXN0OwkgLyogbnVtYmVyIG9mIHNnbGlzdCBlbnRyaWVz
IHF1ZXVlZCBmb3IgRE1BICovCisJdTMyIGNzcjsJCSAvKiBETUEgcmV0dXJuIGNvZGUgKi8KKwlz
Z2RtYV9jYWxsYmFja190IGNhbGxiYWNrOworCXZvaWQgKmFyZzsKK307CisKKy8qIHBoeXNpY2Fs
IERNQSBjaGFubmVsIG1hbmFnZW1lbnQgKi8KK3N0cnVjdCBvbWFwMjR4eGNhbV9kbWEgeworCXNw
aW5sb2NrX3QgbG9jazsJLyogTG9jayBmb3IgdGhlIHdob2xlIHN0cnVjdHVyZS4gKi8KKworCXVu
c2lnbmVkIGxvbmcgYmFzZTsJLyogYmFzZSBhZGRyZXNzIGZvciBkbWEgY29udHJvbGxlciAqLwor
CisJLyogV2hpbGUgZG1hX3N0b3AhPTAsIGFuIGF0dGVtcHQgdG8gc3RhcnQgYSBuZXcgRE1BIHRy
YW5zZmVyIHdpbGwKKwkgKiBmYWlsLgorCSAqLworCWF0b21pY190IGRtYV9zdG9wOworCWludCBm
cmVlX2RtYWNoOwkJLyogbnVtYmVyIG9mIGRtYSBjaGFubmVscyBmcmVlICovCisJaW50IG5leHRf
ZG1hY2g7CQkvKiBpbmRleCBvZiBuZXh0IGRtYSBjaGFubmVsIHRvIHVzZSAqLworCXN0cnVjdCBj
aGFubmVsX3N0YXRlIGNoX3N0YXRlW05VTV9DQU1ETUFfQ0hBTk5FTFNdOworfTsKKworLyogc2Nh
dHRlci1nYXRoZXIgRE1BIChzY2F0dGVybGlzdCBzdHVmZikgbWFuYWdlbWVudCAqLworc3RydWN0
IG9tYXAyNHh4Y2FtX3NnZG1hIHsKKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZG1hIGRtYTsKKworCXNw
aW5sb2NrX3QgbG9jazsJLyogTG9jayBmb3IgdGhlIGZpZWxkcyBiZWxvdy4gKi8KKwlpbnQgZnJl
ZV9zZ2RtYTsJCS8qIG51bWJlciBvZiBmcmVlIHNnIGRtYSBzbG90cyAqLworCWludCBuZXh0X3Nn
ZG1hOwkJLyogaW5kZXggb2YgbmV4dCBzZyBkbWEgc2xvdCB0byB1c2UgKi8KKwlzdHJ1Y3Qgc2dk
bWFfc3RhdGUgc2dfc3RhdGVbTlVNX1NHX0RNQV07CisKKwkvKiBSZXNldCB0aW1lciBkYXRhICov
CisJc3RydWN0IHRpbWVyX2xpc3QgcmVzZXRfdGltZXI7Cit9OworCisvKiBwZXItZGV2aWNlIGRh
dGEgc3RydWN0dXJlICovCitzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNlIHsKKwkvKioqIG11dGV4
ICAqKiovCisJLyoKKwkgKiBtdXRleCBzZXJpYWxpc2VzIGFjY2VzcyB0byB0aGlzIHN0cnVjdHVy
ZS4gQWxzbyBjYW1lcmEKKwkgKiBvcGVuaW5nIGFuZCByZWxlYXNpbmcgaXMgc3luY2hyb25pc2Vk
IGJ5IHRoaXMuCisJICovCisJc3RydWN0IG11dGV4IG11dGV4OworCisJLyoqKiBnZW5lcmFsIGRy
aXZlciBzdGF0ZSBpbmZvcm1hdGlvbiAqKiovCisJYXRvbWljX3QgdXNlcnM7CisJLyoKKwkgKiBM
b2NrIHRvIHNlcmlhbGlzZSBjb3JlIGVuYWJsaW5nIGFuZCBkaXNhYmxpbmcgYW5kIGFjY2VzcyB0
bworCSAqIHNnZG1hX2luX3F1ZXVlLgorCSAqLworCXNwaW5sb2NrX3QgY29yZV9lbmFibGVfZGlz
YWJsZV9sb2NrOworCS8qCisJICogTnVtYmVyIG9yIHNnZG1hIHJlcXVlc3RzIGluIHNjYXR0ZXIt
Z2F0aGVyIHF1ZXVlLCBwcm90ZWN0ZWQKKwkgKiBieSB0aGUgbG9jayBhYm92ZS4KKwkgKi8KKwlp
bnQgc2dkbWFfaW5fcXVldWU7CisJLyoKKwkgKiBTZW5zb3IgaW50ZXJmYWNlIHBhcmFtZXRlcnM6
IGludGVyZmFjZSB0eXBlLCBDQ19DVFJMCisJICogcmVnaXN0ZXIgdmFsdWUgYW5kIGludGVyZmFj
ZSBzcGVjaWZpYyBkYXRhLgorCSAqLworCWludCBpZl90eXBlOworCXVuaW9uIHsKKwkJc3RydWN0
IHBhcmFsbGVsIHsKKwkJCXUzMiB4Y2xrOworCQl9IGJ0NjU2OworCX0gaWZfdTsKKwl1MzIgY2Nf
Y3RybDsKKworCS8qKiogc3Vic3lzdGVtIHN0cnVjdHVyZXMgKioqLworCXN0cnVjdCBvbWFwMjR4
eGNhbV9zZ2RtYSBzZ2RtYTsKKworCS8qKiogaGFyZHdhcmUgcmVzb3VyY2VzICoqKi8KKwl1bnNp
Z25lZCBpbnQgaXJxOworCXVuc2lnbmVkIGxvbmcgbW1pb19iYXNlOworCXVuc2lnbmVkIGxvbmcg
bW1pb19iYXNlX3BoeXM7CisJdW5zaWduZWQgbG9uZyBtbWlvX3NpemU7CisKKwkvKioqIGludGVy
ZmFjZXMgYW5kIGRldmljZSAqKiovCisJc3RydWN0IHY0bDJfaW50X2RldmljZSAqc2RldjsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmZkOworCisJLyoqKiBj
YW1lcmEgYW5kIHNlbnNvciByZXNldCByZWxhdGVkIHN0dWZmICoqKi8KKwlzdHJ1Y3Qgd29ya19z
dHJ1Y3Qgc2Vuc29yX3Jlc2V0X3dvcms7CisJLyoKKwkgKiBXZSdyZSBpbiB0aGUgbWlkZGxlIG9m
IGEgcmVzZXQuIERvbid0IGVuYWJsZSBjb3JlIGlmIHRoaXMKKwkgKiBpcyBub24temVybyEgVGhp
cyBleGlzdHMgdG8gaGVscCBkZWNpc2lvbm1ha2luZyBpbiBhIGNhc2UKKwkgKiB3aGVyZSB2aWRl
b2J1Zl9xYnVmIGlzIGNhbGxlZCB3aGlsZSB3ZSBhcmUgaW4gdGhlIG1pZGRsZSBvZgorCSAqIGEg
cmVzZXQuCisJICovCisJYXRvbWljX3QgaW5fcmVzZXQ7CisJLyoKKwkgKiBOb24temVybyBpZiB3
ZSBkb24ndCB3YW50IGFueSByZXNldHMgZm9yIG5vdy4gVXNlZCB0bworCSAqIHByZXZlbnQgcmVz
ZXQgd29yayB0byBydW4gd2hlbiB3ZSdyZSBhYm91dCB0byBzdG9wCisJICogc3RyZWFtaW5nLgor
CSAqLworCWF0b21pY190IHJlc2V0X2Rpc2FibGU7CisKKwkvKioqIHZpZGVvIGRldmljZSBwYXJh
bWV0ZXJzICoqKi8KKwlpbnQgY2FwdHVyZV9tZW07CisKKwkvKioqIGNhbWVyYSBtb2R1bGUgY2xv
Y2tzICoqKi8KKwlzdHJ1Y3QgY2xrICpmY2s7CisJc3RydWN0IGNsayAqaWNrOworCisJLyoqKiBj
YXB0dXJlIGRhdGEgKioqLworCS8qIGZpbGUgaGFuZGxlLCBpZiBzdHJlYW1pbmcgaXMgb24gKi8K
KwlzdHJ1Y3QgZmlsZSAqc3RyZWFtaW5nOworfTsKKworLyogUGVyLWZpbGUgaGFuZGxlIGRhdGEu
ICovCitzdHJ1Y3Qgb21hcDI0eHhjYW1fZmggeworCXNwaW5sb2NrX3QgdmJxX2xvY2s7IC8qIHNw
aW5sb2NrIGZvciB0aGUgdmlkZW9idWYgcXVldWUgKi8KKwlzdHJ1Y3QgdmlkZW9idWZfcXVldWUg
dmJxOworCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgcGl4OyAvKiBzZXJpYWxpc2UgcGl4IGJ5IHZi
cS0+bG9jayAqLworCWF0b21pY190IGZpZWxkX2NvdW50OyAvKiBmaWVsZCBjb3VudGVyIGZvciB2
aWRlb2J1Zl9idWZmZXIgKi8KKwkvKiBhY2Nlc3NpbmcgY2FtIGhlcmUgZG9lc24ndCBuZWVkIHNl
cmlhbGlzYXRpb246IGl0J3MgY29uc3RhbnQgKi8KKwlzdHJ1Y3Qgb21hcDI0eHhjYW1fZGV2aWNl
ICpjYW07Cit9OworCisvKgorICoKKyAqIFJlZ2lzdGVyIEkvTyBmdW5jdGlvbnMuCisgKgorICov
CisKK3N0YXRpYyBpbmxpbmUgdTMyIG9tYXAyNHh4Y2FtX3JlZ19pbih1bnNpZ25lZCBsb25nIGJh
c2UsIHUzMiBvZmZzZXQpCit7CisJcmV0dXJuIHJlYWRsKGJhc2UgKyBvZmZzZXQpOworfQorCitz
dGF0aWMgaW5saW5lIHUzMiBvbWFwMjR4eGNhbV9yZWdfb3V0KHVuc2lnbmVkIGxvbmcgYmFzZSwg
dTMyIG9mZnNldCwKKwkJCQkJICB1MzIgdmFsKQoreworCXdyaXRlbCh2YWwsIGJhc2UgKyBvZmZz
ZXQpOworCXJldHVybiB2YWw7Cit9CisKK3N0YXRpYyBpbmxpbmUgdTMyIG9tYXAyNHh4Y2FtX3Jl
Z19tZXJnZSh1bnNpZ25lZCBsb25nIGJhc2UsIHUzMiBvZmZzZXQsCisJCQkJCSAgICB1MzIgdmFs
LCB1MzIgbWFzaykKK3sKKwl1MzIgYWRkciA9IGJhc2UgKyBvZmZzZXQ7CisJdTMyIG5ld192YWwg
PSAocmVhZGwoYWRkcikgJiB+bWFzaykgfCAodmFsICYgbWFzayk7CisKKwl3cml0ZWwobmV3X3Zh
bCwgYWRkcik7CisJcmV0dXJuIG5ld192YWw7Cit9CisKKy8qCisgKgorICogRnVuY3Rpb24gcHJv
dG90eXBlcy4KKyAqCisgKi8KKworLyogZG1hIHByb3RvdHlwZXMgKi8KKwordm9pZCBvbWFwMjR4
eGNhbV9kbWFfaHdpbml0KGNvbnN0IHN0cnVjdCBvbWFwMjR4eGNhbV9kbWEgKmRtYSk7Cit2b2lk
IG9tYXAyNHh4Y2FtX2RtYV9pc3Ioc3RydWN0IG9tYXAyNHh4Y2FtX2RtYSAqZG1hKTsKKworLyog
c2dkbWEgcHJvdG90eXBlcyAqLworCit2b2lkIG9tYXAyNHh4Y2FtX3NnZG1hX3Byb2Nlc3Moc3Ry
dWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSk7CitpbnQgb21hcDI0eHhjYW1fc2dkbWFfcXVl
dWUoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSwKKwkJCSAgICBjb25zdCBzdHJ1Y3Qg
c2NhdHRlcmxpc3QgKnNnbGlzdCwgaW50IHNnbGVuLAorCQkJICAgIGludCBsZW4sIHNnZG1hX2Nh
bGxiYWNrX3QgY2FsbGJhY2ssIHZvaWQgKmFyZyk7Cit2b2lkIG9tYXAyNHh4Y2FtX3NnZG1hX3N5
bmMoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSk7Cit2b2lkIG9tYXAyNHh4Y2FtX3Nn
ZG1hX2luaXQoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSwKKwkJCSAgICB1bnNpZ25l
ZCBsb25nIGJhc2UsCisJCQkgICAgdm9pZCAoKnJlc2V0X2NhbGxiYWNrKSh1bnNpZ25lZCBsb25n
IGRhdGEpLAorCQkJICAgIHVuc2lnbmVkIGxvbmcgcmVzZXRfY2FsbGJhY2tfZGF0YSk7Cit2b2lk
IG9tYXAyNHh4Y2FtX3NnZG1hX2V4aXQoc3RydWN0IG9tYXAyNHh4Y2FtX3NnZG1hICpzZ2RtYSk7
CisKKyNlbmRpZgotLSAKMS42LjAuMwoK
------=_Part_31752_12096784.1227725091218
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

--
video4linux-list mailing list
Unsubscribe mailto:video4linux-list-request@redhat.com?subject=unsubscribe
https://www.redhat.com/mailman/listinfo/video4linux-list
------=_Part_31752_12096784.1227725091218--
