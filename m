Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.renesas.com ([202.234.163.13]:54705 "EHLO
	mail05.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1755870Ab0EKIBO (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Tue, 11 May 2010 04:01:14 -0400
Date: Tue, 11 May 2010 17:01:09 +0900 (JST)
From: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Subject: Re: [PATCH] soc_camera_platform: Add necessary v4l2_subdev_video_ops
 method
In-reply-to: <Pine.LNX.4.64.1005110824330.5923@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Cc: Linux-V4L2 <linux-media@vger.kernel.org>
Message-id: <uljbqg94r.wl%kuninori.morimoto.gx@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <upr13f0mn.wl%kuninori.morimoto.gx@renesas.com>
 <Pine.LNX.4.64.1005110824330.5923@axis700.grange>
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>


Dear Guennadi

Thank you for checking patch

> > +static int soc_camera_platform_s_fmt(struct v4l2_subdev *sd,
> > +				     struct v4l2_mbus_framefmt *mf)
> > +{
> > +	return 0;
> 
> This function needs not only return 0, but also fill fmt with the current 
> pixel format.

sorry.
Does this "fill" mean "fill mf->xxxx" ?

mf->code = xxxx;
mf->colorspace = xxx;

> >  static struct v4l2_subdev_video_ops platform_subdev_video_ops = {
> >  	.s_stream	= soc_camera_platform_s_stream,
> >  	.try_mbus_fmt	= soc_camera_platform_try_fmt,
> >  	.enum_mbus_fmt	= soc_camera_platform_enum_fmt,
> > +	.cropcap	= soc_camera_platform_cropcap,
> > +	.g_crop		= soc_camera_platform_g_crop,
> > +	.g_mbus_fmt	= soc_camera_platform_try_fmt,
> > +	.s_mbus_fmt	= soc_camera_platform_s_fmt,
> 
> Wouldn't
> 
> +	.s_mbus_fmt	= soc_camera_platform_try_fmt,
> 
> work here as well?

g_mbus_fmt / try_mbus_fmt are using same argument,
and in this driver, it needs same operation I think.
(same operation mean it fill mf->xxxx)
But should I modify it ?

int (*g_mbus_fmt)(struct v4l2_subdev *sd,  struct v4l2_mbus_framefmt *fmt);
int (*try_mbus_fmt)(struct v4l2_subdev *sd, struct v4l2_mbus_framefmt *fmt);


Best regards
--
Kuninori Morimoto
 
