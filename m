Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail.renesas.com ([202.234.163.13]:53657 "EHLO
	mail02.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org
	with ESMTP id S1751467AbZA3Izv (ORCPT
	<rfc822;linux-media@vger.kernel.org>);
	Fri, 30 Jan 2009 03:55:51 -0500
Date: Fri, 30 Jan 2009 17:55:44 +0900
From: morimoto.kuninori@renesas.com
Subject: Re: [PATCH] ov772x: add support S_CROP operation.
In-reply-to: <Pine.LNX.4.64.0901300829070.4617@axis700.grange>
To: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
Cc: Linux Media <linux-media@vger.kernel.org>
Message-id: <uzlh9maun.wl%morimoto.kuninori@renesas.com>
MIME-version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-type: text/plain; charset=US-ASCII
References: <uskna4qh8.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.0901250245440.4969@axis700.grange>
 <uzlheep1l.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.0901260854010.4236@axis700.grange>
 <uk58hcp3k.wl%morimoto.kuninori@renesas.com>
 <alpine.DEB.2.00.0901270851280.4618@axis700.grange>
 <u3af1o8zz.wl%morimoto.kuninori@renesas.com>
 <Pine.LNX.4.64.0901300829070.4617@axis700.grange>
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>


Dear Guennadi

Thank you for checking patch.

> camera - you will see, that almost all of them have a test "if (pixfmt)," 
> i.e., they have to differentiate between the two cases. And not only 
(snip)
> cropping for both, but the recently added mt9t031 does support scaling, 
> so, it is indeed important. Not sure about mt9m111, and yours ov772x and 
> tw9910.

hmm. I could understand.

> Further, calling set_bus_param() from (or soc_camera_s_fmt_vid_cap()) from 
> S_CROP is not enough too. This lets the capture.c example run, but, I 
> think, we should be able to run with no configuration at all - even 
> without a S_CROP. So, some default configuration has to be set up on 
> open() or on STREAMON if none is set yet (current_fmt == NULL).

I can agree with your opinion.

On my opinion, not only calling set_bus_param but also
try_fmt is important for tw9910.
Because tw9910 needs "INTERLACE" mode, and sh_mobile_ceu
sets "is_interlace flag" in try_fmt.
This is the reason why I would like to call try_fmt
(or s_fmt_vid_cap directly).

And
sh_mobile_ceu_dev :: camera_fmt is set in sh_mobile_ceu_set_fmt,
and it is used in set_bus_param.
but it need xlate->cam_fmt.
you know xlate need pixfmt now....
This is the reason why I would like to use current_fmt to set_fmt.
Therefore, I can agree with your
"some default configuration has to be set up on open()"

> So, you can either wit until I find time to address this, or try to do 
> something along these lines yourself. But I'm not sure if I manage to 
> propose anything meaningful before FOSDEM (next weekend), so, this might 
> take up to two weeks. But, I think, we have a bit of time before the 
> 2.6.30 merge window:-)

OK. no problem for me.
I can always help you if needed.

Best regards
--
Kuninori Morimoto
 
