Return-path: <linux-dvb-bounces+mchehab=infradead.org@linuxtv.org>
Received: from web38806.mail.mud.yahoo.com ([209.191.125.97])
	by www.linuxtv.org with smtp (Exim 4.63)
	(envelope-from <urishk@yahoo.com>) id 1L2iyM-0002xo-Ts
	for linux-dvb@linuxtv.org; Wed, 19 Nov 2008 10:03:46 +0100
Date: Wed, 19 Nov 2008 01:03:08 -0800 (PST)
From: Uri Shkolnik <urishk@yahoo.com>
To: Linux-dvb <linux-dvb@linuxtv.org>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="0-177463081-1227085388=:12947"
Message-ID: <375787.12947.qm@web38806.mail.mud.yahoo.com>
Subject: [linux-dvb] [PATCH 3/5] USB suspend and hibernation support for
	Siano's SMS chip-set based devices.
List-Unsubscribe: <http://www.linuxtv.org/cgi-bin/mailman/listinfo/linux-dvb>,
	<mailto:linux-dvb-request@linuxtv.org?subject=unsubscribe>
List-Archive: <http://www.linuxtv.org/pipermail/linux-dvb>
List-Post: <mailto:linux-dvb@linuxtv.org>
List-Help: <mailto:linux-dvb-request@linuxtv.org?subject=help>
List-Subscribe: <http://www.linuxtv.org/cgi-bin/mailman/listinfo/linux-dvb>,
	<mailto:linux-dvb-request@linuxtv.org?subject=subscribe>
Sender: linux-dvb-bounces@linuxtv.org
Errors-To: linux-dvb-bounces+mchehab=infradead.org@linuxtv.org
List-ID: <linux-dvb@linuxtv.org>

--0-177463081-1227085388=:12947
Content-Type: text/plain; charset=us-ascii

This patch provides USB suspend and hibernation support for Siano's SMS chipset based USB device

Signed-off-by: Uri Shkolnik <uris@siano-ms.com> hibernation



      
--0-177463081-1227085388=:12947
Content-Type: text/x-diff; name="smsusb_patch.diff"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="smsusb_patch.diff"

VGhpcyBwYXRjaCBwcm92aWRlcyBVU0Igc3VzcGVuZCBhbmQgaGliZXJuYXRp
b24gc3VwcG9ydCBmb3IgU2lhbm8ncyBTTVMgY2hpcHNldCBiYXNlZCBVU0Ig
ZGV2aWNlCgpTaWduZWQtb2ZmLWJ5OiBVcmkgU2hrb2xuaWsgPHVyaXNAc2lh
bm8tbXMuY29tPiBoaWJlcm5hdGlvbgoKZGlmZiAtdU5yIHY0bC1kdmItYzVm
OTc2Y2FiMDExL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL3NpYW5vL3Ntc3Vz
Yi5jIHY0bC1kdmItYzVmOTc2Y2FiMDExXzAwMDMvbGludXgvZHJpdmVycy9t
ZWRpYS9kdmIvc2lhbm8vc21zdXNiLmMKLS0tIHY0bC1kdmItYzVmOTc2Y2Fi
MDExL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL3NpYW5vL3Ntc3VzYi5jCTIw
MDgtMTEtMTYgMTU6NDA6MjEuMDAwMDAwMDAwICswMjAwCisrKyB2NGwtZHZi
LWM1Zjk3NmNhYjAxMV8wMDAzL2xpbnV4L2RyaXZlcnMvbWVkaWEvZHZiL3Np
YW5vL3Ntc3VzYi5jCTIwMDgtMTEtMTggMTg6MjY6MDQuMDAwMDAwMDAwICsw
MjAwCkBAIC0xLDIzICsxLDIzIEBACi0vKgotICogIERyaXZlciBmb3IgdGhl
IFNpYW5vIFNNUzF4eHggVVNCIGRvbmdsZQotICoKLSAqICBhdXRob3I6IEFu
YXRvbHkgR3JlZW5ibGF0Ci0gKgotICogIENvcHlyaWdodCAoYyksIDIwMDUt
MjAwOCBTaWFubyBNb2JpbGUgU2lsaWNvbiwgSW5jLgotICoKLSAqICBUaGlz
IHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yIG1vZGlmeQotICogIGl0IHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbiAyIGFz
Ci0gKiAgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRp
b247Ci0gKgotICogIFNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBM
aWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIKLSAqICBiYXNp
cywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl
c3Mgb3IgaW1wbGllZC4KLSAqCi0gKiAgU2VlIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgotICoKLSAqICBZb3Ug
c2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZQotICogIGFsb25nIHdpdGggdGhpcyBwcm9ncmFt
OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCi0gKiAgRm91
bmRhdGlvbiwgSW5jLiwgNjc1IE1hc3MgQXZlLCBDYW1icmlkZ2UsIE1BIDAy
MTM5LCBVU0EuCi0gKi8KKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisKK1NpYW5v
IE1vYmlsZSBTaWxpY29uLCBJbmMuCitNRFRWIHJlY2VpdmVyIGtlcm5lbCBt
b2R1bGVzLgorQ29weXJpZ2h0IChDKSAyMDA2LTIwMDgsIFVyaSBTaGtvbG5p
aworCitUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQoraXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJs
aXNoZWQgYnkKK3RoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhl
ciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisoYXQgeW91ciBvcHRp
b24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgVGhpcyBwcm9ncmFtIGlzIGRp
c3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWws
CitidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUg
aW1wbGllZCB3YXJyYW50eSBvZgorTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworWW91
IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UKK2Fsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAg
SWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lgor
CisqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqLwogCiAjaW5jbHVkZSA8bGludXgva2Vy
bmVsLmg+CiAjaW5jbHVkZSA8bGludXgvaW5pdC5oPgpAQCAtMzcsNyArMzcs
NyBAQAogCiBzdHJ1Y3Qgc21zdXNiX3VyYl90IHsKIAlzdHJ1Y3Qgc21zY29y
ZV9idWZmZXJfdCAqY2I7Ci0Jc3RydWN0IHNtc3VzYl9kZXZpY2VfdAkqZGV2
OworCXN0cnVjdCBzbXN1c2JfZGV2aWNlX3QgKmRldjsKIAogCXN0cnVjdCB1
cmIgdXJiOwogfTsKQEAgLTQ2LDEwICs0NiwxMCBAQAogCXN0cnVjdCB1c2Jf
ZGV2aWNlICp1ZGV2OwogCXN0cnVjdCBzbXNjb3JlX2RldmljZV90ICpjb3Jl
ZGV2OwogCi0Jc3RydWN0IHNtc3VzYl91cmJfdCAJc3VyYnNbTUFYX1VSQlNd
OworCXN0cnVjdCBzbXN1c2JfdXJiX3Qgc3VyYnNbTUFYX1VSQlNdOwogCi0J
aW50CQlyZXNwb25zZV9hbGlnbm1lbnQ7Ci0JaW50CQlidWZmZXJfc2l6ZTsK
KwlpbnQgcmVzcG9uc2VfYWxpZ25tZW50OworCWludCBidWZmZXJfc2l6ZTsK
IH07CiAKIHN0YXRpYyBpbnQgc21zdXNiX3N1Ym1pdF91cmIoc3RydWN0IHNt
c3VzYl9kZXZpY2VfdCAqZGV2LApAQCAtNjEsNyArNjEsNyBAQAogc3RhdGlj
IHZvaWQgc21zdXNiX29ucmVzcG9uc2Uoc3RydWN0IHVyYiAqdXJiLCBzdHJ1
Y3QgcHRfcmVncyAqcmVncykKICNlbmRpZgogewotCXN0cnVjdCBzbXN1c2Jf
dXJiX3QgKnN1cmIgPSAoc3RydWN0IHNtc3VzYl91cmJfdCAqKSB1cmItPmNv
bnRleHQ7CisJc3RydWN0IHNtc3VzYl91cmJfdCAqc3VyYiA9IChzdHJ1Y3Qg
c21zdXNiX3VyYl90ICopdXJiLT5jb250ZXh0OwogCXN0cnVjdCBzbXN1c2Jf
ZGV2aWNlX3QgKmRldiA9IHN1cmItPmRldjsKIAogCWlmICh1cmItPnN0YXR1
cyA8IDApIHsKQEAgLTcxLDcgKzcxLDcgQEAKIAl9CiAKIAlpZiAodXJiLT5h
Y3R1YWxfbGVuZ3RoID4gMCkgewotCQlzdHJ1Y3QgU21zTXNnSGRyX1NUICpw
aGRyID0gKHN0cnVjdCBTbXNNc2dIZHJfU1QgKikgc3VyYi0+Y2ItPnA7CisJ
CXN0cnVjdCBTbXNNc2dIZHJfU1QgKnBoZHIgPSAoc3RydWN0IFNtc01zZ0hk
cl9TVCAqKXN1cmItPmNiLT5wOwogCiAJCWlmICh1cmItPmFjdHVhbF9sZW5n
dGggPj0gcGhkci0+bXNnTGVuZ3RoKSB7CiAJCQlzdXJiLT5jYi0+c2l6ZSA9
IHBoZHItPm1zZ0xlbmd0aDsKQEAgLTgwLDExICs4MCwxMSBAQAogCQkJICAg
IChwaGRyLT5tc2dGbGFncyAmIE1TR19IRFJfRkxBR19TUExJVF9NU0cpKSB7
CiAKIAkJCQlzdXJiLT5jYi0+b2Zmc2V0ID0KLQkJCQkJZGV2LT5yZXNwb25z
ZV9hbGlnbm1lbnQgKwotCQkJCQkoKHBoZHItPm1zZ0ZsYWdzID4+IDgpICYg
Myk7CisJCQkJICAgIGRldi0+cmVzcG9uc2VfYWxpZ25tZW50ICsKKwkJCQkg
ICAgKChwaGRyLT5tc2dGbGFncyA+PiA4KSAmIDMpOwogCiAJCQkJLyogc2Fu
aXR5IGNoZWNrICovCi0JCQkJaWYgKCgoaW50KSBwaGRyLT5tc2dMZW5ndGgg
KworCQkJCWlmICgoKGludClwaGRyLT5tc2dMZW5ndGggKwogCQkJCSAgICAg
c3VyYi0+Y2ItPm9mZnNldCkgPiB1cmItPmFjdHVhbF9sZW5ndGgpIHsKIAkJ
CQkJc21zX2VycigiaW52YWxpZCByZXNwb25zZSAiCiAJCQkJCQkibXNnbGVu
ICVkIG9mZnNldCAlZCAiCkBAIC05Nyw3ICs5Nyw3IEBACiAKIAkJCQkvKiBt
b3ZlIGJ1ZmZlciBwb2ludGVyIGFuZAogCQkJCSAqIGNvcHkgaGVhZGVyIHRv
IGl0cyBuZXcgbG9jYXRpb24gKi8KLQkJCQltZW1jcHkoKGNoYXIgKikgcGhk
ciArIHN1cmItPmNiLT5vZmZzZXQsCisJCQkJbWVtY3B5KChjaGFyICopcGhk
ciArIHN1cmItPmNiLT5vZmZzZXQsCiAJCQkJICAgICAgIHBoZHIsIHNpemVv
ZihzdHJ1Y3QgU21zTXNnSGRyX1NUKSk7CiAJCQl9IGVsc2UKIAkJCQlzdXJi
LT5jYi0+b2Zmc2V0ID0gMDsKQEAgLTEyNiwxNSArMTI2LDExIEBACiAJCX0K
IAl9CiAKLQl1c2JfZmlsbF9idWxrX3VyYigKLQkJJnN1cmItPnVyYiwKLQkJ
ZGV2LT51ZGV2LAotCQl1c2JfcmN2YnVsa3BpcGUoZGV2LT51ZGV2LCAweDgx
KSwKLQkJc3VyYi0+Y2ItPnAsCi0JCWRldi0+YnVmZmVyX3NpemUsCi0JCXNt
c3VzYl9vbnJlc3BvbnNlLAotCQlzdXJiCi0JKTsKKwl1c2JfZmlsbF9idWxr
X3VyYigmc3VyYi0+dXJiLAorCQkJICBkZXYtPnVkZXYsCisJCQkgIHVzYl9y
Y3ZidWxrcGlwZShkZXYtPnVkZXYsIDB4ODEpLAorCQkJICBzdXJiLT5jYi0+
cCwKKwkJCSAgZGV2LT5idWZmZXJfc2l6ZSwgc21zdXNiX29ucmVzcG9uc2Us
IHN1cmIpOwogCXN1cmItPnVyYi50cmFuc2Zlcl9kbWEgPSBzdXJiLT5jYi0+
cGh5czsKIAlzdXJiLT51cmIudHJhbnNmZXJfZmxhZ3MgfD0gVVJCX05PX1RS
QU5TRkVSX0RNQV9NQVA7CiAKQEAgLTE3Myw3ICsxNjksNyBAQAogCiBzdGF0
aWMgaW50IHNtc3VzYl9zZW5kcmVxdWVzdCh2b2lkICpjb250ZXh0LCB2b2lk
ICpidWZmZXIsIHNpemVfdCBzaXplKQogewotCXN0cnVjdCBzbXN1c2JfZGV2
aWNlX3QgKmRldiA9IChzdHJ1Y3Qgc21zdXNiX2RldmljZV90ICopIGNvbnRl
eHQ7CisJc3RydWN0IHNtc3VzYl9kZXZpY2VfdCAqZGV2ID0gKHN0cnVjdCBz
bXN1c2JfZGV2aWNlX3QgKiljb250ZXh0OwogCWludCBkdW1teTsKIAogCXJl
dHVybiB1c2JfYnVsa19tc2coZGV2LT51ZGV2LCB1c2Jfc25kYnVsa3BpcGUo
ZGV2LT51ZGV2LCAyKSwKQEAgLTIzMCwxNCArMjI2LDE0IEBACiAJCXJjID0g
dXNiX2J1bGtfbXNnKHVkZXYsIHVzYl9zbmRidWxrcGlwZSh1ZGV2LCAyKSwK
IAkJCQkgIGZ3X2J1ZmZlciwgZnctPnNpemUsICZkdW1teSwgMTAwMCk7CiAK
LQkJc21zX2luZm8oInNlbnQgJXpkKCVkKSBieXRlcywgcmMgJWQiLCBmdy0+
c2l6ZSwgZHVtbXksIHJjKTsKKwkJc21zX2luZm8oInNlbnQgJWQoJWQpIGJ5
dGVzLCByYyAlZCIsIGZ3LT5zaXplLCBkdW1teSwgcmMpOwogCiAJCWtmcmVl
KGZ3X2J1ZmZlcik7CiAJfSBlbHNlIHsKIAkJc21zX2VycigiZmFpbGVkIHRv
IGFsbG9jYXRlIGZpcm13YXJlIGJ1ZmZlciIpOwogCQlyYyA9IC1FTk9NRU07
CiAJfQotCXNtc19pbmZvKCJyZWFkIEZXICVzLCBzaXplPSV6ZCIsIGZ3X2Zp
bGVuYW1lLCBmdy0+c2l6ZSk7CisJc21zX2luZm8oInJlYWQgRlcgJXMsIHNp
emU9JWQiLCBmd19maWxlbmFtZSwgZnctPnNpemUpOwogCiAJcmVsZWFzZV9m
aXJtd2FyZShmdyk7CiAKQEAgLTI0Nyw3ICsyNDMsNyBAQAogc3RhdGljIHZv
aWQgc21zdXNiMV9kZXRlY3Rtb2RlKHZvaWQgKmNvbnRleHQsIGludCAqbW9k
ZSkKIHsKIAljaGFyICpwcm9kdWN0X3N0cmluZyA9Ci0JCSgoc3RydWN0IHNt
c3VzYl9kZXZpY2VfdCAqKSBjb250ZXh0KS0+dWRldi0+cHJvZHVjdDsKKwkg
ICAgKChzdHJ1Y3Qgc21zdXNiX2RldmljZV90ICopY29udGV4dCktPnVkZXYt
PnByb2R1Y3Q7CiAKIAkqbW9kZSA9IERFVklDRV9NT0RFX05PTkU7CiAKQEAg
LTI2OSw3ICsyNjUsOCBAQAogc3RhdGljIGludCBzbXN1c2IxX3NldG1vZGUo
dm9pZCAqY29udGV4dCwgaW50IG1vZGUpCiB7CiAJc3RydWN0IFNtc01zZ0hk
cl9TVCBNc2cgPSB7IE1TR19TV19SRUxPQURfUkVRLCAwLCBISUZfVEFTSywK
LQkJCSAgICAgc2l6ZW9mKHN0cnVjdCBTbXNNc2dIZHJfU1QpLCAwIH07CisJ
CXNpemVvZihzdHJ1Y3QgU21zTXNnSGRyX1NUKSwgMAorCX07CiAKIAlpZiAo
bW9kZSA8IERFVklDRV9NT0RFX0RWQlQgfHwgbW9kZSA+IERFVklDRV9NT0RF
X0RWQlRfQkRBKSB7CiAJCXNtc19lcnIoImludmFsaWQgZmlybXdhcmUgaWQg
c3BlY2lmaWVkICVkIiwgbW9kZSk7CkBAIC0yODIsNyArMjc5LDcgQEAKIHN0
YXRpYyB2b2lkIHNtc3VzYl90ZXJtX2RldmljZShzdHJ1Y3QgdXNiX2ludGVy
ZmFjZSAqaW50ZikKIHsKIAlzdHJ1Y3Qgc21zdXNiX2RldmljZV90ICpkZXYg
PQotCQkoc3RydWN0IHNtc3VzYl9kZXZpY2VfdCAqKSB1c2JfZ2V0X2ludGZk
YXRhKGludGYpOworCSAgICAoc3RydWN0IHNtc3VzYl9kZXZpY2VfdCAqKXVz
Yl9nZXRfaW50ZmRhdGEoaW50Zik7CiAKIAlpZiAoZGV2KSB7CiAJCXNtc3Vz
Yl9zdG9wX3N0cmVhbWluZyhkZXYpOwpAQCAtMzMzLDggKzMzMCw4IEBACiAJ
Y2FzZSBTTVNfVkVHQToKIAkJZGV2LT5idWZmZXJfc2l6ZSA9IFVTQjJfQlVG
RkVSX1NJWkU7CiAJCWRldi0+cmVzcG9uc2VfYWxpZ25tZW50ID0KLQkJCWRl
di0+dWRldi0+ZXBfaW5bMV0tPmRlc2Mud01heFBhY2tldFNpemUgLQotCQkJ
c2l6ZW9mKHN0cnVjdCBTbXNNc2dIZHJfU1QpOworCQkgICAgZGV2LT51ZGV2
LT5lcF9pblsxXS0+ZGVzYy53TWF4UGFja2V0U2l6ZSAtCisJCSAgICBzaXpl
b2Yoc3RydWN0IFNtc01zZ0hkcl9TVCk7CiAKIAkJcGFyYW1zLmZsYWdzIHw9
IFNNU19ERVZJQ0VfRkFNSUxZMjsKIAkJYnJlYWs7CkBAIC0zOTUsOCArMzky
LDkgQEAKIAlyYyA9IHVzYl9jbGVhcl9oYWx0KHVkZXYsIHVzYl9yY3ZidWxr
cGlwZSh1ZGV2LCAweDAyKSk7CiAKIAlpZiAoaW50Zi0+bnVtX2FsdHNldHRp
bmcgPiAwKSB7Ci0JCXJjID0gdXNiX3NldF9pbnRlcmZhY2UoCi0JCQl1ZGV2
LCBpbnRmLT5jdXJfYWx0c2V0dGluZy0+ZGVzYy5iSW50ZXJmYWNlTnVtYmVy
LCAwKTsKKwkJcmMgPSB1c2Jfc2V0X2ludGVyZmFjZSh1ZGV2LAorCQkJCSAg
ICAgICBpbnRmLT5jdXJfYWx0c2V0dGluZy0+ZGVzYy4KKwkJCQkgICAgICAg
YkludGVyZmFjZU51bWJlciwgMCk7CiAJCWlmIChyYyA8IDApIHsKIAkJCXNt
c19lcnIoInVzYl9zZXRfaW50ZXJmYWNlIGZhaWxlZCwgcmMgJWQiLCByYyk7
CiAJCQlyZXR1cm4gcmM7CkBAIC00MDQsMTIgKzQwMiwxMyBAQAogCX0KIAog
CXNtc19pbmZvKCJzbXN1c2JfcHJvYmUgJWQiLAotCSAgICAgICBpbnRmLT5j
dXJfYWx0c2V0dGluZy0+ZGVzYy5iSW50ZXJmYWNlTnVtYmVyKTsKKwkJIGlu
dGYtPmN1cl9hbHRzZXR0aW5nLT5kZXNjLmJJbnRlcmZhY2VOdW1iZXIpOwog
CWZvciAoaSA9IDA7IGkgPCBpbnRmLT5jdXJfYWx0c2V0dGluZy0+ZGVzYy5i
TnVtRW5kcG9pbnRzOyBpKyspCiAJCXNtc19pbmZvKCJlbmRwb2ludCAlZCAl
MDJ4ICUwMnggJWQiLCBpLAotCQkgICAgICAgaW50Zi0+Y3VyX2FsdHNldHRp
bmctPmVuZHBvaW50W2ldLmRlc2MuYkVuZHBvaW50QWRkcmVzcywKLQkJICAg
ICAgIGludGYtPmN1cl9hbHRzZXR0aW5nLT5lbmRwb2ludFtpXS5kZXNjLmJt
QXR0cmlidXRlcywKLQkJICAgICAgIGludGYtPmN1cl9hbHRzZXR0aW5nLT5l
bmRwb2ludFtpXS5kZXNjLndNYXhQYWNrZXRTaXplKTsKKwkJCSBpbnRmLT5j
dXJfYWx0c2V0dGluZy0+ZW5kcG9pbnRbaV0uZGVzYy4KKwkJCSBiRW5kcG9p
bnRBZGRyZXNzLAorCQkJIGludGYtPmN1cl9hbHRzZXR0aW5nLT5lbmRwb2lu
dFtpXS5kZXNjLmJtQXR0cmlidXRlcywKKwkJCSBpbnRmLT5jdXJfYWx0c2V0
dGluZy0+ZW5kcG9pbnRbaV0uZGVzYy53TWF4UGFja2V0U2l6ZSk7CiAKIAlp
ZiAoKHVkZXYtPmFjdGNvbmZpZy0+ZGVzYy5iTnVtSW50ZXJmYWNlcyA9PSAy
KSAmJgogCSAgICAoaW50Zi0+Y3VyX2FsdHNldHRpbmctPmRlc2MuYkludGVy
ZmFjZU51bWJlciA9PSAwKSkgewpAQCAtNDIxLDkgKzQyMCw5IEBACiAJCXNu
cHJpbnRmKGRldnBhdGgsIHNpemVvZihkZXZwYXRoKSwgInVzYlxcJWQtJXMi
LAogCQkJIHVkZXYtPmJ1cy0+YnVzbnVtLCB1ZGV2LT5kZXZwYXRoKTsKIAkJ
c21zX2luZm8oInN0ZWxsYXIgZGV2aWNlIHdhcyBmb3VuZC4iKTsKLQkJcmV0
dXJuIHNtc3VzYjFfbG9hZF9maXJtd2FyZSgKLQkJCQl1ZGV2LCBzbXNjb3Jl
X3JlZ2lzdHJ5X2dldG1vZGUoZGV2cGF0aCksCi0JCQkJaWQtPmRyaXZlcl9p
bmZvKTsKKwkJcmV0dXJuIHNtc3VzYjFfbG9hZF9maXJtd2FyZSh1ZGV2LAor
CQkJCQkgICAgIHNtc2NvcmVfcmVnaXN0cnlfZ2V0bW9kZShkZXZwYXRoKSwK
KwkJCQkJICAgICBpZC0+ZHJpdmVyX2luZm8pOwogCX0KIAogCXJjID0gc21z
dXNiX2luaXRfZGV2aWNlKGludGYsIGlkLT5kcml2ZXJfaW5mbyk7CkBAIC00
MzYsMTEgKzQzNSw1NSBAQAogCXNtc3VzYl90ZXJtX2RldmljZShpbnRmKTsK
IH0KIAorc3RhdGljIGludCBzbXN1c2Jfc3VzcGVuZChzdHJ1Y3QgdXNiX2lu
dGVyZmFjZSAqaW50ZiwgcG1fbWVzc2FnZV90IG1zZykKK3sKKwlzdHJ1Y3Qg
c21zdXNiX2RldmljZV90ICpkZXYgPQorCSAgICAoc3RydWN0IHNtc3VzYl9k
ZXZpY2VfdCAqKXVzYl9nZXRfaW50ZmRhdGEoaW50Zik7CisJcHJpbnRrKEtF
Uk5fSU5GTyAiJXMgIEVudGVyaW5nIHN0YXR1cyAlZC5cbiIsIF9fZnVuY19f
LCBtc2cuZXZlbnQpOworCXNtc3VzYl9zdG9wX3N0cmVhbWluZyhkZXYpOwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHNtc3VzYl9yZXN1bWUoc3Ry
dWN0IHVzYl9pbnRlcmZhY2UgKmludGYpCit7CisJaW50IHJjLCBpOworCXN0
cnVjdCBzbXN1c2JfZGV2aWNlX3QgKmRldiA9CisJICAgIChzdHJ1Y3Qgc21z
dXNiX2RldmljZV90ICopdXNiX2dldF9pbnRmZGF0YShpbnRmKTsKKwlzdHJ1
Y3QgdXNiX2RldmljZSAqdWRldiA9IGludGVyZmFjZV90b191c2JkZXYoaW50
Zik7CisKKwlwcmludGsoS0VSTl9JTkZPICIlcyAgRW50ZXJpbmcuXG4iLCBf
X2Z1bmNfXyk7CisJdXNiX2NsZWFyX2hhbHQodWRldiwgdXNiX3JjdmJ1bGtw
aXBlKHVkZXYsIDB4ODEpKTsKKwl1c2JfY2xlYXJfaGFsdCh1ZGV2LCB1c2Jf
cmN2YnVsa3BpcGUodWRldiwgMHgwMikpOworCisJZm9yIChpID0gMDsgaSA8
IGludGYtPmN1cl9hbHRzZXR0aW5nLT5kZXNjLmJOdW1FbmRwb2ludHM7IGkr
KykKKwkJcHJpbnRrKEtFUk5fSU5GTyAiZW5kcG9pbnQgJWQgJTAyeCAlMDJ4
ICVkXG4iLCBpLAorCQkgICAgICAgaW50Zi0+Y3VyX2FsdHNldHRpbmctPmVu
ZHBvaW50W2ldLmRlc2MuYkVuZHBvaW50QWRkcmVzcywKKwkJICAgICAgIGlu
dGYtPmN1cl9hbHRzZXR0aW5nLT5lbmRwb2ludFtpXS5kZXNjLmJtQXR0cmli
dXRlcywKKwkJICAgICAgIGludGYtPmN1cl9hbHRzZXR0aW5nLT5lbmRwb2lu
dFtpXS5kZXNjLndNYXhQYWNrZXRTaXplKTsKKworCWlmIChpbnRmLT5udW1f
YWx0c2V0dGluZyA+IDApIHsKKwkJcmMgPSB1c2Jfc2V0X2ludGVyZmFjZSh1
ZGV2LAorCQkJCSAgICAgICBpbnRmLT5jdXJfYWx0c2V0dGluZy0+ZGVzYy4K
KwkJCQkgICAgICAgYkludGVyZmFjZU51bWJlciwgMCk7CisJCWlmIChyYyA8
IDApIHsKKwkJCXByaW50ayhLRVJOX0lORk8KKwkJCSAgICAgICAiJXMgdXNi
X3NldF9pbnRlcmZhY2UgZmFpbGVkLCByYyAlZFxuIiwKKwkJCSAgICAgICBf
X2Z1bmNfXywgcmMpOworCQkJcmV0dXJuIHJjOworCQl9CisJfQorCisJc21z
dXNiX3N0YXJ0X3N0cmVhbWluZyhkZXYpOworCXJldHVybiAwOworfQorCiBz
dGF0aWMgc3RydWN0IHVzYl9kcml2ZXIgc21zdXNiX2RyaXZlciA9IHsKLQku
bmFtZQkJCT0gInNtczF4eHgiLAotCS5wcm9iZQkJCT0gc21zdXNiX3Byb2Jl
LAotCS5kaXNjb25uZWN0CQk9IHNtc3VzYl9kaXNjb25uZWN0LAotCS5pZF90
YWJsZQkJPSBzbXN1c2JfaWRfdGFibGUsCisJLm5hbWUgPSAic21zdXNiIiwK
KwkucHJvYmUgPSBzbXN1c2JfcHJvYmUsCisJLmRpc2Nvbm5lY3QgPSBzbXN1
c2JfZGlzY29ubmVjdCwKKwkuc3VzcGVuZCA9IHNtc3VzYl9zdXNwZW5kLAor
CS5yZXN1bWUgPSBzbXN1c2JfcmVzdW1lLAorCS5pZF90YWJsZSA9IHNtc3Vz
Yl9pZF90YWJsZSwKIH07CiAKIGludCBzbXN1c2JfcmVnaXN0ZXIodm9pZCkK
QEAgLTQ2MSwzICs1MDQsNiBAQAogCXVzYl9kZXJlZ2lzdGVyKCZzbXN1c2Jf
ZHJpdmVyKTsKIH0KIAorTU9EVUxFX0RFU0NSSVBUSU9OKCJEcml2ZXIgZm9y
IHRoZSBTaWFubyBTTVMxeHh4IFVTQiBkb25nbGUiKTsKK01PRFVMRV9BVVRI
T1IoIlNpYW5vIE1vYmlsZSBTaWxpY29uLCBJTkMuICh1cmlzQHNpYW5vLW1z
LmNvbSkiKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsK

--0-177463081-1227085388=:12947
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

_______________________________________________
linux-dvb mailing list
linux-dvb@linuxtv.org
http://www.linuxtv.org/cgi-bin/mailman/listinfo/linux-dvb
--0-177463081-1227085388=:12947--
