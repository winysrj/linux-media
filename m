Return-path: <linux-media-owner@vger.kernel.org>
Received: from mx1.redhat.com ([209.132.183.28]:37690 "EHLO mx1.redhat.com"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1752072AbZL2WsC (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Tue, 29 Dec 2009 17:48:02 -0500
Message-ID: <4B3A86ED.1090303@redhat.com>
Date: Tue, 29 Dec 2009 20:47:09 -0200
From: Mauro Carvalho Chehab <mchehab@redhat.com>
MIME-Version: 1.0
To: =?ISO-8859-2?Q?N=E9meth_M=E1rton?= <nm127@freemail.hu>
CC: Hans Verkuil <hverkuil@xs4all.nl>, linux-media@vger.kernel.org,
	Michael Krufky <mkrufky@linuxtv.org>
Subject: Re: [cron job] v4l-dvb daily build 2.6.22 and up: ERRORS, 2.6.16-2.6.21:
 OK
References: <200912291959.nBTJxkB3066435@smtp-vbr9.xs4all.nl> <4B3A72E1.9010107@freemail.hu>
In-Reply-To: <4B3A72E1.9010107@freemail.hu>
Content-Type: text/plain; charset=ISO-8859-2
Content-Transfer-Encoding: 8bit
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

Németh Márton wrote:
> Hans Verkuil wrote:
>> Detailed results are available here:
>>
>> http://www.xs4all.nl/~hverkuil/logs/Tuesday.log
> 
> linux-2.6.33-rc2-armv5: ERRORS
> 
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: In file included from <command-line>:0error: :
> linux/autoconf.h: No such file or directory
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28:In file included from <command-line>:0 error: :
> linux/autoconf.h: No such file or directory
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> In file included from <command-line>:0:
> /marune/build/v4l-dvb-master/v4l/config-compat.h:4:28: error: linux/autoconf.h: No such file or directory
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_filter.o] Error 1
> make[3]: *** Waiting for unfinished jobs....
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvbdev.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_ringbuffer.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_ca_en50221.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dmxdev.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_demux.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_frontend.o] Error 1
> make[3]: *** [/marune/build/v4l-dvb-master/v4l/dvb_net.o] Error 1
> make[2]: *** [_module_/marune/build/v4l-dvb-master/v4l] Error 2
> make[2]: Leaving directory `/marune/build/trees/armv5/linux-2.6.33-rc2'
> make[1]: *** [default] Error 2
> make[1]: Leaving directory `/marune/build/v4l-dvb-master/v4l'
> make: *** [all] Error 2
> Tue Dec 29 19:01:02 CET 2009
> 
> This problem happens because the v4l/config-compat.h includes the
> linux/autoconf.h . This file is generated by v4l/scripts/make_config_compat.pl .
> 
> I found different commits where the inclusion of this file was
> completely removed, like in
> http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=911f21501f50b16ce77f37b01e90b5b73c8c80bf .
> I doubt whether the line should be completely deleted or a construct
> like this should be used:
> 
> #if LINUX_VERSION_CODE < KERNEL_VERSION(2, 6, 33)
> #include <linux/autoconf.h>
> #endif
> 
> What do you think?

If I'm not mistaken, Michael included this file at the building system,
since some drivers need to do some checks against some CONFIG_foo symbols that
are needed to compile certain drivers.

By removing it, it may break some compilations. So, while I'm not quite sure
what should be done to fix the issue, just removing it seems to me that it will
cause some regression.

Cheers,
Mauro.

