Return-path: <linux-media-owner@vger.kernel.org>
Received: from mail-bw0-f219.google.com ([209.85.218.219]:48420 "EHLO
	mail-bw0-f219.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1750827Ab0BHRuX (ORCPT
	<rfc822;linux-media@vger.kernel.org>); Mon, 8 Feb 2010 12:50:23 -0500
Received: by bwz19 with SMTP id 19so2101226bwz.28
        for <linux-media@vger.kernel.org>; Mon, 08 Feb 2010 09:50:21 -0800 (PST)
MIME-Version: 1.0
Date: Mon, 8 Feb 2010 20:50:21 +0300
Message-ID: <d7fc510e1002080950r2bc7ae5blfab5676568f46555@mail.gmail.com>
Subject: [PATCH] Twinhan 1027 + IR Port support.
From: Sergey Ivanov <123kash@gmail.com>
To: linux-media@vger.kernel.org
Content-Type: multipart/mixed; boundary=00032555a89263f82e047f1a6f76
Sender: linux-media-owner@vger.kernel.org
List-ID: <linux-media.vger.kernel.org>

--00032555a89263f82e047f1a6f76
Content-Type: text/plain; charset=ISO-8859-1

Ok. 3rd try (and i hope the last) to submit this stupid patch. This
patch applies correctly to current mercurial revision (tried 2 times.
patch -p 1 vp1027+ir.patch).
Now about changes. Patch add support of TwinHan 1027 DVB-S card.
Original author is Manu Abraham (abraham dot manu at gmail dot com).
IR Port support is my job.

-- 
WBR Sergey Kash Ivanov.

--00032555a89263f82e047f1a6f76
Content-Type: application/octet-stream; name="vp1027+ir.patch"
Content-Disposition: attachment; filename="vp1027+ir.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_g5fk5tbs0

ZGlmZiAtciA2OTAwNTU5OTMwMTEgbGludXgvZHJpdmVycy9tZWRpYS9JUi9pci1rZXltYXBzLmMK
LS0tIGEvbGludXgvZHJpdmVycy9tZWRpYS9JUi9pci1rZXltYXBzLmMJU3VuIEZlYiAwNyAyMjoy
NjoxMCAyMDEwIC0wMjAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvSVIvaXIta2V5bWFwcy5j
CU1vbiBGZWIgMDggMjA6Mzg6MzIgMjAxMCArMDMwMApAQCAtMzUwMSwzICszNTAxLDcyIEBACiAJ
LnNpemUgPSBBUlJBWV9TSVpFKGlyX2NvZGVzX3dpbmZhc3RfdXNiaWlfZGVsdXhlKSwKIH07CiBF
WFBPUlRfU1lNQk9MX0dQTChpcl9jb2Rlc193aW5mYXN0X3VzYmlpX2RlbHV4ZV90YWJsZSk7CisK
Ky8qIFR3aW5oYW4gdnAxMDI3IERWQi1TIHJlbW90ZQorICAgU2VyZ2V5IF9LYXNoXyBJdmFub3Yg
MTIza2FzaEBnbWFpbC5jb20KKyovCitzdGF0aWMgc3RydWN0IGlyX3NjYW5jb2RlIGlyX2NvZGVz
X3R3aW5oYW5fdnAxMDI3X2R2YnNbXSA9IHsKKwl7IDB4MTYsIEtFWV9QT1dFUjIgfSwKKwl7IDB4
MTcsIEtFWV9GQVZPUklURVMgfSwKKwl7IDB4MGYsIEtFWV9URVhUIH0sCisJeyAweDQ4LCBLRVlf
SU5GT30sCisJeyAweDFjLCBLRVlfRVBHIH0sCisJeyAweDA0LCBLRVlfTElTVCB9LAorCQorCXsg
MHgwMywgS0VZXzEgfSwKKwl7IDB4MDEsIEtFWV8yIH0sCisJeyAweDA2LCBLRVlfMyB9LAorCXsg
MHgwOSwgS0VZXzQgfSwKKwl7IDB4MWQsIEtFWV81IH0sCisJeyAweDFmLCBLRVlfNiB9LAorCXsg
MHgwZCwgS0VZXzcgfSwKKwl7IDB4MTksIEtFWV84IH0sCisJeyAweDFiLCBLRVlfOSB9LAorCXsg
MHgxNSwgS0VZXzAgfSwKKwkKKwl7IDB4MGMsIEtFWV9DQU5DRUwgfSwKKwl7IDB4NGEsIEtFWV9D
TEVBUiB9LAorCXsgMHgxMywgS0VZX0JBQ0tTUEFDRSB9LAorCXsgMHgwMCwgS0VZX1RBQiB9LAor
CQorCXsgMHg0YiwgS0VZX1VQIH0sCisJeyAweDUxLCBLRVlfRE9XTiB9LAorCXsgMHg0ZSwgS0VZ
X0xFRlQgfSwKKwl7IDB4NTIsIEtFWV9SSUdIVCB9LAorCXsgMHg0ZiwgS0VZX0VOVEVSIH0sCisJ
CisJeyAweDFlLCBLRVlfVk9MVU1FVVAgfSwKKwl7IDB4MGEsIEtFWV9WT0xVTUVET1dOIH0sCisJ
eyAweDAyLCBLRVlfQ0hBTk5FTERPV04gfSwKKwl7IDB4MDUsIEtFWV9DSEFOTkVMVVAgfSwKKwl7
IDB4MTEsIEtFWV9SRUNPUkQgfSwKKwkKKwl7IDB4MTQsIEtFWV9QTEFZIH0sCisJeyAweDRjLCBL
RVlfUEFVU0UgfSwKKwl7IDB4MWEsIEtFWV9TVE9QIH0sCisJeyAweDQwLCBLRVlfUkVXSU5EIH0s
CisJeyAweDEyLCBLRVlfRkFTVEZPUldBUkQgfSwKKwl7IDB4NDEsIEtFWV9QUkVWSU9VU1NPTkcg
fSwKKwl7IDB4NDIsIEtFWV9ORVhUU09ORyB9LAorCXsgMHg1NCwgS0VZX1NBVkUgfSwKKwl7IDB4
NTAsIEtFWV9MQU5HVUFHRSB9LAorCXsgMHg0NywgS0VZX01FRElBIH0sCisJeyAweDRkLCBLRVlf
U0NSRUVOIH0sCisJeyAweDQzLCBLRVlfU1VCVElUTEUgfSwKKwl7IDB4MTAsIEtFWV9NVVRFIH0s
CisJeyAweDQ5LCBLRVlfQVVESU8gfSwKKwl7IDB4MDcsIEtFWV9TTEVFUCB9LAorCXsgMHgwOCwg
S0VZX1ZJREVPIH0sCisJeyAweDBlLCBLRVlfQUdBSU4gfSwKKwl7IDB4NDUsIEtFWV9FUVVBTCB9
LAorCXsgMHg0NiwgS0VZX01JTlVTIH0sCisJeyAweDE4LCBLRVlfUkVEIH0sCisJeyAweDUzLCBL
RVlfR1JFRU4gfSwKKwl7IDB4NWUsIEtFWV9ZRUxMT1cgfSwKKwl7IDB4NWYsIEtFWV9CTFVFIH0s
Cit9Oworc3RydWN0IGlyX3NjYW5jb2RlX3RhYmxlIGlyX2NvZGVzX3R3aW5oYW5fdnAxMDI3X2R2
YnNfdGFibGUgPSB7CisJLnNjYW4gPSBpcl9jb2Rlc190d2luaGFuX3ZwMTAyN19kdmJzLAorCS5z
aXplID0gQVJSQVlfU0laRShpcl9jb2Rlc190d2luaGFuX3ZwMTAyN19kdmJzKSwKK307CitFWFBP
UlRfU1lNQk9MX0dQTChpcl9jb2Rlc190d2luaGFuX3ZwMTAyN19kdmJzX3RhYmxlKTsKZGlmZiAt
ciA2OTAwNTU5OTMwMTEgbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9jeDg4L2N4ODgtY2FyZHMu
YwotLS0gYS9saW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC1jYXJkcy5jCVN1biBG
ZWIgMDcgMjI6MjY6MTAgMjAxMCAtMDIwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL3ZpZGVv
L2N4ODgvY3g4OC1jYXJkcy5jCU1vbiBGZWIgMDggMjA6Mzg6MzIgMjAxMCArMDMwMApAQCAtMjEy
MCw2ICsyMTIwLDE4IEBACiAJCX0gfSwKIAkJLm1wZWcgICAgICAgICAgID0gQ1g4OF9NUEVHX0RW
QiwKIAl9LAorCVtDWDg4X0JPQVJEX1RXSU5IQU5fVlAxMDI3X0RWQlNdID0geworCQkubmFtZQkJ
PSAiVHdpbmhhbiBWUC0xMDI3IERWQi1TIiwKKwkJLnR1bmVyX3R5cGUgICAgID0gVFVORVJfQUJT
RU5ULAorCQkucmFkaW9fdHlwZSAgICAgPSBVTlNFVCwKKwkJLnR1bmVyX2FkZHIgICAgID0gQURE
Ul9VTlNFVCwKKwkJLnJhZGlvX2FkZHIgICAgID0gQUREUl9VTlNFVCwKKwkJLmlucHV0ICAgICAg
ICAgID0ge3sKKwkJICAgICAgIC50eXBlICAgPSBDWDg4X1ZNVVhfRFZCLAorCQkgICAgICAgLnZt
dXggICA9IDAsCisJCX0gfSwKKwkJLm1wZWcgICAgICAgICAgID0gQ1g4OF9NUEVHX0RWQiwKKwl9
LAogfTsKIAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCkBAIC0yNTg0LDYgKzI1OTYsMTAgQEAKIAkJLnN1YnZl
bmRvciA9IDB4YjAzNCwKIAkJLnN1YmRldmljZSA9IDB4MzAzNCwKIAkJLmNhcmQgICAgICA9IENY
ODhfQk9BUkRfUFJPRl83MzAxLAorCX0sIHsKKwkJLnN1YnZlbmRvciA9IDB4MTgyMiwKKwkJLnN1
YmRldmljZSA9IDB4MDAyMywKKwkJLmNhcmQgICAgICA9IENYODhfQk9BUkRfVFdJTkhBTl9WUDEw
MjdfRFZCUywKIAl9LAogfTsKIApAQCAtMzA3NSw2ICszMDkxLDEzIEBACiAJCWN4X3NldChNT19H
UDFfSU8sIDB4MTApOwogCQltZGVsYXkoNTApOwogCQlicmVhazsKKworCWNhc2UgQ1g4OF9CT0FS
RF9UV0lOSEFOX1ZQMTAyN19EVkJTOgorCQljeF93cml0ZShNT19HUDBfSU8sIDB4MDAwMDMyMzAp
OworCQljeF93cml0ZShNT19HUDBfSU8sIDB4MDAwMDMyMTApOworCQltc2xlZXAoMSk7CisJCWN4
X3dyaXRlKE1PX0dQMF9JTywgMHgwMDAwMTIzMCk7CisJCWJyZWFrOwogCX0KIH0KIApkaWZmIC1y
IDY5MDA1NTk5MzAxMSBsaW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC1kdmIuYwot
LS0gYS9saW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC1kdmIuYwlTdW4gRmViIDA3
IDIyOjI2OjEwIDIwMTAgLTAyMDAKKysrIGIvbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9jeDg4
L2N4ODgtZHZiLmMJTW9uIEZlYiAwOCAyMDozODozMiAyMDEwICswMzAwCkBAIC01Nyw2ICs1Nyw3
IEBACiAjaW5jbHVkZSAic3R2MDkwMC5oIgogI2luY2x1ZGUgInN0YjYxMDAuaCIKICNpbmNsdWRl
ICJzdGI2MTAwX3Byb2MuaCIKKyNpbmNsdWRlICJtYjg2YTE2LmgiCiAKIE1PRFVMRV9ERVNDUklQ
VElPTigiZHJpdmVyIGZvciBjeDIzODh4IGJhc2VkIERWQiBjYXJkcyIpOwogTU9EVUxFX0FVVEhP
UigiQ2hyaXMgUGFzY29lIDxjLnBhc2NvZUBpdGVlLnVxLmVkdS5hdT4iKTsKQEAgLTI1MSw2ICsy
NTIsMTAgQEAKIAkuaWYyICAgICAgICAgICA9IDQ1NjAwLAogfTsKIAorc3RhdGljIHN0cnVjdCBt
Yjg2YTE2X2NvbmZpZyB0d2luaGFuX3ZwMTAyNyA9IHsKKwkuZGVtb2RfYWRkcmVzcyAgPSAweDA4
LAorfTsKKwogI2lmIGRlZmluZWQoQ09ORklHX1ZJREVPX0NYODhfVlAzMDU0KSB8fCAoZGVmaW5l
ZChDT05GSUdfVklERU9fQ1g4OF9WUDMwNTRfTU9EVUxFKSAmJiBkZWZpbmVkKE1PRFVMRSkpCiBz
dGF0aWMgaW50IGRudHZfbGl2ZV9kdmJ0X3Byb19kZW1vZF9pbml0KHN0cnVjdCBkdmJfZnJvbnRl
bmQqIGZlKQogewpAQCAtNDMwLDE1ICs0MzUsNDEgQEAKIAogCWN4X3NldChNT19HUDBfSU8sIDB4
NjA0MCk7CiAJc3dpdGNoICh2b2x0YWdlKSB7Ci0JCWNhc2UgU0VDX1ZPTFRBR0VfMTM6Ci0JCQlj
eF9jbGVhcihNT19HUDBfSU8sIDB4MjApOwotCQkJYnJlYWs7Ci0JCWNhc2UgU0VDX1ZPTFRBR0Vf
MTg6Ci0JCQljeF9zZXQoTU9fR1AwX0lPLCAweDIwKTsKLQkJCWJyZWFrOwotCQljYXNlIFNFQ19W
T0xUQUdFX09GRjoKLQkJCWN4X2NsZWFyKE1PX0dQMF9JTywgMHgyMCk7Ci0JCQlicmVhazsKKwlj
YXNlIFNFQ19WT0xUQUdFXzEzOgorCQljeF9jbGVhcihNT19HUDBfSU8sIDB4MjApOworCQlicmVh
azsKKwljYXNlIFNFQ19WT0xUQUdFXzE4OgorCQljeF9zZXQoTU9fR1AwX0lPLCAweDIwKTsKKwkJ
YnJlYWs7CisJY2FzZSBTRUNfVk9MVEFHRV9PRkY6CisJCWN4X2NsZWFyKE1PX0dQMF9JTywgMHgy
MCk7CisJCWJyZWFrOworCX0KKworCWlmIChjb3JlLT5wcmV2X3NldF92b2x0YWdlKQorCQlyZXR1
cm4gY29yZS0+cHJldl9zZXRfdm9sdGFnZShmZSwgdm9sdGFnZSk7CisJcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyBpbnQgdnAxMDI3X3NldF92b2x0YWdlKHN0cnVjdCBkdmJfZnJvbnRlbmQgKmZlLAor
CQkJCSAgICBmZV9zZWNfdm9sdGFnZV90IHZvbHRhZ2UpCit7CisJc3RydWN0IGN4ODgwMl9kZXYg
KmRldiA9IGZlLT5kdmItPnByaXY7CisJc3RydWN0IGN4ODhfY29yZSAqY29yZSA9IGRldi0+Y29y
ZTsKKworCXN3aXRjaCAodm9sdGFnZSkgeworCWNhc2UgU0VDX1ZPTFRBR0VfMTM6CisJCWRwcmlu
dGsoMSwgIkxOQiBTRUMgVm9sdGFnZT0xM1xuIik7CisJCWN4X3dyaXRlKE1PX0dQMF9JTywgMHgw
MDAwMTIyMCk7CisJCWJyZWFrOworCWNhc2UgU0VDX1ZPTFRBR0VfMTg6CisJCWRwcmludGsoMSwg
IkxOQiBTRUMgVm9sdGFnZT0xOFxuIik7CisJCWN4X3dyaXRlKE1PX0dQMF9JTywgMHgwMDAwMTIy
Mik7CisJCWJyZWFrOworCWNhc2UgU0VDX1ZPTFRBR0VfT0ZGOgorCQlkcHJpbnRrKDEsICJMTkIg
Vm9sdGFnZSBPRkZcbiIpOworCQljeF93cml0ZShNT19HUDBfSU8sIDB4MDAwMDEyMzApOworCQli
cmVhazsKIAl9CiAKIAlpZiAoY29yZS0+cHJldl9zZXRfdm9sdGFnZSkKQEAgLTEyMTAsNiArMTI0
MSwxOSBAQAogCQl9CiAJCWJyZWFrOwogCQl9CisJY2FzZSBDWDg4X0JPQVJEX1RXSU5IQU5fVlAx
MDI3X0RWQlM6CisJCWRldi0+dHNfZ2VuX2NudHJsID0gMHgwMDsKKwkJZmUwLT5kdmIuZnJvbnRl
bmQgPSBkdmJfYXR0YWNoKG1iODZhMTZfYXR0YWNoLAorCQkJCQkJJnR3aW5oYW5fdnAxMDI3LAor
CQkJCQkJJmNvcmUtPmkyY19hZGFwKTsKKwkJaWYgKGZlMC0+ZHZiLmZyb250ZW5kKSB7CisJCQlj
b3JlLT5wcmV2X3NldF92b2x0YWdlID0KKwkJCQkJZmUwLT5kdmIuZnJvbnRlbmQtPm9wcy5zZXRf
dm9sdGFnZTsKKwkJCWZlMC0+ZHZiLmZyb250ZW5kLT5vcHMuc2V0X3ZvbHRhZ2UgPQorCQkJCQl2
cDEwMjdfc2V0X3ZvbHRhZ2U7CisJCX0KKwkJYnJlYWs7CisKIAlkZWZhdWx0OgogCQlwcmludGso
S0VSTl9FUlIgIiVzLzI6IFRoZSBmcm9udGVuZCBvZiB5b3VyIERWQi9BVFNDIGNhcmQgaXNuJ3Qg
c3VwcG9ydGVkIHlldFxuIiwKIAkJICAgICAgIGNvcmUtPm5hbWUpOwpkaWZmIC1yIDY5MDA1NTk5
MzAxMSBsaW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC1pbnB1dC5jCi0tLSBhL2xp
bnV4L2RyaXZlcnMvbWVkaWEvdmlkZW8vY3g4OC9jeDg4LWlucHV0LmMJU3VuIEZlYiAwNyAyMjoy
NjoxMCAyMDEwIC0wMjAwCisrKyBiL2xpbnV4L2RyaXZlcnMvbWVkaWEvdmlkZW8vY3g4OC9jeDg4
LWlucHV0LmMJTW9uIEZlYiAwOCAyMDozODozMiAyMDEwICswMzAwCkBAIC0zNTAsNiArMzUwLDEx
IEBACiAJCWlyLT5tYXNrX2tleWNvZGUgPSAweDdlOwogCQlpci0+cG9sbGluZyAgICAgID0gMTAw
OyAvKiBtcyAqLwogCQlicmVhazsKKwljYXNlIENYODhfQk9BUkRfVFdJTkhBTl9WUDEwMjdfRFZC
UzoKKwkJaXJfY29kZXMgICAgICAgICA9ICZpcl9jb2Rlc190d2luaGFuX3ZwMTAyN19kdmJzX3Rh
YmxlOworCQlpcl90eXBlICAgICAgICAgID0gSVJfVFlQRV9QRDsKKwkJaXItPnNhbXBsaW5nICAg
ICA9IDB4ZmYwMDsgLyogYWRkcmVzcyAqLworCQlicmVhazsKIAl9CiAKIAlpZiAoTlVMTCA9PSBp
cl9jb2RlcykgewpAQCAtNDY3LDYgKzQ3Miw3IEBACiAJY2FzZSBDWDg4X0JPQVJEX1BST0ZfNzMw
MDoKIAljYXNlIENYODhfQk9BUkRfUFJPRl83MzAxOgogCWNhc2UgQ1g4OF9CT0FSRF9QUk9GXzYy
MDA6CisJY2FzZSBDWDg4X0JPQVJEX1RXSU5IQU5fVlAxMDI3X0RWQlM6CiAJCWlyY29kZSA9IGly
X2RlY29kZV9wdWxzZWRpc3RhbmNlKGlyLT5zYW1wbGVzLCBpci0+c2NvdW50LCAxLCA0KTsKIAog
CQlpZiAoaXJjb2RlID09IDB4ZmZmZmZmZmYpIHsgLyogZGVjb2RpbmcgZXJyb3IgKi8KZGlmZiAt
ciA2OTAwNTU5OTMwMTEgbGludXgvZHJpdmVycy9tZWRpYS92aWRlby9jeDg4L2N4ODguaAotLS0g
YS9saW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC5oCVN1biBGZWIgMDcgMjI6MjY6
MTAgMjAxMCAtMDIwMAorKysgYi9saW51eC9kcml2ZXJzL21lZGlhL3ZpZGVvL2N4ODgvY3g4OC5o
CU1vbiBGZWIgMDggMjA6Mzg6MzIgMjAxMCArMDMwMApAQCAtMjQwLDYgKzI0MCw3IEBACiAjZGVm
aW5lIENYODhfQk9BUkRfV0lORkFTVF9EVFYxODAwSCAgICAgICAgODEKICNkZWZpbmUgQ1g4OF9C
T0FSRF9XSU5GQVNUX0RUVjIwMDBIX0ogICAgICA4MgogI2RlZmluZSBDWDg4X0JPQVJEX1BST0Zf
NzMwMSAgICAgICAgICAgICAgIDgzCisjZGVmaW5lIENYODhfQk9BUkRfVFdJTkhBTl9WUDEwMjdf
RFZCUyAgICAgODQKIAogZW51bSBjeDg4X2l0eXBlIHsKIAlDWDg4X1ZNVVhfQ09NUE9TSVRFMSA9
IDEsCmRpZmYgLXIgNjkwMDU1OTkzMDExIGxpbnV4L2luY2x1ZGUvbWVkaWEvaXItY29tbW9uLmgK
LS0tIGEvbGludXgvaW5jbHVkZS9tZWRpYS9pci1jb21tb24uaAlTdW4gRmViIDA3IDIyOjI2OjEw
IDIwMTAgLTAyMDAKKysrIGIvbGludXgvaW5jbHVkZS9tZWRpYS9pci1jb21tb24uaAlNb24gRmVi
IDA4IDIwOjM4OjMyIDIwMTAgKzAzMDAKQEAgLTE2Myw0ICsxNjMsNSBAQAogZXh0ZXJuIHN0cnVj
dCBpcl9zY2FuY29kZV90YWJsZSBpcl9jb2Rlc19nYWRtZWlfcm0wMDh6X3RhYmxlOwogZXh0ZXJu
IHN0cnVjdCBpcl9zY2FuY29kZV90YWJsZSBpcl9jb2Rlc19uZWNfdGVycmF0ZWNfY2luZXJneV94
c190YWJsZTsKIGV4dGVybiBzdHJ1Y3QgaXJfc2NhbmNvZGVfdGFibGUgaXJfY29kZXNfd2luZmFz
dF91c2JpaV9kZWx1eGVfdGFibGU7CitleHRlcm4gc3RydWN0IGlyX3NjYW5jb2RlX3RhYmxlIGly
X2NvZGVzX3R3aW5oYW5fdnAxMDI3X2R2YnNfdGFibGU7CiAjZW5kaWYK
--00032555a89263f82e047f1a6f76--
