Return-path: <mchehab@pedra>
Received: from mgw2.diku.dk ([130.225.96.92]:33906 "EHLO mgw2.diku.dk"
	rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
	id S1750809Ab1AZF7p (ORCPT <rfc822;linux-media@vger.kernel.org>);
	Wed, 26 Jan 2011 00:59:45 -0500
Date: Wed, 26 Jan 2011 06:59:39 +0100 (CET)
From: Julia Lawall <julia@diku.dk>
To: Peter =?iso-8859-1?q?H=FCwe?= <PeterHuewe@gmx.de>
Cc: Mauro Carvalho Chehab <mchehab@infradead.org>,
	linux-media@vger.kernel.org, linux-kernel@vger.kernel.org,
	kernel-janitors@vger.kernel.org,
	Steven Toth <stoth@kernellabs.com>, Tejun Heo <tj@kernel.org>,
	Dan Carpenter <error27@gmail.com>
Subject: Re: [PATCH] video/saa7164: Fix sparse warning: Using plain integer
 as NULL pointer
In-Reply-To: <201101252354.31217.PeterHuewe@gmx.de>
Message-ID: <Pine.LNX.4.64.1101260653450.18314@ask.diku.dk>
References: <1295988851-23561-1-git-send-email-peterhuewe@gmx.de>
 <Pine.LNX.4.64.1101252319570.3668@ask.diku.dk> <201101252354.31217.PeterHuewe@gmx.de>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="-511516320-865825280-1296021280=:18314"
Content-ID: <Pine.LNX.4.64.1101260655030.18314@ask.diku.dk>
List-ID: <linux-media.vger.kernel.org>
Sender: <mchehab@pedra>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

---511516320-865825280-1296021280=:18314
Content-Type: TEXT/PLAIN; CHARSET=iso-8859-1
Content-Transfer-Encoding: 8BIT
Content-ID: <Pine.LNX.4.64.1101260655031.18314@ask.diku.dk>

On Tue, 25 Jan 2011, Peter Hüwe wrote:

> Am Dienstag 25 Januar 2011, 23:20:44 schrieb Julia Lawall:
> > On Tue, 25 Jan 2011, Peter Huewe wrote:
> > > This patch fixes the warning "Using plain integer as NULL pointer",
> > > generated by sparse, by replacing the offending 0s with NULL.
> > 
> > I recall (a number of years ago) being told that for things like kmalloc,
> > the proper test was !x, not x == NULL.
> > 
> > julia
> > 
> 
> 
> Hi Julia,
> 
> thanks for your input.
> So do I understand you correctly if I say
> if(!x) is better than if(x==NULL) in any case?

No.

> Or only for the kmalloc family?
> 
> Do you remember the reason why !x should be preferred?

Because it is a function call, and NULL represents failure of that 
function, not an actual NULL value.

Here is an email that explains that:

http://lkml.org/lkml/2007/7/27/103

Here is the beginning of the thread:

http://lkml.org/lkml/2007/7/27/75

julia

> In Documentation/CodingStyle ,  Chapter 7: Centralized exiting of functions 
> there is a function fun with looks like this:
> int fun(int a)
> {
>     int result = 0;
>     char *buffer = kmalloc(SIZE);
> 
>     if (buffer == NULL)
>         return -ENOMEM;
> 
>     if (condition1) {
>         while (loop1) {
>             ...
>         }
>         result = 1;
>         goto out;
>     }
>     ...
> out:
>     kfree(buffer);
>     return result;
> }
> 
> 
> -->  So   if (buffer == NULL) is in the official CodingStyle - maybe we should 
> add a paragraph there as well ;)
> 
> 
> Don't get me wrong, I just want to learn ;)
> 
> 
> Thanks,
> Peter
> 
> --
> To unsubscribe from this list: send the line "unsubscribe kernel-janitors" in
> the body of a message to majordomo@vger.kernel.org
> More majordomo info at  http://vger.kernel.org/majordomo-info.html
> 
---511516320-865825280-1296021280=:18314--
